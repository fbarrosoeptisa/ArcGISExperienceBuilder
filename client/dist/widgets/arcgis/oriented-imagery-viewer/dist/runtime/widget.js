System.register(["esri/core/reactiveUtils","esri/widgets/OrientedImageryViewer","calcite-components","jimu-arcgis","jimu-core","jimu-core/react","esri/core/maybe"],(function(e,t){var l={},a={},i={},o={},r={},n={},s={};return{setters:[function(e){l.once=e.once,l.watch=e.watch},function(e){a.default=e.default},function(e){i.CalciteButton=e.CalciteButton,i.CalciteOption=e.CalciteOption,i.CalciteSelect=e.CalciteSelect,i.CalciteTooltip=e.CalciteTooltip},function(e){o.JimuMapViewComponent=e.JimuMapViewComponent},function(e){r.WidgetState=e.WidgetState,r.css=e.css,r.jsx=e.jsx,r.utils=e.utils},function(e){n.memo=e.memo,n.useCallback=e.useCallback,n.useEffect=e.useEffect,n.useState=e.useState},function(e){s.abortMaybe=e.abortMaybe,s.destroyMaybe=e.destroyMaybe}],execute:function(){e((()=>{var e={99037:e=>{"use strict";e.exports=i},71155:e=>{"use strict";e.exports=s},62243:e=>{"use strict";e.exports=l},98357:e=>{"use strict";e.exports=a},62686:e=>{"use strict";e.exports=o},79244:e=>{"use strict";e.exports=r},68972:e=>{"use strict";e.exports=n}},t={};function d(l){var a=t[l];if(void 0!==a)return a.exports;var i=t[l]={exports:{}};return e[l](i,i.exports,d),i.exports}d.d=(e,t)=>{for(var l in t)d.o(t,l)&&!d.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})},d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},d.p="";var c={};return d.p=window.jimuConfig.baseUrl,(()=>{"use strict";d.r(c),d.d(c,{__set_webpack_public_path__:()=>m,default:()=>v});var e=d(62243),t=d(98357),l=d(99037),a=d(62686),i=d(79244),o=d(68972);var r=d(71155);const n=e=>{var t,l,a,i,o;const n=e.viewModel;n._updateFootprintTask=(0,r.abortMaybe)(n._updateFootprintTask),n._clickTask=(0,r.abortMaybe)(n._clickTask),null===(t=n.coverageFrustums)||void 0===t||t.destroy(),null===(l=n.coveragePolygons)||void 0===l||l.destroy(),null===(a=n.pointSources)||void 0===a||a.destroy(),null===(i=n.additionalFootprints)||void 0===i||i.destroy(),null===(o=n.additionalCameraLocations)||void 0===o||o.destroy(),n.bestFeatureFootprint=(0,r.destroyMaybe)(n.bestFeatureFootprint),n.bestFeatureCurrentFootprint=(0,r.destroyMaybe)(n.bestFeatureCurrentFootprint),n._crossSymbol=(0,r.destroyMaybe)(n._crossSymbol),n._referencePointOnGround=(0,r.destroyMaybe)(n._referencePointOnGround),n._referencePointOnImage=(0,r.destroyMaybe)(n._referencePointOnImage),n._overlays&&n._overlays.graphics.removeAll(),e.viewModel.resetImage()},s={_widgetLabel:"Oriented Imagery Viewer",noOiLayersError:"No Oriented Imagery Layer in the selected map.",noMapSelectedError:"No Map selected.",defaultError:"Failed to load the widget.",enableViewer:"Enable viewer",disableViewer:"Disable viewer"};function u(r){var d;const{state:c,config:u,intl:v}=r,[m,p]=(0,o.useState)(null),[y,b]=(0,o.useState)(null),[f,g]=(0,o.useState)([]),[w,x]=(0,o.useState)(!0),[E,C]=(0,o.useState)(null),S=!m||!(null==f?void 0:f.length),j=`oi-viewer-container-${r.id}-${i.utils.getUUID()}`,M=(0,o.useCallback)((e=>{if(e){const t=document.getElementById(j);b(null),t&&(t.innerHTML=""),n(e)}}),[j]),h=(0,o.useCallback)(((e,l=null)=>{const a=new t.default({view:e,disabled:!1,container:j,layer:l});a.visibleElements.title=!1,a.visibleElements.closeButton=!1,a.visibleElements.viewerTools=!1,b(a)}),[j]),O=(0,o.useCallback)((e=>e.filter((e=>"oriented-imagery"===e.type&&e.loaded)).map((e=>({id:"type"in e.parent&&"group"===e.parent.type?`${e.parent.id}-${e.id}`:e.id,layer:e}))).toArray()),[]),_=(0,o.useCallback)((e=>{var t,l;const a=O(e.map.allLayers);let i=E;a.map((e=>e.id)).includes(null==E?void 0:E.id)||(i=a[0]),y?(n(y),k(y,"view",e),k(y,"layer",null!==(t=null==i?void 0:i.layer)&&void 0!==t?t:null)):h(e,null!==(l=null==i?void 0:i.layer)&&void 0!==l?l:null),g(a),C(i)}),[E,y,h,O]);(0,o.useEffect)((()=>()=>{y&&n(y)}),[y]),(0,o.useEffect)((()=>{if(m){const t=e.watch((()=>{var e,t;return null===(t=null===(e=m.map)||void 0===e?void 0:e.allLayers)||void 0===t?void 0:t.filter((e=>"oriented-imagery"===e.type&&e.loaded)).length}),(()=>{_(m)}));return()=>{t.remove()}}}),[m,_]),(0,o.useEffect)((()=>{!m||c&&c!==i.WidgetState.Opened?c===i.WidgetState.Closed&&y&&k(y,"disabled",!0):y&&k(y,"disabled",!w)}),[m,c,y,w]),(0,o.useEffect)((()=>{m?E&&m&&((null==E?void 0:E.layer.loaded)?m.goTo(null==E?void 0:E.layer.fullExtent):e.once((()=>null==E?void 0:E.layer.loaded)).then((()=>{m.goTo(null==E?void 0:E.layer.fullExtent)}))):M(y)}),[E,m,y,M]),(0,o.useEffect)((()=>{if(y){const e=y;e.visibleElements.imageGallery=u.imageGalleryEnabled,e.visibleElements.imageEnhancement=u.imageEnahncementEnabled,e.visibleElements.navigationTool=u.navigationToolEnabled,e.visibleElements.coverageMenu=u.viewerToolsEnabled,e.visibleElements.mapImageConversionTool=u.mapImageConversionToolEnabled,e.visibleElements.showPopupsAction=u.showPopupsActionEnabled,e.visibleElements.measurementTools=u.measurementToolsEnabled,e.visibleElements.imageOverlays=u.imageOverlaysEnabled,e.dataCaptureEnabled=u.dataCaptureEnabled,b(e)}}),[y,u]);const T=e=>v?v.formatMessage({id:e,defaultMessage:s[e]}):e,k=(e,t,l)=>{e[t]=l,b(e)},F=e=>{const t=e.target.selectedOption.value,l=f.find((e=>e.id===t));C(l),k(y,"layer",l.layer),n(y)},I=()=>{x((e=>!e))},P=()=>(0,i.jsx)(l.CalciteSelect,{label:"Oriented Imagery Layer Selector","data-select-id":"imagery-layer-selector",className:"mb-1",value:null==E?void 0:E.id,onCalciteSelectChange:F},null==f?void 0:f.map((e=>(0,i.jsx)(l.CalciteOption,{key:e.id,value:e.id,selected:E.id===e.id},e.layer.title))));return(0,i.jsx)("div",{css:i.css`
    --calcite-color-brand: var(--sys-color-primary-main);
    --calcite-color-brand-press: var(--sys-color-primary-dark);
    --calcite-color-brand-hover: var(--sys-color-primary-light);
    --calcite-color-text-inverse: var(--sys-color-primary-text)};
  `,className:"jimu-widget overflow-auto p-2",style:{backgroundColor:r.theme.ref.palette.white}},(0,i.jsx)(a.JimuMapViewComponent,{useMapWidgetId:null===(d=r.useMapWidgetIds)||void 0===d?void 0:d[0],onActiveViewChange:e=>{if(e){const t=e.view;p(t),_(t)}else p(null),g([]),C(null)}}),(0,i.jsx)("div",{className:"h-100 w-100 flex-column "+(S?"d-none":"d-flex")},(0,i.jsx)("div",{className:"d-flex"},(0,i.jsx)("div",{className:"mr-1"},y?(0,i.jsx)("div",null,(0,i.jsx)(l.CalciteButton,{appearance:"solid",kind:"brand",label:"Viewer Toggle Button",iconStart:w?"view-visible":"view-hide",role:"switch",id:`oi-viewer-toggle-${r.id}`,onClick:I}),(0,i.jsx)(l.CalciteTooltip,{referenceElement:`oi-viewer-toggle-${r.id}`},T(w?"disableViewer":"enableViewer"))):null),(0,i.jsx)("div",{className:"flex-grow-1"},P())),(0,i.jsx)("div",{className:"d-flex flex-grow-1 justify-content-center",id:j})),(()=>{if(!S)return null;let e=T("defaultError");return m?(null==f?void 0:f.length)||(e=T("noOiLayersError")):e=T("noMapSelectedError"),(0,i.jsx)("div",{className:"d-flex align-items-center justify-content-center w-100 h-100 px-3 text-center"},(0,i.jsx)("div",null,e))})())}u.mapExtraStateProps=(e,t)=>({locale:e.appContext.locale});const v=(0,o.memo)(u);function m(e){d.p=e}})(),c})())}}}));