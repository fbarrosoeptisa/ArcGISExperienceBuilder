/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-3ed537.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-3ed537"],{38277:(e,t,i)=>{i.r(t),i.d(t,{arcgis_font_picker:()=>S,arcgis_symbol_picker:()=>Ae,arcgis_symbol_styler:()=>Et,arcgis_symbol_styler_browse_styles:()=>zt,arcgis_symbol_styler_color_ramp_input:()=>Xt,arcgis_symbol_styler_section:()=>Yt,arcgis_symbol_styler_symbol_preview:()=>Kt});var o=i(28614),s=i(52868),r=i(44021),n=i(97127),l=i(50063),a=i(71480),c=i(48843),h=i(89826),m=i(36392),d=i(68180),p=i(58325),y=i(90028);function u(e){return e.credential?.token||e.token||e.user?.credential?.token||e.portalUser?.token||""}const g=["Arial Bold","Arial Bold Italic","Arial Italic","Arial Regular","Arial Unicode MS Bold Italic","Arial Unicode MS Italic","Avenir Bold","Avenir Bold Italic","Avenir Italic","Avenir Regular","Palatino Linotype Regular","Times New Roman Bold","Times New Roman Bold Italic","Times New Roman Italic","Times New Roman Regular","Verdana Bold","Verdana Bold Italic","Verdana Italic","Verdana Regular"];var b;!function(e){e.ASCENDING="ascending",e.DESCENDING="descending"}(b||(b={}));const S=class{constructor(e){(0,o.r)(this,e),this.arcgisClose=(0,o.c)(this,"arcgisClose",7),this.arcgisFontPickerDismissed=(0,o.c)(this,"arcgisFontPickerDismissed",7),this.arcgisChange=(0,o.c)(this,"arcgisChange",7),this.arcgisFontPickerChange=(0,o.c)(this,"arcgisFontPickerChange",7),this.manager=(0,n.u)(this),this.strings=(0,l.u)({blocking:!0}),this.currentFont="",this.mapSpecificFontMap=new Map,this.view=void 0,this.enableMapSpecificFontList=!1,this.fontMap=void 0,this.font=void 0,this.popoverProps=void 0,this.hideCancel=!1,this.lastSortBy=b.ASCENDING,this.currentFontGroup=this.enableMapSpecificFontList&&this.view?"map-fonts":"static-fonts"}async setFocus(){this.panelNode?.setFocus()}async reposition(){this.popoverNode?.reposition()}async componentWillLoad(){const{font:e,enableMapSpecificFontList:t}=this;this.currentFont=e&&(0,s.f)(e),await this.loadAllModules(),await this.loadAllFonts(),t&&await this.loadMapSpecificFonts()}async componentDidLoad(){const{font:e}=this;e&&setTimeout((()=>this.listNode?.selectedItems?.[0]?.scrollIntoView({behavior:"auto",block:"center",inline:"center"})),300),setTimeout((()=>requestAnimationFrame((()=>this.panelNode?.setFocus()))),300)}render(){const{strings:e,popoverProps:t}=this,i={width:`${t.popoverWidth??t.refElement.getBoundingClientRect().width}px`};return t.maxHeight&&(i.maxHeight=t.maxHeight),(0,o.h)(o.H,{key:"adbcd3ab718bda6153a116f2f301eaf1815386c1",class:"js-app-flyout"},(0,o.h)("calcite-popover",{key:"00faf43478ea97080037ba108a3bf925f73af2fe",dir:(0,n.a)(this.el),class:"popover",placement:t.placement||"leading-start",open:!0,pointerDisabled:!0,referenceElement:t.refElement,offsetDistance:t.offsetDistance??-Math.round(t.refElement.getBoundingClientRect().width),offsetSkidding:t.offsetSkidding??0,overlayPositioning:t.overlayPositioning,triggerDisabled:t.triggerDisabled,autoClose:t.autoClose,label:e.fonts,ref:e=>this.popoverNode=e},(0,o.h)("calcite-panel",{key:"2c9c14b0a712d3a474c88d0bf52a8d24e5d6fdfd",class:"panel",heading:e.fonts,closable:!0,style:i,onCalcitePanelClose:()=>{this.arcgisFontPickerDismissed.emit(),this.arcgisClose.emit()},ref:e=>this.panelNode=e},this.renderFontControls(),(0,o.h)("calcite-list",{key:"4203807e2c197e80d59a0d754cdf8d39b37b6440",label:e.fonts,class:"content",filterEnabled:!0,filterPlaceholder:e.searchFonts,selectionMode:"single-persist",ref:e=>this.listNode=e},this.renderSortDropdown(),[...this.getSortedFontList(this.currentFontGroup)].map((([e])=>this.renderListItem(e)))),this.renderCancelButton())))}renderFontControls(){const{strings:e,view:t,enableMapSpecificFontList:i}=this;return t&&i?(0,o.h)("div",{slot:"content-top",class:"font-mode-wrapper"},(0,o.h)("calcite-segmented-control",{scale:"s",width:"full",onCalciteSegmentedControlChange:async e=>{const t=e.target.value;"map-fonts"===t&&(this.mapSpecificFontMap=new Map,await this.loadMapSpecificFonts()),this.currentFontGroup=t,setTimeout((()=>{this.listNode.selectedItems?.[0]?.scrollIntoView({behavior:"auto",block:"center",inline:"center"})}),300)}},(0,o.h)("calcite-segmented-control-item",{value:"map-fonts",checked:!0},e.mapFonts),(0,o.h)("calcite-segmented-control-item",{value:"static-fonts",checked:!1},e.allFonts))):(0,o.h)(o.F,null)}renderListItem(e){const{strings:t,fontMap:i,mapSpecificFontMap:s,currentFont:r,currentFontGroup:n}=this,l="static-fonts"===n?i:s;return(0,o.h)("calcite-list-item",{key:e,label:e,value:e,selected:r===e,metadata:{label:e},onCalciteListItemSelect:async()=>{const e=await this.getSelectedFont();this.arcgisFontPickerChange.emit(e),this.arcgisChange.emit(e),this.arcgisFontPickerDismissed.emit(),this.arcgisClose.emit()}},(0,o.h)("div",{class:"font-preview",slot:"actions-end",style:{fontFamily:l.get(e).font.family,fontStyle:l.get(e).font.style,fontWeight:l.get(e).font.weight}},t.fontPreview))}renderSortDropdown(){const{strings:e}=this;return(0,o.h)("calcite-dropdown",{slot:"filter-actions-end",overlayPositioning:"fixed",placement:"bottom-end"},(0,o.h)("calcite-action",{slot:"trigger",icon:"sortDescending",text:e.sort,title:e.sort}),(0,o.h)("calcite-dropdown-group",null,(0,o.h)("calcite-dropdown-item",{selected:this.lastSortBy===b.ASCENDING,onClick:()=>this.lastSortBy=b.ASCENDING,onKeyDown:e=>{e.stopPropagation()," "!==e.key&&"Enter"!==e.key||(this.lastSortBy=b.ASCENDING)}},e.ascending),(0,o.h)("calcite-dropdown-item",{selected:this.lastSortBy===b.DESCENDING,onClick:()=>this.lastSortBy=b.DESCENDING,onKeyDown:e=>{e.stopPropagation()," "!==e.key&&"Enter"!==e.key||(this.lastSortBy=b.DESCENDING)}},e.descending)))}renderCancelButton(){const{strings:e,hideCancel:t}=this;return t?(0,o.h)(o.F,null):(0,o.h)("calcite-button",{slot:"footer",appearance:"outline-fill",width:"full",onClick:()=>{this.arcgisFontPickerDismissed.emit(),this.arcgisClose.emit()}},e.cancel)}async loadAllModules(){const[e,t,i,o]=await Promise.all([(0,a.c)(),(0,a.ba)(),(0,a.f)(),(0,a.bb)()]);this.modules={portalItem:e,symbolFontUtils:t,request:i,fontUtils:o}}async loadAllFonts(){const{modules:e,fontMap:t}=this,i=Array.from(t.entries());Promise.all(i.map((async t=>{try{g.includes(t[0])||await e.fontUtils.loadFont(t[1].font)}catch(e){}})))}async loadMapSpecificFonts(){const{view:e}=this;if(!e)return(0,o.h)(o.F,null);const t=e.map.allLayers??[];if(t.length){const e=t.flatten((e=>"sublayers"in e?e.sublayers:null));await this.loadLayerFonts(e)}const i=e.map.portalItem;i&&await this.loadItemFonts(i)}async loadLayerFonts(e){const t=[],i=e.filter((e=>"vector-tile"!==e.type))??[],o=e.filter((e=>"vector-tile"===e.type))??[];i.forEach((async e=>{if(e.labelingInfo){[...e.labelingInfo].forEach((e=>{e.symbol?.font&&t.push(e.symbol.font)}))}})),this.loadNonVectorTileLayerFonts(t),await this.loadVectorTileLayerFonts(o)}async loadItemFonts(e){const{modules:t}=this,i=`${o=e.portal,(0,r.a)(o.restUrl)}content/items/${e.id}/data`;var o;const s=await t.request(i,{query:{f:"json"},responseType:"json",method:"get",token:u(e.portal)});if(s?.data){const e=s.data,i=[...e.operationalLayers??[],...e.baseMap?.baseMapLayers??[]];if(i.length){const e=i.filter((e=>"VectorTileLayer"!==e.layerType))??[],o=i.filter((e=>"VectorTileLayer"===e.layerType))??[],s=[];e.forEach((e=>{const i=e.layerDefinition?.drawingInfo?.labelingInfo;if(i){[...i].forEach((e=>{e.symbol?.font&&s.push(t.symbolFontUtils.fromJSON(e.symbol?.font))}))}})),this.loadNonVectorTileLayerFonts(s),await this.loadVectorTileLayerFonts(o)}}}loadNonVectorTileLayerFonts(e){const{fontMap:t}=this;e.map((async e=>{const i=(0,s.f)(e);t.get(i)&&this.mapSpecificFontMap.set(i,t.get(i))}))}async loadVectorTileLayerFonts(e){const{modules:t}=this,i=e.map((async e=>await t.request(e.styleUrl,{query:{f:"json"},method:"get",responseType:"json"})));(await Promise.all(i)).forEach((e=>{const t=e?.data;if(t?.layers){const e=[];t.layers.forEach((t=>{const i=t.layout?.["text-font"]?.[0];i&&!e.includes(i)&&e.push(i)})),e.forEach((e=>{const t=this.fontMap.get(e);t&&this.mapSpecificFontMap.set(e,t)}))}}))}getSortedFontList(e){const{fontMap:t,mapSpecificFontMap:i,lastSortBy:o}=this,s="static-fonts"===e?t:i;return o===b.ASCENDING?[...s].sort():[...s].sort().reverse()}async getSelectedFont(){const{fontMap:e,font:t}=this;return e.get(this.listNode.selectedItems[0].value)?.font??t}static get assetsDirs(){return["assets"]}get el(){return(0,o.g)(this)}};S.style=".popover{--calcite-popover-z-index:100}.panel{min-height:300px}.content{max-height:60vh}.font-mode-wrapper{width:100%}.font-preview{min-width:40px}";const f=[0,0,0,0];function k(e){return{authMode:"public"===e.access?"anonymous":"auto"}}const C=[{name:"Circle",type:"esriSMS",style:"esriSMSCircle",color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}},{name:"Square",type:"esriSMS",style:"esriSMSSquare",color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}},{name:"Diamond",type:"esriSMS",style:"esriSMSDiamond",color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}},{name:"Triangle",type:"esriSMS",style:"esriSMSTriangle",color:[0,0,128,128],size:18,outline:{color:[0,0,128,255],width:1}}],v=[{type:"esriSLS",color:[0,0,0,255],width:.75,style:"esriSLSSolid"}],w=[{type:"esriSFS",color:[0,0,0,64],outline:{type:"esriSLS",color:[0,0,0,255],width:.75,style:"esriSLSSolid"},style:"esriSFSSolid"}];function I(e){return[{title:e.symbolSources.circle,name:"Circle",primitive:"circle"},{title:e.symbolSources.square,name:"Square",primitive:"square"},{title:e.symbolSources.cross,name:"Cross",primitive:"cross"},{title:e.symbolSources.x,name:"X",primitive:"x"},{title:e.symbolSources.kite,name:"Kite",primitive:"kite"},{title:e.symbolSources.triangle,name:"Triangle",primitive:"triangle"}].map((e=>({dimensionality:"flat",name:e.name,title:e.title,type:"PointSymbol3D",symbolLayers:[{type:"Icon",resource:{primitive:e.primitive},material:{color:c.e?.gfxUtils?.defaultThematicColor},outline:{color:[0,0,0]}}]})))}function x(e){return[{title:e.symbolSources.sphere,name:"Sphere",primitive:"sphere"},{title:e.symbolSources.tallCylinder,name:"Tall_Cylinder",primitive:"cylinder",mixins:{width:5,height:10,depth:5}},{title:e.symbolSources.cylinder,name:"Cylinder",primitive:"cylinder"},{title:e.symbolSources.tallCube,name:"Tall_Cube",primitive:"cube",mixins:{width:5,height:10,depth:5,anchor:"bottom"}},{title:e.symbolSources.cube,name:"Cube",primitive:"cube"},{title:e.symbolSources.tallCone,name:"Tall_Cone",primitive:"cone",mixins:{width:5,height:10,depth:5}},{title:e.symbolSources.cone,name:"Cone",primitive:"cone"},{title:e.symbolSources.invertedCone,name:"Inverted_Cone",primitive:"invertedCone"},{title:e.symbolSources.diamond,name:"Diamond",primitive:"diamond"},{title:e.symbolSources.tetrahedron,name:"Tetrahedron",primitive:"tetrahedron"}].map((e=>({dimensionality:"volumetric",name:e.name,title:e.title,type:"PointSymbol3D",symbolLayers:[{type:"Object",resource:{primitive:e.primitive},...e.mixins}]})))}async function M(e,t,i,o){try{await c.e.symbolUtils.renderPreviewHTML(t,{node:e,...i})}catch(t){e.appendChild(P(o))}return e}function P(e){const t=document.createElement("span");return t.setAttribute("alt",""),t.innerHTML=e,t}function F(e="2d"){return{async getEsriSymbol(t){const{data:i,parentData:o,portalItem:s}=t,r=await async function(e,t,i,o){const s=function(e){for(const t of e.typeKeywords)if(/^Esri.*Style$/u.test(t)&&"Esri Style"!==t)return t;return}(i);let r=null;s||(r=`${i.itemUrl}/data`);const n={data:e,baseUrl:i.itemUrl,styleName:s,styleUrl:r},{portal:l}=i;return await c.e.webStyleSymbolUtils.fetchSymbolFromStyle(n,t,{portal:l},o,c.e.styleUtils.symbolUrlFromStyleItem,k(i))}(o,i.name,s,o.cimVersion&&"2d"===e?"cimRef":"webRef");return"point-3d"===r.type&&r.symbolLayers.forEach((e=>{if(e.material?.color)if("icon"===e.type){const t=null!=e.material?e.material:{};t.color=c.e.gfxUtils.defaultThematicColor.clone(),e.material=t}else if("object"===e.type){const t=null!=e.material?e.material:{};t.color=t.color||async function(e,t=!1){const i=e?f:void 0,o=await(0,a.G)();return t?o.fromJSON(i):new o(i)}([255,255,255]),e.material=t}})),r},getThumbnail:async e=>await async function(e){const t=e.data;let i=t.thumbnail?.href;const o=t.thumbnail?.imageData,s=t.title||e.strings?.symbolSources.noTitle,r=document.createElement("div"),n=!!t.cimRef,l=function(e){const t=e.formats?.includes("web3d"),i=e.formatInfos?.some((e=>"gltf"===e.type||"gltf_basisu"===e.type));return t||i}(t),a={size:l&&"volumetric"===t.dimensionality?42:24,disableUpsampling:!1};if(n&&!l){const t=await e.getEsriSymbol();if(!(0,c.i)(t))return(0,c.a)(t)&&delete a.size,await M(r,t,a,s)}if(c.e.devEnvironmentUtils?.isDevEnvironment(globalThis.location.hostname)&&(i=c.e.devEnvironmentUtils.adjustStaticAGOUrl(i)),!i&&!o)return r.appendChild(P(s)),r;const h=new(0,c.e.WebStyleSymbol)({name:t.name,styleUrl:`${e.portalItem.itemUrl}/data`,thumbnail:{url:o?`data:image/jpeg;base64, ${o}`:c.e.urlUtils.makeAbsolute(i,e.portalItem.itemUrl)}});return await M(r,h,a,s)}(e)}}const A={getEsriSymbol:async e=>(await(0,a.O)()).fromJSON(e.data),async getThumbnail(e){const t=await e.getEsriSymbol(),i={size:"line"===(0,c.g)(t)?{width:24}:24};return await c.e.symbolUtils.renderPreviewHTML(t,i)}},L={getEsriSymbol:async e=>c.e.jsonUtils.fromJSON(e.data),async getThumbnail(e){const t=await e.getEsriSymbol();return await c.e.symbolUtils.renderPreviewHTML(t,{size:38})}},_=Function.prototype;class R{constructor({data:e,parentData:t,portalItem:i,strategy:o,strings:s}){this.data=e,this.parentData=t,this.portalItem=i,this.strategy=o,this.strings=s}async getEsriSymbol(){if(!this._symbol){const e=this._symbolRequest||(this._symbolRequest=this.strategy?.getEsriSymbol(this));this._symbol=await e}return this._symbol.clone()}async getThumbnail(e){if(this._thumbnail)return e.appendChild(this._thumbnail),_;const t=this._thumbnailRequest||(this._thumbnailRequest=this.strategy?.getThumbnail(this));return this._thumbnail=await t,()=>this._thumbnail&&e.appendChild(this._thumbnail)}}class E{constructor({portalItem:e,strings:t,symbolType:i}){this.symbolType="2d",this.portalItem=e,this.strings=t,i&&(this.symbolType=i)}get data(){return this._data}get id(){return this.portalItem?.id}get keywords(){return this.portalItem?.typeKeywords||[]}get name(){return this.portalItem?.name}get title(){return this.portalItem?.title}async fetchData(e){if(c.e.promiseUtils.isAborted(e))throw c.e.promiseUtils.createAbortError();return this._data||(this._data=await this.portalItem.fetchData("json",{...e,...k(this.portalItem)})),this._data}}class T extends E{constructor(){super(...arguments),this.type="symbol-set"}async getItems(e){if(c.e.promiseUtils.isAborted(e))throw c.e.promiseUtils.createAbortError();if(!this._items){const t=await this.fetchData(e);this._items=t.map((e=>new R({data:e,parentData:t,portalItem:this.portalItem,strategy:A,strings:this.strings})))}return this._items}}class z extends E{constructor(){super(...arguments),this.type="web-style"}async getItems(e){if(c.e.promiseUtils.isAborted(e))throw c.e.promiseUtils.createAbortError();if(!this._items){const t=await this.fetchData(e);this._items=t.items.map((e=>new R({data:e,parentData:t,portalItem:this.portalItem,strategy:F(this.symbolType),strings:this.strings})))}return this._items}}class O{constructor({strings:e}){this.id="",this.keywords=[],this.name="Basic",this.type="symbol-set",this.title=e.symbolSources.basic}async getItems(e){if(c.e.promiseUtils.isAborted(e))throw c.e.promiseUtils.createAbortError();return this._items||(this._items=this.data.map((e=>new R({data:e,strategy:A,strings:this.strings})))),this._items}}const B="basic-symbol-set:point",N="basic-symbol-set:line",U="basic-symbol-set:polygon";class j extends O{constructor(){super(...arguments),this.data=C,this.id=B,this.keywords=["Point"]}}class V extends O{constructor(){super(...arguments),this.data=v,this.id=N,this.keywords=["Line"]}}class D extends O{constructor(){super(...arguments),this.data=w,this.id=U,this.keywords=["Polygon"]}}class ${constructor({strings:e}){this.keywords=["3d"],this.id="basic-web-style:flat",this.name="Basic",this.type="web-style",this.data={items:I(e)},this.title=e.symbolSources.basic}async getItems(e){if(c.e.promiseUtils.isAborted(e))throw c.e.promiseUtils.createAbortError();return this._items||(this._items=this.data.items.map((e=>new R({data:e,strategy:A,strings:this.strings})))),this._items}}class G{constructor({strings:e}){this.id="basic-web-style:volumetric",this.keywords=["3d","volumetric"],this.name="Basic",this.type="web-style",this.data={items:x(e)},this.title=e.symbolSources.basic}async getItems(e){if(c.e.promiseUtils.isAborted(e))throw c.e.promiseUtils.createAbortError();return this._items||(this._items=this.data.items.map((e=>new R({data:e,parentData:this.data,strategy:L,strings:this.strings})))),this._items}}const H="marker-item",q="calcite-mode-dark",W=({item:e,index:t,observer:i})=>{const s=e.data.title?(0,o.h)("calcite-tooltip",{"reference-element":e.data.name,overlayPositioning:"fixed"},e.data.title):null;return(0,o.h)("span",{class:`${H} ${q}`,ref:o=>{if(!o)return;const s=o;s.item||(s.item=e,s.index=t,i.observe(o))},id:e.data.name,slot:"thumbnail"},s)};async function J(e,t){return await async function(e){return await Z({portal:e,queries:{group:e.symbolSetsGroupQuery,item:'type:"Symbol Set" AND (typekeywords:"by value" AND typekeywords:"marker")'}}).then(ee)}(e).then((e=>e.map((e=>new T({portalItem:e,strings:t})))))}async function X(e,t,i){return await async function(e,t){const i="2d"===t?e.stylesGroupQuery2d:e.stylesGroupQuery3d;if(!i)return[];return await Z({portal:e,queries:{group:i,item:'type:"Style"'}}).then(ee)}(e,t).then((e=>e.map((e=>new z({portalItem:e,symbolType:t,strings:i})))))}async function Y(e,t,i,o){return o?.length?await async function(e,t){let i="",o="";return t.forEach((e=>{i+=`${o}id:${e}`,o=" OR "})),await Z({portal:e,queries:{item:i}})}(e,o).then((e=>e.map((e=>new z({portalItem:e,symbolType:t,strings:i}))))):await new Promise((e=>{e([])}))}function K(e,t){return"flat"===e?new $({strings:t}):new G({strings:t})}function Q(e,t){const i={strings:e};return"line"===t?new V(i):"polygon"===t?new D(i):new j(i)}async function Z(e){const t=e.portal,i=e.queries.group,o=e.queries.item;if(i){const{results:e}=await t.queryGroups({query:i,disableExtraQuery:!0});if(0===e.length)return[];const[s]=e;return(await s.queryItems({query:o,disableExtraQuery:!0,num:100,sortField:s.sortField})).results}return(await t.queryItems({query:o,disableExtraQuery:!0,num:100})).results}function ee(e){const t=[];return e.forEach((e=>{var i;i="default",e.typeKeywords.includes(i)?t.unshift(e):t.push(e)})),t}const te="pointSymbol",ie="lineSymbol",oe="polygonSymbol",se=e=>!!e.portal;async function re(e,t){return await Promise.all(e.map(t)).then((t=>e.filter(((e,i)=>t[i]))))}async function ne(e,t,i,o,s,r){const n=ye(i),l="2d"===s?function(e,t){function i(i){if(t.includes("all"))return!0;const{data:o}=i,{dimensionality:s,type:r}=o;if("volumetric"===s)return!1;if("point"===e){if(t.includes("picture")&&"esriPMS"===r)return!0;if(t.includes("simple")&&"esriSMS"===r)return!0}if("line"===e&&t.includes("simple")&&"esriSLS"===r)return!0;if("polygon"===e&&t.includes("simple")&&"esriSFS"===r)return!0;const{formats:n}=o;return!(!pe(t)||!pe(n))}return async function(o,s){const r="point"===e?c.c:"line"===e?c.a:c.i;if(!i(o))return!1;const n=t.includes("cim:picture"),l=t.includes("cim:vector"),a=n&&l||!n&&!l,h=ae(s)&&!he(s)&&!me(s),m=he(s)&&!ae(s)&&!me(s),d=me(s)&&!ae(s)&&!he(s),p="line"===e?ie:"polygon"===e?oe:te;if((h||m||d)&&a||"web-style"!==s.type||o.data.itemType===p)return!0;const y=await o.getEsriSymbol();return!(0,c.b)(y)||r(y)}}(o,n):(a=n,async function(e){if(a.includes("all")||a.includes("3d"))return!0;const{data:{dimensionality:t}}=e;return a.includes("3d:flat")&&"flat"===t||a.includes("3d:volumetric")&&"volumetric"===t});var a;return await re(t,(async t=>r?await r(t,e,l):await l(t,e)))}const le={point:"Point",line:"Line",polygon:"Polygon"};function ae({keywords:e}){return e.includes(le.point)||e.includes("pointSymbol")}function ce({keywords:e}){return e.includes("marker")}function he({keywords:e}){return e.includes(le.line)||e.includes("lineSymbol")}function me({keywords:e}){return e.includes(le.polygon)||e.includes("polygonSymbol")}async function de(e,t,i,o,s){const r=ye(t),n="2d"===o?function(e,t){return async i=>{const o=i.keywords.includes("3d"),s=i.keywords.includes("Dictionary"),r="point"===e?ae(i)||ce(i):"line"===e?he(i):me(i),n=ae(i)||ce(i)||he(i)||me(i);if(o||s||!r&&n)return!1;if(t.includes("all"))return!0;function l(){return"point"===e?B:"line"===e?N:U}const a=l();return!(!t.includes("picture")||i.id===a||"symbol-set"!==i.type)||(!(!t.includes("simple")||i.id!==a)||!(!pe(t)||"web-style"!==i.type))}}(i,r):function(e){const t={EsriThematicShapesStyle:!0};return async i=>{if(i.keywords.every((e=>!t[e]))&&"web-style"===i.type&&(e.includes("all")||e.includes("3d")))return!0;if(function(e){return"portalItem"in e}(i)){const t=await i.fetchData(),[o]=t.items,{dimensionality:s}=o;return e.includes("3d:flat")&&"flat"===s||e.includes("3d:volumetric")&&"volumetric"===s}return e.includes("3d:flat")&&"basic-web-style:flat"===i.id||e.includes("3d:volumetric")&&"basic-web-style:volumetric"===i.id}}(r);return await re(e,(async e=>s?await s(e,n):await n(e)))}function pe(e){return Array.isArray(e)&&e.some((e=>e.includes("cim")))}function ye(e="all"){const t=Array.isArray(e)?e:[e],i=t.find((e=>"cim"===e&&t.find((e=>e.includes("cim:")))));return i?t.filter((e=>!e.includes("cim:"))):t}async function ue(e,t,i,o,s,r){const n={};t&&await t(e,n),await e.load();const l=await("2d"===s?async function(e,t,i){const o=e.symbolSetsGroupQuery;e.symbolSetsGroupQuery='owner:esri AND title:"Map Viewer Beta Symbols"';const[s,r,n]=await Promise.all([J(e,t),X(e,"2d",t),Y(e,"2d",t,i)]),l=e=>e.keywords.every((e=>"Basic"!==e)),a=[Q(t,"point"),Q(t,"line"),Q(t,"polygon"),...s.filter(l),...r.filter(l),...n.filter(l)];return e.symbolSetsGroupQuery=o,a}(e,o,r):async function(e,t){const[i]=await Promise.all([X(e,"3d",t)]),o=e=>e.keywords.every((e=>"Basic"!==e)),s=[K("flat",t),K("volumetric",t),...i.filter(o)];return s}(e,o));return i&&await i(e,n),l}const ge="arcgis-symbol-styler-storage-styles",be="arcgis-symbol-picker__container",Se="incompatible-symbols-notice",fe="empty-category-content",ke="marker-source-select",Ce="marker-selection",ve="scroller",we="item-palette",Ie="file-upload",xe="categories",Me="categories-center-action",Pe="symbol-div",Fe="empty-filter",Ae=class{constructor(e){(0,o.r)(this,e),this.arcgisActiveSymbolChange=(0,o.c)(this,"arcgisActiveSymbolChange",7),this.arcgisActiveSymbolItemChange=(0,o.c)(this,"arcgisActiveSymbolItemChange",7),this.arcgisActiveSourceIdChange=(0,o.c)(this,"arcgisActiveSourceIdChange",7),this.arcgisSymbolSourcesChange=(0,o.c)(this,"arcgisSymbolSourcesChange",7),this.arcgisActiveSourceItemsChange=(0,o.c)(this,"arcgisActiveSourceItemsChange",7),this.manager=(0,n.u)(this),this.allCustomFileInfos=[],this.customSymbolsStorageId="arcgis-symbol-picker-custom-symbols",this.actionEls=[],this._onSymbolSourceChange=e=>{const t=e.currentTarget,{selectedItems:i}=t,o=i.find((e=>e.getAttribute("data-value")!==this._activeSourceId));this._activeSourceId=o?.getAttribute("data-value")||this._activeSourceId,t.querySelectorAll("calcite-dropdown-item").forEach((e=>{e!==o&&(e.selected=!1)})),e.stopPropagation(),this.displayEmptyFilterMsg=!1},this.symbol=void 0,this.portal=void 0,this.symbolFilter=void 0,this.activeSourceId=void 0,this.activeSymbolItem=void 0,this.hideHeader=!1,this.symbolType="2d",this.customSymbolItemFilter=void 0,this.customSymbolSourceFilter=void 0,this.itemsPerRow=4,this.symbolSources=void 0,this.activeSymbolItems=void 0,this.hideSvgUploadSymbols=!1,this.messages=(0,l.u)({blocking:!0}),this._activeSourceId=void 0,this._symbolSources=void 0,this._activeSymbolItems=void 0,this.customSymbolError=void 0,this.isGridView=!0,this.displayEmptyFilterMsg=!1,this._activeSymbolFetch=void 0}async handleActiveSourceItemIdChanges(){if(this._activeSourceId)if("custom-symbol-set"===this._activeSourceId)this._setupCustomSymbols();else{const e=this._symbolSources?.find((({id:e})=>e===this._activeSourceId));e&&await this._fetchAndSetUpSymbolItems(e)}}get editGeometry(){return(0,c.g)(this.symbol)}async handleFileUploadChange({detail:e}){const t=e,i=t.cim&&JSON.stringify(t.cim.toJSON());if(t.dataURL&&t.dataURL.length>2e5)return void(this.customSymbolError="too-large");if(t.cim&&i&&i.length>2e5)return void(this.customSymbolError="too-large");this.customSymbolError=void 0;const o=this.allCustomFileInfos.find((e=>t.dataURL&&e.dataURL&&e.dataURL===t.dataURL&&e.fileName===t.fileName||t.cim&&e.cim&&e.fileName===t.fileName&&i===JSON.stringify(e.cim.toJSON())));try{let e;if(o)e=this._activeSymbolItems?.find((e=>e.data.name===o.fileName));else{const i=[...this.allCustomFileInfos,t];(0,h.s)(this.customSymbolsStorageId,i.map((e=>e.dataURL?e:{...e,cim:JSON.stringify(e.cim?.toJSON())})),!0),this.allCustomFileInfos=i,this._setupCustomSymbols(),e=this._activeSymbolItems?.[this._activeSymbolItems.length-1]}this.activeSymbolItem=e,this.arcgisActiveSymbolItemChange.emit(this.activeSymbolItem);const i=await(this.activeSymbolItem?.getEsriSymbol());this.arcgisActiveSymbolChange.emit(i),setTimeout((()=>requestAnimationFrame((()=>{this.itemPaletteNode?.setFocus(),this.updateListSelection()}))),1)}catch(e){this.customSymbolError="storage-full"}}handleInvalidFile(){this.customSymbolError="invalid-file"}handleFileUploadError(){this.customSymbolError="error"}async getStyleItemIds(){return this._symbolSources.filter((e=>"web-style"===e.type)).map((e=>e.id))}_renderSymbolSourceOptions(e,t){const{messages:i,savedStyleIds:s}=this,r=e.filter((e=>"symbol-set"===e.type&&!s?.includes(e.id))),n=e.filter((e=>"web-style"===e.type&&!s?.includes(e.id))),l=e.filter((e=>s?.includes(e.id)));l.sort(((e,t)=>e.title.localeCompare(t.title)));const a=!this.symbolFilter||!!(Array.isArray(this.symbolFilter)?this.symbolFilter:[this.symbolFilter]).find((e=>"custom"===e||"picture"===e))||s?.length,c="3d"!==this.symbolType&&("point"===this.editGeometry&&a||this.savedStyleIds?.length)&&(0,o.h)("calcite-dropdown-group",{groupTitle:i.addedStyles,selectionMode:"multiple",key:"custom"},this._renderSourceDropdownItem(l,t),"point"===this.editGeometry&&a&&(0,o.h)("calcite-dropdown-item",{key:"custom","data-value":"custom-symbol-set",selected:"custom-symbol-set"===t},i.customSymbols)),h=r.length>0&&(0,o.h)("calcite-dropdown-group",{groupTitle:i.classicSymbols,selectionMode:"multiple",key:"classic"},this._renderSourceDropdownItem(r,t)),m=n.length>0&&(0,o.h)("calcite-dropdown-group",{groupTitle:i.newSymbols,selectionMode:"multiple",key:"webstyles"},this._renderSourceDropdownItem(n,t));return c?h?m?[h,m,c]:[h,c]:[m,c]:h&&m?[h,m]:(0,o.h)("calcite-dropdown-group",{key:"one-group"},this._renderSourceDropdownItem([...r,...n],t))}_renderSourceDropdownItem(e,t){return e.map((e=>(0,o.h)("calcite-dropdown-item",{key:e.id,"data-value":e.id,selected:e.id===t},e.title)))}_setupCustomSymbols(){const e=this.allCustomFileInfos.map((e=>{let t=24,i=24;if(e.width>e.height?i=Math.round(t/e.width*e.height):e.width<e.height&&(t=Math.round(i/e.height*e.width)),e.dataURL){const o=e.fileName.split(".")[1].toLowerCase();return new R({data:{angle:0,contentType:"png"===o?"image/png":"gif"===o?"image/gif":"image/jpeg",height:i,imageData:e.dataURL.split(",")[1],name:e.fileName,type:"esriPMS",url:void 0,width:t,xoffset:0,yoffset:0},parentData:null,portalItem:void 0,strategy:A,strings:this.messages})}return new R({data:{symbol:e.cim,name:e.fileName},parentData:{cimVersion:"2.6.0"},portalItem:void 0,strategy:{getEsriSymbol:async e=>e.data.symbol,async getThumbnail(e){const t=M(document.createElement("div"),e.data.symbol,{size:24,disableUpsampling:!1},e.data.title);return await t}},strings:this.messages})}));this.setUpSymbolIntersectionObserver(),this.customSymbolError=void 0,this._activeSymbolFetch=null,this._activeSymbolItems=e,this.arcgisActiveSourceIdChange.emit("custom-symbol-set"),this.arcgisActiveSourceItemsChange.emit(e.map((e=>new R({...e}))))}async _fetchAndSetUpSymbolItems(e){this._activeSymbolFetch&&this._activeSymbolFetch.controller.abort();const t=new AbortController,i=t.signal;this._activeSymbolFetch={controller:t,id:e.id};const o=!this._activeSymbolItems&&this.activeSymbolItems||await e.getItems(t);if(i?.aborted)return;const s=await ne(e,o,this.symbolFilter,this.editGeometry,this.symbolType,this.customSymbolItemFilter);i?.aborted||(this.setUpSymbolIntersectionObserver(),this.customSymbolError=void 0,this._activeSymbolFetch=null,this._activeSymbolItems=s,this.arcgisActiveSourceIdChange.emit(this._activeSourceId),this.arcgisActiveSourceItemsChange.emit(s.map((e=>new R({...e})))))}tearDownSymbolIntersectionObserver(){this._symbolIntersectionObserver?.disconnect(),this._symbolIntersectionObserver=void 0}setUpSymbolIntersectionObserver(){this.tearDownSymbolIntersectionObserver();let e=0;const t={};this._symbolIntersectionObserver=new IntersectionObserver(((i,o)=>{function s(){e++,t[e]&&(t[e](),delete t[e],s())}i.forEach((i=>{if(!i.isIntersecting)return;const r=i.target;r.item.getThumbnail(r).then((i=>{r.index===e?(i(),s()):t[r.index]=i})),r.item.getEsriSymbol(),o.unobserve(r)}))}))}async _fetchSources(){this._sourcesFetchController&&this._sourcesFetchController.abort(),this._sourcesFetchController=new AbortController;const e=this._sourcesFetchController.signal,t=this.portal,i=se(t)?t.portal:t,o=se(t)?t.before:null,s=se(t)?t.after:null,r=i?this.symbolSources||await ue(i,o,s,this.messages,this.symbolType,this.savedStyleIds):[];if(e?.aborted)return;this._symbolSources=await de(r,this.symbolFilter,(0,c.g)(this.symbol),this.symbolType,this.customSymbolSourceFilter);const n=this._symbolSources.filter((e=>this.savedStyleIds?.includes(e.id)));if(n.length!==this.savedStyleIds?.length){const e=n.map((e=>e.id)),t=this.savedStyleIds?.filter((t=>!e.includes(t)));this.savedStyleIds=e,this.removeStyleIds(t)}if(this.arcgisSymbolSourcesChange.emit(this._symbolSources),!this._activeSourceId){let e=this.activeSourceId;if(e){this._symbolSources.find((e=>e.id===this.activeSourceId))||(e=void 0)}this._activeSourceId=e||this._symbolSources[0].id}}_getCustomSymbolsFromStorage(){if("3d"===this.symbolType||"point"!==this.editGeometry)return;const e=(0,h.g)(this.customSymbolsStorageId,!0);e&&(this.allCustomFileInfos=e.map((e=>e.dataURL?e:{...e,cim:c.e.CIMSymbol?.fromJSON(JSON.parse(e.cim))})))}_renderSourceSelection(){const{messages:e}=this,t=this._symbolSources;if(!t)return(0,o.h)("div",null);const i=this._symbolSources?.find((e=>e.id===this._activeSourceId)),s="custom-symbol-set"===this._activeSourceId?e.customSymbols:i?.title,r=1===t.length,n=(0,o.h)("calcite-dropdown",{class:{[ke]:!0},hidden:r,maxItems:7,onCalciteDropdownSelect:this._onSymbolSourceChange,overlayPositioning:"fixed"},(0,o.h)("calcite-button",{alignment:"space-between",appearance:"outline-fill",kind:"neutral",iconEnd:"chevron-down",scale:"m",slot:"trigger",width:"full"},s),this._renderSymbolSourceOptions(t,this._activeSourceId));return(0,o.h)("div",{class:"section",key:"header"},(0,o.h)("calcite-label",{class:"section"},this.hideHeader?null:this.messages.category,(0,o.h)("div",{class:xe},n,(0,o.h)("calcite-action",{id:"symbol-picker-grid",active:this.isGridView,appearance:"transparent",icon:"grid",scale:"s",class:Me,text:this.messages.gridView,onClick:()=>{this.isGridView=!0,(0,o.f)(this.el)}}),(0,o.h)("calcite-tooltip",{"reference-element":"symbol-picker-grid",overlayPositioning:"fixed"},this.messages.gridView),(0,o.h)("calcite-action",{id:"symbol-picker-list",active:!this.isGridView,appearance:"transparent",icon:"list",iconFlipRtl:!0,scale:"s",text:this.messages.listView,onClick:()=>{this.isGridView=!1,(0,o.f)(this.el)}}),(0,o.h)("calcite-tooltip",{"reference-element":"symbol-picker-list",overlayPositioning:"fixed"},this.messages.listView))))}_renderItemSelection(){const{portal:e,messages:t}=this,i=this._activeSymbolFetch,s=se(e)?e.portal:e,r=(0,o.h)("div",{class:"remove-button"},(0,o.h)("calcite-button",{appearance:"transparent",kind:"danger",width:"full",onClick:()=>this.removeStyle()},t.removeStyle));return(0,o.h)("div",{class:{[ve]:!0,[Ce]:this.isGridView},key:"gallery"},i?(0,o.h)("calcite-loader",{label:""}):0===this._activeSymbolItems?.length&&"custom-symbol-set"===this._activeSourceId?(0,o.h)("arcgis-symbol-picker-file-upload",{portal:s,hideSvgUploadSymbols:this.hideSvgUploadSymbols}):this._activeSymbolItems&&this._activeSymbolItems.length>0?(0,o.h)("div",{class:we,key:this._activeSymbolItems?.length},this.isGridView?this._renderGridView():this._renderListView(),"custom-symbol-set"===this._activeSourceId&&(0,o.h)("arcgis-symbol-picker-file-upload",{class:Ie,portal:s,hideSvgUploadSymbols:this.hideSvgUploadSymbols}),this.displayEmptyFilterMsg&&(0,o.h)("div",{class:Fe},this.messages.noFilterSymbolsAvailable),this._activeSourceId&&this.savedStyleIds?.includes(this._activeSourceId)&&r):(0,o.h)("div",null,(0,o.h)("div",{class:fe},this.messages.noSymbolsAvailable),this._activeSourceId&&this.savedStyleIds?.includes(this._activeSourceId)&&r))}_renderGridView(){return(0,o.h)("arcgis-item-palette",{key:this._activeSourceId,items:this._activeSymbolItems?.map(((e,t)=>({item:e,index:t,observer:this._symbolIntersectionObserver}))),ItemRenderer:W,itemsPerRow:this.itemsPerRow,selected:({item:e})=>e?.data===this.activeSymbolItem?.data,onArcgisItemSelect:async e=>{const{detail:{item:t}}=e;this.customSymbolError=void 0,this.arcgisActiveSymbolItemChange.emit(t),this.activeSymbolItem=t;const i=await t.getEsriSymbol();this.arcgisActiveSymbolChange.emit(i),e.stopPropagation()},ref:e=>this.itemPaletteNode=e})}_renderListView(){const{messages:e}=this,t="rtl"===(0,n.a)(this.el);return(0,o.h)("calcite-list",{label:e.symbols,key:this._activeSourceId,filterEnabled:this._activeSymbolItems&&this._activeSymbolItems.length>10,filterPlaceholder:e.filterPlaceholder,onCalciteListFilter:e=>{const t=e.target;this.displayEmptyFilterMsg=!!t.filterText&&0===t.filteredItems.length}},this._activeSymbolItems?.map(((e,i)=>(0,o.h)("calcite-list-item",{key:i,label:e.data.title||e.data.name,value:i,selected:this.activeSymbolItem?.data.name===e.data.name,metadata:e.data.tags?.toString(),onCalciteListItemSelect:async e=>{const t=e.target,i=this._activeSymbolItems?.[t.value];this.customSymbolError=void 0,this.arcgisActiveSymbolItemChange.emit(i),this.activeSymbolItem=i;const o=await(i?.getEsriSymbol());this.arcgisActiveSymbolChange.emit(o),e.stopPropagation()}},(0,o.h)("div",{slot:"actions-start",class:Pe,key:e.data.name,ref:t=>{t&&(e.getThumbnail(t).then((e=>e())),e.getEsriSymbol())}}),"custom-symbol-set"===this._activeSourceId&&(0,o.h)("calcite-action",{slot:"actions-end",appearance:"transparent",text:this.messages.removeSymbol,ref:e=>{e&&(this.actionEls[i]=e)},onClick:()=>{this.removeCustomSymbol(i),(0,o.f)(this.el)},onMouseOver:()=>this.addTooltip({referenceElement:this.actionEls[i],placement:t?"right-start":"left-start",innerHTML:this.messages.removeSymbol}),onMouseOut:()=>this.removeTooltip()},(0,o.h)("calcite-icon",{scale:"s",icon:"x"}))))))}updateListSelection(){this.el.querySelectorAll("CALCITE-LIST-ITEM").forEach((e=>{e.selected=e.value===this.activeSymbolItem?.data.name,e.selected&&e.setFocus()}))}removeCustomSymbol(e){this.allCustomFileInfos.splice(e,1),(0,h.s)(this.customSymbolsStorageId,this.allCustomFileInfos.map((e=>e.dataURL?e:{...e,cim:JSON.stringify(e.cim?.toJSON())})),!0),this._setupCustomSymbols(),this.activeSymbolItem=void 0}addTooltip(e){this.removeTooltip(),this.tooltipEl=document.createElement("calcite-tooltip"),this.tooltipEl.placement=e.placement||"auto",this.tooltipEl.referenceElement=e.referenceElement,this.tooltipEl.overlayPositioning="fixed",this.tooltipEl.innerHTML=e.innerHTML,this.tooltipEl.open=!0,this.el.parentElement?.appendChild(this.tooltipEl)}removeTooltip(){this.tooltipEl?.parentNode&&(this.tooltipEl.parentNode.removeChild(this.tooltipEl),this.tooltipEl=void 0)}removeStyle(){this.savedStyleIds=this.savedStyleIds?.filter((e=>e!==this._activeSourceId)),this._activeSourceId&&this.removeStyleIds([this._activeSourceId]),this._activeSourceId=this.savedStyleIds?.[0]||this._symbolSources?.[0].id}removeStyleIds(e){const t=(0,h.g)(ge,!0)||{};let i=t.point||[];i=i.filter((t=>!e?.includes(t))),t.point=i.length?i:void 0;let o=t.lline||[];o=o.filter((t=>!e?.includes(t))),t.line=o.length?o:void 0;let s=t.polygon||[];s=s.filter((t=>!e?.includes(t))),t.polygon=s.length?s:void 0,JSON.stringify(t)===JSON.stringify({})?(0,h.r)(ge):(0,h.s)(ge,t,!0),this._fetchSources()}async componentWillLoad(){await c.e.load();const e=(0,c.g)(this.symbol),t=(0,h.g)(ge,!0)||{};this.savedStyleIds=t?.[e]||[]}componentDidLoad(){this._symbolSources||this._fetchSources(),this._getCustomSymbolsFromStorage()}connectedCallback(){this.setUpSymbolIntersectionObserver(),this._activeSymbolFetch?.controller.abort(),this._sourcesFetchController?.abort()}disconnectedCallback(){this.tearDownSymbolIntersectionObserver()}render(){const e=this._symbolSources,t=this._activeSymbolFetch;if(!e||t)return(0,o.h)("div",{class:be},(0,o.h)("calcite-loader",{label:""}));const i=this._symbolSources?.find((e=>e.id===this._activeSourceId)),s=i?.keywords.includes("Adobe");let r;return s&&(r=this.messages.adobeCopyright.replace("${year}","2024")),(0,o.h)("div",{class:be},this._renderSourceSelection(),this._renderItemSelection(),s?(0,o.h)("calcite-notice",{open:!0,kind:"danger",key:"copyright",scale:"s"},(0,o.h)("div",{slot:"message",innerHTML:r})):null,this.customSymbolError?(0,o.h)("calcite-notice",{open:!0,class:Se,closable:!0,icon:"exclamation-mark-circle",kind:"danger",key:"large-symbol",onCalciteNoticeClose:()=>this.customSymbolError=void 0,scale:"s"},(0,o.h)("div",{slot:"message"},"too-large"===this.customSymbolError?this.messages.customSymbolErrors.tooLarge:"invalid-file"===this.customSymbolError?this.messages.customSymbolErrors.invalidFile:"storage-full"===this.customSymbolError?this.messages.customSymbolErrors.outOfSpace:"error"===this.customSymbolError?this.messages.customSymbolErrors.error:void 0)):null)}static get assetsDirs(){return["assets"]}get el(){return(0,o.g)(this)}static get watchers(){return{_activeSourceId:["handleActiveSourceItemIdChanges"]}}};Ae.style='.sc-arcgis-symbol-picker-h, .arcgis-symbol-picker__container.sc-arcgis-symbol-picker {\n  display: flex;\n  flex: 1 1 auto;\n  flex-flow: column nowrap;\n  align-items: stretch;\n}\n\n.categories.sc-arcgis-symbol-picker {\n  display: flex;\n  align-content: normal;\n}\n\n.categories-center-action.sc-arcgis-symbol-picker {\n  padding: 0 5px;\n}\n\n.marker-selection.sc-arcgis-symbol-picker {\n  padding: 8px;\n}\n\n.symbol-div.sc-arcgis-symbol-picker {\n  padding: 0 8px;\n}\n\n.marker-source-select.sc-arcgis-symbol-picker {\n  width: calc(100% - 74px);\n  display: block;\n}\n\n.marker-source-select[hidden].sc-arcgis-symbol-picker + .marker-selection.sc-arcgis-symbol-picker {\n  border-top: 1px solid lightgray;\n  background-color: var(--calcite-color-foreground-1);\n}\n\n.empty-category-content.sc-arcgis-symbol-picker {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.empty-filter.sc-arcgis-symbol-picker {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 8px;\n}\n\n.incompatible-symbols-notice.sc-arcgis-symbol-picker {\n  margin: 8px 0;\n}\n\n.marker-item.sc-arcgis-symbol-picker {\n  [slot="thumbnail"] > div {\n    margin: 8px 10px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n}\n\n.item-palette.sc-arcgis-symbol-picker {\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n}\n\n.file-upload.sc-arcgis-symbol-picker {\n  margin-top: 20px;\n  width: auto;\n}\n\n.remove-button.sc-arcgis-symbol-picker {\n  padding: 10px 0;\n}\n\n.scroller.sc-arcgis-symbol-picker {\n  max-height: var(--scroller-max-height, min(100vh - 380px, 320px));\n  overflow-y: auto;\n  min-width: 200px;\n  overflow-x: hidden;\n  display: flex;\n  justify-content: center;\n}';const Le="auto-adjust-label",_e="style-dropdown",Re="arrow-dropdown",Ee="icon-dropdown",Te="icon-dropdown--selected",ze="icon-dropdown-item-content",Oe="color-ramp-flipper",Be="scroller",Ne="color-ramp-selection",Ue="auto-adjust-checkbox",je="content-group",Ve="message",De="container",$e="label",Ge="symbol",He="change-symbol-trigger",qe={all:["*"],light:["light"],dark:["dark"],redsAndYellows:["oranges","reds","yellows"],greens:["greens"],blues:["blues"],purplesAndPinks:["purples","pinks"],browns:["browns"],grays:["grays"],bright:["bright"],subdued:["subdued"],colorblindFriendly:["colorblind-friendly"]},We=["none","begin","end","begin-end"],Je=["solid","dash","dot","dash-dot","long-dash-dot-dot","short-dash","short-dot","short-dash-dot","short-dash-dot-dot","long-dash","long-dash-dot"],Xe={size:!0,preview:!0,rotation:!0},Ye={style:!0,arrow:!0,width:!0,autoStrokeAdjust:!1},Ke={suggestedColors:!0,customColor:!0,transparency:!0},Qe={colorRamps:!0,transparency:!0},Ze={extra:!0},et="arcgis-symbol-styler-storage-colors",tt={size:24,maxSize:24},it={size:{width:60,height:2}},ot=100,st=150;function rt(e,t,i=!1,o=!0){if(!e||!t)return!1;const s=e.every(((e,o)=>{const s=t[o];return e.r===s.r&&e.g===s.g&&e.b===s.b&&(!i||e.a===s.a)}));return o?s||rt(e.slice().reverse(),t,i,!1):s}function nt(e,t=!1){return t?function(e){const t=Math.sqrt(e.length),i=lt(e).reverse(),o=[];for(let e=0;e<t;e++){const t=[];i.forEach((i=>t.push(i[e]))),o.push(t)}return function(e,t){let i=[];e=e.slice().map((e=>e.slice()));const o=(t||"HH").split(""),s=o[0],r=o[1];"L"===s&&e.reverse();const n="H"===r;return e.forEach((e=>{n&&e.slice().reverse(),i=i.concat(e)})),i}(o).reverse()}(e):e.slice().reverse()}function lt(e,t){const i=[],o=Math.sqrt(e.length),s=(t||"HH").split(""),r=s[0],n="H"!==s[1];for(let t=0;t<o;t++){const s=[];for(let i=0;i<o;i++){const r=t*o+i;s.push(e[r])}n&&s.reverse(),i.push(s)}return"L"===r&&i.reverse(),i}function at(e,t){return ct(e,t)}function ct(e,t){if(Array.isArray(e)){for(let i=0;i<e.length;i++){const o=ct(e[i],t);if(void 0!==o)return o}return}const i=t(e);return void 0!==i?i:"cim"===e?.type?ct(e.data.symbol,t):"CIMSymbolReference"===e?.type||"CIMMarkerGraphic"===e?.type?ct(e.symbol,t):"CIMPointSymbol"===e?.type||"CIMPolygonSymbol"===e?.type||"CIMLineSymbol"===e?.type?ct(e.symbolLayers,t):"CIMHatchFill"===e?.type?ct(e.lineSymbol,t):"CIMVectorMarker"===e?.type?ct(e.markerGraphics,t):void 0}function ht(e,t,i){const o=t.toJSON();at(e,(e=>{"fill"===i&&("CIMSolidFill"===e?.type&&(e.color=o),"CIMPictureFill"!==e?.type&&"CIMPictureMarker"!==e?.type||(e.tintColor=o)),"stroke"===i&&("CIMSolidStroke"===e?.type&&(e.color=o),"CIMPictureStroke"===e?.type&&(e.tintColor=o))}))}function mt(e){if(e.animations?.length)return e;return at(e,(e=>{if(e.animations?.length)return e}))}function dt(e,t){const i=at(e,(e=>{if("fill"===t){if("CIMSolidFill"===e?.type)return e.color;if("CIMPictureFill"===e?.type||"CIMPictureMarker"===e?.type)return e.tintColor}if("stroke"===t){if("CIMSolidStroke"===e?.type)return e.color;if("CIMPictureStroke"===e?.type)return e.tintColor}}));return c.e.EsriColor.fromJSON(i)}function pt(e,t){return 0===e.a&&(t.a=1),t}function yt(e){return(0,c.b)(e)&&(It(e)||function(e){return!!c.e.cimSymbolUtils.getCIMSymbolColor(e)}(e))||(0,c.d)(e)&&!gt(e)||(0,c.f)(e)}function ut(e){return(0,c.b)(e)&&It(e)||(0,c.d)(e)||(0,c.h)(e)||(0,c.f)(e)}function gt(e){return!("simple-marker"!==e?.type||"x"!==e.style&&"cross"!==e.style)}function bt(e,t=e.size){return{...e,size:void 0!==t?kt((0,m.p)(t)):0}}function St(e){const t=Number.isInteger(e)?0:2;return Number(e.toFixed(t))}function ft(e){const t=Number.isInteger(e)?0:2;return Number(e.toFixed(t))}function kt(e){const t=Number.isInteger(e)?0:3;return Number(e.toFixed(t))}function Ct(e,t){return Number.isNaN(e)?t:St((0,m.a)(e))}function vt(e){return e&&"simple-line"!==e.type&&"simple-fill"!==e.type?(0,c.b)(e)?c.e.cimSymbolUtils.getCIMSymbolRotation(e,!0):e.angle??0:0}function wt(e){return"CIMTextSymbol"===e.type}function It(e){if(wt(e.data.symbol))return!1;const{symbolLayers:t}=e.data.symbol;if(1===t?.length){const[e]=t;if("CIMVectorMarker"!==e.type||e.colorLocked)return!1;const{markerGraphics:i}=e;return 1===i.length&&!wt(i[0].symbol)&&xt(i[0].symbol.symbolLayers)}if(2===t?.length){const[e,i]=t;if("CIMVectorMarker"!==e.type||"CIMVectorMarker"!==i.type||e.colorLocked||e.size>i.size)return!1;const o=e.markerGraphics,s=i.markerGraphics;if(1!==o.length||1!==s.length)return!1;const[{symbol:r}]=o,[{symbol:n}]=s;return r&&n&&!wt(r)&&!wt(n)&&xt(r.symbolLayers)&&function(e){return function(e){return!!e?.find((({type:e})=>"CIMSolidFill"===e))}(e)&&Mt(e)}(n.symbolLayers)}return!1}function xt(e){return function(e){return!!function(e){return e?.find((({type:e,colorLocked:t})=>"CIMSolidFill"===e&&!t))}(e)}(e)&&Mt(e)}function Mt(e){return!!function(e){return e?.find((({type:e})=>"CIMSolidStroke"===e))}(e)}function Pt(e){return e&&function(e){return We.includes(e?.placement)&&"arrow"===e?.style}(e)?e.placement:"none"}function Ft(e){if("none"!==e)return{style:"arrow",placement:e}}function At(e,t){if(e&&t&&function(e){return"color-ramp"===e?.type&&"2d"===e.style}(e)){const i=function(e,t){const i=t.map((e=>e.stops)),o=4;let s=e.map((e=>e.clone())),r=0,n=!1;for(let e=0;e<o;e++){if(i.some((e=>rt(s,e,!0,!1)))){n=!0;break}s=nt(s,!0),r++}return n?(o-r)%o:null}(t.color,e.colorRamps);if(null!==i&&i>0)return e.colorRamps.map((e=>{const t={...e};for(let e=0;e<i;e++)t.stops=nt(t.stops,!0);return t}))}return e?.colorRamps}const Lt=[0,0,0,0];function _t(e,t=!1){const i=e??Lt;return t?c.e.EsriColor.fromJSON(i):new c.e.EsriColor(i)}function Rt({r:e,g:t,b:i,a:o}){return 0===e&&0===t&&0===i&&0===o}const Et=class{constructor(e){(0,o.r)(this,e),this.arcgisEdit=(0,o.c)(this,"arcgisEdit",7),this.arcgisSymbolStylerEdit=(0,o.c)(this,"arcgisSymbolStylerEdit",7),this.arcgisMarkerChange=(0,o.c)(this,"arcgisMarkerChange",7),this.arcgisSymbolStylerMarkerChange=(0,o.c)(this,"arcgisSymbolStylerMarkerChange",7),this.arcgisFillChange=(0,o.c)(this,"arcgisFillChange",7),this.arcgisSymbolStylerFillChange=(0,o.c)(this,"arcgisSymbolStylerFillChange",7),this.arcgisFillEnabledChange=(0,o.c)(this,"arcgisFillEnabledChange",7),this.arcgisStrokeChange=(0,o.c)(this,"arcgisStrokeChange",7),this.arcgisSymbolStylerStrokeChange=(0,o.c)(this,"arcgisSymbolStylerStrokeChange",7),this.arcgisStrokeEnabledChange=(0,o.c)(this,"arcgisStrokeEnabledChange",7),this.arcgisSourceIdChange=(0,o.c)(this,"arcgisSourceIdChange",7),this.arcgisSymbolStylerSourceIdChange=(0,o.c)(this,"arcgisSymbolStylerSourceIdChange",7),this.manager=(0,n.u)(this),this.resizeObserver=new ResizeObserver((e=>{const t=e.pop();t&&(this.narrow=t.contentRect.width<=275)})),this.windowResizeObserver=new ResizeObserver((()=>this.checkPopoverMaxHeight())),this.autoOpenFirstBlock=!1,this.autoCalcHeight=!1,this.colorInputEl=[],this.manualBlockOpen=!1,this.updatePreviewSymbol=(0,p.a)((()=>{const e=this.symbol.clone();this.syncSymbolProps(e,{symbolState:{marker:this.marker,fill:this.fill,stroke:this.stroke}}),this.previewSymbol=e}),150),this.setRampInputRef=e=>{this.rampInputEl=e},this.setColorInputRef=e=>{e&&this.colorInputEl?.push(e)},this.onColorRampFillTransparencyChange=e=>{const t=(0,d.t)(e),i=this.fill,o={color:i.color?.map((e=>_t({...e,a:t})))};this.fill=o,this.arcgisFillChange.emit(o),this.arcgisSymbolStylerFillChange.emit(o),this.setInternalSymbol(this.syncSymbolProps(this.symbol,{cimChangeContext:"root"}),!0)},this.onFillColorRampCategoryChange=e=>{const t=e.target.selectedOption.value,i=this.sections?.fill;this.sections={...this.sections,fill:{...i,activeCategory:t}},e.stopPropagation()},this.onColorFillTransparencyChange=e=>{const t=(0,d.t)(e),{fill:i}=this,o={color:_t({...i?.color,a:t})};this.fill=o,this.arcgisFillChange.emit(o),this.arcgisSymbolStylerFillChange.emit(o),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0)},this.onStrokeColorRampCategoryChange=e=>{const t=e.target.selectedOption.value,i=this.sections?.stroke;this.sections={...this.sections,stroke:{...i,activeCategory:t}},e.stopPropagation()},this.onColorStrokeTransparencyChange=e=>{const{stroke:t}=this,i=(0,d.t)(e),o={...t,color:_t({...t?.color,a:i})};this.stroke=o,this.arcgisStrokeChange.emit(bt(o)),this.arcgisSymbolStylerStrokeChange.emit(bt(o)),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0)},this.onColorRampStrokeTransparencyChange=e=>{const t=(0,d.t)(e),i=this.stroke,o={...i,color:i.color?.map((e=>_t({...e,a:t})))};this.stroke=o,this.arcgisStrokeChange.emit(bt(o)),this.arcgisSymbolStylerStrokeChange.emit(bt(o)),this.setInternalSymbol(this.syncSymbolProps(this.symbol,{cimChangeContext:"root"}),!0)},this.onStrokeStyleChange=e=>{const t=e.currentTarget.selectedItems[0].getAttribute("data-style"),{stroke:i}=this,o={...i,style:t};this.stroke=o,this.arcgisStrokeChange.emit(bt(o)),this.arcgisSymbolStylerStrokeChange.emit(bt(o)),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0),e.stopPropagation()},this.onStrokeArrowChange=e=>{const t=e.currentTarget.selectedItems[0].getAttribute("data-arrow"),{stroke:i}=this,o={...i,marker:Ft(t)};this.stroke=o,this.arcgisStrokeChange.emit(bt(o)),this.arcgisSymbolStylerStrokeChange.emit(bt(o)),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0),e.stopPropagation()},this.onStrokeWidthChange=e=>this.setStrokeWidth(e),this.onAutoAdjustStrokeChange=e=>{const t=e.currentTarget.checked,{stroke:i}=this,o={...i,autoAdjusted:t};this.stroke=o,this.arcgisStrokeChange.emit(bt(o)),this.arcgisSymbolStylerStrokeChange.emit(bt(o)),this.emitEdit(this.symbol),e.stopPropagation()},this.syncSymbolProps=(e,t)=>{const i=t?.symbolState||{marker:this.marker,fill:this.fill,stroke:this.stroke},o=t?.cimChangeContext,s=(0,c.g)(e);return"point"===s?this.syncPointSymbolProps(e,i,o):"line"===s?this.syncLineSymbolProps(e,i,o):this.syncPolygonSymbolProps(e,i,o)},this.syncPointSymbolProps=(e,{fill:t,marker:i,stroke:o},s)=>{const{sections:r}=this,n=void 0!==i?.size?kt((0,m.p)(i?.size)):0;if((0,c.d)(e)){const i=gt(e);i||(this.isFillColorRamp()?e.color=this.getSampleFillColorRampColor():e.color=r?.fill?.enabled&&t?.color?t.color:_t(null)),e.outline&&(this.isStrokeColorRamp()?e.outline.color=this.getSampleStrokeColorRampColor():i&&this.isFillColorRamp()?e.outline.color=this.getSampleFillColorRampColor():e.outline.color=r?.stroke?.enabled&&o?.color?o.color:_t(null),e.outline.marker=o?.marker,e.outline.style=o?.style,e.outline.width=void 0!==o?.size?kt((0,m.p)(o.size)):0),e.size=n}else(0,c.j)(e)&&(e.height=Math.round(e.height/e.width*n*100)/100,e.width=n);const l=i?.angle?Math.abs(i.angle):0;return(0,c.b)(e)?(s&&["root","original-root"].includes(s)?(c.e.cimSymbolUtils.applyCIMSymbolRotation(e,l,!0),c.e.cimSymbolUtils.scaleCIMSymbolTo(e,n)):e.data.symbol.angle=l,this.isFillColorRamp()?c.e.cimSymbolUtils.applyCIMSymbolColor(e,this.getSampleFillColorRampColor(),{layersToColor:"fill"}):this.isStrokeColorRamp()&&c.e.cimSymbolUtils.applyCIMSymbolColor(e,this.getSampleStrokeColorRampColor(),{layersToColor:"outline"})):e.angle=l,e},this.syncLineSymbolProps=(e,{stroke:t},i)=>{const{sections:o}=this,s=void 0!==t?.size?kt((0,m.p)(t?.size)):0;return(0,c.h)(e)?(this.isStrokeColorRamp()?e.color=this.getSampleStrokeColorRampColor():e.color=o?.stroke?.enabled&&t?.color?t.color:_t(null),"original-root"!==i&&(e.marker=t?.marker,e.style=t?.style,e.width=s)):(0,c.b)(e)&&("root"===i&&c.e.cimSymbolUtils.scaleCIMSymbolTo(e,s),this.isStrokeColorRamp()&&c.e.cimSymbolUtils.applyCIMSymbolColor(e,this.getSampleStrokeColorRampColor())),e},this.syncPolygonSymbolProps=(e,{fill:t,stroke:i},o)=>{const{sections:s}=this,r=void 0!==i?.size?kt((0,m.p)(i?.size)):0;return(0,c.f)(e)?(this.isFillColorRamp()?e.color=this.getSampleFillColorRampColor():e.color=s?.fill?.enabled&&t?.color?t.color:_t(null),this.isStrokeColorRamp()?e.outline.color=this.getSampleStrokeColorRampColor():e.outline.color=s?.stroke?.enabled&&i?.color?i.color:_t(null),"original-root"!==o&&(e.outline.width=r,e.outline.style=i?.style)):(0,c.b)(e)&&(this.isFillColorRamp()?c.e.cimSymbolUtils.applyCIMSymbolColor(e,this.getSampleFillColorRampColor(),{layersToColor:"fill"}):this.isStrokeColorRamp()&&c.e.cimSymbolUtils.applyCIMSymbolColor(e,this.getSampleStrokeColorRampColor(),{layersToColor:"outline"}),"root"===o&&((0,c.i)(e)?function(e,t){e.data.symbol?.symbolLayers?.forEach((e=>{["CIMSolidStroke","CIMPictureStroke"].includes(e.type)&&(e.width=t)}))}(e,r):c.e.cimSymbolUtils.scaleCIMSymbolTo(e,r))),e},this.onStrokeEnabledChange=e=>{const{sections:t}=this,i=gt(this.activeSymbol);this.sections={...t,stroke:{...t?.stroke,enabled:!!i||e}},i||(this.arcgisStrokeEnabledChange.emit({enabled:e,stroke:bt(this.stroke)}),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0))},this.onFillEnabledChange=e=>{const{fill:t,sections:i}=this,o=gt(this.activeSymbol);this.sections={...i,fill:{...i?.fill,enabled:!o&&e}},o||(this.arcgisFillEnabledChange.emit({enabled:e,fill:t}),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0))},this.onAutoAdjustSizeChange=e=>{const t=e.currentTarget.checked,{marker:i}=this,o={...i,autoAdjusted:t};this.marker=o,this.arcgisMarkerChange.emit(bt(o)),this.arcgisSymbolStylerMarkerChange.emit(bt(o)),this.emitEdit(this.symbol),e.stopPropagation()},this.onSymbolSizeChange=e=>this.setSymbolSize(e),this.onSymbolRotationChange=e=>{const{marker:t,fill:i,stroke:o}=this,s={...t,angle:e,symbol:this.syncSymbolProps(this.symbol,{cimChangeContext:"root",symbolState:{marker:{...t,angle:e},fill:i,stroke:o}})};this.marker=s,this.setInternalSymbol(s.symbol,!0),this.arcgisMarkerChange.emit(bt(s)),this.arcgisSymbolStylerMarkerChange.emit(bt(s))},this.onSymbolSelect=e=>{const{fill:t,marker:i,sections:o,stroke:s}=this,r="picture-marker"===this.activeSymbol?.type&&"simple-marker"===e.type,n=gt(this.activeSymbol),l=gt(e),a=n&&!l,h=!n&&l;this.autoOpenFirstBlock=!0;const m=yt(e),d=ut(e),p={},y=(0,c.b)(this.activeSymbol)&&!(0,c.b)(e);if(y){if((0,c.d)(e)||(0,c.f)(e)){if(m&&"color"===o?.fill?.type&&(p.fill={...t,color:e.color.clone()}),d&&"color"===o?.stroke?.type){const t=e.outline.color.clone();h&&(t.a=1),p.stroke={...s,color:t},(0,c.f)(e)&&(p.stroke.size=e.outline.width,p.stroke.style=e.outline.style)}}else if((0,c.h)(e)&&d&&"color"===o?.stroke?.type){const t=e;p.stroke={...s,size:t.width,color:t.color.clone()}}}else if((0,c.b)(e)){const r=c.e.cimSymbolUtils.getCIMSymbolColor(e);"color"===o?.fill?.type&&(p.fill={...t,color:r}),p.stroke={...s},"point"===this.editGeometry&&i?.size?p.stroke.size=kt(i.size):"line"===this.editGeometry&&(p.stroke.size=kt(c.e.cimSymbolUtils.getCIMSymbolSize(e))),"color"===o?.stroke?.type&&(p.stroke.color=r),this.cimStrokeWidthBounds={min:0,max:18}}else if("color-ramp"===o?.fill?.type&&"color"===o?.stroke?.type)l?(this.tempStrokeColorRampStateActiveCategory=o.fill.activeCategory,this.tempStrokeColorRampStateStops=t?.color,this.tempStrokePreviousColorBeforeColorRampSwitch=s?.color,p.stroke={...s,color:this.tempStrokeColorRampStateStops}):a&&(p.fill={...t,color:this.tempStrokeColorRampStateStops},p.stroke={...s,color:this.tempStrokePreviousColorBeforeColorRampSwitch},this.tempStrokeColorRampStateActiveCategory=void 0,this.tempStrokeColorRampStateStops=void 0);else if("color"===o?.fill?.type&&"color-ramp"===o?.stroke?.type){if(h){const e=s?.color?.map((e=>(e.a=1,e)));p.stroke={...s,color:e}}}else if("color"===o?.fill?.type&&"color"===o?.stroke?.type&&h){const e=s?.color?.clone();h&&e&&(e.a=1),p.stroke={...s,color:e}}this.sections={...o,fill:{...o?.fill,open:!l&&o?.fill?.open,enabled:m&&(!l||(0,c.b)(e)||a||r||o?.fill?.enabled)},stroke:{...o?.stroke,enabled:d&&((0,c.b)(e)||h||y&&!l||r||o?.stroke?.enabled)}};const u=p.fill||t,g=p.stroke||s,b={...i,symbol:this.syncSymbolProps(e,{cimChangeContext:"original-root",symbolState:{marker:i,fill:u,stroke:g}})};this.fill=u,this.stroke=g,this.marker=b,this.activeSymbol=e,this.setInternalSymbol(b.symbol,!0,!0),this.arcgisMarkerChange.emit(bt(b)),this.arcgisSymbolStylerMarkerChange.emit(bt(b))},this.addStyles=async()=>{const{portal:e,portalOrInterceptor:t,dir:i,editGeometry:o,mergedStrings:s}=this;if(document.querySelector("arcgis-symbol-styler-browse-styles"))return;const r=await(0,a.H)(),n=document.createElement("arcgis-symbol-styler-browse-styles");n.editGeometry=o,n.dir=i??"rtl",n.portal=t?.portal||t||e||r.getDefault(),n.strings=s,n.excludeItemIds=await(this.symbolPickerElement?.getStyleItemIds())||[],document.body.appendChild(n),n.addEventListener("arcgisSymbolStylerBrowseStylesClose",(e=>{document.body.removeChild(n),e.detail?.length&&(this.activeSourceId=e.detail[0],this.pickerReRenderFlag=!this.pickerReRenderFlag)}))},this.emitEdit=(0,p.d)((async(e,t)=>{const i=e.clone(),o={},{editGeometry:s}=this,r="point"===s,n=!gt(e)&&"point"===s||"polygon"===s;r&&(o.marker={...bt(this.marker),symbol:i}),n&&(o.fill={...this.fill}),o.stroke={...bt(this.stroke)},this.arcgisEdit.emit({symbol:i,info:o,symbolSwitch:t}),this.arcgisSymbolStylerEdit.emit({symbol:i,info:o,symbolSwitch:t})}),300),this.flipFillColorRamps=()=>{const e=this.sections?.fill,t=this.fill,i="2d"===e.style,o={color:nt(t.color,i)};this.sections={...this.sections,fill:{...e,colorRamps:e.colorRamps.map((({stops:e,tags:t,name:o})=>({stops:nt(e,i),tags:t,name:o})))}},this.fill=o,this.arcgisFillChange.emit(o),this.arcgisSymbolStylerFillChange.emit(o),this.emitEdit(this.symbol)},this.renderBlock=e=>(0,o.h)("calcite-block",{collapsible:!0,disabled:e.disabled??!1,heading:e.heading,key:e.key,onCalciteBlockOpen:this.onBlockToggle,onCalciteBlockClose:this.onBlockToggle},e.icon,e.content),this.onBlockToggle=e=>{this.manualBlockOpen?this.manualBlockOpen=!1:(this.rampInputEl?.close(),this.colorInputEl?.forEach((async e=>await(e?.close()))))},this.renderSection=({disabled:e,embedded:t=!1,key:i,sectionContent:s})=>(0,o.h)("arcgis-symbol-styler-section",{disabled:e,key:i,embedded:t},s.map((({content:e})=>e))),this.flipStrokeColorRamps=()=>{const e=this.sections?.stroke,t=this.stroke,i="2d"===e.style,o={...t,color:nt(t.color,i)};this.sections={...this.sections,stroke:{...e,colorRamps:e.colorRamps.map((({stops:e,tags:t,name:o})=>({stops:nt(e,i),tags:t.slice(),name:o})))}},this.stroke=o,this.arcgisStrokeChange.emit(bt(o)),this.arcgisSymbolStylerStrokeChange.emit(bt(o)),this.emitEdit(this.symbol)},this.popoverProps=void 0,this.initialSourceId=void 0,this.portal=void 0,this.stringOverrides=void 0,this.mode="default",this.hideSvgUploadSymbols=!1,this.hideAddStyles=!1,this.displaySymbolsSelectionOnly=!1,this.cimStrokeWidthBounds=void 0,this.config=void 0,this.editGeometry=void 0,this.fill=void 0,this.marker=void 0,this.narrow=!1,this.preppingEdit=!0,this.previewSymbol=void 0,this.sections=void 0,this.builtInStrings=(0,l.u)({blocking:!0}),this.mergedStrings=(0,l.u)({blocking:!0}),this.stroke=void 0,this.symbol=void 0,this.tempStrokeColorRampStateActiveCategory="all",this.pickerReRenderFlag=!1,this.activeSymbol=void 0,this.activeSymbolItem=void 0,this.activeSourceId=void 0,this.state="editing"}connectedCallback(){this.resizeObserver.observe(this.el),this.windowResizeObserver.observe(document.body)}disconnectedCallback(){this.resizeObserver.unobserve(this.el),this.windowResizeObserver.unobserve(document.body)}async componentWillLoad(){await c.e.load(),this.currentLanguage=this.builtInStrings._lang,this.dir=(0,n.a)(this.el);const e=new Intl.NumberFormat(this.currentLanguage,{style:"percent"}).format(0);this.percentLabelFlip="rtl"===this.dir?e.endsWith("%"):e.startsWith("%"),this.mergedStrings={...this.builtInStrings,...this.stringOverrides}}componentShouldUpdate(e,t,i){return"preppingEdit"!==i||!e}componentDidRender(){if(this.autoOpenFirstBlock&&!this.preppingEdit){const e=this.el.shadowRoot?.querySelector("calcite-block");e&&(this.autoOpenFirstBlock=!1,this.manualBlockOpen=!0,e.open=!0)}}handleStringChanges(){this.mergedStrings={...this.builtInStrings,...this.stringOverrides}}onPanelBack(e){e.stopPropagation()}async edit(e,t){const i=function(e){return e?"text"===e.type||"picture-fill"===e.type?`editing symbol of type ${e.type} is not supported`:null:"missing symbol to edit"}(e);if(i)throw new Error(`[symbol-styler] ${i}`);e=await this.checkLineOnlySymbol(e,t);const o=await(0,a.H)();this.portalOrInterceptor=t.portal||this.portal||o.getDefault(),this.preppingEdit=!0,this.autoOpenFirstBlock=!0;const s=t.sections?.marker,r=t.sections?.fill,n=t.sections?.stroke;this.symbolFilter=t.symbolFilter||("all"===s?.markerType?void 0:s?.markerType),this.editGeometry=(0,c.g)(e);const l=yt(e=e.clone()),h=ut(e);((0,c.d)(e)||(0,c.f)(e))&&(e.outline?e.outline.color||(e.outline.color=_t(null)):e.outline={type:"simple-line",color:_t(null)});const m={autoAdjusted:!1,...t.stroke,size:void 0!==t.stroke?.size?Ct(t.stroke.size,2):2,style:Je.includes(t.stroke?.style)?t.stroke?.style:"solid"};t.stroke?.marker&&(m.marker=t.stroke.marker),this.sections={marker:{backgroundStyle:"light",optional:!1,enabled:!1,open:s?.open||!1,symbolsOpen:s&&(!("symbolsOpen"in s)||s.symbolsOpen)||!1,sizeOpen:s&&(!("sizeOpen"in s)||s.sizeOpen)||!1,rotationOpen:s&&(!("rotationOpen"in s)||s.rotationOpen)||!1,keepChoice:s?.keepChoice||!1,parts:{...Xe,...s?.parts}},fill:{activeCategory:"all",open:r?.open||!1,optional:r?.optional||!1,enabled:l&&(t.fillEnabled??!0)&&!(0,c.b)(e)&&"color"===r?.type&&!!this.toColorPickerValue(t.fill?.color),type:r?.type,style:r?.style,suggestedColorsOpen:r?.suggestedColorsOpen||!1,customColorOpen:r?.customColorOpen||!1,colorRampsOpen:r?.colorRampsOpen||!1,colorRamps:At(r,t.fill),transparencyOpen:r?.transparencyOpen||!1,parts:{...Ke,...Qe,...r?.parts}},stroke:{activeCategory:"all",optional:n?.optional||!1,open:n?.open||!1,enabled:h&&(t.strokeEnabled??!0)&&!(0,c.b)(e)&&"color"===n?.type&&!!this.toColorPickerValue(t.stroke?.color),type:n?.type,style:n?.style,suggestedColorsOpen:n?.suggestedColorsOpen||!1,customColorOpen:n?.customColorOpen||!1,colorRampsOpen:n?.colorRampsOpen||!1,colorRamps:At(n,t.stroke),transparencyOpen:n?.transparencyOpen||!1,extraOpen:n?.extraOpen||!1,extraParts:{...Ye,...n?.extraParts},parts:{...Ke,...Qe,...Ze,...n?.parts}}},this.marker={...t.marker,size:t.marker?.size?Ct(t.marker.size,0):0,angle:vt(e),autoAdjusted:t.marker?.autoAdjusted||!1,symbol:e},this.fill={...t.fill},this.stroke=m,this.activeSymbol=e,this.activeSourceId=s?.keepChoice?this.activeSourceId:void 0,this.activeSymbolItem=s?.keepChoice?this.activeSymbolItem:void 0,this.config=t,(0,c.b)(e)&&(this.isFillColorRamp()||this.isStrokeColorRamp())&&this.syncSymbolProps(e,{cimChangeContext:"root"}),(0,c.b)(e)&&(this.cimStrokeWidthBounds={min:0,max:18}),this.setInternalSymbol(e,!1),this.preppingEdit=!1}async checkLineOnlySymbol(e,t){if(gt(e)){return e=new(await(0,a.U)()),t.fill?.color&&(Array.isArray(t.fill.color)?e.color=t.fill.color[t.fill.color.length-1]:e.color=t.fill.color),t.stroke?.color&&(t.stroke.color=e.outline.color.clone()),(t.stroke?.size||0===t.stroke?.size)&&(t.stroke.size=e.outline.width),t.marker?.size&&(e.size=t.marker.size),this.marker={...t.marker,size:t.marker?.size?Ct(t.marker.size,0):0,angle:vt(e),autoAdjusted:t.marker?.autoAdjusted||!1,symbol:e},this.emitEdit(e),await Promise.resolve(e)}return await Promise.resolve(e)}async setSize(e,t){"stroke"===e&&this.setStrokeWidth(ft((0,m.a)(t)),!1),"marker"===e&&this.setSymbolSize(ft((0,m.a)(t)),!1)}getLinePatternStyle(e){return{backgroundImage:`url(${(0,o.a)(`./assets/line-patterns/${e}.png`)})`}}getSelectedArrowPatternStyle(){return{backgroundImage:`url(${(0,o.a)("./assets/arrow-pattern-spritesheet.png")})`}}getArrowPatternOptionStyle(){return{backgroundImage:`url(${(0,o.a)("./assets/arrow-pattern-options-spritesheet.png")})`}}hasActiveLineOnlySimpleMarkerSymbol(){const{marker:e,symbol:t}=this;return!!e&&gt(t)}hasActivePictureMarkerSymbol(){return"picture-marker"===this.symbol?.type||"picture-marker"===this.activeSymbol?.type}setStrokeWidth(e,t=!0){const{stroke:i}=this,o={...i,size:e<0?0:ft(e)};this.stroke=o,t&&(this.arcgisStrokeChange.emit(bt(o,e)),this.arcgisSymbolStylerStrokeChange.emit(bt(o,e))),this.setInternalSymbol(this.syncSymbolProps(this.symbol,{cimChangeContext:"root"}),t)}isFillColorRamp(){return"color-ramp"===this.config?.sections?.fill?.type}isStrokeColorRamp(){return"color-ramp"===this.config?.sections?.stroke?.type}getSampleFillColorRampColor(){const e=this.sections?.fill,t=this.fill;return this.getSampleColorRampColor(e,t.color)}getSampleStrokeColorRampColor(){const e=this.sections?.stroke,t=this.stroke;return this.getSampleColorRampColor(e,t.color)}getSampleColorRampColor(e,t){const i=t.length;return"2d"===e.style||"discrete"===e.style?t[i-1]:t[Math.floor(i/2)]}setSymbolSize(e,t=!0){const{marker:i,fill:o,stroke:s,symbol:r}=this,n={...i,symbol:this.syncSymbolProps(r,{cimChangeContext:"root",symbolState:{marker:{...i,size:e},fill:o,stroke:s}}),size:e};this.marker=n,this.setInternalSymbol(n.symbol,t),t&&(this.arcgisMarkerChange.emit(bt(n,e)),this.arcgisSymbolStylerMarkerChange.emit(bt(n,e)))}render(){if(this.preppingEdit)return(0,o.h)(o.H,null);const e=(0,n.a)(this.el),{sections:t}=this.config,i=(0,c.b)(this.activeSymbol);return(0,o.h)(o.H,null,(0,o.h)("calcite-flow",{ref:e=>{this.flowEl=e,this.checkPopoverMaxHeight()}},(0,o.h)("calcite-flow-item",{dir:e,key:"main",selected:"editing"===this.state},(0,o.h)("div",{class:"content"},[!1!==t?.marker?.parts?.rotation||!1!==t?.marker?.parts?.preview||!1!==t?.marker?.parts?.size||"minimal"===this.mode||this.displaySymbolsSelectionOnly?this.renderSymbolBlock():null,i||!t?.fill||this.displaySymbolsSelectionOnly?null:this.renderFillBlock(),i||!t?.stroke||this.displaySymbolsSelectionOnly?null:this.renderStrokeBlock()])),"choosing-symbol"===this.state?this.renderSymbolSelectionPanel():(0,o.h)(o.F,null),"animation"===this.state?this.renderAnimationPanel():(0,o.h)(o.F,null)))}renderSymbolBlock(){const{marker:e,stroke:t}=this.sections,{parts:i}=e,{editGeometry:o,symbol:s}=this,r=(0,c.b)(s),n=[];if((i.preview||this.displaySymbolsSelectionOnly)&&n.push({content:this.renderSymbolsSelection()}),this.displaySymbolsSelectionOnly)return this.renderSection({key:"marker-symbols",sectionContent:n});if(r&&(this.isFillColorRamp()?n.push({content:this.renderColorRampFillBlock(!0)}):this.isStrokeColorRamp()&&n.push({content:this.renderColorRampStrokeBlock(!0)})),"minimal"===this.mode&&(i.color&&n.push({content:this.renderRootCIMSymbolColorContent()}),i.transparency&&n.push({content:this.renderRootCIMSymbolTransparencyContent()})),"point"===o?(i.size&&n.push({content:r?this.renderRootCIMSymbolSizeContent():this.renderSymbolSizeContent()}),i.rotation&&n.push({content:this.renderSymbolRotationContent()})):r&&t?.extraParts?.width&&(!(0,c.i)(s)||(0,c.i)(s)&&function(e){const t=e.data.symbol?.symbolLayers?.find((({type:e})=>["CIMSolidStroke","CIMPictureStroke"].includes(e)));return!!t}(s))&&n.push({content:this.renderRootCIMSymbolWidthContent()}),r){const e=s.data.symbol;"CIMPointSymbol"===e.type&&e.animations&&n.push({content:this.renderCIMAnimationEntryPoint(e,"root-symbol","point")}),n.push({content:this.renderRootCIMSymbolContent(s)})}return this.renderSection({key:"marker-symbols",sectionContent:n})}renderRootCIMSymbolContent(e){const t=this.renderCIMSymbolLayersContent(e.data.symbol,"root-symbol");return t.length>10?[...t.slice(0,10),(0,o.h)("div",{class:Ve},this.mergedStrings.additionalSymbolLayersNotShown.replace("${count}",10..toString()))]:t}renderCIMSymbolLayersContent({symbolLayers:e},t,i=!1,s){return e.filter((({type:e})=>this.isSupportedSymbolLayerType(e))).map(((e,r)=>{const n=`${t}__symbol-layers__symbol-layer__${r.toString()}`;return"CIMVectorMarker"===e.type?this.renderCIMVectorMarkerSymbolLayerBlocks(e,n):"CIMPictureMarker"===e.type?(0,o.h)(o.F,null,this.renderCIMPictureMarkerSymbolLayerBlock(e,n,i),(e.animatedSymbolProperties||e.animations)&&this.renderCIMAnimationEntryPoint(e,n,"picture-marker")):"CIMSolidStroke"===e.type?this.renderCIMSolidStrokeSymbolLayerBlock(e,n,i,s):"CIMPictureStroke"===e.type?this.renderCIMPictureStrokeSymbolLayerBlock(e,n,i):"CIMSolidFill"===e.type?this.renderCIMSolidFillSymbolLayerBlock(e,n,i):"CIMHatchFill"===e.type?this.renderCIMHatchFillSymbolLayerBlocks(e,n):"CIMPictureFill"===e.type?this.renderCIMPictureFillSymbolLayerBlock(e,n,i):(0,o.h)(o.F,null)})).filter(Boolean).flat()}renderSymbolsSelection(){const e=this.previewSymbol,t=e?c.e.previewSymbol2D.getContrastingBackgroundTheme(e,245):"light",i="rtl"===(0,n.a)(this.el),s=1===this.filteredSources?.length&&1===this.activeSymbolItems?.length;return(0,o.h)("calcite-label",{style:{"--symbol-styler-inline-input-trigger-background-color":"dark"===t?"#f3f3f3":""}},this.mergedStrings.currentSymbol,(0,o.h)("button",{class:He,disabled:s,onClick:()=>this.state="choosing-symbol",type:"button"},(0,o.h)("div",{class:De,tabIndex:0},(0,o.h)("div",{class:Ge},(0,o.h)("arcgis-symbol-styler-symbol-preview",{symbol:e,options:"point"===this.editGeometry?tt:"line"===this.editGeometry?it:void 0})),(0,o.h)("div",{class:$e},function(e,t){if(!e)return null;if("picture-marker"===e.type||"simple-marker"===e.type)return t.basicPoint;if("simple-line"===e.type)return t.basicLine;if("simple-fill"===e.type)return t.basicPolygon;if("CIMPointSymbol"===e.data.symbol?.type)return t.vectorPoint;if("CIMLineSymbol"===e.data.symbol?.type)return t.vectorLine;if("CIMPolygonSymbol"===e.data.symbol?.type)return t.vectorPolygon;throw new Error("unsupported symbol provided")}(e,this.mergedStrings))),(0,o.h)("calcite-icon",{icon:s?void 0:"chevron-"+(i?"left":"right"),scale:"s"})))}renderAnimationPanel(){const{mergedStrings:e,currentAnimationSymbolLayer:t}=this,i=t,s="CIMPictureMarker"===i.type?i.animations??[{animatedSymbolProperties:i.animatedSymbolProperties,type:"default"}]:i.animations;return(0,o.h)("calcite-flow-item",{class:"animation-panel",heading:e.animation,selected:"animation"===this.state,beforeBack:async()=>{this.state="editing"}},s.map(((t,i)=>{const s=this.getAnimationBlockHeadingInfo(t.type),r=t.animatedSymbolProperties;return(0,o.h)("calcite-block",{iconStart:s.icon,class:"animation-block",heading:s.heading,collapsible:!0,open:0===i},this.renderAnimationSpecificProperty(t),(0,o.h)("div",{class:"play-reverse-animation"},(0,o.h)("calcite-checkbox",{checked:r.playAnimation,onCalciteCheckboxChange:e=>{const{checked:t}=e.currentTarget;r.playAnimation=t,this.setInternalSymbol(this.symbol,!0)}}),(0,o.h)("div",{class:"play-reverse-animation-text"},e.playAnimation)),(0,o.h)("div",{class:"play-reverse-animation"},(0,o.h)("calcite-checkbox",{checked:r.reverseAnimation,onCalciteCheckboxChange:e=>{const{checked:t}=e.currentTarget;r.reverseAnimation=t,this.setInternalSymbol(this.symbol,!0)}}),(0,o.h)("div",{class:"play-reverse-animation-text"},e.reverseAnimation)),(0,o.h)("calcite-label",null,e.startTimeOffset,(0,o.h)("calcite-segmented-control",{onCalciteSegmentedControlChange:e=>{const t=e.currentTarget.value;r.randomizeStartTime="random"===t,this.setInternalSymbol(this.symbol,!0)}},(0,o.h)("calcite-segmented-control-item",{value:"random",checked:r.randomizeStartTime},e.randomized),(0,o.h)("calcite-segmented-control-item",{value:"manual",checked:!r.randomizeStartTime},e.manualOffset))),(0,o.h)("calcite-label",null,e.manualOffset,(0,o.h)("arcgis-slider-input",{disabled:r.randomizeStartTime,max:20,min:0,onArcgisValueChange:e=>{const t=e.detail;r.startTimeOffset=t,this.setInternalSymbol(this.symbol,!0)},step:1,value:r.startTimeOffset??0,withSteppers:!this.narrow,label:e.manualOffset})),(0,o.h)("calcite-label",null,e.duration,(0,o.h)("arcgis-slider-input",{max:20,min:0,onArcgisValueChange:e=>{const t=e.detail;r.duration=t,this.setInternalSymbol(this.symbol,!0)},step:1,value:r.duration??0,withSteppers:!this.narrow,label:e.duration})),(0,o.h)("calcite-label",null,e.repeatType,(0,o.h)("calcite-segmented-control",{onCalciteSegmentedControlChange:e=>{const t=e.currentTarget.value;r.repeatType=t,this.setInternalSymbol(this.symbol,!0)}},(0,o.h)("calcite-segmented-control-item",{value:"None",checked:"None"===r.repeatType},e.none),(0,o.h)("calcite-segmented-control-item",{value:"Loop",checked:"Loop"===r.repeatType},e.loop),(0,o.h)("calcite-segmented-control-item",{value:"Oscillate",checked:"Oscillate"===r.repeatType},e.oscillate))),(0,o.h)("calcite-label",null,e.repeatDelay,(0,o.h)("arcgis-slider-input",{max:20,min:0,onArcgisValueChange:e=>{const t=e.detail;r.repeatDelay=t,this.setInternalSymbol(this.symbol,!0)},step:1,value:r.repeatDelay??0,withSteppers:!this.narrow,label:e.repeatDelay})),r.easing?(0,o.h)(o.F,null,(0,o.h)("calcite-label",null,e.animations.easingType),(0,o.h)("calcite-combobox",{selectionMode:"single-persist",clearDisabled:!0,label:e.animations.easingType,onCalciteComboboxChange:e=>{const t=e.currentTarget.value;r.easing=t,this.setInternalSymbol(this.symbol,!0)}},(0,o.h)("calcite-combobox-item",{value:"Linear",heading:e.animations.linear,selected:"Linear"===r.easing}),(0,o.h)("calcite-combobox-item",{value:"EaseIn",heading:e.animations.easeIn,selected:"EaseIn"===r.easing}),(0,o.h)("calcite-combobox-item",{value:"EaseOut",heading:e.animations.easeOut,selected:"EaseOut"===r.easing}),(0,o.h)("calcite-combobox-item",{value:"EaseInOut",heading:e.animations.easeInOut,selected:"EaseInOut"===r.easing}))):(0,o.h)(o.F,null))})),(0,o.h)("calcite-button",{width:"full",slot:"footer",onClick:async()=>await(this.flowEl?.back())},e.done))}renderAnimationSpecificProperty(e){const{mergedStrings:t}=this;switch(e.type){case"CIMSymbolAnimationColor":{const i=new c.e.EsriColor(e.toColor),s={...this.popoverProps,offsetDistance:(this.popoverProps?.offsetDistance??10)+50};return(0,o.h)(o.F,null,(0,o.h)("calcite-label",null,t.animations.toColor),(0,o.h)("arcgis-color-input",{color:this.toColorPickerValue(i),clearable:!1,onArcgisChange:t=>{const i=_t(t.currentTarget.color),o=new c.e.EsriColor(i).toRgb();e.toColor=[...o,255],this.setInternalSymbol(this.symbol,!0)},popoverProps:s,storageId:et,ref:this.setColorInputRef}))}case"CIMSymbolAnimationSize":return(0,o.h)("calcite-label",null,t.animations.size,(0,o.h)("arcgis-slider-input",{disabled:!1,min:1,max:150,step:1,unitsLabel:t.px,value:ft((0,m.a)(e.toSize)),onArcgisValueChange:t=>{const i=(0,m.p)(t.detail);e.toSize=i,this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:t.animations.size}));case"CIMSymbolAnimationRotation":return(0,o.h)("calcite-label",null,t.rotation,(0,o.h)("arcgis-slider-input",{min:0,max:360,step:1,unitsLabel:"\xba",flipLabels:"rtl"===this.dir,value:e.toRotation,onArcgisValueChange:t=>{const i=t.detail;e.toRotation=i,this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:t.rotation}));case"CIMSymbolAnimationOffset":return(0,o.h)(o.F,null,(0,o.h)("calcite-label",null,t.animations.offset),(0,o.h)("div",{class:"offset-div"},(0,o.h)("arcgis-xy-slider",{x:Math.round((0,m.a)(e.offsetX)),y:-Math.round((0,m.a)(e.offsetY)),minX:-20,minY:-20,maxX:20,maxY:20,step:1,snappable:!0,onArcgisInput:t=>{t.stopPropagation();const i=t.currentTarget;e.offsetX=(0,m.p)(i.x),e.offsetY=-(0,m.p)(i.y),this.setInternalSymbol(this.symbol,!0)}}),(0,o.h)("div",null,(0,o.h)("calcite-label",{scale:"s"},t.animations.xOffset,(0,o.h)("calcite-input-number",{scale:"s",placeholder:t.animations.xOffset,value:`${Math.round((0,m.a)(e.offsetX))}`,inputMode:"decimal",min:-20,max:20,onCalciteInputNumberInput:t=>{const i=t.currentTarget;this.waitOnUser(t,(()=>{e.offsetX=(0,m.p)(Number.parseInt(i.value)),this.setInternalSymbol(this.symbol,!0)}),0)}})),(0,o.h)("calcite-label",{scale:"s"},t.animations.yOffset,(0,o.h)("calcite-input-number",{scale:"s",placeholder:t.animations.yOffset,value:`${Math.round((0,m.a)(e.offsetY))}`,inputMode:"decimal",min:-20,max:20,onCalciteInputNumberInput:t=>{const i=t.currentTarget;this.waitOnUser(t,(()=>{e.offsetY=(0,m.p)(Number.parseInt(i.value)),this.setInternalSymbol(this.symbol,!0)}),0)}})))));case"CIMSymbolAnimationScale":return(0,o.h)("div",{class:"scale-animation-wrapper"},(0,o.h)("calcite-label",null,t.animations.scaleFactor),(0,o.h)("calcite-slider",{min:0,max:3.5,step:.01,minLabel:t.animations.small,maxLabel:t.animations.large,value:e.scaleFactor,onCalciteSliderInput:t=>{const i=t.target.value;e.scaleFactor=i,this.setInternalSymbol(this.symbol,!0)}}),(0,o.h)("div",{class:"scale-animation-slider-labels","aria-hidden":"true"},(0,o.h)("calcite-label",null,t.animations.small),(0,o.h)("calcite-label",null,t.animations.large)));case"CIMSymbolAnimationTransparency":return(0,o.h)("calcite-label",null,t.transparency,(0,o.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:0,max:100,step:1,unitsLabel:"%",value:Math.round(e.toTransparency),onArcgisValueChange:t=>{e.toTransparency=t.detail,this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,disabled:!1,label:t.transparency}));default:return(0,o.h)(o.F,null)}}renderSymbolSelectionPanel(){const{dir:e,mergedStrings:t}=this,i=!this.hideAddStyles&&window.customElements?.get("arcgis-item-browser");return(0,o.h)("calcite-flow-item",{class:"symbol-selection-panel",dir:e,heading:t.changeSymbol,key:"symbol-selection",selected:"choosing-symbol"===this.state,beforeBack:async()=>{this.state="editing"}},i&&(0,o.h)(o.F,null,(0,o.h)("calcite-action",{id:"add-styles",slot:"header-actions-end",text:t.addStyles,icon:"plus",onClick:async()=>await this.addStyles()}),(0,o.h)("calcite-tooltip",{"reference-element":"add-styles"},t.addStyles)),(0,o.h)("arcgis-symbol-picker",{lang:this.currentLanguage,hideSvgUploadSymbols:this.hideSvgUploadSymbols,onArcgisActiveSymbolChange:e=>{const{detail:t}=e;this.onSymbolSelect(t),e.stopPropagation()},onArcgisActiveSourceIdChange:({detail:e})=>{this.activeSourceId=e,this.arcgisSourceIdChange.emit(e),this.arcgisSymbolStylerSourceIdChange.emit(e)},onArcgisActiveSymbolItemChange:({detail:e})=>{this.activeSymbolItem=e},onArcgisSymbolSourcesChange:({detail:e})=>this.filteredSources=e,onArcgisActiveSourceItemsChange:({detail:e})=>this.activeSymbolItems=e,activeSymbolItem:this.activeSymbolItem,activeSourceId:this.activeSourceId||this.initialSourceId,portal:this.portalOrInterceptor,style:{"--scroller-max-height":"var(--symbol-scroller-max-height)"},symbolFilter:this.symbolFilter,symbol:this.activeSymbol,key:`${this.pickerReRenderFlag}`,ref:e=>this.symbolPickerElement=e}),(0,o.h)("calcite-button",{width:"full",slot:"footer",onClick:async()=>await(this.flowEl?.back())},t.done))}setInternalSymbol(e,t,i){if(this.symbol=e,"animation"===this.state){let e=this.symbol.data.symbol;if("root-symbol"===this.currentAnimationInfo.symbolLayerKey)this.currentAnimationSymbolLayer=e;else{const t=this.currentAnimationInfo.symbolLayerKey.split("__");for(let i=0;i<t.length;i++)if("symbol-layers"===t[i])e=e.symbolLayers;else if("symbol-layer"===t[i]){const o=t[i+1];e=e[Number.parseInt(o)],i++}"picture-marker"===this.currentAnimationInfo.symbolLayerType?this.currentAnimationSymbolLayer=e:this.currentAnimationSymbolLayer=mt(e)}}this.updatePreviewSymbol(),t&&this.emitEdit(e,i)}renderRootCIMSymbolColorContent(){const e=c.e.cimSymbolUtils.getCIMSymbolColor(this.symbol);return(0,d.i)(e)?(0,o.h)(o.F,null,(0,o.h)("calcite-label",null,this.mergedStrings.color),(0,o.h)("arcgis-color-input",{color:this.toColorPickerValue(e),clearable:!0,onArcgisChange:t=>{const i=_t(t.currentTarget.color);Rt(i)||Rt(e)||(i.a=e.a),c.e.cimSymbolUtils.applyCIMSymbolColor(this.symbol,i),this.setInternalSymbol(this.syncSymbolProps(this.symbol.clone(),{cimChangeContext:"point"===this.editGeometry?"root":"original-root"}),!0),t.stopPropagation()},popoverProps:this.popoverProps,storageId:et,ref:this.setColorInputRef})):(0,o.h)(o.F,null)}renderRootCIMSymbolTransparencyContent(){const e=c.e.cimSymbolUtils.getCIMSymbolColor(this.symbol);return(0,d.i)(e)?(0,o.h)("calcite-label",null,this.mergedStrings.transparency,(0,o.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:0,max:100,step:1,unitsLabel:"%",value:Math.round((0,d.k)(e.a??1)),onArcgisValueChange:t=>{const i=t.detail,o=(0,d.t)(i);e.a=o,c.e.cimSymbolUtils.applyCIMSymbolColor(this.symbol,e),this.setInternalSymbol(this.syncSymbolProps(this.symbol.clone(),{cimChangeContext:"point"===this.editGeometry?"root":"original-root"}),!0),t.stopPropagation()},withSteppers:!this.narrow,disabled:!1,label:this.mergedStrings.transparency})):(0,o.h)(o.F,null)}renderRootCIMSymbolSizeContent(){const{sections:e,marker:t}=this,i=e?.marker?.parts?.size,s="object"==typeof i&&i?.autoSizeAdjust,r=c.e.cimSymbolUtils.getCIMSymbolSize(this.symbol);return(0,o.h)("div",{class:je},(0,o.h)("calcite-label",null,this.mergedStrings.symbolSize,(0,o.h)("arcgis-slider-input",{disabled:s&&"editable"!==s&&t?.autoAdjusted,min:1,max:150,step:1,unitsLabel:this.mergedStrings.px,value:ft((0,m.a)(r)),onArcgisValueChange:e=>this.onSymbolSizeChange(e.detail),withSteppers:!this.narrow,label:this.mergedStrings.symbolSize})),s?this.renderAutoAdjust((0,n.a)(this.el),this.marker?.autoAdjusted||!1,this.mergedStrings.autoAdjustSize,this.onAutoAdjustSizeChange):null)}renderRootCIMSymbolWidthContent(){const e=this.symbol,{sections:t,stroke:i}=this,s=t?.stroke?.extraParts?.autoStrokeAdjust,r=(0,n.a)(this.el),l=(0,c.i)(e)?function(e){const t=e.data.symbol?.symbolLayers?.find((e=>["CIMSolidStroke","CIMPictureStroke"].includes(e.type)));return t.width??0}(e):c.e.cimSymbolUtils.getCIMSymbolSize(this.symbol);let a=this.getStrokeString("width"),h=this.cimStrokeWidthBounds?.min,d=this.cimStrokeWidthBounds?.max;if((0,c.a)(e)){const t=e?.data?.symbol?.symbolLayers?.some((e=>["CIMVectorMarker","CIMPictureMarker"].includes(e.type)));t&&(a=this.mergedStrings.symbolSize,h=1,d=st)}return(0,o.h)("div",{class:je},(0,o.h)("calcite-label",{dir:r},a,(0,o.h)("arcgis-slider-input",{disabled:s&&"editable"!==s&&i?.autoAdjusted,min:h,max:d,step:1,unitsLabel:this.mergedStrings.px,value:ft((0,m.a)(l)),onArcgisValueChange:e=>this.onStrokeWidthChange(e.detail),withSteppers:!this.narrow,label:a})),s?this.renderAutoAdjust(r,this.stroke?.autoAdjusted||!1,this.mergedStrings.autoAdjustStroke,this.onAutoAdjustStrokeChange):null)}renderSymbolSizeContent(){const{sections:e,marker:t}=this,i=e?.marker?.parts?.size,s=(0,n.a)(this.el),r="object"==typeof i&&i?.autoSizeAdjust;return(0,o.h)("div",{class:je},(0,o.h)("calcite-label",null,this.mergedStrings.symbolSize,(0,o.h)("arcgis-slider-input",{disabled:r&&"editable"!==r&&t?.autoAdjusted,min:1,max:150,step:1,unitsLabel:this.mergedStrings.px,value:t?.size,onArcgisValueChange:e=>this.onSymbolSizeChange(e.detail),withSteppers:!this.narrow,label:this.mergedStrings.symbolSize})),r?this.renderAutoAdjust(s,t?.autoAdjusted??!1,this.mergedStrings.autoAdjustSize,this.onAutoAdjustSizeChange):null)}renderAutoAdjust(e,t,i,s){return(0,o.h)("calcite-label",{class:Le,dir:e,layout:"inline",key:"auto-adjust"},(0,o.h)("calcite-checkbox",{checked:t,class:Ue,onCalciteCheckboxChange:s}),i)}renderSymbolRotationContent(){const{marker:e,mergedStrings:t}=this;return(0,o.h)("calcite-label",null,t.rotation,(0,o.h)("arcgis-slider-input",{min:0,max:360,step:1,unitsLabel:"\xba",flipLabels:"rtl"===this.dir,value:e?.angle,onArcgisValueChange:e=>this.onSymbolRotationChange(e.detail),withSteppers:!this.narrow,label:t.rotation}))}renderFillBlock(){if(!this.config?.sections)return(0,o.h)("div",null,";");const{sections:e}=this.config,{fill:t}=e;return"color"===t?.type?this.renderColorFillBlock():this.renderColorRampFillBlock()}renderColorFillBlock(){const e=this.sections?.fill,{parts:t}=e,i=[];return(t.suggestedColors||t.customColor)&&i.push({content:this.renderFillColorContent()}),t.transparency&&i.push({content:(0,o.h)("arcgis-symbol-styler-section",{embedded:!0,disabled:!e.enabled},this.renderColorFillTransparencyContent(this.mergedStrings.fillTransparency,!e.enabled))}),this.renderSection({key:"color-fill",disabled:"non-editable"===e.optional||this.hasActivePictureMarkerSymbol()||this.hasActiveLineOnlySimpleMarkerSymbol(),sectionContent:i})}toColorPickerValue(e){if(e&&!Rt(e))return e.toHex()}renderFillColorContent(){const e=this.sections?.fill,t=e?.enabled?this.toColorPickerValue(this.fill?.color):void 0;return(0,o.h)(o.F,null,(0,o.h)("calcite-label",null,this.mergedStrings.fillColor),(0,o.h)("arcgis-color-input",{color:t,clearable:!1!==e?.optional,onArcgisChange:t=>{const i=t.currentTarget.color;if(!i)return void this.onFillEnabledChange(!1);e?.enabled||this.onFillEnabledChange(!0);const o=_t(i),{color:s}=this.fill,r={color:_t(pt(s,{...s,...o,a:s.a}))};this.fill=r,this.arcgisFillChange.emit(r),this.arcgisSymbolStylerFillChange.emit(r),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0),t.stopPropagation()},popoverProps:this.popoverProps,storageId:et,ref:this.setColorInputRef}))}getStrokeString(e){return this.mergedStrings["line"===this.editGeometry?e:`stroke${t=e,t.charAt(0).toUpperCase()+t.slice(1)}`];var t}isSupportedSymbolLayerType(e){return"CIMVectorMarker"===e||"CIMSolidFill"===e||"CIMSolidStroke"===e||"CIMHatchFill"===e||"CIMPictureFill"===e||"CIMPictureStroke"===e||"CIMPictureMarker"===e}getSymbolLayerPreviewSymbol(e,t){const i={data:{type:"CIMSymbolReference",symbol:{type:"point"===t?"CIMPointSymbol":"line"===t?"CIMLineSymbol":"CIMPolygonSymbol",symbolLayers:[e]}}};return"CIMVectorMarker"===e.type&&((i.data?.symbol).angle=e.rotation??0),new c.e.CIMSymbol(i)}renderCIMVectorMarkerSymbolLayerBlocks(e,t){if("minimal"===this.mode)return(0,o.h)(o.F,null);const{sections:i,marker:s,mergedStrings:r}=this,n=i?.marker?.parts.size,l=i?.marker?.parts.rotation,a=i?.stroke?.extraParts?.autoStrokeAdjust,h="object"==typeof n&&n?.autoSizeAdjust,p=this.getSymbolLayerPreviewSymbol(e,"point"),y=mt(e),u=c.e.cimSymbolUtils.getCIMSymbolSize(p),g=c.e.cimSymbolUtils.getCIMSymbolRotation(p,!0),b=function(e){const t=new Set;let i=at(e,(e=>{if("CIMSolidFill"===e?.type||"CIMHatchFill"===e?.type||"CIMPictureFill"===e?.type||"CIMPictureMarker"===e?.type)return"fill"}));return i&&t.add(i),i=at(e,(e=>{if("CIMSolidStroke"===e?.type||"CIMPictureStroke"===e?.type)return"stroke"})),i&&t.add(i),Array.from(t).filter(Boolean)}(e),S=[];if(b.includes("fill")&&(!this.isFillColorRamp()||e.colorLocked)){const t=dt(e,"fill"),i=[(0,o.h)(o.F,null,(0,o.h)("calcite-label",{key:"fill-color"},1===b.length?r.color:r.fillColor),(0,o.h)("div",{class:"input-color"},(0,o.h)("arcgis-color-input",{color:this.toColorPickerValue(t),clearable:!0,onArcgisChange:i=>{const o=_t(i.currentTarget.color);Rt(o)||Rt(t)||(o.a=t.a),ht(e,o,"fill"),this.setInternalSymbol(this.symbol,!0),i.stopPropagation()},popoverProps:this.popoverProps,storageId:et,ref:this.setColorInputRef}))),(0,o.h)("calcite-label",{key:"fill-transparency"},1===b.length?r.transparency:r.fillTransparency,(0,o.h)("arcgis-slider-input",{min:0,max:ot,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,d.k)(t.a)),onArcgisValueChange:i=>{const o=i.detail,s=(0,d.t)(o),r=t.clone();r.a=s,ht(e,r,"fill"),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:1===b.length?r.transparency:r.fillTransparency}))];S.push(i)}if(b.includes("stroke")){const t=dt(e,"stroke"),i=function(e,t){let i=0;return at(e,(e=>{"fill"===t&&("CIMVectorMarker"!==e?.type&&"CIMPictureMarker"!==e?.type||void 0!==e.size&&e.size>i&&(i=e.size)),"stroke"===t&&("CIMSolidStroke"!==e?.type&&"CIMPictureStroke"!==e?.type||void 0!==e.width&&e.width>i&&(i=e.width))})),i}(e,"stroke"),s=[(0,o.h)(o.F,null,(0,o.h)("calcite-label",{key:"stroke-color"},1===b.length?r.color:r.strokeColor),(0,o.h)("div",{class:"input-color"},(0,o.h)("arcgis-color-input",{color:this.toColorPickerValue(t),clearable:!0,onArcgisChange:i=>{const o=_t(i.currentTarget.color);Rt(o)||Rt(t)||(o.a=t.a),ht(e,o,"stroke"),this.setInternalSymbol(this.symbol,!0),i.stopPropagation()},popoverProps:this.popoverProps,storageId:et,ref:this.setColorInputRef}))),(0,o.h)("calcite-label",{key:"stroke-transparency"},1===b.length?r.transparency:r.strokeTransparency,(0,o.h)("arcgis-slider-input",{min:0,max:ot,step:1,unitsLabel:"%",flipLabels:this.percentLabelFlip,value:Math.round((0,d.k)(t.a)),onArcgisValueChange:i=>{const o=i.detail,s=(0,d.t)(o),r=t.clone();r.a=s,ht(e,r,"stroke"),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:1===b.length?r.transparency:r.strokeTransparency})),(0,o.h)("calcite-label",{key:"stroke-width"},1===b.length?r.width:r.strokeWidth,(0,o.h)("arcgis-slider-input",{disabled:a&&"editable"!==a&&this.stroke?.autoAdjusted,min:this.cimStrokeWidthBounds?.min,max:this.cimStrokeWidthBounds?.max,step:1,unitsLabel:r.px,value:ft((0,m.a)(i)),onArcgisValueChange:t=>{const i=t.detail;!function(e,t,i){at(e,(e=>{"fill"===i&&("CIMVectorMarker"!==e?.type&&"CIMPictureMarker"!==e?.type||(e.size=t)),"stroke"===i&&("CIMSolidStroke"!==e?.type&&"CIMPictureStroke"!==e?.type||(e.width=t))}))}(e,kt((0,m.p)(i)),"stroke"),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:1===b.length?r.width:r.strokeWidth}))];S.push(s)}const f=(0,o.h)("div",{class:je,key:`${t}__vector-marker-symbol-layer`},[...S],n&&(0,o.h)("calcite-label",null,r.symbolSize,(0,o.h)("arcgis-slider-input",{disabled:h&&"editable"!==h&&s?.autoAdjusted,min:1,max:st,step:1,unitsLabel:r.px,value:ft((0,m.a)(u)),onArcgisValueChange:e=>{const t=e.detail;this.setMarkerSymbolLayerSize(p,t),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:r.symbolSize})),l&&(0,o.h)("calcite-label",null,r.rotation,(0,o.h)("arcgis-slider-input",{min:0,max:360,step:1,unitsLabel:"\xba",flipLabels:"rtl"===this.dir,value:St(g),onArcgisValueChange:e=>{const t=e.detail;c.e.cimSymbolUtils.applyCIMSymbolRotation(p,St(t),!0),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:r.rotation})),this.renderCIMMarkerPlacementSection(e),this.renderCIMAnimationEntryPoint(y,t,"vector-marker")),k=this.getSymbolLayerPreviewSymbol(this.sanitizePointPreviewSymbolLayer(e),"point");return this.renderBlock({icon:(0,o.h)("arcgis-symbol-styler-symbol-preview",{contrast:!0,key:`${t}__symbol-layer-preview`,symbol:k,options:tt,slot:"icon"}),key:`${t}__symbol-layer`,heading:r.vectorMarker,content:f})}setMarkerSymbolLayerSize(e,t){(0,c.c)(this.activeSymbol)?(e.data.symbol?.symbolLayers?.[0]).size=kt((0,m.p)(t)):c.e.cimSymbolUtils.scaleCIMSymbolTo(e,kt((0,m.p)(t)))}renderCIMSolidFillSymbolLayerBlock(e,t,i=!1){if("minimal"===this.mode)return(0,o.h)(o.F,null);const s=_t(e.color,!0),r=Rt(s);let n=null,l=null;this.isFillColorRamp()&&!e.colorLocked||(n=(0,o.h)(o.F,null,(0,o.h)("calcite-label",null,this.mergedStrings.fillColor),(0,o.h)("div",{class:"input-color"},(0,o.h)("arcgis-color-input",{color:this.toColorPickerValue(s),clearable:!0,onArcgisChange:t=>{const i=_t(t.currentTarget.color);Rt(i)||r||(i.a=s.a),e.color=i.toJSON(),this.setInternalSymbol(this.symbol,!0),t.stopPropagation()},popoverProps:this.popoverProps,storageId:et,ref:this.setColorInputRef}))),l=(0,o.h)("calcite-label",null,this.mergedStrings.fillTransparency,(0,o.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:0,max:ot,step:1,unitsLabel:"%",value:Math.round((0,d.k)(s.a)),disabled:r,onArcgisValueChange:t=>{const i=t.detail,o=(0,d.t)(i),r=s.clone();r.a=o,e.color=r.toJSON(),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:this.mergedStrings.fillTransparency})));const a=n||l?(0,o.h)("arcgis-symbol-styler-section",{embedded:!0,key:`${t}__solid-fill-symbol-layer-content`},n,(0,o.h)("arcgis-symbol-styler-section",{embedded:!0,disabled:r},l)):(0,o.h)("calcite-label",null,this.mergedStrings.emptySymbolLayerMsg);if(i)return a;const c=this.getSymbolLayerPreviewSymbol(e,"polygon");return this.renderBlock({icon:(0,o.h)("arcgis-symbol-styler-symbol-preview",{contrast:!0,key:`${t}__solid-fill-symbol-layer-preview`,symbol:c,slot:"icon"}),heading:this.mergedStrings.solidFill,key:`${t}__solid-fill-symbol-layer`,content:a})}renderCIMSolidStrokeSymbolLayerBlock(e,t,i=!1,s){if("minimal"===this.mode)return(0,o.h)(o.F,null);const r=_t(e.color,!0),n="CIMHatchFill"===s?.type,l=n&&this.isFillColorRamp(),a=this.sections?.stroke?.extraParts.autoStrokeAdjust,c=Rt(r);let h=null,p=null;this.isStrokeColorRamp()&&!e.colorLocked||(h=(0,o.h)(o.F,null,(0,o.h)("calcite-label",{key:"stroke-color"},i?this.mergedStrings.strokeColor:this.mergedStrings.color),(0,o.h)("div",{class:"input-color"},(0,o.h)("arcgis-color-input",{color:this.toColorPickerValue(r),clearable:!0,onArcgisChange:t=>{const i=_t(t.currentTarget.color);Rt(i)||c||(i.a=r.a),e.color=i.toJSON(),this.setInternalSymbol(this.symbol,!0),t.stopPropagation()},popoverProps:this.popoverProps,storageId:et,ref:this.setColorInputRef}))),p=(0,o.h)("calcite-label",{key:"stroke-transparency"},i?this.mergedStrings.strokeTransparency:this.mergedStrings.transparency,(0,o.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:0,max:ot,step:1,unitsLabel:"%",value:Math.round((0,d.k)(r.a)),disabled:c,onArcgisValueChange:t=>{const i=t.detail,o=(0,d.t)(i),s=r.clone();s.a=o,e.color=s.toJSON(),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:i?this.mergedStrings.strokeTransparency:this.mergedStrings.transparency})));const y=(0,o.h)("arcgis-symbol-styler-section",{embedded:!0,key:`${t}__solid-stroke-symbol-layer-content`},l?null:h,(0,o.h)("arcgis-symbol-styler-section",{embedded:!0,disabled:c},l?null:p,(0,o.h)("calcite-label",null,i?this.mergedStrings.strokeWidth:this.mergedStrings.width,(0,o.h)("arcgis-slider-input",{disabled:c||a&&"editable"!==a&&this.stroke?.autoAdjusted,min:this.cimStrokeWidthBounds?.min,max:this.cimStrokeWidthBounds?.max,step:1,unitsLabel:this.mergedStrings.px,value:void 0!==e.width?ft((0,m.a)(e.width)):0,onArcgisValueChange:t=>{const i=t.detail;e.width=kt((0,m.p)(i)),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:i?this.mergedStrings.strokeWidth:this.mergedStrings.width}))),n?this.renderCIMHatchFillPatternSection(s):null);if(i)return y;const u=n?this.getSymbolLayerPreviewSymbol({...s,lineSymbol:{type:"CIMLineSymbol",symbolLayers:[e]}},"polygon"):this.getSymbolLayerPreviewSymbol(e,"line");return this.renderBlock({icon:(0,o.h)("arcgis-symbol-styler-symbol-preview",{contrast:!0,key:`${t}__solid-stroke-symbol-layer-preview`,symbol:u,slot:"icon"}),heading:n?this.mergedStrings.hatchFill:this.mergedStrings.solidStroke,key:`${t}__solid-stroke-symbol-layer`,content:y})}renderCIMHatchFillSymbolLayerBlocks(e,t){return this.renderCIMSymbolLayersContent(e.lineSymbol,`${t}__hatch-symbol-fill-symbol-layers`,!1,e).flat()}renderCIMHatchFillPatternSection(e){const{mergedStrings:t}=this,i=e.offsetX??0;return(0,o.h)("calcite-block-section",{key:"hatch-fill-pattern",text:t.pattern},(0,o.h)("calcite-label",null,t.rotation,(0,o.h)("arcgis-slider-input",{flipLabels:"rtl"===this.dir,max:360,min:0,onArcgisValueChange:t=>{const i=t.detail;e.rotation=Math.abs(i),this.setInternalSymbol(this.symbol,!0)},step:1,unitsLabel:"\xba",value:e.rotation??0,withSteppers:!this.narrow,label:t.rotation})),(0,o.h)("calcite-label",null,t.separation,(0,o.h)("arcgis-slider-input",{flipLabels:"rtl"===this.dir,max:200,min:0,onArcgisValueChange:t=>{const i=t.detail;e.separation=i,this.setInternalSymbol(this.symbol,!0)},step:1,value:e.separation??0,unitsLabel:t.px,withSteppers:!this.narrow,label:t.separation})),(0,o.h)("calcite-label",null,t.offset,(0,o.h)("arcgis-slider-input",{flipLabels:"rtl"===this.dir,max:100,min:0,onArcgisValueChange:t=>{const i=t.detail;e.offsetX=i,e.offsetY=i,this.setInternalSymbol(this.symbol,!0)},step:1,value:i,unitsLabel:t.px,withSteppers:!this.narrow,label:t.offset})))}renderCIMPictureMarkerSymbolLayerBlock(e,t,i=!1){if("minimal"===this.mode)return(0,o.h)(o.F,null);const s=_t(e.tintColor,!0),{sections:r,marker:n}=this,l=r?.marker?.parts.size,a="object"==typeof l&&l?.autoSizeAdjust,c=this.getSymbolLayerPreviewSymbol(e,"point"),h=Rt(s),p=(0,o.h)("div",{key:`${t}__picture-marker-symbol-layer`},(0,o.h)("arcgis-symbol-styler-section",{embedded:!0,key:`${t}__picture-marker-symbol-layer-content`},(0,o.h)("calcite-label",null,this.mergedStrings.fillColor),(0,o.h)("div",{class:"input-color"},(0,o.h)("arcgis-color-input",{color:this.toColorPickerValue(s),clearable:!0,onArcgisChange:t=>{const i=_t(t.currentTarget.color);Rt(i)||h||(i.a=s.a),e.tintColor=i.toJSON(),this.setInternalSymbol(this.symbol,!0),t.stopPropagation()},popoverProps:this.popoverProps,storageId:et,ref:this.setColorInputRef})),(0,o.h)("arcgis-symbol-styler-section",{embedded:!0,disabled:h},(0,o.h)("calcite-label",null,this.mergedStrings.fillTransparency,(0,o.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:0,max:ot,step:1,unitsLabel:"%",value:Math.round((0,d.k)(s.a)),disabled:h,onArcgisValueChange:t=>{const i=t.detail,o=(0,d.t)(i),r=s.clone();r.a=o,e.tintColor=r.toJSON(),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:this.mergedStrings.fillTransparency})),(0,o.h)("calcite-label",null,this.mergedStrings.symbolSize,(0,o.h)("arcgis-slider-input",{disabled:h||a&&"editable"!==a&&n?.autoAdjusted,min:1,max:st,step:1,unitsLabel:this.mergedStrings.px,value:void 0!==e.size?ft((0,m.a)(e.size)):0,onArcgisValueChange:e=>{const t=e.detail;this.setMarkerSymbolLayerSize(c,t),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:this.mergedStrings.symbolSize})))),this.renderCIMMarkerPlacementSection(e));if(i)return p;const y=this.getSymbolLayerPreviewSymbol(this.sanitizePointPreviewSymbolLayer(e),"point");return this.renderBlock({icon:(0,o.h)("arcgis-symbol-styler-symbol-preview",{contrast:!0,key:`${t}__solid-fill-symbol-layer-preview`,symbol:y,options:tt,slot:"icon"}),heading:this.mergedStrings.pictureMarker,key:`${t}__picture-marker-symbol-layer`,content:p})}sanitizePointPreviewSymbolLayer(e){return{...e,markerPlacement:void 0}}renderCIMPictureStrokeSymbolLayerBlock(e,t,i=!1){if("minimal"===this.mode)return(0,o.h)(o.F,null);const s=_t(e.tintColor,!0),{sections:r,marker:n}=this,l=r?.marker?.parts.size,a="object"==typeof l&&l?.autoSizeAdjust,c=Rt(s),h=(0,o.h)("arcgis-symbol-styler-section",{embedded:!0,key:`${t}__picture-stroke-symbol-layer-content`},(0,o.h)("calcite-label",null,this.mergedStrings.fillColor),(0,o.h)("div",{class:"input-color"},(0,o.h)("arcgis-color-input",{color:this.toColorPickerValue(s),clearable:!0,onArcgisChange:t=>{const i=_t(t.currentTarget.color);Rt(i)||c||(i.a=s.a),e.tintColor=i.toJSON(),this.setInternalSymbol(this.symbol,!0),t.stopPropagation()},popoverProps:this.popoverProps,storageId:et,ref:this.setColorInputRef})),(0,o.h)("arcgis-symbol-styler-section",{embedded:!0,disabled:c},(0,o.h)("calcite-label",null,this.mergedStrings.fillTransparency,(0,o.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:0,max:ot,step:1,unitsLabel:"%",value:Math.round((0,d.k)(s.a)),disabled:c,onArcgisValueChange:t=>{const i=t.detail,o=(0,d.t)(i),r=s.clone();r.a=o,e.tintColor=r.toJSON(),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:this.mergedStrings.fillTransparency})),(0,o.h)("calcite-label",null,this.mergedStrings.symbolSize,(0,o.h)("arcgis-slider-input",{disabled:c||a&&"editable"!==a&&n?.autoAdjusted,min:1,max:st,step:1,unitsLabel:this.mergedStrings.px,value:void 0!==e.width?ft((0,m.a)(e.width)):0,onArcgisValueChange:t=>{const i=t.detail;e.width=kt((0,m.p)(i)),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:this.mergedStrings.symbolSize}))));if(i)return h;const p=this.getSymbolLayerPreviewSymbol(e,"line");return this.renderBlock({icon:(0,o.h)("arcgis-symbol-styler-symbol-preview",{contrast:!0,key:`${t}__picture-stroke-symbol-layer-preview`,symbol:p,slot:"icon"}),heading:this.mergedStrings.pictureStroke,key:`${t}__picture-stroke-symbol-layer`,content:h})}renderCIMPictureFillSymbolLayerBlock(e,t,i=!1){if("minimal"===this.mode)return(0,o.h)(o.F,null);const s=_t(e.tintColor,!0),{sections:r,marker:n}=this,l=r?.marker?.parts.size,a="object"==typeof l&&l?.autoSizeAdjust,c=Rt(s),h=(0,o.h)("arcgis-symbol-styler-section",{embedded:!0,key:`${t}__picture-fill-symbol-layer-content`},(0,o.h)("calcite-label",null,this.mergedStrings.fillColor),(0,o.h)("div",{class:"input-color"},(0,o.h)("arcgis-color-input",{color:this.toColorPickerValue(s),clearable:!0,onArcgisChange:t=>{const i=_t(t.currentTarget.color);Rt(i)||c||(i.a=s.a),e.tintColor=i.toJSON(),this.setInternalSymbol(this.symbol,!0),t.stopPropagation()},popoverProps:this.popoverProps,storageId:et,ref:this.setColorInputRef})),(0,o.h)("arcgis-symbol-styler-section",{embedded:!0,disabled:c},(0,o.h)("calcite-label",null,this.mergedStrings.fillTransparency,(0,o.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:0,max:ot,step:1,unitsLabel:"%",value:Math.round((0,d.k)(s.a)),disabled:c,onArcgisValueChange:t=>{const i=t.detail,o=(0,d.t)(i),r=s.clone();r.a=o,e.tintColor=r.toJSON(),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:this.mergedStrings.fillTransparency})),(0,o.h)("calcite-label",null,this.mergedStrings.symbolSize,(0,o.h)("arcgis-slider-input",{disabled:c||a&&"editable"!==a&&n?.autoAdjusted,min:1,max:st,step:1,unitsLabel:this.mergedStrings.px,value:void 0!==e.height?ft((0,m.a)(e.height)):0,onArcgisValueChange:t=>{const i=t.detail;e.height=kt((0,m.p)(i)),this.setInternalSymbol(this.symbol,!0)},withSteppers:!this.narrow,label:this.mergedStrings.symbolSize}))));if(i)return h;const p=this.getSymbolLayerPreviewSymbol(e,"polygon");return this.renderBlock({icon:(0,o.h)("arcgis-symbol-styler-symbol-preview",{contrast:!0,key:`${t}__picture-fill-symbol-layer-preview`,symbol:p,slot:"icon"}),heading:this.mergedStrings.pictureFill,key:`${t}__picture-fill-symbol-layer`,content:h})}renderCIMAnimationEntryPoint(e,t,i){if(!e)return(0,o.h)(o.F,null);const{mergedStrings:s}=this,r="rtl"===(0,n.a)(this.el);return e.animations?.length??("CIMPictureMarker"===e.type&&e.animatedSymbolProperties)?(0,o.h)("calcite-label",null,(0,o.h)("button",{class:He,onClick:()=>{this.currentAnimationSymbolLayer=e,this.currentAnimationInfo={symbolLayerKey:t,symbolLayerType:i},this.state="animation"},type:"button"},(0,o.h)("div",{class:De,tabIndex:0},(0,o.h)("div",{class:`${$e} animation-label`},s.animation)),(0,o.h)("calcite-icon",{icon:"chevron-"+(r?"left":"right"),scale:"s"}))):(0,o.h)(o.F,null)}renderCIMMarkerPlacementSection(e){const{dir:t,mergedStrings:i}=this,{markerPlacement:s}=e;return"CIMMarkerPlacementInsidePolygon"!==s?.type||"Random"!==s?.gridType&&"Fixed"!==s?.gridType?(0,o.h)(o.F,null):(0,o.h)("calcite-block-section",{key:"marker-placement",text:i.markerPlacement},(0,o.h)("calcite-label",null,i.gridType,(0,o.h)("calcite-segmented-control",{onCalciteSegmentedControlChange:e=>{const t=e.currentTarget.value;s.gridType=t,this.setInternalSymbol(this.symbol,!0)}},(0,o.h)("calcite-segmented-control-item",{value:"Fixed",checked:"Fixed"===s.gridType},i.fixed),(0,o.h)("calcite-segmented-control-item",{value:"Random",checked:"Random"===s.gridType},i.random))),(0,o.h)("calcite-label",null,i.randomness,(0,o.h)("arcgis-slider-input",{disabled:"Fixed"===s.gridType,flipLabels:this.percentLabelFlip,max:100,min:0,onArcgisValueChange:e=>{const t=e.detail;s.randomness=t,this.setInternalSymbol(this.symbol,!0)},step:1,value:s.randomness,unitsLabel:"%",withSteppers:!this.narrow,label:i.randomness})),(0,o.h)("calcite-label",null,i.stepX,(0,o.h)("arcgis-slider-input",{max:200,min:0,onArcgisValueChange:e=>{const t=e.detail;s.stepX=kt((0,m.p)(t)),this.setInternalSymbol(this.symbol,!0)},step:1,value:void 0!==s.stepX?ft((0,m.a)(s.stepX)):0,unitsLabel:i.px,withSteppers:!this.narrow,label:i.stepX})),(0,o.h)("calcite-label",null,i.stepY,(0,o.h)("arcgis-slider-input",{max:200,min:0,onArcgisValueChange:e=>{const t=e.detail;s.stepY=kt((0,m.p)(t)),this.setInternalSymbol(this.symbol,!0)},step:1,unitsLabel:i.px,value:void 0!==s.stepY?ft((0,m.a)(s.stepY)):0,withSteppers:!this.narrow,label:i.stepY})),(0,o.h)("calcite-label",{dir:t,layout:"inline"},(0,o.h)("calcite-checkbox",{checked:s.shiftOddRows&&"Fixed"===s.gridType,disabled:"Random"===s.gridType,onCalciteCheckboxChange:e=>{const{checked:t}=e.currentTarget;s.shiftOddRows=t,this.setInternalSymbol(this.symbol,!0)}}),i.shiftOddRows))}renderColorFillTransparencyContent(e,t){const{fill:i}=this;return(0,o.h)("calcite-label",null,e,(0,o.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:0,max:100,step:1,unitsLabel:"%",value:Math.round((0,d.k)(i?.color?.a??1)),onArcgisValueChange:e=>this.onColorFillTransparencyChange(e.detail),withSteppers:!this.narrow,disabled:t,label:e}))}renderColorRampFillBlock(e=!1){const t=this.sections?.fill,{parts:i}=t;if(this.hasActivePictureMarkerSymbol()||this.hasActiveLineOnlySimpleMarkerSymbol())return(0,o.h)(o.F,null);const s=[];return i.colorRamps&&s.push({content:this.renderFillColorRampsContent()}),i.transparency&&s.push({content:this.renderColorRampFillTransparencyContent()}),this.renderSection({key:"color-ramp-fill",disabled:"non-editable"===t.optional,embedded:e,sectionContent:s})}renderFillColorRampsContent(){const{style:e}=this.config?.sections?.fill,{activeCategory:t,colorRamps:i}=this.sections?.fill;return this.renderRampsContent({style:e,activeCategory:t,colorRampStops:this.fill?.color,colorRamps:i,heading:this.mergedStrings.colors,onCategoryChange:this.onFillColorRampCategoryChange,isSelected:t=>{const i=this.fill?.color;return rt(i,t.stops,"2d"===e)},onSelect:e=>{const{detail:t}=e,i=t.stops.slice(),{fill:o}=this,s={...o,color:i};this.fill=s,this.tempStrokeColorRampStateStops=i,this.arcgisFillChange.emit(s),this.arcgisSymbolStylerFillChange.emit(s),this.setInternalSymbol(this.syncSymbolProps(this.symbol,{cimChangeContext:"root"}),!0),e.stopPropagation()},onFlip:this.flipFillColorRamps})}renderRampsContent(e){return(0,o.h)("calcite-label",null,e.heading,(0,o.h)("arcgis-symbol-styler-color-ramp-input",{options:e,strings:this.mergedStrings,popoverProps:this.popoverProps,style:{"--scroller-max-height":"var(--ramp-scroller-max-height)"},ref:this.setRampInputRef}))}renderColorRampFillTransparencyContent(){const{fill:e}=this,t=e.color[0],i=4===t.length?t[3]/255:t.a;return(0,o.h)("calcite-label",null,this.mergedStrings.fillTransparency,(0,o.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:0,max:100,step:1,unitsLabel:"%",value:Math.round((0,d.k)(i)),onArcgisValueChange:e=>this.onColorRampFillTransparencyChange(e.detail),withSteppers:!this.narrow,label:this.mergedStrings.fillTransparency}))}renderStrokeBlock(){const e=this.config?.sections?.stroke;return"color"===e?.type?this.renderColorStrokeBlock():this.renderColorRampStrokeBlock()}renderColorStrokeBlock(){const e=this.sections,t=e?.stroke,{parts:i}=t,s=[];if((i.suggestedColors||i.customColor)&&s.push({content:this.renderStrokeColorsContent()}),i.transparency||i.extra){const e=[];i.transparency&&e.push(this.showingRampOptionsInStroke()?this.renderColorRampStrokeTransparencyContent(!t.enabled):this.renderColorStrokeTransparencyContent(!t.enabled)),i.extra&&e.push(this.renderStrokeExtraContent(!t.enabled)),s.push({content:(0,o.h)("arcgis-symbol-styler-section",{embedded:!0,disabled:!t.enabled},e)})}return this.renderSection({key:"color-stroke",disabled:"non-editable"===t.optional||this.hasActivePictureMarkerSymbol(),sectionContent:s})}renderStrokeColorRampsContent(){const{style:e}=this.config?.sections?.stroke,{activeCategory:t,colorRamps:i}=this.sections?.stroke;return this.renderRampsContent({style:e,activeCategory:t,colorRampStops:this.stroke?.color,colorRamps:i,heading:this.getStrokeString("color"),onCategoryChange:this.onStrokeColorRampCategoryChange,isSelected:e=>{const t=this.stroke?.color;return rt(t,e.stops)},onSelect:e=>{const{detail:t}=e,i=t.stops.slice(),{stroke:o}=this,s={...o,color:i};this.stroke=s,this.arcgisStrokeChange.emit(bt(s)),this.arcgisSymbolStylerStrokeChange.emit(bt(s)),this.setInternalSymbol(this.syncSymbolProps(this.symbol,{cimChangeContext:"root"}),!0),e.stopPropagation()},onFlip:this.flipStrokeColorRamps})}showingRampOptionsInStroke(){const e=this.config?.sections?.stroke,t=gt(this.activeSymbol),i=this.sections?.fill?.type;return t&&"color-ramp"===i&&"color"===e.type}renderStrokeColorsContent(){const e=this.sections?.stroke;if(this.showingRampOptionsInStroke()){const e=this.tempStrokeColorRampStateActiveCategory,{style:t}=this.config?.sections?.fill,{colorRamps:i}=this.sections?.fill;return this.renderRampsContent({style:t,activeCategory:e,colorRampStops:this.tempStrokeColorRampStateStops,colorRamps:i,heading:this.getStrokeString("color"),onCategoryChange:e=>{const t=e.currentTarget.selectedItems[0].getAttribute("data-value");this.tempStrokeColorRampStateActiveCategory=t,e.stopPropagation()},isSelected:e=>rt(this.tempStrokeColorRampStateStops,e.stops),onSelect:e=>{const{detail:t}=e,i=t.stops.slice(),{stroke:o}=this,s={...o,color:i};this.stroke=s,this.tempStrokeColorRampStateStops=i,this.arcgisStrokeChange.emit(bt(s)),this.arcgisSymbolStylerStrokeChange.emit(bt(s)),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0),e.stopPropagation()},onFlip:this.flipFillColorRamps})}const t=e?.enabled?this.toColorPickerValue(this.stroke?.color):void 0;return(0,o.h)(o.F,null,(0,o.h)("calcite-label",null,this.getStrokeString("color")),(0,o.h)("arcgis-color-input",{color:t,clearable:!1!==e?.optional,onArcgisChange:t=>{const i=t.currentTarget.color;if(!i)return void this.onStrokeEnabledChange(!1);e?.enabled||this.onStrokeEnabledChange(!0);const o=_t(i),s=this.stroke?.color,{stroke:r}=this,n={...r,color:_t(pt(s,{...s,...o,a:s.a}))};this.stroke=n,this.arcgisStrokeChange.emit(bt(n)),this.arcgisSymbolStylerStrokeChange.emit(bt(n)),this.setInternalSymbol(this.syncSymbolProps(this.symbol),!0),t.stopPropagation()},popoverProps:this.popoverProps,storageId:et,ref:this.setColorInputRef}))}renderColorStrokeTransparencyContent(e){const{stroke:t}=this;return(0,o.h)("calcite-label",null,this.getStrokeString("transparency"),(0,o.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:0,max:100,step:1,unitsLabel:"%",value:Math.round((0,d.k)((t?.color).a)),onArcgisValueChange:e=>this.onColorStrokeTransparencyChange(e.detail),withSteppers:!this.narrow,disabled:e,label:this.getStrokeString("transparency")}))}renderStrokeExtraContent(e){const{sections:t,stroke:i}=this,s=t?.stroke?.extraParts.arrow,r=t?.stroke?.extraParts.autoStrokeAdjust,l=t?.stroke?.extraParts.style,a=t?.stroke?.extraParts.width,h="line"===this.editGeometry,m="polygon"===this.editGeometry,d=h?.1:0,p=(0,c.b)(this.symbol),y=!p&&l&&(h||m),u=!p&&s&&h,g=!p&&a,b=!p&&r,S=(0,n.a)(this.el),f=Pt(i?.marker);return(0,o.h)("div",{class:je},g?(0,o.h)("calcite-label",{dir:S,key:"width-options"},this.getStrokeString("width"),(0,o.h)("arcgis-slider-input",{disabled:e||r&&"editable"!==r&&i?.autoAdjusted,min:d,max:18,step:1,unitsLabel:this.mergedStrings.px,value:i?.size,onArcgisValueChange:e=>this.onStrokeWidthChange(e.detail),withSteppers:!this.narrow,label:this.getStrokeString("width")})):null,b?this.renderAutoAdjust(S,i?.autoAdjusted??!1,this.mergedStrings.autoAdjustStroke,this.onAutoAdjustStrokeChange):null,u?(0,o.h)("calcite-label",{dir:S,key:"arrow-options"},this.mergedStrings.arrow,(0,o.h)("calcite-dropdown",{class:{[Ee]:!0,[Re]:!0},onCalciteDropdownSelect:this.onStrokeArrowChange,widthScale:"l",placement:"top-end",overlayPositioning:this.popoverProps?.overlayPositioning,scale:"s"},(0,o.h)("div",{role:"button",slot:"trigger",tabIndex:0},(0,o.h)("div",{"data-arrow":f,class:Te,style:this.getSelectedArrowPatternStyle()}),(0,o.h)("calcite-icon",{icon:"chevron-down",scale:"s"})),(0,o.h)("calcite-dropdown-group",null,We.map((e=>(0,o.h)("calcite-dropdown-item",{selected:e===f,"data-arrow":e},(0,o.h)("div",{class:ze,"data-arrow":e,style:this.getArrowPatternOptionStyle()}))))))):null,y?(0,o.h)("calcite-label",{dir:S,key:"pattern-options"},this.mergedStrings.pattern,(0,o.h)("calcite-dropdown",{class:{[Ee]:!0,[_e]:!0},onCalciteDropdownSelect:this.onStrokeStyleChange,widthScale:"l",placement:"top-end",overlayPositioning:this.popoverProps?.overlayPositioning,scale:"s",maxItems:7},(0,o.h)("div",{role:"button",slot:"trigger",tabIndex:0},(0,o.h)("div",{class:Te,style:this.getLinePatternStyle(i?.style||"solid")}),(0,o.h)("calcite-icon",{icon:"chevron-down",scale:"s"})),(0,o.h)("calcite-dropdown-group",null,Je.map((e=>(0,o.h)("calcite-dropdown-item",{selected:e===i?.style,"data-style":e},(0,o.h)("div",{style:this.getLinePatternStyle(e),class:ze}))))))):null)}renderColorRampStrokeBlock(e=!1){const t=this.sections?.stroke,i=t.parts,o=[];return i.colorRamps&&o.push({content:this.renderStrokeColorRampsContent()}),i.transparency&&o.push({content:this.renderColorRampStrokeTransparencyContent("non-editable"===t.optional||this.hasActivePictureMarkerSymbol())}),i.extra&&o.push({content:this.renderStrokeExtraContent("non-editable"===t.optional||this.hasActivePictureMarkerSymbol())}),this.renderSection({key:"color-ramp-stroke",disabled:"non-editable"===t.optional||this.hasActivePictureMarkerSymbol(),embedded:e,sectionContent:o})}renderColorRampStrokeTransparencyContent(e){const{stroke:t}=this;return(0,o.h)("calcite-label",null,this.getStrokeString("transparency"),(0,o.h)("arcgis-slider-input",{flipLabels:this.percentLabelFlip,min:0,max:100,step:1,unitsLabel:"%",value:Math.round((0,d.k)(t?.color[0].a)),onArcgisValueChange:e=>this.onColorRampStrokeTransparencyChange(e.detail),withSteppers:!this.narrow,disabled:e,label:this.getStrokeString("transparency")}))}checkPopoverMaxHeight(){if(this.flowEl&&this.popoverProps&&(!this.popoverProps.maxHeight||this.autoCalcHeight)){this.autoCalcHeight=!0;const e=this.flowEl.getBoundingClientRect(),t=window.innerHeight||document.documentElement?.clientHeight||document.body?.clientHeight||0,i=t&&e?.top?t-e.top-30:0;this.popoverProps.maxHeight=Math.max(i||e.height,250)-(this.popoverProps.offsetDistance??0)-5+"px"}}getAnimationBlockHeadingInfo(e){const{mergedStrings:t}=this;switch(e){case"CIMSymbolAnimationColor":return{heading:t.animations.color,icon:"styling"};case"CIMSymbolAnimationOffset":return{heading:t.animations.offset,icon:"relative-direction"};case"CIMSymbolAnimationRotation":return{heading:t.animations.rotation,icon:"rotate"};case"CIMSymbolAnimationScale":return{heading:t.animations.scale,icon:"stretch"};case"CIMSymbolAnimationSize":return{heading:t.animations.size,icon:"dimensions-unit"};case"CIMSymbolAnimationTransparency":return{heading:t.animations.transparency,icon:"transparency"};default:return{heading:t.animation,icon:"play"}}}waitOnUser(e,t,i){const o=e.target;this.typingHandle&&(clearTimeout(this.typingHandle),this.typingHandle=void 0);const s=o.value,r=Number.parseFloat(s);s?(0,d.i)(o.min)&&(0,d.i)(o.max)&&(o.min>r||o.max<r)?this.typingHandle=setTimeout((()=>{this.typingHandle=void 0,o.min>r?(o.value=`${o.min}`,t(o)):o.max<r&&(o.value=`${o.max}`,t(o))}),750):s.startsWith("-")&&(0===r||Number.isNaN(r))||t(o):this.typingHandle=setTimeout((()=>{this.typingHandle=void 0,o.value=`${i}`,t(o)}),2e3)}static get assetsDirs(){return["assets"]}get el(){return(0,o.g)(this)}static get watchers(){return{builtInStrings:["handleStringChanges"],stringOverrides:["handleStringChanges"]}}};Et.style=':host {\n  min-width: 240px;\n  height: min-content;\n  display: flex;\n  flex: 1 1 auto;\n  flex-flow: column nowrap;\n  align-items: stretch;\n}\n\nbutton {\n  overflow: hidden;\n  background-color: var(--arcgis-symbol-styler-inline-input-trigger-background-color);\n  align-items: center;\n  border: none;\n  border-radius: 0;\n  box-sizing: border-box;\n  cursor: pointer;\n  display: flex;\n  font-family: inherit;\n  gap: 8px;\n  height: 100%;\n  justify-content: center;\n  outline-color: transparent;\n  outline-offset: 0;\n  padding: 3px 0;\n  padding-inline: 3px 8px;\n  position: relative;\n  text-decoration: none;\n  user-select: none;\n  text-align: center;\n  -webkit-appearance: none;\n  width: 100%;\n  &:focus {\n    outline: 2px solid var(--calcite-color-brand);\n    outline-offset: 2px;\n  }\n  &:hover {\n    text-decoration: none;\n  }\n}\n\ncalcite-dropdown {\n  width: 100%;\n}\n\ncalcite-flow {\n  height: 100%;\n}\n\n.content {\n  background-color: var(--calcite-color-foreground-1);\n}\n\n.color-locked-info {\n  display: flex;\n  gap: 4px;\n  margin: 8px 0;\n  align-items: center;\n\n  calcite-icon {\n    color: var(--calcite-color-text-3);\n  }\n}\n\n.icon-dropdown {\n  padding: 0.25rem 0 0 0;\n  width: 100%;\n  background-color: var(--calcite-color-foreground-1);\n  height: 2.25rem;\n  border: 1px solid #a9a9a9;\n  box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.075);\n}\n\n.icon-dropdown--selected {\n  cursor: pointer;\n  margin-left: 12px;\n  height: 3px;\n  width: 100%;\n}\n\n.icon-dropdown-item-content,\n.icon-dropdown--selected {\n  background-position: center;\n  background-clip: content-box;\n  background-origin: content-box;\n  padding-left: 0;\n  padding-right: 0;\n}\n\n.icon-dropdown-item-content {\n  height: 30px;\n  width: 200px;\n}\n\n:dir(rtl) {\n  .icon-dropdown--selected {\n    margin-right: 12px;\n  }\n}\n\n.style-dropdown {\n  [slot="trigger"] {\n    width: 100%;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    calcite-icon {\n      margin: 8px;\n      background-color: #fff;\n    }\n  }\n\n  [slot="trigger"],\n  .icon-dropdown-item-content {\n    background-repeat: repeat-x;\n  }\n}\n\n.arrow-dropdown {\n  [slot="trigger"] {\n    width: 100%;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n\n    .icon-dropdown--selected {\n      height: 30px;\n      background-size: 100% 119px;\n    }\n\n    calcite-icon {\n      margin: 8px;\n      background-color: #fff;\n    }\n  }\n\n  [slot="trigger"] .icon-dropdown--selected,\n  .icon-dropdown-item-content {\n    background-repeat: no-repeat;\n\n    &[data-arrow="none"] {\n      background-position: 0 0;\n    }\n\n    &[data-arrow="begin"] {\n      background-position: 0 -32px;\n    }\n\n    &[data-arrow="end"] {\n      background-position: 0 -61px;\n    }\n\n    &[data-arrow="begin-end"] {\n      background-position: 0 -91px;\n    }\n  }\n}\n\n.content-group {\n  display: flex;\n  flex-direction: column;\n\n  label {\n    margin: 8px 0 0 0;\n  }\n}\n\n.color-ramp-selection {\n  padding: 4px;\n}\n\n.section-toggle--disabled {\n  pointer-events: none;\n  opacity: 0.5;\n}\n\n.swatch-item {\n  box-sizing: border-box;\n  height: 16px;\n  width: 16px;\n  border-radius: 2px;\n  box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.33);\n}\n\n/* workaround for https://github.com/Esri/calcite-components/issues/2582 */\ncalcite-input[disabled] {\n  [data-adjustment] {\n    pointer-events: none;\n  }\n}\n\narcgis-symbol-styler-section {\n  calcite-block {\n    overflow: visible;\n    margin: 0 -12px;\n\n    &[open]:before {\n      content: "";\n      height: 16px;\n      display: flex;\n      background-color: var(--calcite-color-foreground-2);\n    }\n\n    &:nth-of-type(n + 1) {\n      border-bottom: 1px solid #f0f0f0;\n    }\n\n    &:last-child {\n      border-bottom: none;\n    }\n\n    arcgis-symbol-styler-section:nth-of-type(2) {\n      margin-top: 12px;\n    }\n  }\n}\n\ncalcite-panel {\n  overflow: visible;\n  /* stopgap to allow styler to be embedded into existing panels */\n  margin-top: 0;\n}\n\n.input-color {\n  flex-wrap: nowrap;\n  gap: 8px;\n  align-items: center;\n}\n\ncalcite-tooltip {\n  max-width: 250px;\n\n  &:not([open]) {\n    visibility: hidden;\n    pointer-events: none;\n  }\n}\n\n.message {\n  margin-top: 8px;\n}\n\n/* symbol layer previews */\narcgis-symbol-styler-symbol-preview[slot="icon"] {\n  width: 32px;\n  height: 32px;\n  padding: 2px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.container {\n  display: flex;\n  padding: 8px 12px;\n  align-items: center;\n  justify-content: center;\n  width: 100%;\n  gap: 8px;\n  flex-grow: 1;\n}\n\n.symbol {\n  height: 32px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.label {\n  flex-grow: 1;\n  display: flex;\n  justify-content: flex-start;\n}\n\n.animation-label {\n  font-weight: var(--calcite-font-weight-medium);\n}\n\n.change-symbol-trigger {\n  border: 1px solid var(--calcite-color-border-input);\n}\n\n.symbol-selection-panel {\n  min-height: min(100vh - 200px, 500px);\n  display: flex;\n  flex-direction: column;\n\n  arcgis-item-palette .palette {\n    gap: 8px;\n  }\n\n  calcite-notice:first-of-type {\n    margin: auto 0 0 0;\n  }\n\n  calcite-label {\n    margin: 16px 12px 0 12px;\n  }\n\n  calcite-panel {\n    overflow: visible;\n  }\n}\n\n.section {\n  display: flex;\n  flex-direction: column;\n  background-color: var(--calcite-color-foreground-1);\n}\n\narcgis-color-input {\n  margin-top: calc(-1 * var(--calcite-spacing-xxs));\n  padding-bottom: var(--calcite-spacing-md);\n}\n\n.animation-panel {\n  min-height: min(100vh - 200px, 500px);\n  display: flex;\n  flex-direction: column;\n}\n\n.play-reverse-animation {\n  display: flex;\n  align-items: center;\n  padding-bottom: var(--calcite-spacing-sm);\n}\n\n.play-reverse-animation-text {\n  margin: 0px var(--calcite-spacing-sm);\n}\n\n.offset-div {\n  align-items: center;\n  display: flex;\n  justify-content: space-between;\n  gap: 16px;\n  margin-bottom: var(--calcite-spacing-md);\n}\n\n.offset-animation-content-margin {\n  margin-bottom: var(--calcite-spacing-md);\n}\n\n.scale-animation-wrapper {\n  margin: var(--calcite-spacing-md) 0px;\n}\n\n.scale-animation-slider-labels {\n  display: flex;\n  justify-content: space-between;\n}\n';const Tt="arcgis-symbol-styler-storage-styles",zt=class{constructor(e){(0,o.r)(this,e),this.arcgisSymbolStylerBrowseStylesClose=(0,o.c)(this,"arcgisSymbolStylerBrowseStylesClose",7),this.manager=(0,n.u)(this),this.cardNodes={},this.editGeometry=void 0,this.excludeItemIds=void 0,this.portal=void 0,this.strings=void 0,this.items=void 0,this.pagination=void 0,this.selectedCount=0}async componentWillLoad(){const{editGeometry:e}=this,t=(0,h.g)(Tt,!0)||{};this.savedStyleIds=t?.[e]||[]}render(){const{portal:e,editGeometry:t,savedStyleIds:i,excludeItemIds:s,strings:r}=this,n=e.user;let l="";i?.forEach((e=>l+=` -id:${e}`)),s?.length&&s.forEach((e=>l+=` -id:${e}`));const a=`type:"Style" typekeywords:"web2d" ${"point"===t?'typekeywords:"pointSymbol"':"line"===t?'typekeywords:"lineSymbol"':'typekeywords:"polygonSymbol"'}${l}`,c=`${(0,y.a)(e)}/home/`;return(0,o.h)(o.H,{key:"9b90033c9658919b92a217628c3cdb339ba00aac"},(0,o.h)("calcite-dialog",{key:"177219aec6398f9fb271ad08e96b6492ae2cfa9f",class:"styles-dialog",open:!0,modal:!0,scale:"l",escapeDisabled:!0,outsideCloseDisabled:!0,onCalciteDialogClose:()=>this.arcgisSymbolStylerBrowseStylesClose.emit(),heading:this.strings.addStyles},(0,o.h)("arcgis-item-browser",{key:"1590c1947e6235c9a65e4320347f96e99c31a7c3",view:"list",selection:"multiple",filter:a,portal:e,user:n,api:4,config:{baseUrl:c},onArcgisItemBrowserUpdate:e=>{const{results:t,num:i,start:o,total:s}=e.detail;this.items=t,this.pagination={start:o,num:i,total:s}},onArcgisItemBrowserSelect:()=>this.selectedCount=this.itemBrowserNode?.selectedItems?.length,ref:e=>this.itemBrowserNode=e},(0,o.h)("arcgis-item-browser-top-bar",{key:"72535f3cb9400aad6e54d62868af9b5b645c0a55",slot:"top-bar","filter-toggle":!0},(0,o.h)("arcgis-item-browser-bucket-select",{key:"28f75bae67ce25bae88366d842a9e7337d595598",slot:"bucket",options:e.isPortal?["my","favorites","group","org","living atlas"]:void 0}),(0,o.h)("arcgis-item-browser-search",{key:"6caa60d81ae7854b810ef3d217f4ce80151934da",slot:"search",term:""})),(0,o.h)("arcgis-item-browser-sort",{key:"2fd4ae6f2ccd85799a479699bb92b488d9211ddf",options:["modified","title","relevance"],slot:"sort"}),(0,o.h)("arcgis-item-browser-filters",{key:"67d3fe70e6b9fce1030899323e08224361dff64d",slot:"filters"},e.user&&(0,o.h)("arcgis-item-browser-filter-folder",{key:"d618e6906a32bb6eabfc7817eb575e579990bb12"}),(0,o.h)("arcgis-item-browser-filter-categories",{key:"0461738cf69ea432b9bc06f1a423079d82fb512a"}),(0,o.h)("arcgis-item-browser-filter-sharing",{key:"649a830a6624b48fdc27399d7ffb4e38511a5daf"}),(0,o.h)("arcgis-item-browser-filter-collaborations",{key:"a67f59bed7a299f3fe1f876ffb63a96d428f4ac4"}),(0,o.h)("arcgis-item-browser-filter-tags",{key:"b87b255b8d55d9d732513fb931a03362eed169ab"}),(0,o.h)("arcgis-item-browser-filter-content-status",{key:"822f2dad694f2730ee4acd5a98ee20e73cb0ffb6"}),(0,o.h)("arcgis-item-browser-filter-date",{key:"a864375696ab12997ca5ab00b1cd943e5ae4d934",property:"modified"}),(0,o.h)("arcgis-item-browser-filter-date",{key:"61e0c68d94e54bd09595a218d83cf718149b6a65",property:"created"})),(0,o.h)("arcgis-item-browser-content",{key:"cd3d86f6c22f05b8b3d94f01a750cc612df499ba",slot:"content"},(this.items||[]).map((t=>(0,o.h)("arcgis-item-browser-card",{key:`card-${t.id}`,item:t,portal:e,baseUrl:c,showItemType:!0,showDateUpdated:!0,showOwner:!0,showSummary:!0,showThumbnail:!0,ref:e=>this.cardNodes[t.id]=e},(0,o.h)("calcite-button",{label:r.viewItemDetail,scale:"s",appearance:"outline-fill",kind:"neutral",slot:"actions-end",target:"_blank",href:`${c}/item.html?id=${t.id}`},r.viewItemDetail))))),(0,o.h)("arcgis-item-browser-pagination",{key:"c12c398b8102d8e26f2b321ebd85dfb7042011b2",slot:"pagination",total:this.pagination?.total,start:this.pagination?.start,num:this.pagination?.num})),(0,o.h)("calcite-button",{key:"bae3d240fe6fe15f6c19574949af9532138666a0",slot:"footer-end",appearance:"outline-fill",alignment:"center",onClick:()=>this.arcgisSymbolStylerBrowseStylesClose.emit()},this.strings.cancel),(0,o.h)("calcite-button",{key:"3bfd700a06a150e8b6e0bb3fb9d2054ea980bd56",slot:"footer-end",alignment:"center",appearance:"solid",disabled:!this.selectedCount,onClick:()=>{this.saveNewStyleItemsInLocalStorage(this.itemBrowserNode.selectedItems),this.arcgisSymbolStylerBrowseStylesClose.emit(this.itemBrowserNode.selectedItems.length?this.itemBrowserNode.selectedItems.map((e=>e.id)):[])}},this.strings.add)))}saveNewStyleItemsInLocalStorage(e){const{editGeometry:t}=this,i=(0,h.g)(Tt,!0)||{},o=i?.[t]||[];if(e.map((e=>e.id)).forEach((e=>{o.includes(e)||o.push(e)})),this.savedStyleIds=o,i[t]=o,["point","polygon"].includes(t)){const t=e.filter((e=>e.typeKeywords.includes("lineSymbol"))).map((e=>e.id)),o=i.line||[];t.forEach((e=>{o.includes(e)||o.push(e)})),o.length&&(i.line=o)}if(["point","line"].includes(t)){const t=e.filter((e=>e.typeKeywords.includes("polygonSymbol"))).map((e=>e.id)),o=i.polygon||[];t.forEach((e=>{o.includes(e)||o.push(e)})),o.length&&(i.polygon=o)}if(["line","polygon"].includes(t)){const t=e.filter((e=>e.typeKeywords.includes("pointSymbol"))).map((e=>e.id)),o=i.point||[];t.forEach((e=>{o.includes(e)||o.push(e)})),o.length&&(i.point=o)}(0,h.s)(Tt,i,!0)}get el(){return(0,o.g)(this)}};zt.style=".styles-dialog{--calcite-dialog-size-y:min(900px, calc(80vh + 100px));--calcite-dialog-size-x:1080px;--calcite-dialog-content-space:0px}";const Ot="color-picker-container";let Bt=0;const Nt="color-ramp-item",Ut=({stops:e,style:t="continuous",name:i,layout:s="vertical",width:r=20,height:n=70})=>{const l=Bt+++"-color-ramp-gradient",a="vertical"===s?"rotate(90)":"";return(0,o.h)("span",{title:i,class:Nt},(0,o.h)("svg",{xmlns:"http://www.w3.org/2000/svg",height:n,width:r},(0,o.h)("defs",null,(0,o.h)("linearGradient",{id:l,gradientTransform:a},"continuous"===t?function(e){const t=1/(e.length-1);return e.slice().map((({r:e,g:i,b:s},r)=>{const n=r*t*100;return(0,o.h)("stop",{"stop-color":`rgb(${e}, ${i}, ${s})`,offset:`${n}%`})}))}(e):function(e){const t=1/e.length,i=[];return e.slice().forEach((({r:e,g:s,b:r},n)=>{const l=n*t*100,a=(n+1)*t*100;i.push((0,o.h)("stop",{"stop-color":`rgb(${e}, ${s}, ${r})`,offset:`${l}%`}),(0,o.h)("stop",{"stop-color":`rgb(${e}, ${s}, ${r})`,offset:`${a}%`}))})),i}(e))),(0,o.h)("rect",{x:"0",y:"0",fill:`url('#${l}')`,width:"100%",height:"100%"})))};const jt="color-ramp-item",Vt=({stops:e,name:t,opacity:i,size:s=48})=>{const{svgUtils:r}=c.e,n=Math.sqrt(e.length),l=lt(e),a=Math.sqrt(s**2+s**2)+0;let h;(0,d.i)(i)&&(h={opacity:`${i}`});const m=[],p=[],y=[],u=(s||75)/n;for(let e=0;e<n;e++){const t=e*u;for(let i=0;i<n;i++){const o=i*u,s=qt(l[e][i]),n=Wt(),a={type:"rect",x:o,y:t,width:u,height:u};m.push(Dt(s)),p.push(Ht(a,s.fill,n)),y.push(r.getBoundingBox(a))}}const g=r.computeBBox(y),b=r.getTransformMatrix(g,a,a,0,!1,0,!1);return(0,o.h)("span",{title:t,class:jt},(0,o.h)("div",{style:h},(0,o.h)("svg",{width:a,height:a,style:undefined,xmlns:"http://www.w3.org/2000/svg"},(0,o.h)("defs",null,m),(0,o.h)("g",{transform:b},p))))};function Dt(e){const{pattern:t,linearGradient:i}=e;if(t)return(0,o.h)("pattern",{id:t.id,patternUnits:"userSpaceOnUse",x:t.x,y:t.y,width:t.width,height:t.height},(0,o.h)("image",{x:t.image.x,y:t.image.y,width:t.image.width,height:t.image.height,href:t.image.href}));if(i){const e=i.stops.map(((e,t)=>(0,o.h)("stop",{key:`${t}-stop`,offset:e.offset,"stop-color":e.color})));return(0,o.h)("linearGradient",{id:i.id,gradientUnits:"userSpaceOnUse",x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2},e)}return null}let $t=0,Gt=0;function Ht(e,t,i,s){if(e){if("circle"===e.type)return(0,o.h)("circle",{fill:t,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4",cx:e.cx,cy:e.cy,r:e.r});if("ellipse"===e.type)return(0,o.h)("ellipse",{fill:t,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4",cx:e.cx,cy:e.cy,rx:e.rx,ry:e.ry});if("rect"===e.type)return(0,o.h)("rect",{fill:t,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4",x:e.x,y:e.y,width:e.width,height:e.height});if("image"===e.type)return(0,o.h)("image",{href:e.src,x:e.x,y:e.y,width:e.width,height:e.height,preserveAspectRatio:"none"});if("path"===e.type){const s="string"!=typeof e.path?e.path.map((e=>`${e.command} ${e.values.join(" ")}`)).join(" ").trim():e.path;return(0,o.h)("path",{fill:t,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4",d:s})}if("text"===e.type)return(0,o.h)("text",{fill:t,"fill-rule":"evenodd",stroke:i.color,"stroke-width":i.width,"stroke-linecap":i.cap,"stroke-linejoin":i.join,"stroke-dasharray":i.dashArray,"stroke-miterlimit":"4","text-anchor":s?.align,"text-decoration":s?.decoration,kerning:s?.kerning,rotate:s?.rotate,"text-rendering":"auto","font-style":s?.font.style,"font-variant":s?.font.variant,"font-weight":s?.font.weight,"font-size":s?.font.size,"font-family":s?.font.family,x:e.x,y:e.y},e.text)}return null}function qt(e){const t={fill:"none",pattern:void 0,linearGradient:void 0};if(e)if("type"in e&&"pattern"===e.type){const i="patternId-"+ ++$t;t.fill=`url(#${i})`,t.pattern={id:i,x:e.x,y:e.y,width:e.width,height:e.height,image:{x:0,y:0,width:e.width,height:e.height,href:e.src}}}else if("type"in e&&"linear"===e.type){const i="linearGradientId-"+ ++Gt;t.fill=`url(#${i})`,t.linearGradient={id:i,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,stops:e.colors.map((e=>({offset:e.offset,color:e.color&&_t(e.color).toString()})))}}else if(e){const i=_t(e);t.fill=i.toString()}return t}function Wt(e){const t={color:"none",width:1,cap:"butt",join:"4",dashArray:"none"};if(e&&(null!=e.width&&(t.width=e.width),e.cap&&(t.cap=e.cap),e.join&&(t.join=e.join.toString()),e.color&&(t.color=_t(e.color).toString()),e.style)){let i="";if(e.style in Jt&&(i=Jt[e.style]),Array.isArray(i)){i=i.slice(0);for(let t=0;t<i.length;++t)i[t]*=e.width??1;if("butt"!==e.cap){for(let t=0;t<i.length;t+=2)i[t]-=e.width??1,i[t]<1&&(i[t]=1);for(let t=1;t<i.length;t+=2)i[t]+=e.width??1}i=i.join(",")}t.dashArray=i}return t}const Jt={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},Xt=class{constructor(e){(0,o.r)(this,e),this.manager=(0,n.u)(this),this.setInlineInputRef=e=>{this.inlineInputEl=e},this.disabled=!1,this.options=void 0,this.placement="auto",this.popoverProps=void 0,this.strings=void 0}async setFocus(){await(this.inlineInputEl?.setFocus())}async close(){await(this.inlineInputEl?.close())}render(){const{disabled:e,strings:t}=this;return(0,o.h)(o.H,{key:"53b7f9dc065f5d01b3507cbf3229d3cde0fab6b4"},(0,o.h)("arcgis-symbol-styler-inline-input",{key:"616c30efed0524a3e0abbd4cca2a998dfa4e8d00",disabled:e,intlDone:t.done,heading:t.ramp,label:this.options.heading,popoverProps:this.popoverProps,ref:this.setInlineInputRef},(0,o.h)("div",{key:"61669efa2389ea9585a4e558ec77267edfa743e9",class:Ot,slot:"content"},this.renderRampsContent(this.options)),(0,o.h)("div",{key:"17f4cc2effbaed51eba685a7cd523ac3ef9a892a",slot:"preview"},(0,o.h)(Ut,{key:"7d1ef783fedd6ff4a208c6d2e45547e794bcbc28",stops:this.options.colorRampStops.slice().reverse(),style:this.options.style,layout:"horizontal",height:"100%",width:"100%"}))))}renderRampsContent({activeCategory:e,colorRamps:t,isSelected:i,onCategoryChange:s,onFlip:r,onSelect:n,style:l}){const{strings:a}=this,{categories:c,ramps:h}=this.getCategoriesAndColorRampsBySelectedCategory(e,t),m="2d"===l,d=m?"rotate":"arrow-up-down",p=m?a.rotateColors:a.flipColors,y=m?Vt:Ut,u=m?3:6;return[(0,o.h)("div",{class:"section"},(0,o.h)("calcite-label",null,this.strings.category,(0,o.h)("calcite-select",{width:"full",label:this.strings.category,onCalciteSelectChange:s},c.map((t=>(0,o.h)("calcite-option",{value:t,label:a.categories[t],selected:t===e}))))),(0,o.h)("calcite-button",{class:Oe,appearance:"transparent",onClick:e=>{e.preventDefault(),e.stopImmediatePropagation(),r()},scale:"s",width:"full"},(0,o.h)("calcite-icon",{icon:d,scale:"s",style:m?{transform:"rotateY(180deg)"}:void 0}),p)),(0,o.h)("div",{class:{[Be]:!0,[Ne]:!0}},(0,o.h)("arcgis-item-palette",{items:h,extraItemProps:{style:l},ItemRenderer:y,itemsPerRow:u,selected:i,onArcgisItemSelect:n}))]}getCategoriesAndColorRampsBySelectedCategory(e,t){const i=qe[e],o=t.filter((t=>"all"===e||i.some((e=>t.tags.includes(e))))),s=new Set;t.forEach((e=>e.tags.forEach((e=>s.add(e)))));return{categories:Object.keys(qe).filter((e=>"all"===e||qe[e].some((e=>s.has(e))))),ramps:o}}get el(){return(0,o.g)(this)}};Xt.style='.scroller {\n  max-height: var(--scroller-max-height, 200px);\n  overflow-y: auto;\n  min-width: 200px;\n  overflow-x: hidden;\n  display: flex;\n  justify-content: center;\n}\n\n.color-ramp-item {\n  display: inline-flex;\n  flex-grow: 1;\n  svg {\n    display: flex;\n  }\n}\n\n.color-picker-container {\n  display: flex;\n  flex-direction: column;\n\n  arcgis-item-palette .palette {\n    gap: 20px;\n  }\n}\n\ncalcite-color-picker-swatch {\n  width: 200px;\n}\n\n.section {\n  display: flex;\n  flex-direction: column;\n  padding: 12px;\n  background-color: var(--calcite-color-foreground-1);\n}\n\n.color-ramp-selection {\n  padding: 4px 20px 4px 4px; /* FF needs space for scroll bars */\n  border: 1px solid lightgray;\n  border-top: none;\n}\n\n:dir(rtl) {\n  .color-ramp-selection {\n    padding: 4px 4px 4px 20px; /* FF needs space for scroll bars */\n  }\n}\n\n.color-ramp-flipper {\n  calcite-icon {\n    margin: 0 0.5rem;\n  }\n}\n\n[slot="preview"] {\n  .color-ramp-item {\n    height: 24px;\n  }\n}\n';const Yt=class{constructor(e){(0,o.r)(this,e),this.disabled=!1,this.embedded=!1}render(){return(0,o.h)(o.H,{key:"7b3a9892b5cedff8f8c032a07cbf310216986fee",tabindex:this.disabled?-1:""},(0,o.h)("slot",{key:"b554258432448331ba5e946fdd9f25552bc52f66"}))}};Yt.style=":host{display:flex;flex-direction:column;background-color:var(---calcite-color-foreground-1);padding:16px 12px}:host([disabled]){opacity:var(--calcite-opacity-disabled);pointer-events:none}:host([embedded]){padding:0}";const Kt=class{constructor(e){(0,o.r)(this,e),this.manager=(0,n.u)(this),this.updatePreview=(0,p.d)((async()=>{const{symbol:e}=this;if(!e)return;const t={...this.options,size:this.options?.size&&"object"==typeof this.options.size?{...this.options.size}:this.options?.size};"cim"===e.type&&"CIMPolygonSymbol"===e.data.symbol?.type?delete t?.size:"cim"===e.type&&"CIMLineSymbol"===e.data.symbol.type&&t.size&&"object"==typeof t.size&&(t.size.height=20);const i=e.clone();"picture-marker"===i.type&&t.size&&"number"==typeof t.size?(i.width=i.width/i.height*t.size,i.height=t.size):"simple-line"===i.type&&t.size&&"object"==typeof t.size&&(i.width=t.size.height);const o=c.e.symbolUtils.renderPreviewHTML(i,t);this.lastPreviewRender=o;const s=await o;this.lastPreviewRender!==o||(this.lastPreview?.remove(),this.lastPreview=s,s&&this.el.shadowRoot?.append(s),this.backgroundTheme=c.e.previewSymbol2D.getContrastingBackgroundTheme(e,245))}),250),this.backgroundTheme="light",this.contrast=!1,this.options=void 0,this.symbol=void 0}watchSymbolAndOptions(){this.updatePreview()}async componentDidLoad(){await this.updatePreview()}render(){return(0,o.h)(o.H,{key:"181b7c560906d622ed93cf6fb687f60119f35343",class:{dark:this.contrast&&"dark"===this.backgroundTheme}})}get el(){return(0,o.g)(this)}static get watchers(){return{symbol:["watchSymbolAndOptions"],options:["watchSymbolAndOptions"]}}};Kt.style=":host{display:inline-block}:host(.dark){background-color:#f3f3f3}img{vertical-align:middle}"},90028:(e,t,i)=>{i.d(t,{a:()=>s,g:()=>r});var o=i(44021);function s(e){const{customBaseUrl:t,portalHostname:i,urlKey:o}=e,{protocol:s}=window.location;return`${s}//${o?`${o}.${t}`:i}`}function r(e){return(0,o.a)(e.restUrl)}},36392:(e,t,i)=>{i.d(t,{a:()=>s,p:()=>r});const o=96;function s(e){return e?e/72*o:0}function r(e){return e?72*e/o:0}},44021:(e,t,i)=>{i.d(t,{a:()=>o});const o=e=>e&&!e.endsWith("/")?`${e}/`:e},50063:(e,t,i)=>{i.d(t,{u:()=>r});var o=i(97127),s=i(28614);const r=(0,o.m)(s.a)}}]);