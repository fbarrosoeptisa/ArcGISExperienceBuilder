/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-76b94b.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-76b94b"],{93307:(e,t,s)=>{s.r(t),s.d(t,{arcgis_effects:()=>v});var i=s(28614),a=s(68180),c=s(58325),r=s(53133),n=s(69989),l=s(97127),o=s(50063),f=s(71480);const h="panel",d="notice",u="hint",p="basemap-type",g="radio-buttons",m="switch",E="list",y="effect-thumb",_="effect-thumb-img",v=class{constructor(e){(0,i.r)(this,e),this.arcgisClose=(0,i.c)(this,"arcgisClose",7),this.arcgisEffectsClose=(0,i.c)(this,"arcgisEffectsClose",7),this.arcgisChange=(0,i.c)(this,"arcgisChange",7),this.arcgisEffectsChange=(0,i.c)(this,"arcgisEffectsChange",7),this.arcgisApplyLayerEffect=(0,i.c)(this,"arcgisApplyLayerEffect",7),this.manager=(0,l.u)(this),this.strings=(0,o.u)({blocking:!0}),this.popovers=new Map,this.afterCreatePanel=e=>{this.panelNode=e},this.onSwitchEffectType=async e=>{const{props:t,popovers:s}=this,i=t.layer,a=e.target;if(s.forEach((e=>e.open=!1)),"layer"===a.selectedItem.value)this.lastFeatureEffect=i.featureEffect||this.lastFeatureEffect,i.featureEffect=null,i.effect=this.lastLayerEffect,this.showFeatureEffects=!1;else{if(this.lastLayerEffect=i.effect,i.effect=null,this.lastFeatureEffect)i.featureEffect=this.lastFeatureEffect,t.featureEffectType=(0,r.p)(t);else{const{backgroundTheme:e}=t;await this.selectFeatureEffectType("light"===e?r.a[0]:r.b[0])}this.showFeatureEffects=!0;const e=await this.getPopover("featureEffect");e.open=!0,e.updateHeader(t.featureEffectType),setTimeout((()=>e.setFocus()),300)}this.reRender=!this.reRender},this.onRemoveEffect=()=>{const{props:e}=this,{layer:t}=e;t.effect=null,t.featureEffect=null,this.isUnsupported=!1},this.onSwitchChange=async e=>{const t=e.target,s=(0,a.q)(t,"calcite-list-item"),i=s.value;if(!t.checked){(await this.getPopover(i)).open=!1,s.selected=!1}this.arcgisApplyLayerEffect.emit({type:i,keepSwitch:!0})},this.onFeatureEffectEnabledSwitchChange=async e=>{const{props:t,lightListNode:s,darkListNode:i}=this,a=t.layer;if(e.target.checked){if(this.lastFeatureEffect)a.featureEffect=this.lastFeatureEffect,t.featureEffectType=(0,r.p)(t);else{const{backgroundTheme:e}=t;t.featureEffectType="light"===e?r.a[0]:r.b[0]}s?.querySelectorAll("calcite-list-item").forEach((e=>{e.value===t.featureEffectType&&(e.selected=!0)})),i?.querySelectorAll("calcite-list-item").forEach((e=>{e.value===t.featureEffectType&&(e.selected=!0)})),await this.selectFeatureEffectType(t.featureEffectType)}else{(await this.getPopover("featureEffect")).open=!1,s?.querySelectorAll("calcite-list-item").forEach((e=>e.selected=!1)),i?.querySelectorAll("calcite-list-item").forEach((e=>e.selected=!1)),this.lastFeatureEffect=a.featureEffect,a.featureEffect=null,this.arcgisEffectsChange.emit(),this.arcgisChange.emit()}},this.openPopover=async e=>{const{popovers:t}=this,s=e.target,i=s.tagName.toLowerCase();let c;if("img"===i)c=(0,a.q)(s,"calcite-list-item");else if("calcite-switch"===i){if(!s.checked)return;c=(0,a.q)(s,"calcite-list-item")}else{if("calcite-list-item"!==i)return;c=s}c.selected=!0;const n=c.value;if(r.a.concat(r.b).includes(n))await this.selectFeatureEffectType(n,c);else{const e=c.querySelector("calcite-switch"),s=await this.getPopover(n);s.open?(s.open=!1,e.checked=!1,c.selected=!1,this.arcgisApplyLayerEffect.emit()):(e.checked||(e.checked=!0,this.arcgisApplyLayerEffect.emit()),t.forEach((e=>e.open=!1)),s.open=!0)}},this.view=void 0,this.layer=void 0,this.hideLayerTitle=!1,this.reRender=!1,this.isUnsupported=!1,this.showFeatureEffects=!1}async arcgisApplyLayerEffectHandler(e){const{props:t,listNode:s}=this,{layer:i}=t,a=e.detail?.type;if(a&&!e.detail?.keepSwitch){Array.from(s.querySelectorAll("calcite-list-item")).find((e=>e.value===a)).querySelector("calcite-switch").checked=!0}const c=await(0,r.c)(this.listNode,this.popovers,t);i.effect=c,this.arcgisEffectsChange.emit(),this.arcgisChange.emit(),t.effectsJSON=(0,r.p)(t)}async setFocus(e){e&&"dismiss-button"!==e?this.listNode?.setFocus():this.panelNode?.setFocus()}async done(){const{popovers:e}=this;e.forEach((e=>e.open=!1)),document.body.querySelectorAll("arcgis-effects-popovers").forEach((e=>e.parentNode?.removeChild(e)))}async componentWillLoad(){const{view:e,layer:t,strings:s}=this,i=this.strings._t9nLocale,a=!t.featureReduction&&["feature","geojson","ogc-feature","wfs","csv","stream","oriented-imagery","knowledge-graph-sublayer"].includes(t.type);this.props={view:e,layer:t,strings:s,supportsFeatureEffects:a};const{props:c}=this;c.locale=i;const n=await(0,f.s)();c.backgroundTheme=e&&(await n.getBackgroundColorTheme(e)??void 0),c.modules={FeatureEffect:await(0,f.t)(),effectsUtils:await(0,f.u)()};try{const e=t;e.effect&&e.featureEffect?this.isUnsupported=!0:e.effect?(c.effectsJSON=(0,r.p)(c),(0,r.s)(c)):e.featureEffect&&(c.featureEffectType=(0,r.p)(c))}catch(e){this.isUnsupported=!0}}componentDidLoad(){requestAnimationFrame((()=>this.setFocus())),this.createPopovers()}disconnectedCallback(){this.done()}render(){const{isUnsupported:e}=this;return(0,i.h)(i.H,{key:"9f2c781aac8af58923b2e0d17d8b3454d2d24f90",class:"calcite-match-height"},e?this.renderUnsupported():this.renderContent())}renderUnsupported(){const{props:e,hideLayerTitle:t}=this,{layer:s,strings:a}=e;return(0,i.h)("calcite-panel",{heading:a.general.effects,description:t?void 0:s.title??void 0,class:h,closable:!0,onCalcitePanelClose:()=>{this.arcgisEffectsClose.emit(),this.arcgisClose.emit()},ref:e=>this.panelNode=e},(0,i.h)("calcite-tip",{heading:a.error.title,closeDisabled:!0},(0,i.h)("div",null,a.error.text1),(0,i.h)("div",null,a.error.text2)),(0,i.h)("calcite-fab",{class:"autofocus",slot:"fab",appearance:"outline-fill",kind:"neutral",scale:"s",textEnabled:!0,label:a.error.button,text:a.error.button,onClick:this.onRemoveEffect}))}renderContent(){const{props:e,hideLayerTitle:t,showFeatureEffects:s}=this,{layer:a,supportsFeatureEffects:c,strings:r}=e,n=c&&!!a.featureEffect;return(0,i.h)("calcite-panel",{heading:r.general.effects,description:t?void 0:a.title??void 0,class:h,closable:!0,onCalcitePanelClose:()=>{const{popovers:e}=this;e.forEach((e=>e.open=!1)),this.arcgisEffectsClose.emit(),this.arcgisClose.emit()},ref:this.afterCreatePanel},this.renderTip(),c?(0,i.h)("div",{class:g},(0,i.h)("calcite-segmented-control",{layout:"horizontal",appearance:"solid",scale:"s",width:"full",onCalciteSegmentedControlChange:this.onSwitchEffectType},(0,i.h)("calcite-segmented-control-item",{value:"layer",checked:!(n||s)},r.general.wholeLayer),(0,i.h)("calcite-segmented-control-item",{value:"feature",checked:n||s},r.general.featureSpecific))):null,n||s?this.renderFeatureEffectsContent():this.renderLayerEffectsContent())}renderTip(){const{props:e}=this,{strings:t}=e;return(0,n.g)(n.l.ARCGIS_COMPONENT_NOTIFICATIONS,n.a.EFFECTS_TIP_DISMISSED)?(0,i.h)("div",null):(0,i.h)("div",{class:d},(0,i.h)("calcite-notice",{scale:"s",width:"full",open:!0,closable:!0,onCalciteNoticeClose:()=>{(0,n.s)(n.l.ARCGIS_COMPONENT_NOTIFICATIONS,{key:n.a.EFFECTS_TIP_DISMISSED,value:"true"})}},(0,i.h)("div",{slot:"message"},t.general.notice)))}renderLayerEffectsContent(){const{strings:e}=this;return(0,i.h)("div",null,(0,i.h)("div",{class:u},(0,i.h)("calcite-label",{scale:"s"},e.general.dragToReorder)),(0,i.h)("calcite-list",{label:e.general.effects,class:E,dragEnabled:!0,onCalciteListOrderChange:()=>this.arcgisApplyLayerEffect.emit(),ref:e=>this.listNode=e},r.d.map((e=>this.renderLayerEffectItem(e)))))}renderLayerEffectItem(e){const{props:t}=this,{effectsJSON:s,strings:a}=t;let c=-1;return s&&Array.from(s)?.forEach(((t,s)=>{t.type===(0,r.f)(e)&&(c=s+1)})),(0,i.h)("calcite-list-item",{label:a.effectsTitle[e],description:a.effectsSummary[e],value:e,onClick:this.openPopover,onKeyDown:e=>{if("Enter"===e.key&&this.openPopover(e)," "===e.key){const t=e.composedPath()[0];"SPAN"===t.tagName&&t.classList.contains("handle")||this.openPopover(e)}}},(0,i.h)("div",{slot:"actions-start",class:y},(0,i.h)("img",{class:_,src:(0,i.a)(`./assets/effect-thumbs/${e}.png`),alt:""})),(0,i.h)("calcite-switch",{scale:"s",checked:c>0,slot:"actions-end",class:m,onCalciteSwitchChange:this.onSwitchChange}))}renderFeatureEffectsContent(){const{props:e,lastFeatureEffect:t,strings:s}=this,{layer:a,backgroundTheme:c}=e,n="light"===c,l=(0,i.h)("div",null,(0,i.h)("div",{class:p},(0,i.h)("calcite-label",{scale:"s"},s.general.lightBasemaps)),(0,i.h)("calcite-list",{label:s.general.effects,class:E,"data-value":"light",ref:e=>this.lightListNode=e},r.a.map((e=>this.renderFeatureEffectItem(e,"light"))))),o=(0,i.h)("div",null,(0,i.h)("div",{class:p},(0,i.h)("calcite-label",{scale:"s"},s.general.darkBasemaps)),(0,i.h)("calcite-list",{label:s.general.effects,class:E,"data-value":"dark",ref:e=>this.darkListNode=e},r.b.map((e=>this.renderFeatureEffectItem(e,"dark")))));return(0,i.h)("div",null,(0,i.h)("div",{class:u},(0,i.h)("calcite-label",{scale:"s"},s.general.emphasize),(0,i.h)("calcite-label",{scale:"s",layout:"inline-space-between"},s.general.enabled,(0,i.h)("calcite-switch",{scale:"s",checked:!(!a.featureEffect&&!t),onCalciteSwitchChange:this.onFeatureEffectEnabledSwitchChange,ref:e=>this.enabledSwitchNode=e}))),n?l:o,n?o:l)}renderFeatureEffectItem(e,t){const{props:s}=this,{featureEffectType:a,strings:c}=s,n=r.a.find((t=>e===t)),l=r.b.find((t=>e===t));return(0,i.h)("calcite-list-item",{label:c.featureEffectsTitle[e],description:c.featureEffectsSummary[e],value:e,selected:a===e,onClick:this.openPopover,onKeyDown:e=>{if("Enter"===e.key&&this.openPopover(e)," "===e.key){const t=e.composedPath()[0];"SPAN"===t.tagName&&t.classList.contains("handle")||this.openPopover(e)}}},(0,i.h)("div",{slot:"actions-start",class:y},(0,i.h)("img",{class:`${_} feature`,src:(0,i.a)(`./assets/effect-thumbs/${e}${n&&l?`_${t}`:""}.png`),alt:""})))}async createPopovers(){const{props:e}=this,{featureEffectType:t,supportsFeatureEffects:s}=e,{popovers:i,panelNode:a}=this;i&&this.done();const c=s?["featureEffect"].concat(r.d):r.d,n=async t=>await new Promise((s=>{const i=document.createElement("arcgis-effects-popovers");i.props=e,i.type=t,i.referenceElement=a,i.addEventListener("arcgisReady",(()=>s(i))),i.addEventListener("arcgisClose",(()=>this.arcgisPopoverCloseHandler())),i.addEventListener("arcgisFilterChange",(e=>this.arcgisFilterChangeHandler(e))),document.body.appendChild(i)}));for(const e of c)i.set(e,await n(e));if(t){const e=await this.getPopover("featureEffect");e.open=!0,e.updateHeader(t)}}async selectFeatureEffectType(e,t){const{popovers:s,props:i,lightListNode:a,darkListNode:c,defaultWhere:n,enabledSwitchNode:l}=this,{layer:o}=i;i.featureEffectType=e,a?.querySelectorAll("calcite-list-item").forEach((t=>{t.selected&&t.value!==e&&(t.selected=!1)})),c?.querySelectorAll("calcite-list-item").forEach((t=>{t.selected&&t.value!==e&&(t.selected=!1)})),o.featureEffect=(0,r.e)(e,o.featureEffect?.filter?.where||n,i),this.defaultWhere=void 0,this.arcgisEffectsChange.emit(),this.arcgisChange.emit();const f=await this.getPopover("featureEffect");f.open?(f.updateHeader(e),t?.setFocus()):(s.forEach((e=>e.open=!1)),f.open=!0,f.updateHeader(e),setTimeout((()=>f.setFocus()),300)),l?l.checked=!0:this.reRender=!this.reRender}async getPopover(e){const{popovers:t}=this;let s=t.get(e);for(;!s;)await(0,c.t)(100),s=t.get(e);return s}arcgisPopoverCloseHandler(){const{listNode:e,lightListNode:t,darkListNode:s}=this;e?.querySelectorAll("calcite-list-item").forEach((e=>{e.selected&&(e.selected=!1,setTimeout((()=>e.setFocus()),100))})),t?.querySelectorAll("calcite-list-item").forEach((e=>{e.selected&&setTimeout((()=>e.setFocus()),100)})),s?.querySelectorAll("calcite-list-item").forEach((e=>{e.selected&&setTimeout((()=>e.setFocus()),100)}))}arcgisFilterChangeHandler(e){const{props:t,el:s}=this,{layer:i}=t,a=e.detail,c=Array.from(s.shadowRoot.querySelectorAll("calcite-list-item")).find((e=>e.selected)),n=c?.value;if(n){if(r.d.find((e=>e===n)))return;i.featureEffect=(0,r.e)(n,a,t),this.arcgisEffectsChange.emit(),this.arcgisChange.emit()}else this.defaultWhere=a}static get assetsDirs(){return["assets"]}get el(){return(0,i.g)(this)}};v.style=":host {\n  height: 100%;\n}\n\n.flow {\n  height: 100%;\n}\n\n.panel {\n  height: 100%;\n}\n\n.notice {\n  margin: 0.5rem;\n}\n\n.radio-buttons {\n  padding: 0.5rem;\n  background-color: white;\n}\n\n.hint {\n  padding: 0.25rem 0.5rem;\n  background-color: white;\n}\n\n.basemap-type {\n  padding: 0.75rem 0.5rem 0.25rem 0.5rem;\n}\n\n.switch {\n  margin-right: 0.75rem;\n  margin-left: 0;\n  align-self: center;\n}\n\n.list {\n  flex-flow: column nowrap;\n  margin: 1px;\n}\n\n.effect-thumb {\n  display: flex;\n  align-items: center;\n  padding-left: 0.5rem;\n  cursor: pointer;\n}\n\n.effect-thumb-img {\n  margin-top: 0.25rem;\n  margin-bottom: 0.25rem;\n  height: 48px;\n  width: 48px;\n}\n\n:dir(rtl) {\n  .switch {\n    margin-left: 0.75rem;\n    margin-right: 0;\n  }\n  .effect-thumb {\n    padding-left: 0;\n    padding-right: 0.5rem;\n  }\n}\n"},58325:(e,t,s)=>{s.d(t,{a:()=>a,d:()=>i,t:()=>c});const i=(e,t)=>{let s,i="idle";const a=async(...a)=>await new Promise((c=>{switch(i){case"flushed":i="idle",s?(clearTimeout(s),c(e(...a))):c(null);break;case"invoked":clearTimeout(s),i="idle",c(e(...a));break;case"cancelled":clearTimeout(s),i="idle",c(null);break;default:s&&clearTimeout(s),i="pending",s=setTimeout((()=>{i="idle",c(e(...a))}),t)}}));return a.flush=async function(...e){return i="flushed",await a(...e)},a.invoke=async function(...e){return i="invoked",await a(...e)},a.cancel=async function(...e){return i="cancelled",await a(...e)},a.getStatus=function(){return i},a},a=(e,t)=>{let s;return async(...i)=>await new Promise((a=>{s||(s=setTimeout((()=>{clearTimeout(s),s=void 0,a(e(...i))}),t))}))};function c(e){return new Promise((t=>setTimeout(t,e)))}},69989:(e,t,s)=>{var i,a;s.d(t,{a:()=>a,g:()=>n,l:()=>i,s:()=>r}),function(e){e.ARCGIS_COMPONENT_NOTIFICATIONS="arcgisComponent_notifications"}(i||(i={})),function(e){e.FEATURE_REDUCTION_WARNING_DISMISSED="arcgis_feature_reduction_warning_dismissed",e.POPUP_WARNING_DISMISSED="arcgis_popup_warning_dismissed",e.INCOMPATIBLE_VECTOR_SYMBOLS_DISMISSED="arcgis_symbol_styler_incompatible_vector_symbols_dismissed",e.EFFECTS_TIP_DISMISSED="arcgis_effects_tip_dismissed",e.LAYER_VIEW_DEFINITION_DISMISSED="arcgis_layer_view_definition_dismissed",e.LAYER_OVERRIDE_STATUS_TIP_DISMISSED="arcgis_layer_override_status_tip_dismissed",e.SMART_MAPPING_TIP1_DISMISSED="arcgis_smart_mapping_tip1_dismissed",e.SMART_MAPPING_TIP2_DISMISSED="arcgis_smart_mapping_tip2_dismissed",e.LAYER_VIEW_JOIN_TIP_DISMISSED="arcgis_layer_view_join_tip_dismissed",e.MULTIDIMENSIONAL_INFO_TIP_DISMISSED="arcgis_multidimensional_info_tip_dismissed"}(a||(a={}));const c=e=>{const t=(e=>localStorage.getItem(e))(e);return t?JSON.parse(t):{}},r=(e,t)=>{const s=c(e);s[t.key]=t.value,((e,t)=>{localStorage.setItem(e,t)})(e,JSON.stringify(s))},n=(e,t)=>{const s=c(e);return Object.getOwnPropertyDescriptor(s,t)?s[t]:null}},50063:(e,t,s)=>{s.d(t,{u:()=>c});var i=s(97127),a=s(28614);const c=(0,i.m)(a.a)}}]);