/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-a82dc6.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-a82dc6"],{37617:(e,i,t)=>{t.r(i),t.d(i,{arcgis_raster_multidimensional_info:()=>r});var n=t(19564),s=t(66507),a=t(26756),o=t(79241);t(91102),t(73807),t(89261),t(98034),t(99004);const r=class{constructor(e){(0,n.r)(this,e),this.showFilterLength=10,this.showRawSourceInfo=!1,this.layer=void 0,this.open=!1,this.showStatistics=!1,this.multidimensionalInfo=void 0,this.selectedVariableNames=[]}watchLayer(e){this.closePopover(),this.multidimensionalInfo=void 0,this.selectedVariableNames=[],this.initLayer(e)}async componentWillLoad(){[this.strings]=await(0,s.g)(this.hostElement),this.initLayer(this.layer)}disconnectedCallback(){this.closePopover()}async done(){this.closePopover()}render(){const{layer:e,multidimensionalInfo:i,strings:t}=this;if(!i){const i=!(null==e?void 0:e.loaded);return(0,n.h)(n.H,null,(0,n.h)("calcite-block",{class:"info",heading:t.multidimensionalInfo.info,collapsible:!0,open:!!this.open,loading:i},i?(0,n.h)("calcite-loader",{class:"loader",label:"",type:"indeterminate"}):(0,n.h)("div",null,t.general.unsupported)))}const{variables:s}=i;s.forEach((({dimensions:e})=>e.forEach((e=>{}))));const a=this.showRawSourceInfo&&!(0,o.g)(o.l.ARCGIS_COMPONENT_NOTIFICATIONS,o.a.MULTIDIMENSIONAL_INFO_TIP_DISMISSED);return(0,n.h)(n.H,null,(0,n.h)("calcite-block",{class:"info",heading:t.multidimensionalInfo.info,collapsible:!0,open:!!this.open,onCalciteBlockClose:()=>this.closePopover()},a&&this.renderNotice(),this.renderVariableSelect(),(0,n.h)("slot",null)))}renderNotice(){return(0,n.h)("calcite-notice",{open:!0,closable:!0,icon:!0,scale:"s",class:"notice",onCalciteNoticeClose:()=>{(0,o.s)(o.l.ARCGIS_COMPONENT_NOTIFICATIONS,{key:o.a.MULTIDIMENSIONAL_INFO_TIP_DISMISSED,value:"true"})}},(0,n.h)("div",{slot:"message"}," ",this.strings.multidimensionalInfo.tip))}renderVariableFilter(){const{strings:e}=this,i=this.multidimensionalInfo.variables.map((({name:e,dimensions:i})=>({name:e,dimensionNames:i.map((e=>e.name))})));return(0,n.h)("calcite-filter",{items:i,messageOverrides:{clear:e.general.clear,label:e.multidimensionalInfo.searchVariables},placeholder:e.multidimensionalInfo.searchVariables,onCalciteFilterChange:e=>{const i=e.target.filteredItems;this.selectedVariableNames=i.map((({name:e})=>e))}})}renderVariableSelect(){var e,i;const{variables:t}=this.multidimensionalInfo,{serviceRasterInfo:s}=this.layer,a=null!==(e=s.keyProperties.DefaultVariable)&&void 0!==e?e:t[0].name,o=[];t.forEach((({dimensions:e})=>e.forEach((e=>{o.some((i=>i.name===e.name))||o.push(e)}))));const{multidimensionalInfo:r}=this.strings,l=o.map((({name:e,values:i})=>{const t="StdTime"===e?r.timeValues:"StdZ"===e?r.zValues:r.generalValues.replace("${dimensionName}",e),n=null==i?void 0:i.length;return n?`${t}: ${n}`:t})).join("; "),c=(null===(i=this.selectedVariableNames)||void 0===i?void 0:i.length)?t.filter((({name:e})=>this.selectedVariableNames.includes(e))):t;return(0,n.h)("div",{ref:e=>this.variableEL=e},(0,n.h)("calcite-label",null,`${r.variables}: ${t.length}; ${l}`),t.length>=this.showFilterLength&&this.renderVariableFilter(),(0,n.h)("calcite-list",{label:r.variables},c.map((e=>this.renderVariableListItem(e,e.name===a)))))}renderVariableListItem(e,i){const{name:t,unit:s,description:a}=e,o=s?`${t} (${s})`:t,{general:r}=this.strings;return(0,n.h)("calcite-list-item",{label:o,description:a,key:t,onClick:()=>this.renderPickListPopover(e)},(0,n.h)("calcite-action",{icon:"information",scale:"s",text:r.close,slot:"actions-start",onClick:()=>this.renderPickListPopover(e)}),i?(0,n.h)("calcite-chip",{slot:"actions-end",value:void 0,label:""},(0,n.h)("span",{class:"default-variable"},r.default)):null)}renderPickListPopover(e){if(this.popOver)return this.popOver.variableInfo=e,void this.popOver.setFocus("dismiss-button");const i=document.createElement("arcgis-raster-multidimensional-variable-info");i.variableInfo=e,i.showStatistics=this.showStatistics,i.strings=this.strings;let t=0;this.variableEL&&(t=this.variableEL.getBoundingClientRect().top-this.hostElement.getBoundingClientRect().top),i.popoverProps={refElement:this.hostElement,placement:"leading-start",offsetDistance:0,offsetSkidding:t,popoverWidth:300},i.addEventListener("arcgisRasterMultidimensionalVariableInfoDismiss",(e=>{this.closePopover()})),document.body.appendChild(i),i.componentOnReady().then((()=>{requestAnimationFrame((()=>{i.setFocus("dismiss-button")}))})),this.popOver=i}closePopover(){this.popOver&&(document.body.removeChild(this.popOver),this.popOver=void 0)}async initLayer(e){e&&(e.loaded||await e.load(),this.multidimensionalInfo=await(0,a.g)(e,this.showRawSourceInfo))}get hostElement(){return(0,n.d)(this)}static get watchers(){return{layer:["watchLayer"]}}};r.style=":host{display:flex;flex:1 1 auto}.info{width:100%}.default-variable{font-size:var(--calcite-font-size--2)}.notice{margin-bottom:10px}"},79241:(e,i,t)=>{var n,s;t.d(i,{a:()=>s,g:()=>r,l:()=>n,s:()=>o}),function(e){e.ARCGIS_COMPONENT_NOTIFICATIONS="arcgisComponent_notifications"}(n||(n={})),function(e){e.FEATURE_REDUCTION_WARNING_DISMISSED="arcgis_feature_reduction_warning_dismissed",e.POPUP_WARNING_DISMISSED="arcgis_popup_warning_dismissed",e.INCOMPATIBLE_VECTOR_SYMBOLS_DISMISSED="arcgis_symbol_styler_incompatible_vector_symbols_dismissed",e.EFFECTS_TIP_DISMISSED="arcgis_effects_tip_dismissed",e.LAYER_VIEW_DEFINITION_DISMISSED="arcgis_layer_view_definition_dismissed",e.LAYER_OVERRIDE_STATUS_TIP_DISMISSED="arcgis_layer_override_status_tip_dismissed",e.SMART_MAPPING_TIP1_DISMISSED="arcgis_smart_mapping_tip1_dismissed",e.SMART_MAPPING_TIP2_DISMISSED="arcgis_smart_mapping_tip2_dismissed",e.LAYER_VIEW_JOIN_TIP_DISMISSED="arcgis_layer_view_join_tip_dismissed",e.MULTIDIMENSIONAL_INFO_TIP_DISMISSED="arcgis_multidimensional_info_tip_dismissed"}(s||(s={}));const a=e=>JSON.parse((e=>localStorage.getItem(e))(e))||{},o=(e,i)=>{const t=a(e);t[i.key]=i.value,((e,i)=>{localStorage.setItem(e,i)})(e,JSON.stringify(t))},r=(e,i)=>{const t=a(e);return(null==t?void 0:t.hasOwnProperty(i))?t[i]:null}},26756:(e,i,t)=>{t.d(i,{a:()=>c,b:()=>l,c:()=>d,d:()=>v,e:()=>s,f:()=>r,g:()=>u,i:()=>m,m:()=>n,u:()=>h});const n=10.9,s=Number.MAX_VALUE-1;function a(e,i){const t=new Date(e),{useFriendlyIsoFormat:n,intl:s,format:a}=i;if(n&&s)return s.formatDate(t,Object.assign(Object.assign({},s.convertDateFormatToIntlOptions(null!=a?a:"short-date-long-time")),{timeZone:"UTC"}));let o=new Date(e).toISOString();return o=`${o.slice(0,o.indexOf("."))}Z`,o}function o(e,i,t="long"){const n=new Date(2022,9,10);return n.setMonth(e-1),i.formatDate(n,{month:t})}function r(e,i,t={}){var n,s,r;if(null==e)return"";const{intl:l,useRecurringTimeLabel:c}=t;if(c&&l&&!Array.isArray(e)){const t=null===(n=i.intervalUnit)||void 0===n?void 0:n.toLowerCase().trim(),s=function(e){return"StdTime"===e.name&&!!e.recurring}(i)&&("months"===t||"quarters"===t);if(s)return"months"===t?o(e,l):function(e,i){return`${o(3*(e-1)+1,i,"short")} - ${o(3*e,i,"short")}`}(e,l)}const d=null===(s=i.values)||void 0===s?void 0:s[i.values.length-1];if(t.useStartOrEndForRangedValue&&Array.isArray(e)&&2===e.length&&Array.isArray(d)){const i=e.join("-")===d.join("-");e=i?e[1]:e[0]}if(!m(i))return Array.isArray(e)?e.map((e=>{var i;return null!==(i=null==l?void 0:l.formatNumber(e))&&void 0!==i?i:String(e)})).join(" - "):null!==(r=null==l?void 0:l.formatNumber(e))&&void 0!==r?r:String(e);if(t.useFriendlyIsoFormat&&!t.format){const e=function(e){var i,t,n;let s=null!==(t=null===(i=e.intervalUnit)||void 0===i?void 0:i.toLowerCase().trim())&&void 0!==t?t:"";const{interval:a=0,extent:o}=e,r=null===(n=e.values)||void 0===n?void 0:n.length;if(!["years","months","days","hours"].includes(s)&&(null==o?void 0:o.length)&&r){const e=(o[1]-o[0])/r,i=864e5;s=e>=365*i?"years":e>=28*i?"months":s}switch(s){case"months":s=a>11?"years":s;break;case"days":s=a>364?"years":a>27?"months":s;break;case"hours":s="days"}return"years"===s?"year":"months"===s?"short-month-year":"short-date"}(i);t=Object.assign({format:e},t)}return Array.isArray(e)?e.map((e=>a(e,t))).join(" - "):a(e,t)}function l(e,i){var t;const n=null===(t=null==i?void 0:i.dimensions)||void 0===t?void 0:t.find((({name:i})=>i===e.name));if(!(null==n?void 0:n.extent))return e;const s=[...n.extent],{values:a}=e;if(null==a?void 0:a.length){const i=a.filter((e=>Array.isArray(e)?null==s[1]||s[0]===s[1]?e[0]===s[0]:e[0]>=s[0]&&e[0]<=s[1]&&e[1]>=s[0]&&e[1]<=s[1]:e>=s[0]&&e<=s[1]));if(0===i.length){const e=a[a.length-1];Array.isArray(e)&&e[1]===s[0]&&i.push(e)}return Object.assign(Object.assign({},e),{extent:s,values:i})}return Object.assign(Object.assign({},e),{extent:s})}function c(e){var i;const{values:t,extent:n,name:s}=e;let a=null!==(i=null==t?void 0:t[0])&&void 0!==i?i:null==n?void 0:n[0];return"stdz"===s.toLowerCase()&&!e.hasRanges&&n&&Math.abs(n[1])<=Math.abs(n[0])&&(a=(null==t?void 0:t.length)?t[t.length-1]:n[1]),a}function d(e){var i,t;return"imagery-tile"===e.type||"wcs"===e.type?e.multidimensionalDefinition:null===(t=null!==(i=e.mosaicRule)&&void 0!==i?i:e.defaultMosaicRule)||void 0===t?void 0:t.multidimensionalDefinition}async function u(e,i=!1){var t;if("imagery-tile"===e.type||"wcs"===e.type)return e.serviceRasterInfo.multidimensionalInfo;const{rasterFunction:s,version:a}=e;if(i||a<=n||!s||"none"===(null===(t=s.functionName)||void 0===t?void 0:t.toLowerCase()))return e.serviceRasterInfo.multidimensionalInfo;return(await e.generateRasterInfo(e.rasterFunction).catch((()=>e.serviceRasterInfo))).multidimensionalInfo}function m(e,i=!1){return"StdTime"===e.name&&(i||!e.recurring)}function h(e,i,t){var n;i=l(i,t);const s=r(e.values[0],i);if(!(null===(n=i.values)||void 0===n?void 0:n.some((e=>s===r(e,i))))){const t=c(i);e.values=null!=t?[t]:[]}}function v(e){return Array.isArray(e[0])}}}]);