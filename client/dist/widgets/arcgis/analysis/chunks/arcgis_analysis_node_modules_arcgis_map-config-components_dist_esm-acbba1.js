/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-acbba1.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-acbba1"],{17843:(e,i,t)=>{t.r(i),t.d(i,{arcgis_smart_mapping_color_slider:()=>S});var s=t(28614),o=t(48122),a=(t(68180),t(99592)),r=t(13898),l=t(54351),n=t(98518),d=t(66215),u=t(33101),h=t(84521),m=t(58825),c=t(58944),p=t(97127);t(71480),t(99818);const S=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingColorSliderChange=(0,s.c)(this,"arcgisSmartMappingColorSliderChange",7),this.arcgisSmartMappingColorSliderError=(0,s.c)(this,"arcgisSmartMappingColorSliderError",7),this.manager=(0,p.u)(this),this.currentStopValues=[],this.currentBreakValues=[],this.zigzagClick=!1,this.styleSheetStatus="not-loaded",this.smartMappingState=(0,u.u)(),this.histogramStatus=a.s.MISSING,this.statisticsStatus=a.s.MISSING,this.sliderZoomed=!1,this.cap=void 0}async updateStatistics(){this.statisticsStatus=a.s.MISSING,this.statistics=void 0,this.histogramStatus=a.s.MISSING,this.histogram=void 0,this.colorSlider?.destroy(),this.colorSlider=void 0,this.sliderZoomed=!1,this.getStatistics()}componentWillLoad(){this.getStatistics()}componentDidLoad(){this.flowItemNode=(0,o.f)(this.el,"calcite-flow-item")}render(){const{config:e}=this.smartMappingState;return(0,s.h)(s.H,{key:"29628d69eed32424a264cfca33137ba2b7cabfb1"},(0,s.h)("link",{key:"ef611567c2be8c667d58b11ee4c0b1f3fcf13052",rel:"stylesheet",href:`${e.jsapiUrl}/themes/light/main.css`,onLoad:()=>{this.styleSheetStatus="loaded",(0,s.f)(this.el)},onError:()=>{this.styleSheetStatus="failed",(0,s.f)(this.el)}}),"loaded"===this.styleSheetStatus?this.renderColorSlider():"not-loaded"===this.styleSheetStatus?this.renderColorSliderLoading():null)}renderColorSlider(){const{statisticsStatus:e,histogramStatus:i,sliderZoomed:t,smartMappingState:o}=this,{strings:r}=o,l=(0,a.j)(o),n=(0,a.b)(l,"color");if(e===a.s.FAILED||e===a.s.MISSING||n&&1===n.stops.length||!n&&1===l.classBreakInfos.length)return this.colorSlider&&(this.colorSlider.destroy(),this.colorSlider=void 0),(0,s.h)(s.F,null);if(e===a.s.IN_PROGRESS||i===a.s.IN_PROGRESS&&!this.colorSlider)return this.renderColorSliderLoading();{const e=this.prepareColorSlider();let i=!1;if(n&&!t){const e=(0,a.G)(l,"color"),t=(0,a.aI)(n.stops,e.minSliderValue,e.maxSliderValue);(t?.minMaxSame||!(0,a.M)(t?.min)&&!(0,a.M)(t?.max))&&(i=!0,this.zoomButtonNode&&(this.zoomButtonNode.disabled=!0))}return n?this.currentStopValues=n.stops.map((e=>e.value)):this.currentBreakValues=l.classBreakInfos.map((e=>({min:e.minValue,max:e.maxValue}))),(e||this.colorSlider)&&this.colorSlider.min!==this.colorSlider.max?(0,s.h)("div",{class:"slider-box"},(0,s.h)("calcite-label",null,r.panels.color.dataRange),(0,s.h)("div",{class:"slider-box-buttons-front"},this.renderInvertButton(),n&&(0,s.h)(s.F,null,(0,s.h)("div",null,"\xa0"),this.renderZoomButton(i),(0,s.h)("div",null,"\xa0"),this.renderResetButton())),(0,s.h)("div",{ref:e=>{e&&this.afterColorSliderCreate(e)}})):this.colorSlider&&this.colorSlider.min===this.colorSlider.max?(0,s.h)(s.F,null):this.renderColorSliderLoading()}}renderColorSliderLoading(){const{strings:e}=this.smartMappingState;return(0,s.h)("div",{class:"slider-box"},(0,s.h)("calcite-loader",{label:e.loading}))}renderInvertButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("arcgis-smart-mapping-action",{text:e.panels.color.invertSlider,icon:"arrowUpDown",onClick:()=>this.handleInvertSlider()})}renderZoomButton(e){const{strings:i}=this.smartMappingState,{sliderZoomed:t}=this;return(0,s.h)("arcgis-smart-mapping-action",{text:i.panels.color.zoomSlider,icon:t?"magnifyingGlassMinus":"magnifyingGlassPlus",disabled:e,onClick:()=>this.handleZoomSlider(),ref:e=>this.zoomButtonNode=e})}renderResetButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("arcgis-smart-mapping-action",{text:e.panels.color.resetSlider,icon:"undo",onClick:()=>this.handleResetSlider()})}prepareColorSlider(){const{statistics:e,histogram:i,histogramStatus:t,sliderZoomed:s,smartMappingState:o}=this,{mapView:l,modules:u}=o,m=(0,a.j)(o),c=(0,a.a)(o),p=["color-age","color-age-size"].includes(c),S=this.getFieldInfo().simpleFieldType===a.q.DATE,g=(0,a.b)(m,"color"),f=(0,a.G)(m,"color");let x,b,V;if(f?(x=(0,a.au)(f.theme,g.stops),b=f.minSliderValue,V=f.maxSliderValue):(b=m.classBreakInfos[0].minValue,V=m.classBreakInfos[m.classBreakInfos.length-1].maxValue),({min:b,max:V}=(0,a.ag)({min:b,max:V})),t===a.s.IN_PROGRESS)return!1;if(!this.colorSlider||g&&this.colorSlider.breaks||!g&&this.colorSlider.stops){this.colorSlider?.destroy(),this.colorSliderBars=[];let t={histogramConfig:{bins:i?.bins,average:Math.round(10*e.avg)/10,standardDeviation:e.stddev,standardDeviationCount:1},min:b??e.min,max:V??e.max};g?(t={...t,...x},S&&!p&&(t.hasTimeData=!0,(0,r.a)(o,t,l.timeZone)),t.stops=g.stops,t.precision=(0,n.g)(g.stops),t.histogramConfig.barCreatedFunction=i&&d.b.bind(this,o,g,i,this.colorSliderBars),this.colorSlider=new u.ColorSlider(t),this.colorSlider&&this.colorSlider.min===this.colorSlider.max&&this.colorSlider.set(t)):(t.histogramConfig.min=m.classBreakInfos[0].minValue,t.histogramConfig.max=m.classBreakInfos[m.classBreakInfos.length-1].maxValue,this.sliderZoomed=!1,t.breaks=(0,h.g)(o),t.precision=(0,n.g)(t.breaks),t.histogramConfig.barCreatedFunction=i&&d.b.bind(this,o,t.breaks,i,this.colorSliderBars),this.colorSlider=new u.ClassedColorSlider(t),this.colorSlider&&this.colorSlider.min===this.colorSlider.max&&this.colorSlider.set(t),(0,d.u)(o,this.colorSlider,this.colorSliderBars,t.breaks,i)),this.createColorSliderChangeEvents()}else{const t=this.colorSlider;if("dragging"===t.slider?.state)return!0;let u={histogramConfig:{bins:i?.bins,average:Math.round(10*e.avg)/10,standardDeviation:e.stddev,standardDeviationCount:1},min:b??e.min,max:V??e.max};g?(u={...u,...x},u.stops=g.stops,u.precision=(0,n.g)(g.stops),u.hasTimeData=S&&!p,S&&!p&&(0,r.a)(o,u,l.timeZone),s?this.zigzagClick||(u.zoomOptions=(0,a.aI)(g.stops,f?.minSliderValue??e.min,f?.maxSliderValue??e.max)):u.zoomOptions=null,u.histogramConfig.barCreatedFunction=i&&this.colorSliderBars&&d.b.bind(this,o,g,i,this.colorSliderBars),(0,d.u)(o,t,this.colorSliderBars,g,i)):(u.breaks=(0,h.g)(o),u.precision=(0,n.g)(u.breaks),u.histogramConfig.barCreatedFunction=i&&this.colorSliderBars&&d.b.bind(this,o,u.breaks,i,this.colorSliderBars),(0,d.u)(o,t,this.colorSliderBars,u.breaks,i)),this.sliderZoomed&&this.adjustedZoomOptions&&!this.zigzagClick&&(u.zoomOptions=this.adjustedZoomOptions,"min"===this.zoomAdjustment?(this.colorSlider.slider.min=u.zoomOptions.min,u.zoomOptions.min=null):(this.colorSlider.slider.max=u.zoomOptions.max,u.zoomOptions.max=null)),this.adjustedZoomOptions=void 0,this.zoomAdjustment=void 0,this.colorSlider.set(u),this.zigzagClick=!1}return(0,a.M)(this.colorSlider)}handleInvertSlider(){const{smartMappingState:e}=this,{modules:i}=e,t=(0,a.j)(e),o=(0,a.b)(t,"color");if((0,a.B)(),(0,d.u)(e,this.colorSlider,this.colorSliderBars,o||(0,h.g)(e),this.histogram),o){let e=o.stops.map((e=>e.color));e=e.reverse(),o.stops.forEach(((i,t)=>{i.color=e[t]}))}else{let s=t.classBreakInfos.map((t=>(0,a.Z)(e,t.symbol)||new i.EsriColor({r:64,g:64,b:64,a:1})));s=s.reverse(),t.classBreakInfos.forEach(((i,t)=>{(0,a.Z)(e,i.symbol)&&(0,a.X)(e,i.symbol,s[t])}))}(0,a.u)(e),(0,s.f)(this.el),this.arcgisSmartMappingColorSliderChange.emit()}handleZoomSlider(e){const{smartMappingState:i}=this;if(this.cap=this.colorSlider.slider.max,this.histogramStatus===a.s.IN_PROGRESS)return;const{statistics:t}=this,s=(0,a.j)(i);this.sliderZoomed=(0,a.M)(e)?!!e:!this.sliderZoomed;const o=(0,a.b)(s,"color");o||(this.sliderZoomed=!1);const r=(0,a.G)(s,"color"),l=this.sliderZoomed?(0,a.aI)(o.stops,r?.minSliderValue??t.min,r?.maxSliderValue??t.max):null,n=r?.minSliderValue===r?.maxSliderValue;this.getHistogram({field:o.field,expression:o.valueExpression,expressionTitle:o.valueExpressionTitle,simpleFieldType:a.q.NUMBER},o.normalizationField??void 0,t,(l?.min||(n?t.min:r?.minSliderValue??t.min))??void 0,(l?.max||(n?t.max:r?.maxSliderValue??t.max))??void 0)}handleResetSlider(){const{smartMappingState:e}=this,i=(0,a.j)(e),t=(0,a.a)(e);this.sliderZoomed=!1;const o=(0,a.b)(i,"color"),r=(0,a.G)(i,"color"),n=this.getFieldInfo(),d=(o?o.normalizationField:i.normalizationField)??void 0;let u;"color"===t?u=h.b:"color-age"===t?(n.field=r.field,u=h.d):"color-age-size"===t?(n.field=r.field,u=c.j):"color-size-age"===t?u=c.i:"color-size"===t?u=c.g:"compare"===t&&(u=m.a),u&&(0,l.r)(u(e,{fieldInfos:(0,a.f)(e),normalizationField:d,noReuse:!0,discardMinMax:!0},"color"),this.flowItemNode).then((i=>{if(0===i.statistics?.count){const[e,t]=this.getDefaultDataRange(n),s=e,o=t;i.statistics.min=s,i.statistics.max=o,i.statistics.avg=(o+s)/2,this.statistics=i.statistics,this.statisticsStatus=a.s.SUCCESS}else i.statistics&&(0,a.M)(i.statistics.min)&&(0,a.M)(i.statistics.max)&&i.statistics.min<=i.statistics.max?(i.statistics=(0,a.ag)(i.statistics),this.statistics=i.statistics,this.statisticsStatus=a.s.SUCCESS,this.getHistogram(n,d,i.statistics,i.statistics.min,i.statistics.max)):this.statisticsStatus=a.s.FAILED;r.minSliderValue=this.statistics.min,r.maxSliderValue=this.statistics.max,(0,a.u)(e),(0,s.f)(this.el)}),(e=>this.arcgisSmartMappingColorSliderError.emit(e)))}afterColorSliderCreate(e){if(this.colorSlider.container)e.append(this.colorSlider.container);else{const i=document.createElement("div");i.classList.add("slider-container"),e.append(i),this.colorSlider.container=i}}getStatistics(){const{smartMappingState:e}=this,{layer:i,useFeatureReduction:t,mapView:s,modules:o}=e,r=i,l=(0,a.j)(e);let n,d;const u=this.getFieldInfo(),h=(0,a.b)(l,"color"),m=(h?h.normalizationField:l.normalizationField)??void 0,c=(0,a.G)(l,"color")||{};n=c.minSliderValue,d=c.maxSliderValue;const p=l.authoringInfo;if("equal-interval"===p?.classificationMethod){const e=l.classBreakInfos;n=e[0].minValue,d=e[e.length-1].maxValue}this.statisticsStatus=a.s.IN_PROGRESS,this.statistics||o.summaryStatistics({layer:r,view:s,field:u.field??void 0,valueExpression:u.expression??void 0,normalizationField:m,forBinning:"featureReduction"in r&&"binning"===r.featureReduction?.type&&t,outStatisticTypes:{exclude:["median"]}}).then((e=>{if(0===e.count){const[i,t]=this.getDefaultDataRange(u),s=c.minSliderValue||i,o=c.maxSliderValue||t;e.min=s,e.max=o,e.avg=(o+s)/2,(0,a.M)(c.minSliderValue)||(c.minSliderValue=s,c.maxSliderValue=o)}else if(!(0,a.M)(e.avg)||!(0,a.M)(e.min)||!(0,a.M)(e.max))return void(this.statisticsStatus=a.s.FAILED);e=(0,a.ag)(e),n=n??e.min,d=d??e.max,n===d&&(n=e.min,d=e.max),this.statistics=e,this.statisticsStatus=a.s.SUCCESS,this.getHistogram(u,m,e,n,d)}),(e=>{console.log(e),this.statisticsStatus=a.s.FAILED}))}getHistogram(e,i,t,s,o){const{layer:r,useFeatureReduction:l,mapView:n,modules:d}=this.smartMappingState,u=r;(t=t||this.statistics)&&0!==t.count&&(this.histogramStatus=a.s.IN_PROGRESS,d.histogram({layer:u,view:n,field:e.field??void 0,valueExpression:e.expression??void 0,numBins:50,minValue:(0,a.M)(s)?s:t.min??void 0,maxValue:(0,a.M)(o)?o:t.max??void 0,normalizationField:i,forBinning:"featureReduction"in u&&"binning"===u.featureReduction?.type&&l}).then((e=>{this.histogram=e,this.histogramStatus=a.s.SUCCESS}),(e=>{console.log(e),this.histogramStatus=a.s.FAILED})))}onMinMaxChange(e,i,t){const{statistics:s,smartMappingState:o}=this,r=(0,a.j)(o),l=(0,a.b)(r,"color"),n=(0,a.G)(r,"color")||{};if(!l){const t=r.classBreakInfos[0],s=r.classBreakInfos[r.classBreakInfos.length-1];t.minValue=e,t.label=(0,a.at)(t,this.colorSlider.precision),s.maxValue=i,s.label=`> ${(0,a.at)(s,this.colorSlider.precision)}`}"min"===t?n.minSliderValue=e:n.maxSliderValue=i;const u=(0,a.aI)(l?.stops,n.minSliderValue,n.maxSliderValue);this.zoomButtonNode&&(this.sliderZoomed?this.zoomButtonNode.disabled=!1:!u||u.minMaxSame||!(0,a.M)(u.min)&&!(0,a.M)(u.max)?this.zoomButtonNode.disabled=!0:this.zoomButtonNode.disabled=!1),this.sliderZoomed&&(this.adjustedZoomOptions=this.colorSlider.zoomOptions,"min"===t?(this.adjustedZoomOptions.min=e,this.zoomAdjustment="min"):(this.adjustedZoomOptions.max=i,this.zoomAdjustment="max"));const m=this.getFieldInfo(),c=(l?l.normalizationField:r.normalizationField)??void 0;this.getHistogram(m,c,s,e,i),(0,d.u)(o,this.colorSlider,this.colorSliderBars,l||(0,h.g)(o),this.histogram),e===n.minSliderValue&&i===n.maxSliderValue&&(this.sliderZoomed=!1),r.authoringInfo.classificationMethod="manual",this.arcgisSmartMappingColorSliderChange.emit()}createColorSliderChangeEvents(){const{smartMappingState:e}=this,i=(0,a.j)(e),t=(0,a.b)(i,"color");this.colorSlider&&(this.colorSlider.watch("zoomOptions",((e,i)=>{this.sliderZoomed&&(i?.min&&!e?.min||i?.max&&!e?.max)&&(this.zigzagClick=!0,this.handleZigzagClick(e))})),this.colorSlider.on("min-change",(e=>{t?e.value>this.currentStopValues[0]?(this.colorSlider.stops.forEach(((e,i)=>{e.value=this.currentStopValues[i]})),this.onMinMaxChange(this.currentStopValues[0],this.colorSlider.slider.max,"min")):this.onMinMaxChange(e.value,this.colorSlider.slider.max,"min"):e.value>this.currentBreakValues[0].max?this.onMinMaxChange(this.currentBreakValues[0].max,this.colorSlider.slider.max,"min"):this.onMinMaxChange(e.value,this.colorSlider.slider.max,"min")})),this.colorSlider.on("max-change",(e=>{t?e.value<this.currentStopValues[this.currentStopValues.length-1]?(this.colorSlider.stops.forEach(((e,i)=>{e.value=this.currentStopValues[i]})),this.onMinMaxChange(this.colorSlider.slider.min,this.currentStopValues[this.currentStopValues.length-1],"max")):this.onMinMaxChange(this.colorSlider.slider.min,e.value,"max"):e.value<this.currentBreakValues[this.currentBreakValues.length-1].min?this.onMinMaxChange(this.colorSlider.slider.min,this.currentBreakValues[this.currentBreakValues.length-1].min,"max"):this.onMinMaxChange(this.colorSlider.slider.min,e.value,"max")})),this.colorSlider.on("thumb-change",(e=>{if(t){const i=this.getFieldInfo();if((0,a.aM)(i)&&0===e.value)return void(0,s.f)(this.el);const t=this.colorSlider.stops;this.updateRendererStops(t)}else this.updateRendererBreaks(this.colorSlider.breaks)})),this.colorSlider.on("thumb-drag",(()=>{if(t){const e=this.colorSlider.stops;this.updateRendererStops(e)}else this.updateRendererBreaks(this.colorSlider.breaks)})),this.colorSlider.on("segment-drag",(()=>{if(t){const e=this.colorSlider.stops;this.updateRendererStops(e)}else this.updateRendererBreaks(this.colorSlider.breaks)})))}updateRendererStops(e){const{smartMappingState:i}=this,t=(0,a.j)(i),s=(0,a.b)(t,"color"),o=(0,a.G)(t,"color");5===e.length&&e.forEach((e=>e.label="")),s.stops=e,this.currentStopValues=s.stops.map((e=>e.value));const r=(0,a.aI)(s?.stops,o.minSliderValue,o.maxSliderValue);this.sliderZoomed?this.zoomButtonNode.disabled=!1:!r||r.minMaxSame||!(0,a.M)(r.min)&&!(0,a.M)(r.max)?this.zoomButtonNode.disabled=!0:this.zoomButtonNode.disabled=!1,(0,d.u)(i,this.colorSlider,this.colorSliderBars,s,this.histogram),(0,a.u)(i)}updateRendererBreaks(e){const{smartMappingState:i}=this,t=(0,a.j)(i);t.authoringInfo.classificationMethod="manual",t.classBreakInfos.forEach(((i,t)=>{if(i.minValue!==e[t].min||i.maxValue!==e[t].max){i.minValue=e[t].min,i.maxValue=e[t].max;const s=t>0?"> ":"";i.label=`${s} ${(0,a.at)(i,this.colorSlider.precision)}`,this.currentBreakValues[t].min=e[t].min,this.currentBreakValues[t].max=e[t].max}})),(0,d.u)(i,this.colorSlider,this.colorSliderBars,(0,h.g)(i),this.histogram),(0,a.u)(i),this.arcgisSmartMappingColorSliderChange.emit()}getDefaultDataRange(e){if(e.simpleFieldType===a.q.DATE){const e=(new Date).getFullYear();return[new Date(`1/1/${e}`).getTime(),new Date(`12/31/${e}`).getTime()]}return[0,100]}getFieldInfo(){const{smartMappingState:e}=this,i=(0,a.j)(e),t=(0,a.b)(i,"color"),s=(0,a.o)(e,t?t.field:i.field);return{field:t?.field||i.field,expression:t?.valueExpression||i.valueExpression,expressionTitle:t?.valueExpressionTitle||i.valueExpressionTitle,simpleFieldType:s?s.simpleFieldType:a.q.NUMBER}}handleZigzagClick(e){const{statistics:i,smartMappingState:t}=this,s=(0,a.j)(t),o=(0,a.b)(s,"color"),r=(0,a.G)(s,"color"),l=this.getFieldInfo(),n=(o?o.normalizationField:s.normalizationField)??void 0,d=r.minSliderValue===r.maxSliderValue;this.getHistogram(l,n,i,e?.min??(d?i.min:r.minSliderValue),e?.max??(d?i.max:r.maxSliderValue)),e||(this.sliderZoomed=!1)}get el(){return(0,s.g)(this)}};S.style=".slider-box {\n  height: 320px;\n\n  .esri-color-slider,\n  .esri-classed-color-slider {\n    min-width: 200px;\n  }\n\n  .esri-color-slider .esri-slider .esri-slider__content,\n  .esri-classed-color-slider .esri-slider .esri-slider__content {\n    height: 175px;\n  }\n\n  .esri-color-slider__histogram-container,\n  .esri-classed-color-slider__histogram-container {\n    width: 85px;\n  }\n\n  .esri-color-slider .esri-slider .esri-slider__label,\n  .esri-color-slider .esri-slider .esri-slider__min,\n  .esri-color-slider .esri-slider .esri-slider__max,\n  .esri-classed-color-slider .esri-slider .esri-slider__label,\n  .esri-classed-color-slider .esri-slider .esri-slider__min,\n  .esri-classed-color-slider .esri-slider .esri-slider__max {\n    text-decoration: underline;\n  }\n  .esri-color-slider .esri-slider .esri-slider__label:hover,\n  .esri-color-slider .esri-slider .esri-slider__min:hover,\n  .esri-color-slider .esri-slider .esri-slider__max:hover,\n  .esri-classed-color-slider .esri-slider .esri-slider__label:hover,\n  .esri-classed-color-slider .esri-slider .esri-slider__min:hover,\n  .esri-classed-color-slider .esri-slider .esri-slider__max:hover {\n    border: 1px solid #bbb;\n    background-color: #f3f3f3;\n    text-decoration: none;\n    z-index: 1;\n  }\n}\n\n.slider-box-buttons-front {\n  display: flex;\n}\n\n.slider-container {\n  overflow: hidden;\n}\n"},58825:(e,i,t)=>{t.d(i,{a:()=>r,c:()=>a,g:()=>l});var s=t(68180),o=t(99592);t(97127);async function a(e,i){const{layer:t,useFeatureReduction:a,mapImageSublayer:r,mapView:l,modules:n}=e,d=t;i=i||{};const u=(0,o.k)((0,o.j)(e));return await n.ColorCreator.createContinuousRenderer({layer:d,view:l,field:i.fieldInfos[0].field,theme:"above-and-below",colorScheme:(0,o.Y)(e,"above-and-below"),normalizationField:i.fieldInfos[1].field,outlineOptimizationEnabled:!r&&((0,s.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:(0,o.z)(e)),sizeOptimizationEnabled:!r&&(!(0,s.i)(i.sizeOptimizationEnabled)||i.sizeOptimizationEnabled),legendOptions:i.legendOptions,defaultSymbolEnabled:!1,forBinning:"binning"===d.featureReduction?.type&&a}).then((e=>(((0,o.G)(e.renderer,"color")||{}).style="ratio",(0,o.l)(u,e.renderer),e)))}async function r(e,i){const{layer:t,useFeatureReduction:a,mapImageSublayer:r,mapView:n,modules:d}=e,u=t;i=i||{};const h=(0,o.j)(e),m=(0,o.b)(h,"color");if(m&&i.fieldInfo&&i.fieldInfo.field===m.field&&i.normalizationField===m.normalizationField&&(delete i.fieldInfos,(0,o.T)(i)))return{renderer:h.clone()};const c=(0,o.G)(h,"color"),p=(0,o.k)(h),S=i.fieldInfos?i.fieldInfos[0]:m?{field:m.field,expression:m.valueExpression,expressionTitle:m.valueExpressionTitle,simpleFieldType:o.q.NUMBER}:{field:h.field,expression:h.valueExpression,expressionTitle:h.valueExpressionTitle,simpleFieldType:o.q.NUMBER},g=i.normalizationField?i.normalizationField:m?m.normalizationField:h.normalizationField,f=h.classBreakInfos?.length?h.classBreakInfos[0].symbol:null,x=h.defaultSymbol,b=h.defaultLabel;let V=!1;(null===i.normalizationField||i.normalizationField||i.fieldInfo)&&(V=!0);const v=i.discardMinMax?void 0:(0,s.i)(i.min)?i.min:V?void 0:c?c.minSliderValue:h.classBreakInfos[0].minValue,M=i.discardMinMax?void 0:(0,s.i)(i.max)?i.max:V?void 0:c?c.maxSliderValue:h.classBreakInfos[h.classBreakInfos.length-1].maxValue;return await d.ColorCreator.createContinuousRenderer({layer:u,view:n,field:S?S.field:h.field,theme:"above-and-below",colorScheme:(0,o.Y)(e,"above-and-below"),normalizationField:g,minValue:v,maxValue:M,outlineOptimizationEnabled:!r&&((0,s.i)(i.outlineOptimizationEnabled)?i.outlineOptimizationEnabled:!!p.sizeOutlineVisVar),sizeOptimizationEnabled:!r&&((0,s.i)(i.sizeOptimizationEnabled)?i.sizeOptimizationEnabled:!!p.sizeAutoVisVar),legendOptions:i.legendOptions?.toJSON()||m?.legendOptions?.toJSON()||h.legendOptions?.toJSON(),defaultSymbolEnabled:(0,s.i)(i.defaultSymbolEnabled)?i.defaultSymbolEnabled:!!h.defaultSymbol,forBinning:"binning"===u.featureReduction?.type&&a}).then((e=>{if(i.discardMinMax){const i=(0,o.b)(h,"color"),t=(0,o.b)(e.renderer,"color");i.stops.forEach(((e,i)=>e.value=t.stops[i].value));const s=!!c&&"percent"===c.style,a=!!c&&"percent-of-total"===c.style;i.stops[0].label=`< ${l(i.stops[0].value,s,a)}`,i.stops[2].label=l(i.stops[2].value,s,a),i.stops[4].label=`> ${l(i.stops[4].value,s,a)}`}return((0,o.G)(e.renderer,"color")||{}).style="ratio",(0,o.l)(p,e.renderer),f&&e.renderer.classBreakInfos?.length&&(e.renderer.classBreakInfos[0].symbol=f),x&&(e.renderer.defaultSymbol=x,e.renderer.defaultLabel=b),e}))}function l(e,i,t){return t?Math.round(e/(1+e)*1e4)/100+"%":i?Math.round(1e4*e)/100+"%":`${e}`}},13898:(e,i,t)=>{function s(e,i,t){i.labelFormatFunction=i=>l(e,i,t,"short-date"),i.inputFormatFunction=i=>l(e,i,t,"short-date"),i.inputParseFunction=e=>function(e,i){if(!e)return e;let t;if(i&&"system"!==i)if("unknown"===i)t=e;else{const s=new Date;t=e+(new Date(s.toLocaleString("en-US",{timeZone:"utc"})).getTime()-new Date(s.toLocaleString("en-US",{timeZone:i})).getTime())}else{t=e+6e4*(new Date).getTimezoneOffset()}return console.log("mapTZToUTC",e," - ",new Date(e).toISOString()," - ",new Date(t).toISOString()),t}(Date.parse(e),t)}function o(e,i){let t;if(i&&"system"!==i)if("unknown"===i)t=new Date(e).toISOString();else{const s=(new Date).getTimezoneOffset(),o=new Date(e).toLocaleString("en-US",{timeZone:i});t=new Date(new Date(o).getTime()-6e4*s).toISOString()}else{const i=(new Date).getTimezoneOffset();t=new Date(e-6e4*i).toISOString()}return t}function a(e,i,t){let s;if(i&&"system"!==i)if("unknown"===i)s=new Date(e).toISOString();else{const t=(new Date).getTimezoneOffset(),o=new Date(e).toLocaleString("en-US",{timeZone:i});s=new Date(new Date(o).getTime()-6e4*t).toISOString()}else{const i=(new Date).getTimezoneOffset();s=new Date(e-6e4*i).toISOString()}return s=t?s.substring(11,19):s.substring(11,16),s}function r(e,i){let t,s=new Date(e);if(s=new Date(s.getTime()-6e4*s.getTimezoneOffset()),i&&"system"!==i)if("unknown"===i)t=s.getTime();else{const e=new Date(s.toLocaleString("en-US",{timeZone:"utc"})).getTime()-new Date(s.toLocaleString("en-US",{timeZone:i})).getTime();t=s.getTime()+e}else{const e=(new Date).getTimezoneOffset();t=s.getTime()+6e4*e}return t}function l(e,i,t,s){const{modules:o}=e;let a;return a="unknown"===t?o.intl.formatDate(i,{...o.intl.convertDateFormatToIntlOptions(s||"short-date-short-time"),timeZone:"utc",timeZoneName:"shortOffset"}):o.intl.formatDate(i,{...o.intl.convertDateFormatToIntlOptions(s||"short-date-short-time"),timeZone:t}),a}t.d(i,{a:()=>s,b:()=>a,d:()=>r,u:()=>o})},98518:(e,i,t)=>{t.d(i,{a:()=>l,b:()=>r,g:()=>h,u:()=>a});var s=t(68180),o=t(99592);t(97127);function a(e,i){const{modules:t}=e,a=(0,o.j)(e),r=t.esriLang.clone(a.classBreakInfos);a.classBreakInfos=[],r.forEach(((t,o)=>{t=function(e,i,t,o,a){if((0,s.i)(t))if(0===t);else if(t<1){const s=Math.round(1/t);i.minValue="first"===a?Math.floor(i.minValue/t)/s:Math.round(i.minValue/t)/s,i.maxValue="last"===a?Math.ceil(i.maxValue/t)/s:Math.round(i.maxValue/t)/s,i.label=`${o>0?"> ":""}${i.minValue.toLocaleString(e.fullLocale,{maximumSignificantDigits:15})} - ${i.maxValue.toLocaleString(e.fullLocale,{maximumSignificantDigits:15})}`}else i.minValue="first"===a?Math.floor(i.minValue/t)*t:Math.round(i.minValue/t)*t,i.maxValue="last"===a?Math.ceil(i.maxValue/t)*t:Math.round(i.maxValue/t)*t,i.label=`${o>0?"> ":""}${i.minValue.toLocaleString()} - ${i.maxValue.toLocaleString()}`;return i}(e,t,i,o,0===o?"first":o===r.length-1?"last":void 0),a.addClassBreakInfo({minValue:t.minValue,maxValue:t.maxValue,symbol:t.symbol,label:t.label})}))}function r(e,i){const t=(0,o.j)(e).classBreakInfos;let s=i,a=Number.POSITIVE_INFINITY;t.forEach((e=>{s||(s=Math.max(n(e.minValue),n(e.maxValue))),a=Math.min(a,e.maxValue-e.minValue)}));const r=[];return a>1e7?(r.push(1e7),r.push(1e6),r.push(1e5),r.push(1e4),r.push(1e3),r.push(100),r.push(10),s>0&&r.push(1),s>1&&r.push(.1),s>2&&r.push(.01)):a>1e6?(r.push(1e6),r.push(1e5),r.push(1e4),r.push(1e3),r.push(100),r.push(10),s>0&&r.push(1),s>1&&r.push(.1),s>2&&r.push(.01)):a>1e5?(r.push(1e5),r.push(1e4),r.push(1e3),r.push(100),r.push(10),s>0&&r.push(1),s>1&&r.push(.1),s>2&&r.push(.01)):a>1e4?(r.push(1e4),r.push(1e3),r.push(100),r.push(10),s>0&&r.push(1),s>1&&r.push(.1),s>2&&r.push(.01)):a>1e3?(r.push(1e3),r.push(100),r.push(10),s>0&&r.push(1),s>1&&r.push(.1),s>2&&r.push(.01),s>3&&r.push(.001)):a>100?(r.push(100),r.push(10),s>0&&r.push(1),s>1&&r.push(.1),s>2&&r.push(.01),s>3&&r.push(.001),s>4&&r.push(1e-4),s>5&&r.push(1e-5)):a>10?(r.push(10),s>0&&r.push(1),s>1&&r.push(.1),s>2&&r.push(.01),s>3&&r.push(.001),s>4&&r.push(1e-4),s>5&&r.push(1e-5),s>6&&r.push(1e-6)):a>1?(s>0&&r.push(1),s>1&&r.push(.1),s>2&&r.push(.01),s>3&&r.push(.001),s>4&&r.push(1e-4),s>5&&r.push(1e-5),s>6&&r.push(1e-6)):a>.1?(s>1&&r.push(.1),s>2&&r.push(.01),s>3&&r.push(.001),s>4&&r.push(1e-4),s>5&&r.push(1e-5),s>6&&r.push(1e-6)):a>.01?(s>2&&r.push(.01),s>3&&r.push(.001),s>4&&r.push(1e-4),s>5&&r.push(1e-5),s>6&&r.push(1e-6)):a>.001?(s>3&&r.push(.001),s>4&&r.push(1e-4),s>5&&r.push(1e-5),s>6&&r.push(1e-6),s>7&&r.push(1e-7)):a>1e-4?(s>4&&r.push(1e-4),s>5&&r.push(1e-5),s>6&&r.push(1e-6),s>7&&r.push(1e-7),s>8&&r.push(1e-8)):a>1e-5&&(s>5&&r.push(1e-5),s>6&&r.push(1e-6),s>7&&r.push(1e-7),s>8&&r.push(1e-8),s>9&&r.push(1e-9)),r}function l(e){const i=(0,o.j)(e);let t=1e10;return i.classBreakInfos.forEach((e=>{t=Math.min(t,d(e.minValue)),t=Math.min(t,d(e.maxValue))})),t}function n(e){let i=1;for(;Math.round(e*i)/i!==e;)i*=10;return Math.log(i)/Math.LN10}function d(e){let i=1e-8;for(;u(Math.round(e/i)*i)===e;)i*=10;return i/10}function u(e){return Number.parseFloat(e.toPrecision(12))}function h(e){let i=0;e.forEach((e=>{(0,s.i)(e.value)?i=Math.max(n(u(e.value)),i):((0,s.i)(e.minValue)&&(i=Math.max(n(u(e.minValue)),i)),(0,s.i)(e.maxValue)&&(i=Math.max(n(u(e.maxValue)),i)),(0,s.i)(e.min)&&(i=Math.max(n(u(e.min)),i)),(0,s.i)(e.max)&&(i=Math.max(n(u(e.max)),i)))})),i=Math.min(i,3);const t=e[0],o=e[e.length-1],a=Math.min(t.minValue??t.min??t.value,o.minValue??o.min??o.value),r=Math.max(t.maxValue??t.max??t.value,o.maxValue??o.max??o.value)-a;return r/e.length<2e-7?i=8:r/e.length<2e-6?i=7:r/e.length<2e-5?i=6:r/e.length<2e-4?i=5:r/e.length<.002?i=4:r/e.length<.02?i=3:r/e.length<.2?i=Math.max(i,2):r/e.length<2&&(i=Math.max(i,1)),Math.round(i)}},66215:(e,i,t)=>{function s(e,i,t,s,o,l){const n=i?.length?r(i,t.bins[o]):a(e,i.stops,t.bins[o]);n&&(l.setAttribute("fill",n.toHex()),l.setAttribute("opacity",`${Math.max(n.a,.2)}`)),s?.push(l)}function o(e,i,t,s,o){i&&t?.forEach(((t,l)=>{const n=(o||i.histogramConfig)?.bins?.[l],d="breaks"in i?r(s||i.breaks,n):a(e,(s||i).stops,n);d&&(t.setAttribute("fill",d.toHex()),t.setAttribute("opacity",`${Math.max(d.a,.2)}`))}))}function a(e,i,t){const{modules:s}=e;if(!t)return;const o=(t.maxValue-t.minValue)/2+t.minValue;let a=i[0],r=i[i.length-1];const l=a.value,n=r.value;if(o<l)return a.color;if(o>n)return r.color;const d=i.filter((e=>e.value===o));if(d.length>0)return d[0].color;a=null,r=null,i.forEach(((e,t)=>{!a&&!r&&e.value>=o&&(a=i[t-1],r=e)}));const u=(o-a.value)/(r.value-a.value);return s.EsriColor.blendColors(a.color,r.color,u)}function r(e,i){if(!i)return;const t=(i.maxValue-i.minValue)/2+i.minValue;let s=e[0],o=e[e.length-1];if(t<s.min||t>o.max)return;const a=e.filter((e=>e.min===t));return a.length>0?a[0].color:(s=e[e.length-1],o=null,e.forEach(((i,a)=>{!o&&i.min>=t&&(s=e[a-1],o=i)})),s.color)}t.d(i,{b:()=>s,u:()=>o})}}]);