/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-2c5d77.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-2c5d77"],{76107:(e,t,i)=>{i.r(t),i.d(t,{arcgis_smart_mapping_method_button:()=>p,arcgis_smart_mapping_transparency:()=>m});var s=i(28614),a=i(68180),n=i(99592),o=i(33101),r=i(97127),l=i(48122),d=i(13898),u=i(98518),c=i(78567);i(71480);async function h(e,t){const{layer:i,useFeatureReduction:s,mapView:a,modules:n}=e,o=i;if(!(t=t||{}).fieldInfos&&!t.fieldInfos?.length)throw new Error;const r=t.fieldInfos[0];return await n.OpacityVariableCreator.createVisualVariable({layer:o,field:r.field,view:a,valueExpression:r.expression,valueExpressionTitle:r.expressionTitle,normalizationField:t.normalizationField,forBinning:"binning"===o.featureReduction?.type&&s})}const p=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingMethodButtonChange=(0,s.c)(this,"arcgisSmartMappingMethodButtonChange",7),this.arcgisSmartMappingMethodButtonBeforeOpen=(0,s.c)(this,"arcgisSmartMappingMethodButtonBeforeOpen",7),this.manager=(0,r.u)(this),this.methodInfos=[],this.smartMappingState=(0,o.u)(),this.open=!1,this.showStdDev=!1,this.showDefinedInterval=!1}async setFocus(){this.buttonNode?.focus()}componentWillLoad(){this.populateMethodInfo(),this.setSelection()}componentWillUpdate(){const{smartMappingState:e}=this,t=(0,n.j)(e).authoringInfo.classificationMethod;this.selectedMethodInfo&&this.selectedMethodInfo.value!==t&&this.setSelection()}render(){const{strings:e}=this.smartMappingState;return(0,s.h)(s.H,{key:"3499e7787234e7de8c7c59564e2553b1dd14be12"},(0,s.h)("calcite-label",{key:"e907448ecfbaedadc81365607b21936613c7283b"},e.methodButton.method,(0,s.h)("div",{key:"0b1d40465f3ada81513d29b5dce806d2eeb09f1c",class:"method-button",role:"button",tabindex:"0","aria-haspopup":"true","aria-label":e.methodButton.selectMethod,ref:e=>{e&&(this.buttonNode=e)},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.openMethodDropdown())},onClick:()=>this.openMethodDropdown()},(0,s.h)("div",{key:"d34898f157a652049991766b34c127a2b9e951d9",class:"method-content"},(0,s.h)("div",{key:"5602a4b5240c96f1979a1da705be7e0a0dc5e9d6",class:"method-button-text"},(0,s.h)("div",{key:"243be47e30b8729be3d18da839b6e652144e865c",class:"method-button-title"},this.selectedMethodInfo.title),(0,s.h)("div",{key:"c63aab7222931ce3bc3a0ce87790ff306e6f15b2",class:"method-button-msg"},this.selectedMethodInfo.msg)),(0,s.h)("div",{key:"5472fbb551ebe63d02a2bfb83363003dfa0ed20e"},(0,s.h)("calcite-icon",{key:"84fa2b4d9472ac11e182d9c589754c89d2e796b5",scale:"s",icon:"chevron-down"}))))))}setSelection(){const{smartMappingState:e}=this,t=(0,n.j)(e).authoringInfo.classificationMethod;this.selectedMethodInfo=this.methodInfos.find((e=>e.value===t)),this.methodInfos.forEach((e=>{e.selected=e.value===this.selectedMethodInfo.value}))}populateMethodInfo(){const{strings:e}=this.smartMappingState;this.methodInfos.push({value:"natural-breaks",title:e.methodButton.naturalBreaks,msg:e.methodButton.naturalBreaksMsg,iconPath:void 0,selected:!1},{value:"equal-interval",title:e.methodButton.equalInterval,msg:e.methodButton.equalIntervalMsg,iconPath:void 0,selected:!1}),this.showStdDev&&this.methodInfos.push({value:"standard-deviation",title:e.methodButton.standardDeviation,msg:e.methodButton.standardDeviationMsg,iconPath:void 0,selected:!1}),this.methodInfos.push({value:"quantile",title:e.methodButton.quantile,msg:e.methodButton.quantileMsg,iconPath:void 0,selected:!1}),this.showDefinedInterval&&this.methodInfos.push({value:"defined-interval",title:e.methodButton.definedInterval,msg:e.methodButton.definedIntervalMsg,iconPath:void 0,selected:!1}),this.methodInfos.push({value:"manual",title:e.methodButton.manualBreaks,msg:e.methodButton.manualBreaksMsg,iconPath:void 0,selected:!1})}closeDropdown(){this.open=!1,this.dropdownNode&&(this.dropdownNode.parentNode?.removeChild(this.dropdownNode),this.dropdownNode=void 0,this.buttonNode.classList.remove("active"))}openMethodDropdown(){const{smartMappingState:e}=this;if(this.open)this.open=!1;else{this.arcgisSmartMappingMethodButtonBeforeOpen.emit();const t=document.createElement("arcgis-smart-mapping-dropdown");t.smartMappingState=e,t.buttonNode=this.buttonNode,t.infos=this.methodInfos,this.dropdownNode=t,t.addEventListener("arcgisSmartMappingDropdownClose",(e=>{this.closeDropdown(),"Escape"===e.detail&&this.setFocus()})),t.addEventListener("arcgisSmartMappingDropdownChange",(e=>this.setMethod(e.detail))),t.addEventListener("arcgisSmartMappingDropdownDisconnected",(()=>this.closeDropdown())),this.buttonNode.classList.add("active"),document.body.appendChild(t),this.open=!0}}setMethod(e){const{smartMappingState:t}=this,i=(0,n.j)(t).authoringInfo.classificationMethod,s=e.value;if(s===i)return this.closeDropdown(),void setTimeout((()=>{this.setFocus()}),300);for(let e=0;e<this.methodInfos.length;e++)this.methodInfos[e].selected=this.methodInfos[e].value===s;this.selectedMethodInfo=e,this.arcgisSmartMappingMethodButtonChange.emit(this.selectedMethodInfo.value),this.closeDropdown(),setTimeout((()=>{this.setFocus()}),300)}get el(){return(0,s.g)(this)}};p.style=".method-button{display:flex;padding:6px;justify-content:space-between;align-items:center;border-radius:0;cursor:pointer;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-1);border-color:var(--calcite-color-foreground-3);border-width:2px;border-style:solid;box-shadow:transparent 0px 0px 0px 1px inset}.method-button:active{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3)}.method-button:focus{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3);outline:2px solid var(--calcite-color-brand);outline-offset:2px}.method-button.active{outline:1px solid var(--calcite-ui-focus-color, var(--calcite-color-brand))}.method-content{justify-content:space-between;display:flex;align-items:center;width:100%}.method-button-text{display:inline-block;padding:0 10px}.method-button-title{font-weight:bold}.method-button-msg{font-size:80%;line-height:16px}";const m=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingSymbolTransparencyError=(0,s.c)(this,"arcgisSmartMappingSymbolTransparencyError",7),this.manager=(0,r.u)(this),this.isBlockOpen=!1,this.lastSettings={},this.currentStopValues=[],this.zigzagClick=!1,this.zoomExecuting=!1,this.percentLabelFlip=!1,this.styleSheetStatus="not-loaded",this.smartMappingState=(0,o.u)(),this.open=!1,this.histogramStatus=n.s.MISSING,this.statisticsStatus=n.s.MISSING,this.sliderZoomed=!1,this.isLoading=!1}async setFocus(){await(this.blockNode?.setFocus())}async updateStatistics(){this.statisticsStatus=n.s.MISSING,this.statistics=void 0,this.histogramStatus=n.s.MISSING,this.histogram=void 0,this.transparencySlider?.destroy(),this.transparencySlider=void 0,this.sliderZoomed=!1,this.getStatistics()}componentWillLoad(){const e=(0,n.j)(this.smartMappingState),t=(0,n.b)(e,"opacity");this.isBlockOpen=this.open||!!t,this.getStatistics(),this.percentLabelFlip=(0,n.ay)(this.smartMappingState,this.el)}componentDidLoad(){this.flowItemNode=(0,l.f)(this.el,"calcite-flow-item")}render(){const{smartMappingState:e}=this,{config:t,strings:i,mapImageSublayer:a,supportsArcade:o,layer:r}=e,{isBlockOpen:l,isLoading:d}=this,u=(0,n.a)(e);if(a&&!o||"geo-rss"===r.type||!(0,n.aj)(e))return(0,s.h)(s.F,null);const c=["predominance","predominance-size"].includes(u);return(0,s.h)(s.H,null,(0,s.h)("link",{rel:"stylesheet",href:`${t.jsapiUrl}/themes/light/main.css`,onLoad:()=>{this.styleSheetStatus="loaded",(0,s.f)(this.el)},onError:()=>{this.styleSheetStatus="failed",(0,s.f)(this.el)}}),(0,s.h)("calcite-block",{heading:c?i.transparency.transparencyByPredominance:i.transparency.transparencyByAttribute,collapsible:!0,open:l,loading:d,class:"transparency-block",ref:e=>this.blockNode=e,onCalciteBlockOpen:()=>{this.isBlockOpen=!0,(0,n.aN)(this.blockNode)},onCalciteBlockClose:()=>this.isBlockOpen=!1},this.renderTransparencyToggle()))}renderTransparencyToggle(){const{styleSheetStatus:e,smartMappingState:t}=this,{strings:i}=t,a=(0,n.j)(t),o=(0,n.a)(t),r=(0,n.b)(a,"opacity"),l=["predominance","predominance-size"].includes(o);return(0,s.h)("calcite-block-section",{text:l?i.transparency.transparencyLabelPredominance:i.transparency.transparencyLabel,"toggle-display":"switch",open:!!r,onCalciteBlockSectionToggle:e=>this.handleToggle(e),ref:e=>this.blockSectionNode=e},(0,s.h)("div",{class:"block-section-padding"},r&&"loaded"===e?this.renderContent():r&&"not-loaded"===e||!r&&"loaded"===e?this.renderLoading():null))}renderLoading(){const{strings:e}=this.smartMappingState;return(0,s.h)("div",{class:"block-content-loading"},(0,s.h)("calcite-loader",{label:e.loading}))}renderContent(){return(0,s.h)(s.F,null,this.renderAttributes(),this.renderSlider(),this.renderRange(),this.renderLegend())}renderAttributes(){const{smartMappingState:e}=this,t=(0,n.j)(e),i=(0,n.a)(e);if(["predominance","predominance-size"].includes(i))return(0,s.h)(s.F,null);const a=(0,n.b)(t,"opacity"),o=(0,n.o)(e,a.field),r=a.normalizationField?(0,n.o)(e,a.normalizationField):void 0,l={field:a.field,expression:a.valueExpression,expressionTitle:a.valueExpressionTitle,simpleFieldType:o?o.simpleFieldType:n.q.NUMBER};return(0,s.h)(s.F,null,this.renderAttributeMain(l),this.renderAttributeDividedBy(r))}renderAttributeMain(e){const{fields:t,layer:i,useFeatureReduction:a,strings:o}=this.smartMappingState,r=!("featureReduction"in i&&"binning"===i.featureReduction?.type&&a);return(0,s.h)("arcgis-smart-mapping-attribute-input",{fieldList:t.filter((e=>[n.q.DATE,n.q.NUMBER].includes(e.simpleFieldType))),popoverReferenceElement:this.flowItemNode,selectedField:e,label:o.transparency.field,mode:r?"expression":"simple",onArcgisSmartMappingAttributeInputChange:async e=>{const t=e.detail;await this.getOpacityVisualVariable(t),this.dividedByAttributeInputNode?.clear()},onArcgisSmartMappingAttributeInputError:e=>this.arcgisSmartMappingSymbolTransparencyError.emit(e.detail)})}renderAttributeDividedBy(e){const{smartMappingState:t}=this,{fields:i,strings:a}=t,o=(0,n.j)(t),r=(0,n.b)(o,"opacity"),l=(0,n.o)(t,r.field),d=(r.field,r.valueExpression),u=(r.valueExpressionTitle,l?l.simpleFieldType:n.q.NUMBER);if(d||u!==n.q.NUMBER)return(0,s.h)(s.F,null);return(0,n.F)(t,i).number<2?(0,s.h)(s.F,null):(0,s.h)("arcgis-smart-mapping-attribute-input",{fieldList:i.filter((e=>e.layerField.name!==r.field&&e.simpleFieldType===n.q.NUMBER)),popoverReferenceElement:this.flowItemNode,label:a.transparency.dividedBy,selectedField:e?{field:e.layerField.name,simpleFieldType:e.simpleFieldType}:void 0,mode:"remove",ref:e=>{e&&(this.dividedByAttributeInputNode=e)},onArcgisSmartMappingAttributeInputChange:async e=>{if(e.detail){const t=e.detail;await this.getOpacityVisualVariable({field:r.field,simpleFieldType:n.q.NUMBER},t.field)}else{const e=(0,n.j)(t),i=(0,n.b)(e,"opacity");await this.getOpacityVisualVariable({field:i.field,simpleFieldType:n.q.NUMBER},void 0)}}})}renderSlider(){const{statisticsStatus:e,histogramStatus:t,sliderZoomed:i,smartMappingState:o}=this;if(e===n.s.FAILED||e===n.s.MISSING)return this.transparencySlider?.destroy(),this.transparencySlider=void 0,(0,s.h)(s.F,null);if(e===n.s.IN_PROGRESS||t===n.s.IN_PROGRESS&&(!this.transparencySlider||this.zoomExecuting))return this.renderTransparencySliderLoading();{const e=this.prepareTransparencySlider();let t=!1;const r=(0,n.j)(o),l=(0,n.b)(r,"opacity");if(!i){const e=(0,n.G)((0,n.j)(o),"opacity"),i=(0,n.aI)(l.stops,e?.minSliderValue,e?.maxSliderValue);(i?.minMaxSame||!(0,a.i)(i?.min)&&!(0,a.i)(i?.max))&&(t=!0,this.zoomButtonNode&&(this.zoomButtonNode.disabled=!0))}return this.currentStopValues=l.stops.map((e=>e.value)),(e||this.transparencySlider)&&this.transparencySlider&&this.transparencySlider.min!==this.transparencySlider.max?(0,s.h)("div",{class:"slider-box"},(0,s.h)("div",{class:"slider-box-buttons-front"},this.renderZoomButton(t),(0,s.h)("div",null,"\xa0"),this.renderResetButton()),(0,s.h)("div",{ref:e=>{e&&this.afterTransparencySliderCreate(e)}})):this.transparencySlider&&this.transparencySlider.min===this.transparencySlider.max?(0,s.h)(s.F,null):this.renderTransparencySliderLoading()}}renderTransparencySliderLoading(){const{strings:e}=this.smartMappingState;return(0,s.h)("div",{class:"slider-box"},(0,s.h)("calcite-loader",{label:e.loading}))}renderZoomButton(e){const{strings:t}=this.smartMappingState,{sliderZoomed:i}=this;return(0,s.h)("arcgis-smart-mapping-action",{text:t.transparency.zoomSlider,icon:i?"magnifyingGlassMinus":"magnifyingGlassPlus",disabled:e,onClick:()=>this.handleZoomSlider(),ref:e=>this.zoomButtonNode=e})}renderResetButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("arcgis-smart-mapping-action",{text:e.transparency.resetSlider,icon:"undo",onClick:()=>{this.handleResetSlider()}})}renderRange(){const{percentLabelFlip:e,smartMappingState:t}=this,{strings:i}=t,a=(0,n.j)(t),o=(0,n.b)(a,"opacity").stops,r=Math.round(100-100*o[1].opacity),l=Math.round(100-100*o[0].opacity);return this.highInputNode&&(this.highInputNode.value=`${r}`),this.lowInputNode&&(this.lowInputNode.value=`${l}`),(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,i.transparency.transparencyRange),(0,s.h)("div",{class:"transparency-range"},(0,s.h)("div",{class:"transparency-range-item"},(0,s.h)("calcite-label",{scale:"s"},i.transparency.transparencyHighValues,(0,s.h)("calcite-input-number",{prefixText:e?"%":void 0,suffixText:e?void 0:"%",value:""+(100-Math.round(100*o[1].opacity)),min:0,max:100,step:1,scale:"s",numberButtonType:"vertical",ref:e=>this.highInputNode=e,onCalciteInputNumberInput:e=>this.handleRangeChange(e,"high"),label:i.transparency.transparencyHighValues}))),(0,s.h)("div",{class:"transparency-range-item"},(0,s.h)("calcite-label",{scale:"s"},i.transparency.transparencyLowValues,(0,s.h)("calcite-input-number",{prefixText:e?"%":void 0,suffixText:e?void 0:"%",value:""+(100-Math.round(100*o[0].opacity)),min:0,max:100,step:1,scale:"s",numberButtonType:"vertical",ref:e=>this.lowInputNode=e,onCalciteInputNumberInput:e=>this.handleRangeChange(e,"low"),label:i.transparency.transparencyLowValues})))))}renderLegend(){const{smartMappingState:e}=this,{strings:t}=e,i=(0,n.j)(e);let a=!0;const o=(0,n.b)(i,"opacity").legendOptions;return o&&!1===o.showLegend&&(a=!1),(0,s.h)("calcite-label",{class:"include-legend",layout:"inline-space-between"},t.transparency.includeInLegend,(0,s.h)("calcite-switch",{scale:"s",checked:a,onCalciteSwitchChange:()=>this.handleIncludeInLegendToggle(),ref:e=>this.includeInLegendNode=e}))}prepareTransparencySlider(){const{statistics:e,histogram:t,histogramStatus:i,sliderZoomed:s,smartMappingState:o}=this,{mapView:r,modules:l}=o,c=(0,n.j)(o),h=(0,n.b)(c,"opacity"),p=(0,n.G)(c,"opacity"),m=(0,n.o)(o,h.field),g={field:h.field,expression:h.valueExpression,expressionTitle:h.valueExpressionTitle,simpleFieldType:m?.simpleFieldType||n.q.NUMBER},f=(0,n.aM)(g);if(i===n.s.IN_PROGRESS)return!1;let S=p?.minSliderValue,y=p?.maxSliderValue;if(({min:S,max:y}=(0,n.ag)({min:S,max:y})),this.transparencySlider){const i=this.transparencySlider;if("dragging"===i.slider?.state)return!0;const a={histogramConfig:{bins:t?.bins,average:Math.round(10*e.avg)/10,standardDeviation:e.stddev,standardDeviationCount:1},min:S??e.min,max:y??e.max,stops:l.esriLang.clone(h.stops),hasTimeData:f};f&&(0,d.a)(o,a,r.timeZone),s?this.zigzagClick||(a.zoomOptions=(0,n.aI)(h.stops,p?.minSliderValue,p?.maxSliderValue)):a.zoomOptions=null,this.sliderZoomed&&this.adjustedZoomOptions&&!this.zigzagClick&&(a.zoomOptions=this.adjustedZoomOptions,"min"===this.zoomAdjustment?(this.transparencySlider.slider.min=a.zoomOptions.min,a.zoomOptions.min=null):(this.transparencySlider.slider.max=a.zoomOptions.max,a.zoomOptions.max=null)),this.adjustedZoomOptions=void 0,this.zoomAdjustment=void 0,this.transparencySlider.set(a),this.zigzagClick=!1,this.zoomExecuting=!1}else{const i={histogramConfig:{bins:t?.bins,average:Math.round(10*e.avg)/10,standardDeviation:e.stddev,standardDeviationCount:1},style:{trackFillColor:new l.EsriColor([84,84,84])},min:S??e.min,max:y??e.max,stops:l.esriLang.clone(h.stops),precision:(0,u.g)(h.stops)};f&&(i.hasTimeData=!0,(0,d.a)(o,i,r.timeZone)),this.transparencySlider=new l.OpacitySlider(i),this.transparencySlider&&this.transparencySlider.min===this.transparencySlider.max&&this.transparencySlider.set(i),this.createTransparencySliderChangeEvents()}return(0,a.i)(this.transparencySlider)}createTransparencySliderChangeEvents(){const{smartMappingState:e}=this,t=(0,n.j)(e),i=(0,n.b)(t,"opacity"),a=(0,n.o)(e,i.field),o={field:i.field,expression:i.valueExpression,expressionTitle:i.valueExpressionTitle,simpleFieldType:a?a.simpleFieldType:n.q.NUMBER},r=(0,n.aM)(o);this.transparencySlider&&(this.transparencySlider.watch("zoomOptions",((e,t)=>{this.sliderZoomed&&(t?.min&&!e?.min||t?.max&&!e?.max)&&(this.zigzagClick=!0,this.handleZigzagClick(e))})),this.transparencySlider.on("min-change",(e=>{e.value>this.currentStopValues[0]?(this.transparencySlider.stops.forEach(((e,t)=>{e.value=this.currentStopValues[t]})),this.onMinMaxChange(this.currentStopValues[0],this.transparencySlider.slider.max,"min")):this.onMinMaxChange(e.value,this.transparencySlider.slider.max,"min")})),this.transparencySlider.on("max-change",(e=>{e.value<this.currentStopValues[this.currentStopValues.length-1]?(this.transparencySlider.stops.forEach(((e,t)=>{e.value=this.currentStopValues[t]})),this.onMinMaxChange(this.transparencySlider.slider.min,this.currentStopValues[this.currentStopValues.length-1],"max")):this.onMinMaxChange(this.transparencySlider.slider.min,e.value,"max")})),this.transparencySlider.on("thumb-change",(e=>{if(r&&0===e.value)return void(0,s.f)(this.el);const t=this.transparencySlider.stops;this.updateRendererStops(t)})),this.transparencySlider.on("thumb-drag",(()=>{const e=this.transparencySlider.stops;this.updateRendererStops(e)})))}afterTransparencySliderCreate(e){if(this.transparencySlider.container)e.append(this.transparencySlider.container);else{const t=document.createElement("div");t.classList.add("slider-container"),e.append(t),this.transparencySlider.container=t}}handleToggle(e){const{smartMappingState:t}=this,{modules:i}=t,a=(0,n.j)(t);(0,n.B)();const o=(0,n.b)(a,"opacity"),r=e.target;if(!(r.open&&o||!r.open&&!o))if(o){const e=(0,n.G)(a,"opacity");this.lastSettings.opacityVisVar=o,this.lastSettings.authOpacityVisVar=e,a.visualVariables=(0,n.V)(a,"opacity")||[],a.authoringInfo.visualVariables=(0,n.W)(a,"opacity")||[],this.sliderZoomed=!1,(0,n.u)(t)}else if(this.lastSettings.opacityVisVar)a.visualVariables=(0,n.V)(a,"opacity")||[],a.visualVariables.push(this.lastSettings.opacityVisVar),a.authoringInfo=a.authoringInfo||new i.AuthoringInfo({}),this.lastSettings.authOpacityVisVar&&(a.authoringInfo.visualVariables=(0,n.W)(a,"opacity")||[],a.authoringInfo.visualVariables.push(this.lastSettings.authOpacityVisVar)),(0,s.f)(this.el),(0,n.u)(t),(0,n.aN)(this.blockNode);else{const e=(0,n.aO)(t),i=e?e.layerField.name:"";this.getOpacityVisualVariable({field:i,simpleFieldType:n.q.NUMBER})}}async handleResetSlider(){const{smartMappingState:e}=this,{modules:t}=e,i=(0,n.j)(e),s=(0,n.a)(e),o=(0,n.b)(i,"opacity"),r={field:o.field,expression:o.valueExpression,expressionTitle:o.valueExpressionTitle,simpleFieldType:n.q.NUMBER},l=o.normalizationField;if(["predominance","predominance-size"].includes(s))try{this.statisticsStatus=n.s.IN_PROGRESS,this.histogramStatus=n.s.MISSING,await(0,c.a)(e,{includeOpacityVariable:!0}).then((t=>{const s=(0,n.b)(t.renderer,"opacity"),a=(0,n.G)(t.renderer,"opacity");i.visualVariables=(0,n.V)(i,"opacity")||[],i.visualVariables.push(s),i.authoringInfo.visualVariables=(0,n.W)(i,"opacity")||[],i.authoringInfo.visualVariables.push(a),this.includeInLegendNode.checked=!s.legendOptions||!!s.legendOptions.showLegend,(0,n.u)(e),this.updateStatistics(),(0,n.aN)(this.blockNode)}))}catch(e){this.statisticsStatus=n.s.FAILED,console.log(e)}else this.statisticsStatus=n.s.IN_PROGRESS,this.histogramStatus=n.s.IN_PROGRESS,await h(e,{fieldInfos:[r],normalizationField:l}).then((i=>{const s=(0,n.j)(e);if(i.statistics&&(0,a.i)(i.statistics.min)&&(0,a.i)(i.statistics.max)&&i.statistics.min<=i.statistics.max)i.statistics=(0,n.ag)(i.statistics),this.statistics=i.statistics,this.statisticsStatus=n.s.SUCCESS,this.getHistogram(r,l??void 0,i.statistics,i.statistics.min,i.statistics.max);else if(0===i.statistics?.count){const[e,t]=(0,n.aP)(r);this.statistics={min:e,max:t,avg:(t-e)/2,count:0},this.statisticsStatus=n.s.SUCCESS}else this.statisticsStatus=n.s.FAILED;s.visualVariables=(0,n.V)(s,"opacity")||[],s.visualVariables.push(i.visualVariable),s.authoringInfo=s.authoringInfo||new t.AuthoringInfo({}),s.authoringInfo.visualVariables=(0,n.W)(s,"opacity")||[],s.authoringInfo.visualVariables.push(i.authoringInfo.visualVariables[0]),(0,n.u)(e),this.updateStatistics(),(0,n.aN)(this.blockNode)})).catch((e=>console.log(e)))}handleZoomSlider(e){if(this.histogramStatus===n.s.IN_PROGRESS)return;this.zoomExecuting=!0;const{smartMappingState:t}=this,i=(0,n.j)(t);this.sliderZoomed=(0,a.i)(e)?!!e:!this.sliderZoomed;const{sliderZoomed:s,statistics:o}=this,r=(0,n.b)(i,"opacity"),l=(0,n.G)(i,"opacity"),d=s?(0,n.aI)(r.stops,l?.minSliderValue??o.min,l?.maxSliderValue??o.max):null,u=(0,n.o)(t,r.field),c=l?.minSliderValue===l?.maxSliderValue;this.getHistogram({field:r.field,expression:r.valueExpression,expressionTitle:r.valueExpressionTitle,simpleFieldType:u?u.simpleFieldType:n.q.NUMBER},r.normalizationField??void 0,o,d?d.min:c?o.min:l?.minSliderValue??o.min,d?d.max:c?o.max:l?.maxSliderValue??o.max)}handleRangeChange(e,t){const{smartMappingState:i}=this,a=e.target;let o=a.value?Number.parseInt(a.value):0;const r=(0,n.j)(i);o<0?o=0:o>100&&(o=100);const l=(0,n.b)(r,"opacity").stops,d=Math.round(100*(1-o/100))/100;"high"===t?l[1].opacity=d:l[0].opacity=d,(0,n.u)(i),(0,s.f)(this.el)}handleIncludeInLegendToggle(){const{smartMappingState:e}=this,t=(0,n.j)(e),i=(0,n.b)(t,"opacity"),s=i.legendOptions;s&&!1===s.showLegend?s?.title?s.showLegend=!0:i.legendOptions=void 0:(i.legendOptions=s||{},i.legendOptions.showLegend=!1),(0,n.u)(e)}updateRendererStops(e){const{smartMappingState:t}=this,i=(0,n.j)(t),s=(0,n.b)(i,"opacity"),o=(0,n.G)(i,"opacity");s.stops=e,this.transparencySlider.stops=e,this.currentStopValues=s.stops.map((e=>e.value));const r=(0,n.aI)(s?.stops,o?.minSliderValue,o?.maxSliderValue);this.sliderZoomed?this.zoomButtonNode.disabled=!1:!r||r.minMaxSame||!(0,a.i)(r.min)&&!(0,a.i)(r.max)?this.zoomButtonNode.disabled=!0:this.zoomButtonNode.disabled=!1,(0,n.u)(t)}async getOpacityVisualVariable(e,t){const{smartMappingState:i}=this,{modules:s}=i,o=(0,n.j)(i),r=(0,n.a)(i);if(this.statistics=void 0,this.histogram=void 0,this.histogramStatus=n.s.MISSING,this.sliderZoomed=!1,this.statisticsStatus=n.s.IN_PROGRESS,["predominance","predominance-size"].includes(r))try{const e=await(0,c.a)(i,{includeOpacityVariable:!0});(0,n.u)(i,e.renderer),this.getStatistics(),(0,n.aN)(this.blockNode)}catch(e){console.log(e)}else try{const r=await h(i,{fieldInfos:[e],normalizationField:t});if(r.statistics&&(0,a.i)(r.statistics.min)&&(0,a.i)(r.statistics.max)&&r.statistics.min<=r.statistics.max)r.statistics=(0,n.ag)(r.statistics),this.statistics=r.statistics,this.statisticsStatus=n.s.SUCCESS,this.getHistogram(e,t,r.statistics,r.statistics.min,r.statistics.max);else if(0===r.statistics?.count){const[t,i]=(0,n.aP)(e);this.statistics={min:t,max:i,avg:(i-t)/2,count:0},this.statisticsStatus=n.s.SUCCESS}else this.statisticsStatus=n.s.FAILED;o.visualVariables=(0,n.V)(o,"opacity")||[],o.visualVariables.push(r.visualVariable),o.authoringInfo=o.authoringInfo||new s.AuthoringInfo({}),o.authoringInfo.visualVariables=(0,n.W)(o,"opacity")||[],o.authoringInfo.visualVariables.push(r.authoringInfo.visualVariables[0]),(0,n.u)(i),(0,n.aN)(this.blockNode)}catch(e){this.statisticsStatus=n.s.FAILED,this.blockSectionNode.open=!1,console.log(e)}}getStatistics(){const{smartMappingState:e}=this,{layer:t,useFeatureReduction:i,mapView:s,modules:o}=e,r=t,l=(0,n.j)(e),d=(0,n.b)(l,"opacity");if(!d)return;const u=(0,n.o)(e,d.field),c={field:d.field,expression:d.valueExpression,expressionTitle:d.valueExpressionTitle,simpleFieldType:u?u.simpleFieldType:n.q.NUMBER},h=d.normalizationField??void 0,p=(0,n.G)(l,"opacity");let m=p?.minSliderValue,g=p?.maxSliderValue;this.statisticsStatus=n.s.IN_PROGRESS,!this.statistics&&r&&setTimeout((()=>{o.summaryStatistics({layer:r,view:s,field:c.field??void 0,valueExpression:c.expression??void 0,normalizationField:h,forBinning:"featureReduction"in r&&"binning"===r.featureReduction?.type&&i,outStatisticTypes:{exclude:["median"]}}).then((e=>{if(0===e.count){const[t,i]=(0,n.aP)(c),s=p?.minSliderValue||t,a=p?.maxSliderValue||i;e={min:s,max:a,avg:(a+s)/2,count:0}}else if(!(0,a.i)(e.avg)||!(0,a.i)(e.min)||!(0,a.i)(e.max))return void(this.statisticsStatus=n.s.FAILED);e=(0,n.ag)(e),m=m??e.min,g=g??e.max,m===g&&(m=e.min,g=e.max),this.statistics=e,this.statisticsStatus=n.s.SUCCESS,this.getHistogram(c,h,e,m,g,!0)}),(e=>{console.log("error-summaryStatistics",e),this.statisticsStatus=n.s.FAILED}))}),300)}getHistogram(e,t,i,s,o,r){const{layer:l,useFeatureReduction:d,mapView:u,modules:c}=this.smartMappingState,h=l;(i=i||this.statistics)&&0!==i.count&&(this.histogramStatus=n.s.IN_PROGRESS,setTimeout((()=>{c.histogram({layer:h,view:u,field:e.field??void 0,valueExpression:e.expression??void 0,numBins:50,minValue:(0,a.i)(s)?s:i.min??void 0,maxValue:(0,a.i)(o)?o:i.max??void 0,normalizationField:t??void 0,forBinning:"featureReduction"in h&&"binning"===h.featureReduction?.type&&d}).then((e=>{this.histogram=e,this.histogramStatus=n.s.SUCCESS}),(e=>{console.log("error-histogram",e),this.histogramStatus=n.s.FAILED}))}),r?0:300))}onMinMaxChange(e,t,i){const{statistics:s,smartMappingState:o}=this,r=(0,n.j)(o),l=(0,n.b)(r,"opacity"),d=(0,n.G)(r,"opacity")||{};"min"===i?d.minSliderValue=e:d.maxSliderValue=t;const u=(0,n.aI)(l?.stops,d.minSliderValue,d.maxSliderValue);this.sliderZoomed?this.zoomButtonNode.disabled=!1:!u||u.minMaxSame||!(0,a.i)(u.min)&&!(0,a.i)(u.max)?this.zoomButtonNode.disabled=!0:this.zoomButtonNode.disabled=!1,this.sliderZoomed&&(this.adjustedZoomOptions=this.transparencySlider.zoomOptions,"min"===i?(this.adjustedZoomOptions.min=e,this.zoomAdjustment="min"):(this.adjustedZoomOptions.max=t,this.zoomAdjustment="max"));const c=(0,n.o)(o,l.field),h={field:l.field,expression:l.valueExpression,expressionTitle:l.valueExpressionTitle,simpleFieldType:c?c.simpleFieldType:n.q.NUMBER},p=l.normalizationField;this.getHistogram(h,p,s,e,t),e===d.minSliderValue&&t===d.maxSliderValue&&(this.sliderZoomed=!1)}handleZigzagClick(e){const{statistics:t,smartMappingState:i}=this,s=(0,n.j)(i),a=(0,n.b)(s,"opacity"),o=(0,n.G)(s,"opacity"),r=(0,n.o)(i,a.field),l=a?.normalizationField,d={field:a.field,expression:a.valueExpression,expressionTitle:a.valueExpressionTitle,simpleFieldType:r?r.simpleFieldType:n.q.NUMBER},u=o?.minSliderValue===o?.maxSliderValue;this.getHistogram(d,l,t,e?.min??(u?t.min:o?.minSliderValue??t.min),e?.max??(u?t.max:o?.maxSliderValue??t.max)),e||(this.sliderZoomed=!1)}get el(){return(0,s.g)(this)}};m.style=".block-content-loading {\n  height: 150px;\n}\n\n.transparency-block {\n  overflow: hidden;\n}\n\n.block-section-padding {\n  padding-top: 6px;\n}\n\n.transparency-range {\n  display: flex;\n  justify-content: space-between;\n}\n.transparency-range-item {\n  width: 49%;\n  display: flex;\n  flex-flow: column;\n  justify-content: space-between;\n}\n.include-legend {\n  margin: 10px 0 0 0;\n}\n\n.slider-box {\n  height: 300px;\n\n  .esri-opacity-slider__histogram-container {\n    width: 85px;\n  }\n  .esri-opacity-slider .esri-slider .esri-slider__content {\n    height: 175px;\n  }\n  .esri-opacity-slider {\n    min-width: 200px;\n  }\n  .esri-opacity-slider .esri-slider .esri-slider__label,\n  .esri-opacity-slider .esri-slider .esri-slider__min,\n  .esri-opacity-slider .esri-slider .esri-slider__max {\n    text-decoration: underline;\n  }\n  .esri-opacity-slider .esri-slider .esri-slider__label:hover,\n  .esri-opacity-slider .esri-slider .esri-slider__min:hover,\n  .esri-opacity-slider .esri-slider .esri-slider__max:hover {\n    border: 1px solid #bbb;\n    background-color: #f3f3f3;\n    text-decoration: none;\n    z-index: 1;\n  }\n}\n.slider-box-buttons-front {\n  display: flex;\n}\n\n.slider-container {\n  overflow: hidden;\n}\n"},13898:(e,t,i)=>{function s(e,t,i){t.labelFormatFunction=t=>r(e,t,i,"short-date"),t.inputFormatFunction=t=>r(e,t,i,"short-date"),t.inputParseFunction=e=>function(e,t){if(!e)return e;let i;if(t&&"system"!==t)if("unknown"===t)i=e;else{const s=new Date;i=e+(new Date(s.toLocaleString("en-US",{timeZone:"utc"})).getTime()-new Date(s.toLocaleString("en-US",{timeZone:t})).getTime())}else{i=e+6e4*(new Date).getTimezoneOffset()}return console.log("mapTZToUTC",e," - ",new Date(e).toISOString()," - ",new Date(i).toISOString()),i}(Date.parse(e),i)}function a(e,t){let i;if(t&&"system"!==t)if("unknown"===t)i=new Date(e).toISOString();else{const s=(new Date).getTimezoneOffset(),a=new Date(e).toLocaleString("en-US",{timeZone:t});i=new Date(new Date(a).getTime()-6e4*s).toISOString()}else{const t=(new Date).getTimezoneOffset();i=new Date(e-6e4*t).toISOString()}return i}function n(e,t,i){let s;if(t&&"system"!==t)if("unknown"===t)s=new Date(e).toISOString();else{const i=(new Date).getTimezoneOffset(),a=new Date(e).toLocaleString("en-US",{timeZone:t});s=new Date(new Date(a).getTime()-6e4*i).toISOString()}else{const t=(new Date).getTimezoneOffset();s=new Date(e-6e4*t).toISOString()}return s=i?s.substring(11,19):s.substring(11,16),s}function o(e,t){let i,s=new Date(e);if(s=new Date(s.getTime()-6e4*s.getTimezoneOffset()),t&&"system"!==t)if("unknown"===t)i=s.getTime();else{const e=new Date(s.toLocaleString("en-US",{timeZone:"utc"})).getTime()-new Date(s.toLocaleString("en-US",{timeZone:t})).getTime();i=s.getTime()+e}else{const e=(new Date).getTimezoneOffset();i=s.getTime()+6e4*e}return i}function r(e,t,i,s){const{modules:a}=e;let n;return n="unknown"===i?a.intl.formatDate(t,{...a.intl.convertDateFormatToIntlOptions(s||"short-date-short-time"),timeZone:"utc",timeZoneName:"shortOffset"}):a.intl.formatDate(t,{...a.intl.convertDateFormatToIntlOptions(s||"short-date-short-time"),timeZone:i}),n}i.d(t,{a:()=>s,b:()=>n,d:()=>o,u:()=>a})},98518:(e,t,i)=>{i.d(t,{a:()=>r,b:()=>o,g:()=>c,u:()=>n});var s=i(68180),a=i(99592);i(97127);function n(e,t){const{modules:i}=e,n=(0,a.j)(e),o=i.esriLang.clone(n.classBreakInfos);n.classBreakInfos=[],o.forEach(((i,a)=>{i=function(e,t,i,a,n){if((0,s.i)(i))if(0===i);else if(i<1){const s=Math.round(1/i);t.minValue="first"===n?Math.floor(t.minValue/i)/s:Math.round(t.minValue/i)/s,t.maxValue="last"===n?Math.ceil(t.maxValue/i)/s:Math.round(t.maxValue/i)/s,t.label=`${a>0?"> ":""}${t.minValue.toLocaleString(e.fullLocale,{maximumSignificantDigits:15})} - ${t.maxValue.toLocaleString(e.fullLocale,{maximumSignificantDigits:15})}`}else t.minValue="first"===n?Math.floor(t.minValue/i)*i:Math.round(t.minValue/i)*i,t.maxValue="last"===n?Math.ceil(t.maxValue/i)*i:Math.round(t.maxValue/i)*i,t.label=`${a>0?"> ":""}${t.minValue.toLocaleString()} - ${t.maxValue.toLocaleString()}`;return t}(e,i,t,a,0===a?"first":a===o.length-1?"last":void 0),n.addClassBreakInfo({minValue:i.minValue,maxValue:i.maxValue,symbol:i.symbol,label:i.label})}))}function o(e,t){const i=(0,a.j)(e).classBreakInfos;let s=t,n=Number.POSITIVE_INFINITY;i.forEach((e=>{s||(s=Math.max(l(e.minValue),l(e.maxValue))),n=Math.min(n,e.maxValue-e.minValue)}));const o=[];return n>1e7?(o.push(1e7),o.push(1e6),o.push(1e5),o.push(1e4),o.push(1e3),o.push(100),o.push(10),s>0&&o.push(1),s>1&&o.push(.1),s>2&&o.push(.01)):n>1e6?(o.push(1e6),o.push(1e5),o.push(1e4),o.push(1e3),o.push(100),o.push(10),s>0&&o.push(1),s>1&&o.push(.1),s>2&&o.push(.01)):n>1e5?(o.push(1e5),o.push(1e4),o.push(1e3),o.push(100),o.push(10),s>0&&o.push(1),s>1&&o.push(.1),s>2&&o.push(.01)):n>1e4?(o.push(1e4),o.push(1e3),o.push(100),o.push(10),s>0&&o.push(1),s>1&&o.push(.1),s>2&&o.push(.01)):n>1e3?(o.push(1e3),o.push(100),o.push(10),s>0&&o.push(1),s>1&&o.push(.1),s>2&&o.push(.01),s>3&&o.push(.001)):n>100?(o.push(100),o.push(10),s>0&&o.push(1),s>1&&o.push(.1),s>2&&o.push(.01),s>3&&o.push(.001),s>4&&o.push(1e-4),s>5&&o.push(1e-5)):n>10?(o.push(10),s>0&&o.push(1),s>1&&o.push(.1),s>2&&o.push(.01),s>3&&o.push(.001),s>4&&o.push(1e-4),s>5&&o.push(1e-5),s>6&&o.push(1e-6)):n>1?(s>0&&o.push(1),s>1&&o.push(.1),s>2&&o.push(.01),s>3&&o.push(.001),s>4&&o.push(1e-4),s>5&&o.push(1e-5),s>6&&o.push(1e-6)):n>.1?(s>1&&o.push(.1),s>2&&o.push(.01),s>3&&o.push(.001),s>4&&o.push(1e-4),s>5&&o.push(1e-5),s>6&&o.push(1e-6)):n>.01?(s>2&&o.push(.01),s>3&&o.push(.001),s>4&&o.push(1e-4),s>5&&o.push(1e-5),s>6&&o.push(1e-6)):n>.001?(s>3&&o.push(.001),s>4&&o.push(1e-4),s>5&&o.push(1e-5),s>6&&o.push(1e-6),s>7&&o.push(1e-7)):n>1e-4?(s>4&&o.push(1e-4),s>5&&o.push(1e-5),s>6&&o.push(1e-6),s>7&&o.push(1e-7),s>8&&o.push(1e-8)):n>1e-5&&(s>5&&o.push(1e-5),s>6&&o.push(1e-6),s>7&&o.push(1e-7),s>8&&o.push(1e-8),s>9&&o.push(1e-9)),o}function r(e){const t=(0,a.j)(e);let i=1e10;return t.classBreakInfos.forEach((e=>{i=Math.min(i,d(e.minValue)),i=Math.min(i,d(e.maxValue))})),i}function l(e){let t=1;for(;Math.round(e*t)/t!==e;)t*=10;return Math.log(t)/Math.LN10}function d(e){let t=1e-8;for(;u(Math.round(e/t)*t)===e;)t*=10;return t/10}function u(e){return Number.parseFloat(e.toPrecision(12))}function c(e){let t=0;e.forEach((e=>{(0,s.i)(e.value)?t=Math.max(l(u(e.value)),t):((0,s.i)(e.minValue)&&(t=Math.max(l(u(e.minValue)),t)),(0,s.i)(e.maxValue)&&(t=Math.max(l(u(e.maxValue)),t)),(0,s.i)(e.min)&&(t=Math.max(l(u(e.min)),t)),(0,s.i)(e.max)&&(t=Math.max(l(u(e.max)),t)))})),t=Math.min(t,3);const i=e[0],a=e[e.length-1],n=Math.min(i.minValue??i.min??i.value,a.minValue??a.min??a.value),o=Math.max(i.maxValue??i.max??i.value,a.maxValue??a.max??a.value)-n;return o/e.length<2e-7?t=8:o/e.length<2e-6?t=7:o/e.length<2e-5?t=6:o/e.length<2e-4?t=5:o/e.length<.002?t=4:o/e.length<.02?t=3:o/e.length<.2?t=Math.max(t,2):o/e.length<2&&(t=Math.max(t,1)),Math.round(t)}},78567:(e,t,i)=>{i.d(t,{a:()=>o,c:()=>n,g:()=>r});var s=i(68180),a=i(99592);i(97127);async function n(e,t){const{layer:i,useFeatureReduction:n,mapImageSublayer:o,mapView:r,selectedFields:d,modules:u}=e,c=i;t=t||{};const h=(0,a.k)((0,a.j)(e));return await u.PredominanceCreator.createRenderer({layer:c,view:r,fields:l(e,t.fieldInfos),predominanceScheme:t.predominanceScheme||(0,a.a2)(e),includeOpacityVariable:!(0,s.i)(t.includeOpacityVariable)||(0,s.i)(t.includeOpacityVariable),includeSizeVariable:!!(0,s.i)(t.includeSizeVariable)&&t.includeSizeVariable,outlineOptimizationEnabled:!o&&((0,s.i)(t.outlineOptimizationEnabled)?t.outlineOptimizationEnabled:(0,a.z)(e)),sizeOptimizationEnabled:!(0,s.i)(t.sizeOptimizationEnabled)||t.sizeOptimizationEnabled,legendOptions:t.legendOptions,defaultSymbolEnabled:!1,forBinning:"binning"===c.featureReduction?.type&&n}).then((i=>{(0,a.l)(h,i.renderer,{notOpacity:!0});const n=(0,a.a)(e);if(!(0,s.i)(t.includeOpacityVariable)&&["predominance","predominance-size"].includes(n)){const s=(0,a.f)(e),n=d.map((e=>e.field)).sort(),o=s.map((e=>e.field)).sort();if(n.toString()===o.toString()){const s=(0,a.b)((0,a.j)(e),"opacity"),n=(0,a.G)((0,a.j)(e),"opacity");i.renderer.visualVariables=(0,a.V)(i.renderer,"opacity")||[],s&&i.renderer.visualVariables.push(s),i.renderer.authoringInfo.visualVariables=(0,a.W)(i.renderer,"opacity")||[],n&&i.renderer.authoringInfo.visualVariables.push(n);const o=i.renderer.uniqueValueInfos[0].symbol.clone();i.renderer.uniqueValueInfos=(0,a.j)(e).uniqueValueInfos,(0,a.z)(e)&&("predominance-size"===(0,a.a)(e)&&!0!==t.includeSizeVariable?(0,a.a3)(e,i.renderer,o):"predominance"===(0,a.a)(e)&&!0===t.includeSizeVariable&&(0,a.a4)(e,i.renderer,o))}}return i}))}async function o(e,t){const{layer:i,useFeatureReduction:n,mapImageSublayer:o,mapView:r,modules:d}=e,u=i;t=t||{};const c=(0,a.j)(e),h=(0,a.b)(c,"size"),p=(0,a.G)(c,"size"),m=(0,a.k)(c),g=t.fieldInfos?t.fieldInfos:c.uniqueValueGroups[0].classes.map((e=>({field:e.values[0].value,simpleFieldType:a.q.NUMBER})));let f,S=!0;if(t.fieldInfos&&(c.uniqueValueGroups[0].classes.forEach(((e,i)=>{e.values[0].value!==t.fieldInfos[i].field&&(S=!1)})),S&&(delete t.fieldInfos,(0,a.T)(t))))return{renderer:c.clone()};S&&(f=c.uniqueValueInfos.map((e=>e.value)));const y=(0,a.j)(e),b=y.uniqueValueInfos?.length?y.uniqueValueInfos[0].symbol:null,v=c.defaultSymbol,x=c.defaultLabel,V=c.backgroundFillSymbol;let I=!1;h&&(I=h.minSize.stops?h.minSize.stops[0].size>h.maxSize.stops[0].size:h.minSize>h.maxSize);const M=(0,s.i)(t.includeSizeVariable)?t.includeSizeVariable:!!h,w=g[0];return g[0]=g[1],g[1]=w,await d.PredominanceCreator.createRenderer({layer:u,view:r,fields:l(e,g),predominanceScheme:t.predominanceScheme||(0,a.a2)(e),includeOpacityVariable:(0,s.i)(t.includeOpacityVariable)?t.includeOpacityVariable:!!m.opacityVisVar,includeSizeVariable:M,outlineOptimizationEnabled:!o&&((0,s.i)(t.outlineOptimizationEnabled)?t.outlineOptimizationEnabled:!!m.sizeOutlineVisVar),sizeOptimizationEnabled:(0,s.i)(t.sizeOptimizationEnabled)?t.sizeOptimizationEnabled:!!m.sizeAutoVisVar,legendOptions:void 0,defaultSymbolEnabled:(0,s.i)(t.defaultSymbolEnabled)?t.defaultSymbolEnabled:!!v,forBinning:"binning"===u.featureReduction?.type&&n}).then((i=>{const n=i.renderer.uniqueValueInfos[0].symbol.clone();if(!t.fieldInfos&&h){const e=(0,a.b)(i.renderer,"size");if(e.minDataValue=h.minDataValue,e.maxDataValue=h.maxDataValue,p){const e=(0,a.G)(i.renderer,"size");e.minSliderValue=p.minSliderValue,e.maxSliderValue=p.maxSliderValue}}if(!(0,s.i)(t.includeOpacityVariable)&&S&&m.opacityVisVar&&m.authOpacityVisVar&&(i.renderer.visualVariables=(0,a.V)(i.renderer,"opacity"),i.renderer.authoringInfo.visualVariables=(0,a.W)(i.renderer,"opacity"),i.renderer.visualVariables.push(m.opacityVisVar),i.renderer.authoringInfo.visualVariables=i.renderer.authoringInfo.visualVariables||[],i.renderer.authoringInfo.visualVariables.push(m.authOpacityVisVar)),(0,a.l)(m,i.renderer,{notOpacity:!0}),f&&i.renderer.uniqueValueInfos.sort(((e,t)=>{const i=f.indexOf(e.value),s=f.indexOf(t.value);return i>-1&&s>-1&&i<s?-1:i>-1&&s>-1&&i>s?1:i>-1?-1:s>-1?1:0})),S&&i.renderer.uniqueValueInfos.forEach(((e,t)=>{e.label=c.uniqueValueInfos[t].label})),b&&i.renderer.uniqueValueInfos?.length){const t=i.renderer.uniqueValueInfos.slice();t.forEach(((t,i)=>{let s;S?s=c.uniqueValueInfos[i].symbol:(s=b.clone(),(0,a.X)(e,s,(0,a.Z)(e,t.symbol))),t.symbol=s})),i.renderer.uniqueValueInfos=t,(0,a.z)(e)&&("predominance-size"!==(0,a.a)(e)||M?"predominance"===(0,a.a)(e)&&M&&(0,a.a4)(e,i.renderer,n):(0,a.a3)(e,i.renderer,n))}if(v&&(i.renderer.defaultSymbol=v,i.renderer.defaultLabel=x),V&&(i.renderer.backgroundFillSymbol=V),I){const e=(0,a.b)(i.renderer,"size"),t=e.minSize;e.minSize=e.maxSize,e.maxSize=t}return i}))}async function r(e,t){const{layer:i,useFeatureReduction:s,mapView:a,modules:n}=e,o=i;return t=t||{},await n.predominantCategories({layer:o,view:a,fields:t.fieldInfos.map((e=>e.field)),forBinning:"binning"===o.featureReduction?.type&&s})}function l(e,t){return t.map((t=>({name:t.field,label:d(e,t.field)})))}function d(e,t){const i=e.fields.filter((e=>e.layerField.name===t));return i.length?i[0].label:""}},33101:(e,t,i)=>{i.d(t,{c:()=>n,u:()=>o});var s=i(97127),a=(i(68180),i(99592));function n(e){e.selectedFields=[],e.layerFields=void 0,e.fields=void 0,e.hideLayerTitle=!1,e.supportsArcade=!1,e.stringFieldsCount=-1,e.dateFieldsCount=-1,e.numberFieldsCount=-1,e.containsFlow=!0,e.oneFeatureResponseStatus=a.s.MISSING,e.selectedAttribute=void 0,e.selectedAttributeText=void 0,e.selectedTypeValue=void 0,e.selectedValue=void 0,e.lastDefault=void 0,e.lastDefaults=void 0,e.dotColorSelected=void 0,e.backgroundStyleSelected=void 0,e.lastSettings=void 0,e.classedSymbolSelectedIdx=void 0,e.allUniqueValues=void 0,e.useFeatureReduction=void 0,e.hideSvgUploadSymbols=!1,e.hideAddStyles=!1,e.rasterInfo=void 0}function o(){const e=(0,s.r)(),t=e;e.manager.onLoad((()=>{t.smartMappingState=function(e,t){const i=r.get(e);if(i)return i;const a=(0,s.c)(e,t);if(a&&"store"in a)return r.set(e,a.store),a.store;return null}(e.el,"arcgis-smart-mapping").state}))}const r=new WeakMap}}]);