/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-e79ca9.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-e79ca9"],{37250:(e,t,a)=>{a.r(t),a.d(t,{arcgis_display_filter:()=>o});var i=a(28614),r=a(97127),n=a(50063),s=a(68180),l=a(71480);const o=class{constructor(e){(0,i.r)(this,e),this.arcgisChange=(0,i.c)(this,"arcgisChange",7),this.manager=(0,r.u)(this),this.strings=(0,n.u)({blocking:!0}),this.mapView=void 0,this.layer=void 0}async componentWillLoad(){const e=await(0,l.b)();e.watch((()=>this.mapView.map?.allLayers?.length),(()=>(0,i.f)(this.el))),e.watch((()=>this.mapView.displayFilterEnabled),(e=>{e||(0,i.f)(this.el)}))}render(){const{strings:e,mapView:t,layer:a}=this,{map:r}=t,{allLayers:n}=r,l=a?.displayFilterInfo?[a]:n.filter((e=>(0,s.i)(e.displayFilterInfo))).toArray(),o=l.map((e=>this.renderDisplayFilterLayerInfo(e)));return(0,i.h)(i.H,{key:"c76af5359ae732bbea9e8b159e164bd44097a462"},o?.length?(0,i.h)(i.F,null,this.renderDisplayFilterMapViewInfo(),(0,i.h)("calcite-panel",{class:"panel",disabled:!t.displayFilterEnabled},o)):(0,i.h)("div",null,e.noDisplayFilters))}renderDisplayFilterMapViewInfo(){const{mapView:e,layer:t,strings:a}=this;return t?(0,i.h)(i.F,null):(0,i.h)("calcite-label",{class:"mapview-level-label",layout:"inline-space-between"},a.enableDisplayFilters,(0,i.h)("calcite-switch",{scale:"s",checked:e.displayFilterEnabled,onCalciteSwitchChange:()=>{e.displayFilterEnabled=!e.displayFilterEnabled,(0,i.f)(this.el),this.arcgisChange.emit()}}))}renderDisplayFilterLayerInfo(e){const{strings:t}=this,a=!(0,s.i)(this.layer),{displayFilterInfo:r}=e,{mode:n}=r;if("manual"===n){if(!r.filters.some((e=>e.id===r.activeFilterId))){e.displayFilterEnabled=!1;const t=r.clone();t.activeFilterId=t.filters.getItemAt(0).id,e.displayFilterInfo=t,this.arcgisChange.emit()}}return(0,i.h)("div",{class:"wrapper-node"},(0,i.h)("calcite-label",{layout:"inline-space-between"},a?e.title:t.enableDisplayFilter,(0,i.h)("calcite-switch",{scale:"s",checked:e.displayFilterEnabled,onCalciteSwitchChange:()=>{e.displayFilterEnabled=!e.displayFilterEnabled,(0,i.f)(this.el),this.arcgisChange.emit()}})),this.renderLayerControls(e))}renderLayerControls(e){const{strings:t}=this,{displayFilterEnabled:a,displayFilterInfo:n}=e,{mode:s}=n;if(!a)return(0,i.h)(i.F,null);if("manual"===s){const t=n.filters.map((e=>(0,i.h)("calcite-label",{layout:"inline"},(0,i.h)("calcite-radio-button",{value:e.id,checked:n.activeFilterId===e.id}),e.title)));return(0,i.h)("div",{class:"filter-description-padding"},(0,i.h)("calcite-radio-button-group",{layout:"vertical",name:`manual-filters-${(0,r.g)()}`,onCalciteRadioButtonGroupChange:t=>{const a=t.target.selectedItem.value,r=n.clone();r.activeFilterId=a,e.displayFilterInfo=r,(0,i.f)(this.el),this.arcgisChange.emit()}},...t.toArray()))}return(0,i.h)("div",{class:"filter-description-padding"},t.scaleDisplayFilterDescription)}static get assetsDirs(){return["assets"]}get el(){return(0,i.g)(this)}};o.style=".panel {\n  --calcite-panel-background-color: var(--calcite-color-foreground-1);\n}\n\n.wrapper-node {\n  margin: var(--calcite-spacing-sm) var(--calcite-spacing-xs) 0;\n}\n\n.mapview-level-label {\n  border-bottom: 1px solid var(--calcite-color-border-3);\n}\n\n.filter-description-padding {\n  margin-left: var(--calcite-spacing-md);\n}\n\n:dir(rtl) {\n  .filter-description-padding {\n    margin-right: var(--calcite-spacing-md);\n  }\n}\n"},68180:(e,t,a)=>{a.d(t,{a:()=>i,b:()=>h,c:()=>F,d:()=>y,e:()=>u,f:()=>s,g:()=>p,h:()=>I,i:()=>o,j:()=>c,k:()=>g,l:()=>r,m:()=>d,n:()=>m,o:()=>w,p:()=>x,q:()=>v,s:()=>n,t:()=>f});var i,r,n,s,l=a(71480);function o(e){return null!=e}function c(e,t){const a=e.fieldName;if(a.includes(i.expression)){const e=t.get(a);return e?.title?e.title:a}return e.label?e.label:a}async function p(e){return new Map((await async function(e){return await new Promise(((t,a)=>{switch(y(e)){case n.feature:case n.ogcFeature:case n.stream:t(e.fields);break;case n.mapImage:{const i=e,r=i?.layer;r?.portalItem&&r.url.includes("https://demographics")&&r.url.includes(".arcgis.com")?r.portalItem?.fetchData().then((e=>{if(e?.thematicGroup){const a=new Map(i.fields.map((e=>[e.name,e]))),r=e.thematicGroup.fieldNames,n=[];r.forEach((e=>{a.has(e)&&n.push(a.get(e))})),t(n)}else t(i.fields)})).catch((e=>{a(new Error(e))})):t(i.fields);break}case n.imagery:{const a=e;t((a.fields||[]).concat(a.rasterFields||[]));break}case n.imageryTile:case n.wcs:t(e.rasterFields);break;default:t("fields"in e?e.fields??[]:[])}}))}(e)).filter((e=>e.visible)).map((e=>[e.name,e])))}function u(e){const t=new Map;return e?.expressionInfos&&e.expressionInfos.forEach((e=>{const a=`${i.expression}${e.name}`;t.set(a,e)})),t}function y(e){return"map-image"===e?.layer?.type?n.mapImage:"subtype-sublayer"===e?.type?n.subtype:"tile"===e?.layer?.type?n.tile:"scene"===e?.type?n.scene:"ogc-feature"===e?.type?n.ogcFeature:"imagery"===e?.type?n.imagery:"imagery-tile"===e?.type?n.imageryTile:"wfs"===e?.type?n.wfs:"wcs"===e?.type?n.wcs:"wms"===e?.layer?.type?n.wms:"csv"===e?.type?n.csv:"geojson"===e?.type?n.geojson:"stream"===e?.type?n.stream:"oriented-imagery"===e?.type?n.orientedImagery:"catalog"===e?.type?n.catalog:"catalog-footprint"===e?.type?n.catalogFootprint:"knowledge-graph-sublayer"===e?.type?n.knowledgeGraphSublayer:"voxel"===e?.type?n.voxel:n.feature}function d(e){if(e)switch(e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"multipoint":case"polyline":return e.extent?.center;default:return}}function g(e){return Number((100*(1-e)).toFixed(1))}function f(e){return Number((1-e/100).toFixed(3))}!function(e){e.expression="expression/",e.raster="Raster.",e.relationship="relationships/"}(i||(i={})),function(e){e.cluster="cluster",e.feature="feature",e.mapNotes="mapNotes"}(r||(r={})),function(e){e.catalog="catalog",e.catalogFootprint="catalog-footprint",e.csv="csv",e.feature="feature",e.geojson="geojson",e.imagery="imagery",e.imageryTile="imagery-tile",e.knowledgeGraphSublayer="knowledge-graph-sublayer",e.mapImage="map-image",e.ogcFeature="ogc-feature",e.orientedImagery="oriented-imagery",e.scene="scene",e.stream="stream",e.subtype="subtype",e.tile="tile",e.voxel="voxel",e.wcs="wcs",e.wfs="wfs",e.wms="wms"}(n||(n={})),function(e){e.bigInteger="big-integer",e.date="date",e.dateOnly="date-only",e.double="double",e.globalId="global-id",e.guid="guid",e.integer="integer",e.long="long",e.number="number",e.oid="oid",e.single="single",e.smallInteger="small-integer",e.string="string",e.timeOnly="time-only",e.timestampOffset="timestamp-offset"}(s||(s={}));const m=(e,t)=>{const a=[];return e?.fieldInfos?.forEach((e=>{e.fieldName?.includes(i.expression)?t&&a.push({name:e.fieldName.slice(i.expression.length),alias:e.fieldName.slice(i.expression.length),type:"string"}):a.push({name:e.fieldName,alias:e.label,type:"string"})})),a},h=async(e,t)=>{const[a,i]=await Promise.all([(0,l.g)(),(0,l.h)()]),r=new i;r.geometry=t.extent,r.mapExtent=t.extent,r.returnGeometry=!0,r.tolerance=6,r.layerOption="popup",r.width=t.width,r.height=t.height,r.layerIds=[e.id];const n=(await a.identify(e.layer.url,r))?.results,s=n?.[0]?.feature;return s},w=async(e,t,a)=>{const i=await e.whenLayerView(t),r=await i.queryAggregates();return await b(a,r.features?.[0])},b=async(e,t)=>{const a=await(0,l.j)(),i=await(0,l.k)();let r;if(t)r=t.clone();else{r=new a;const t=m(e,!1);if(t?.length){const e={};t.forEach((t=>{e[t.name]=""})),r.attributes=e}const n=new i;r.geometry=n}return r};function v(e,t){const a=t.startsWith("#"),i=t.startsWith(".");for((i||a)&&(t=t.slice(1));e;){if(a){if(e.id===t)return e}else if(i){if(e.classList.contains(t))return e}else if(e.tagName.toLowerCase()===t.toLowerCase())return e;e=e.parentElement??e.getRootNode()?.host??void 0}}async function F(e){if(y(e)===n.stream)return await Promise.resolve("point");if(e.geometryType)return await Promise.resolve(e.geometryType);if(y(e)===n.mapImage&&e?.layer?.sourceJSON?.layers){const t=e.layer?.sourceJSON.layers.find((t=>{if(t.id===e.id)return t}))?.geometryType?.toLowerCase();if(t)return t.indexOf("point")>-1?await Promise.resolve("point"):t.indexOf("line")>-1?await Promise.resolve("polyline"):t.indexOf("polygon")>-1?await Promise.resolve("polygon"):await Promise.resolve(t);{const t=e?.layer?.findSublayerById(e.id);if(t){const e=await(t?.createFeatureLayer());return e?(await e.load(),await Promise.resolve(e?.geometryType)):void await Promise.resolve()}return void await Promise.resolve()}}await Promise.resolve()}function I(e,t,a){let i="";if(/^raster.(?:item|service)pixelvalue/iu.test(e))i="number";else if(t.has(e)){const a=t.get(e);i=a.type?a.type.toLowerCase():""}else if(a.has(e)){const t=a.get(e);i=t.returnType?t.returnType.toLowerCase():""}else i="number";return i}async function x(e,t){return"feature"!==e.type||e.url?"feature"===e.type||"csv"===e.type||"scene"===e.type||"wfs"===e.type||"geojson"===e.type||"oriented-imagery"===e.type||"subtype-group"===e.type||"subtype-sublayer"===e.type||"catalog"===e.type||"catalog-footprint"===e.type?await e.queryFeatureCount():!t||"stream"!==e.type&&"ogc-feature"!==e.type?await Promise.reject(new Error(`Can't get feature count for layer of type ${e.type}.`)):await async function(e,t){const a=await t.whenLayerView(e);return await a.queryFeatureCount()}(e,t):await async function(e){const t=e.createQuery();t.outFields=["*"];const a=await e.queryFeatures(t);if(a.features?.length)return a.features.length;throw new Error("could not get feature count")}(e)}},50063:(e,t,a)=>{a.d(t,{u:()=>n});var i=a(97127),r=a(28614);const n=(0,i.m)(r.a)}}]);