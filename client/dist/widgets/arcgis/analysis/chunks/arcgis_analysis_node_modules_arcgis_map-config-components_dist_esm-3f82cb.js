/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-3f82cb.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-3f82cb"],{26219:(e,t,i)=>{i.r(t),i.d(t,{arcgis_smart_mapping_age:()=>x,arcgis_smart_mapping_classify:()=>M,arcgis_smart_mapping_default_symbol:()=>I,arcgis_smart_mapping_divided_by:()=>N,arcgis_smart_mapping_info_popover:()=>C,arcgis_smart_mapping_panels_size:()=>w,arcgis_smart_mapping_size_range_slider:()=>k,arcgis_smart_mapping_size_slider:()=>T,arcgis_smart_mapping_symbol_pair_button:()=>V,arcgis_smart_mapping_symbol_pair_popover:()=>P,arcgis_smart_mapping_theme_button:()=>B,arcgis_smart_mapping_tile:()=>E});var s=i(28614),a=i(48122),n=(i(68180),i(99592)),o=i(13898),l=i(54351),r=i(33101),d=i(84521),c=i(58944),h=i(79323),p=i(58325),u=i(97127),m=i(98518),g=i(39304),f=i(372),S=i(63625),b=i(99818),y=i(78567),z=i(42444),v=i(76133);i(71480),i(67751),i(80216);const x=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingAgeChange=(0,s.c)(this,"arcgisSmartMappingAgeChange",7),this.arcgisSmartMappingAgeError=(0,s.c)(this,"arcgisSmartMappingAgeError",7),this.manager=(0,u.u)(this),this.smartMappingState=(0,r.u)(),this.rendererSubtype=void 0}componentWillLoad(){const{fields:e}=this.smartMappingState,t=(0,n.j)(this.smartMappingState),i="color"===this.rendererSubtype?(0,n.G)(t,"color"):(0,n.G)(t,"size"),s=e.filter((e=>e.simpleFieldType===n.q.DATE&&e.layerField.name===i.field));this.restDateFields=e.filter((e=>e.simpleFieldType===n.q.DATE&&e!==s[0])),this.flowItemNode=(0,a.f)(this.el,"calcite-flow-item")}render(){return(0,s.h)(s.H,{key:"040d4039bf8f84c5b9982c6659a525cc331fe257"},this.renderFrom(),this.renderTo(),this.renderUnits())}renderFrom(){const{smartMappingState:e}=this,{strings:t}=e,i=(0,n.j)(e),a="color"===this.rendererSubtype?(0,n.G)(i,"color"):(0,n.G)(i,"size"),{field:o,startTime:l}=a;return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,t.age.from),(0,s.h)("div",{class:"from-field"},o===l?this.rendererStaticField():this.rendererAgeField()))}renderTo(){const{smartMappingState:e}=this,{strings:t}=e,i=(0,n.j)(e),a="color"===this.rendererSubtype?(0,n.G)(i,"color"):(0,n.G)(i,"size"),{field:o,endTime:l}=a;return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,(0,s.h)("div",{class:"to-flip-wrapper"},(0,s.h)("div",{class:"to-label"},t.age.to),(0,s.h)("arcgis-smart-mapping-action",{hideOutline:!0,text:t.age.flip,icon:"arrowUpDown",onClick:()=>this.handleFlip()}))),(0,s.h)("div",{class:"to-field"},o===l?this.rendererStaticField():this.rendererAgeField()))}rendererStaticField(){const{smartMappingState:e}=this,t=(0,n.j)(e),i="color"===this.rendererSubtype?(0,n.G)(t,"color"):(0,n.G)(t,"size"),a=(0,n.o)(e,i.field);return(0,s.h)("div",{class:"field-select-fixed"},a?.label)}rendererAgeField(){const{smartMappingState:e}=this,{strings:t}=e,i=(0,n.j)(e),a="color"===this.rendererSubtype?(0,n.G)(i,"color"):(0,n.G)(i,"size"),{field:o,startTime:l,endTime:r}=a,d=l===o?r:l,c="string"==typeof d,h=this.restDateFields?.[0]?.layerField.alias||this.restDateFields?.[0]?.layerField.name;let p;return c&&(p={field:d,simpleFieldType:n.q.DATE}),(0,s.h)("div",null,this.restDateFields?.length?(0,s.h)("calcite-radio-button-group",{class:"variable-field-radio",name:"variableType",onCalciteRadioButtonGroupChange:e=>this.handleTypeChange(e.target.selectedItem.value)},(0,s.h)("calcite-label",{layout:"inline"},(0,s.h)("calcite-radio-button",{key:c?`age-variable-radio-field-${Math.random()}`:void 0,checked:c,value:"field"}),t.age.field),(0,s.h)("calcite-label",{layout:"inline"},(0,s.h)("calcite-radio-button",{key:c?void 0:`age-variable-radio-date-${Math.random()}`,checked:!c,value:"date"}),t.age.customDate)):null,c?this.restDateFields?.length&&this.restDateFields?.length>1?(0,s.h)("arcgis-smart-mapping-attribute-input",{fieldList:this.restDateFields,selectedField:p,mode:"simple",hideLabel:!0,popoverReferenceElement:this.flowItemNode,onArcgisSmartMappingAttributeInputChange:e=>{if(e.detail){const t=e.detail.field;this.createRendererUpdateCall(o===l?{endTime:t}:{startTime:t})}},ref:e=>{e&&(this.rendererAgeFieldNode=e)}}):(0,s.h)("div",{class:"field-select-fixed"},h):this.rendererAgeFieldDate())}renderUnits(){const{smartMappingState:e}=this,{strings:t}=e,i=(0,n.j)(e),a=("color"===this.rendererSubtype?(0,n.G)(i,"color"):(0,n.G)(i,"size")).units;return(0,s.h)("calcite-label",{class:"units-label"},t.age.units,(0,s.h)("calcite-select",{class:"units-select",width:"full",label:t.age.units,onCalciteSelectChange:e=>this.handleUnitChange(e),value:a,ref:e=>this.unitsNode=e},(0,s.h)("calcite-option",{value:"seconds",label:t.age.seconds,selected:"seconds"===a}),(0,s.h)("calcite-option",{value:"minutes",label:t.age.minutes,selected:"minutes"===a}),(0,s.h)("calcite-option",{value:"hours",label:t.age.hours,selected:"hours"===a}),(0,s.h)("calcite-option",{value:"days",label:t.age.days,selected:"days"===a}),(0,s.h)("calcite-option",{value:"months",label:t.age.months,selected:"months"===a}),(0,s.h)("calcite-option",{value:"years",label:t.age.years,selected:"years"===a})))}rendererAgeFieldDate(){const{smartMappingState:e}=this,{mapView:t}=e,i=(0,n.j)(e),a="color"===this.rendererSubtype?(0,n.G)(i,"color"):(0,n.G)(i,"size"),{field:l,startTime:r,endTime:d}=a,c=a.units,h=r===l?d:r,u="string"==typeof h,m=u?void 0:(0,o.u)(h,t.timeZone),g=["seconds","minutes","hours"].includes(c),f=!u&&g?(0,o.b)(h,t.timeZone,"seconds"===c):void 0;return(0,s.h)(s.F,null,(0,s.h)("calcite-input-date-picker",{scale:"s",value:m,class:"variable-date-date",ref:e=>{e&&(this.datePickerNode=e)},onCalciteInputDatePickerChange:()=>this.handleDateChange()}),g?(0,s.h)("calcite-input-time-picker",{key:`${c}-${h}`,step:"seconds"===c?1:60,scale:"s",value:f,class:"variable-date-time",ref:e=>{e&&(this.timePickerNode=e)},onCalciteInputTimePickerChange:(0,p.d)((()=>{this.timePickerNode&&(this.timePickerNode.open=!1),this.handleTimeChange()}),750)}):null)}createRendererUpdateCall(e){const{smartMappingState:t}=this,i=(0,n.a)(t);let a;a="color-age"===i?d.d:"size-age"===i?c.h:"color-age-size"===i?c.j:"color-size-age"===i?c.i:h.d,(0,l.r)(a(t,e,this.rendererSubtype),this.flowItemNode).then((e=>{(0,n.u)(t,e.renderer),(0,s.f)(this.el),this.arcgisSmartMappingAgeChange.emit()}),(e=>{this.rendererAgeFieldNode&&(0,s.f)(this.rendererAgeFieldNode);const{mapView:i}=this.smartMappingState,a=(0,n.j)(t),l="color"===this.rendererSubtype?(0,n.G)(a,"color"):(0,n.G)(a,"size"),{field:r,startTime:d,endTime:c}=l,h=l.units,p=d===r?c:d,u="string"==typeof p,m=["seconds","minutes","hours"].includes(h),g=u?void 0:(0,o.u)(p,i.timeZone),f=!u&&m?(0,o.b)(p,i.timeZone,"seconds"===h):void 0;this.datePickerNode&&g&&(this.datePickerNode.value=g),this.timePickerNode&&f&&(this.timePickerNode.value=f),this.unitsNode&&(this.unitsNode.value=h),(0,s.f)(this.el),this.arcgisSmartMappingAgeError.emit(e)}))}handleUnitChange(e){const t={units:e.target.selectedOption.value};this.createRendererUpdateCall(t)}handleTypeChange(e){const{smartMappingState:t}=this,i=(0,n.j)(t),s="color"===this.rendererSubtype?(0,n.G)(i,"color"):(0,n.G)(i,"size"),{field:a,startTime:o}=s,l="field"===e?this.restDateFields?.[0]?.layerField.name:(new Date).getTime();this.createRendererUpdateCall(a===o?{endTime:l}:{startTime:l})}handleDateChange(){const{smartMappingState:e}=this,{mapView:t}=e,i=(0,n.j)(e),s="color"===this.rendererSubtype?(0,n.G)(i,"color"):(0,n.G)(i,"size"),a=this.datePickerNode?.value;if(!a)return;const l=this.timePickerNode?.value||"00:00:00",r=(0,o.d)(`${a}T${l}`,t.timeZone),{field:d,startTime:c}=s,h={};d===c?h.endTime=r:h.startTime=r,this.createRendererUpdateCall(h)}handleTimeChange(){const{smartMappingState:e}=this,{mapView:t}=e,i=(0,n.j)(e),s="color"===this.rendererSubtype?(0,n.G)(i,"color"):(0,n.G)(i,"size"),{field:a,startTime:l}=s,r=this.timePickerNode?.value,d=this.datePickerNode?.value,c=(0,o.d)(`${d}T${r}`,t.timeZone),h={};a===l?h.endTime=c:h.startTime=c,this.createRendererUpdateCall(h)}handleFlip(){const{smartMappingState:e}=this,t=(0,n.j)(e),i="color"===this.rendererSubtype?(0,n.G)(t,"color"):(0,n.G)(t,"size"),{startTime:s,endTime:a}=i,o={startTime:a,endTime:s};this.createRendererUpdateCall(o),this.createRendererUpdateCall(o)}get el(){return(0,s.g)(this)}};x.style=".field-select-fixed{background-color:#f6f6f6;padding:6px 6px;justify-content:space-between;align-items:center;color:#333333;margin:0;transition:box-shadow 250ms ease-in-out;box-shadow:0 0 0 1px #e0e0e0;height:auto;line-height:1.25;overflow-wrap:anywhere}.variable-date-date{width:100%}.variable-date-time{width:100%;margin-top:5px}.variable-field-radio{display:flex;justify-content:space-between}.to-flip-wrapper{display:flex;justify-content:space-between}.to-label{display:flex;align-items:center;margin-top:10px}.units-label{margin-top:6px}.to-field{margin-top:-10px}.from-field{margin-top:-8px;margin-bottom:6px}.units-select{margin-bottom:10px}";const M=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingClassifyChange=(0,s.c)(this,"arcgisSmartMappingClassifyChange",7),this.arcgisSmartMappingClassifyError=(0,s.c)(this,"arcgisSmartMappingClassifyError",7),this.manager=(0,u.u)(this),this.inputNodes=[],this.labelNodes=[],this.symbolNodes=[],this.disconnected=!1,this.smartMappingState=(0,r.u)()}componentWillLoad(){this.flowItemNode=(0,a.f)(this.el,"calcite-flow-item")}disconnectedCallback(){this.disconnected=!0,clearTimeout(this.classesChangeHandle)}render(){const{smartMappingState:e}=this,{strings:t,mapImageSublayer:i,supportsArcade:a}=e,o=(0,n.j)(e),l=(0,n.b)(o,"color"),r=(0,n.b)(o,"size"),d=l||r,c=(0,n.H)(e),h=(0,n.Y)(e)??(0,n.Y)(e,"above-and-below"),p=l&&["high-to-low","above-and-below","above","below"].includes(c)&&h&&!h.colorsForClassBreaks?.length;return i&&!a?(0,s.h)("calcite-block-section",{class:"classify-block-section",text:t.classify.classifyData,open:!d,toggleDisplay:"button"},!d&&this.renderContents()):(0,s.h)(s.F,null,(0,s.h)("calcite-label",{class:"classify-block-section classify-heading "+(p?"disable-classify":""),layout:"inline-space-between",onMouseOver:()=>{p&&(0,n.ai)(this.blockLabelNode,t.classify.cannotClassify,!0,"left-start")},onMouseOut:()=>(0,n.ah)(),onFocus:()=>{p&&(0,n.ai)(this.blockLabelNode,t.classify.cannotClassify,!0,"left-start")},onFocusout:()=>(0,n.ah)(),ref:e=>this.blockLabelNode=e},t.classify.classifyData,(0,s.h)("calcite-switch",{disabled:p,scale:"s",checked:!d,onCalciteSwitchChange:e=>{e.stopImmediatePropagation(),this.handleClassifyToggle()},ref:e=>this.classifySwitchNode=e})),!p&&!d&&this.renderContents())}renderContents(){return(0,s.h)("div",{class:"block-section-padding"},this.renderMethod(),this.renderClasses(),this.renderStdDev(),this.renderRoundClasses(),this.renderValues())}renderMethod(){const{smartMappingState:e}=this,t=(0,n.j)(e),i=(0,n.a)(e);return(0,s.h)("arcgis-smart-mapping-method-button",{key:t.authoringInfo?.classificationMethod??void 0,showStdDev:!0,onArcgisSmartMappingMethodButtonBeforeOpen:()=>(0,n.B)(),onArcgisSmartMappingMethodButtonChange:t=>{const a=t.target;this.precisionValue=void 0;const o=(0,n.j)(e);if("manual"===t.detail){const t=o.authoringInfo;"standard-deviation"===t.classificationMethod&&o.classBreakInfos.forEach(((e,t)=>{const i=t>0?"> ":"";e.label=`${i} ${e.minValue.toLocaleString()} - ${e.maxValue.toLocaleString()}`})),t.classificationMethod="manual",(0,n.u)(e),(0,s.f)(this.el),setTimeout((()=>{this.methodButtonNode?.setFocus()}),300)}else{const o="color"===i?d.e:c.k;(0,l.r)(o(e,{classificationMethod:t.detail}),this.flowItemNode).then((t=>{(0,n.u)(e,t.renderer),(0,s.f)(this.el),this.arcgisSmartMappingClassifyChange.emit(),setTimeout((()=>{this.methodButtonNode?.setFocus()}),300)}),(e=>{(0,s.f)(a),this.arcgisSmartMappingClassifyError.emit(e)}))}},ref:e=>{e&&(this.methodButtonNode=e)}})}renderClasses(){const{smartMappingState:e}=this,{strings:t}=e,i=(0,n.j)(e),a=i.classBreakInfos.length;return"standard-deviation"===i.authoringInfo.classificationMethod?(0,s.h)(s.F,null):(0,s.h)("calcite-label",null,t.classify.classifyClasses,(0,s.h)("calcite-input-number",{value:`${a}`,min:1,max:10,step:1,scale:"s",onCalciteInputNumberInput:(0,p.d)((()=>{if(!this.disconnected&&(clearTimeout(this.classesChangeHandle),this.classesNode)){const e=Number.parseInt(this.classesNode.value);if(e===a)return;!e||e<this.classesNode.min||e>this.classesNode.max?this.classesChangeHandle=setTimeout((()=>this.handleClassesChange()),3e3):this.handleClassesChange()}}),300),ref:e=>{e&&(this.classesNode=e)}}))}renderStdDev(){const{smartMappingState:e}=this,{strings:t}=e,i=(0,n.j)(e).authoringInfo,a=i.standardDeviationInterval||1;return"standard-deviation"!==i.classificationMethod?(0,s.h)(s.F,null):(0,s.h)("calcite-label",null,t.classify.classifyStdDevIntervals,(0,s.h)("calcite-select",{width:"full",role:"button",label:t.classify.classifyStdDevIntervals,onCalciteSelectChange:e=>this.handleStdDevChange(e),value:`${a}`,ref:e=>this.stdDevSelectNode=e},(0,s.h)("calcite-option",{value:"0.5",label:"0.5",selected:.5===a}),(0,s.h)("calcite-option",{value:"1",label:"1",selected:1===a})))}renderRoundClasses(){const{smartMappingState:e}=this,{strings:t,locale:i}=e;if("standard-deviation"===(0,n.j)(e).authoringInfo.classificationMethod)return(0,s.h)(s.F,null);const a=(0,m.a)(e),o=(0,s.h)("calcite-option",{value:"select",label:t.classify.selectAnOption});this.precisionValue||(this.precisionValue=a.toString().split(".")[1]?.length??a.toFixed(20).toString().split(".")[1]?.length);const l=(0,m.b)(e,this.precisionValue).map((e=>(0,s.h)("calcite-option",{value:`${e}`,label:e.toLocaleString(i,{maximumSignificantDigits:15}),disabled:a>=e,selected:a===e})));return(0,s.h)("calcite-label",null,t.classify.classifyRoundClasses,(0,s.h)("calcite-select",{width:"full",label:t.classify.classifyRoundClasses,onCalciteSelectChange:e=>this.handleRoundClassesChange(e)},[o,...l]))}renderValues(){const{smartMappingState:e}=this,{strings:t}=e,i=(0,n.j)(e);return this.labelNodes=[],this.inputNodes=[],(0,s.h)("calcite-list",{label:t.classify.classes},i.classBreakInfos.map(((e,t)=>this.renderValue(e,t))).reverse())}renderValue(e,t){return(0,s.h)("calcite-list-item",null,(0,s.h)("div",{class:"symbol-container",slot:"actions-start"},this.renderSymbolNode(e,t)),this.renderTextNode(e,t))}renderSymbolNode(e,t){const{smartMappingState:i}=this,{strings:a}=i,o=(0,n.j)(i).classBreakInfos[t].symbol.clone(),l={"symbol-is-white":(0,n.av)(i,o),symbol:!0};return(0,s.h)("div",{class:l,tabindex:"0","aria-label":a.classify.accessibility.editSymbolFor.replace("${value}",e.label),"aria-haspopup":"true",ref:e=>{e&&this.symbolNodes.unshift(e)},onClick:()=>{this.popoverNode?(this.symbolNodes[this.selectedPopoverIdx].classList.remove("selected"),this.selectedPopoverIdx===t?((0,n.B)(),this.popoverNode=void 0,this.selectedPopoverIdx=void 0):(this.selectedPopoverIdx=t,this.handleValueSymbolClick(t))):(this.selectedPopoverIdx=t,this.handleValueSymbolClick(t))},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleValueSymbolClick(t))}},(0,s.h)("div",{ref:e=>{e&&this.afterCreateValueSymbol(e,t)}}))}renderTextNode(e,t){const{strings:i}=this.smartMappingState;return(0,s.h)(s.F,null,(0,s.h)("div",{key:e.label??void 0,class:"label",slot:"content",tabindex:"0",ref:e=>{e&&this.labelNodes.unshift(e)},"aria-label":i.classify.accessibility.editLabelFor.replace("${value}",e.label),onClick:e=>this.handleLabelEdit(t,e),onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||this.handleLabelEdit(t,e)}},e.label),(0,s.h)("calcite-input",{slot:"content",class:"hidden",scale:"s",ref:e=>{e&&this.inputNodes.unshift(e)},value:e.label??void 0,onCalciteInputChange:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onFocusout:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onKeyDown:i=>{if(i.stopPropagation(),"Escape"===i.key||"Enter"===i.key){this.inputNodes[t].classList.add("hidden");const s=i.currentTarget;s.value=e.label||"",s.disabled=!0,this.handleValueTextChange(t,i),this.labelNodes[t].classList.remove("hidden"),s.disabled=!1,setTimeout((()=>this.labelNodes[t].focus()),300)}}}))}afterCreateValueSymbol(e,t){const{smartMappingState:i}=this,{modules:s}=i,a=(0,n.j)(i).classBreakInfos[t].symbol.clone();for(;e?.childNodes?.length;)e.removeChild(e.childNodes[0]);const{symbolUtils:o}=s;a&&o.renderPreviewHTML(a,{size:(0,n.aw)(a),symbolConfig:"cim"===a.type&&"CIMPolygonSymbol"===a.data.symbol.type?{isSquareFill:!0}:void 0}).then((t=>{t&&e?.appendChild(t)}))}handleClassifyToggle(){const{smartMappingState:e}=this,t=(0,n.a)(e),i=this.classifySwitchNode.checked?"color"===t?d.e:c.k:"color"===t?d.b:c.f;(0,l.r)(i(e,{}),this.flowItemNode).then((t=>{(0,n.u)(e,t.renderer),(0,s.f)(this.el),this.arcgisSmartMappingClassifyChange.emit({closePopovers:!0,toggle:!0})}),(e=>{this.classifySwitchNode.checked=!this.classifySwitchNode.checked,this.arcgisSmartMappingClassifyError.emit(e)}))}handleClassesChange(){const{smartMappingState:e}=this,t=(0,n.a)(e),i=Math.min(Math.max(Number.parseInt(this.classesNode.value),1),10)||5;`${i}`!==this.classesNode.value&&(this.classesNode.value=`${i}`);const s="color"===t?d.e:c.k,a=(0,n.j)(e).authoringInfo.classificationMethod;(0,l.r)(s(e,{numClasses:i}),this.flowItemNode).then((t=>{"manual"===a&&(t.renderer.authoringInfo.classificationMethod="manual"),(0,n.u)(e,t.renderer),this.arcgisSmartMappingClassifyChange.emit({classesChange:!0}),this.classesNode.value=`${t.renderer.classBreakInfos.length}`}),(t=>{const i=(0,n.j)(e);this.classesNode.value=`${i.classBreakInfos.length}`,this.arcgisSmartMappingClassifyError.emit(t)}))}handleStdDevChange(e){const{smartMappingState:t}=this,i=e.currentTarget,a="color"===(0,n.a)(t)?d.e:c.k;(0,l.r)(a(t,{standardDeviationInterval:Number.parseFloat(i.value)}),this.flowItemNode).then((e=>{(0,n.u)(t,e.renderer),(0,s.f)(this.el),this.arcgisSmartMappingClassifyChange.emit()}),(e=>{const i=(0,n.j)(t).authoringInfo.standardDeviationInterval||1;this.stdDevSelectNode.value=`${i}`,(0,s.f)(this.el),this.arcgisSmartMappingClassifyError.emit(e)}))}handleRoundClassesChange(e){const{smartMappingState:t}=this,i=(0,n.j)(t).authoringInfo,s=e.currentTarget;"select"!==s.value&&((0,m.u)(t,Number.parseFloat(s.value)),i.classificationMethod="manual",(0,n.u)(t),this.arcgisSmartMappingClassifyChange.emit({closePopovers:!0}))}handleLabelEdit(e,t){const i=this.inputNodes[e];i.classList.remove("hidden"),i.setFocus(),t.target.classList.add("hidden")}handleValueSymbolClick(e){const{smartMappingState:t}=this;(0,n.B)();const{strings:i}=this.smartMappingState,a=(0,g.c)(t,{referenceElement:this.flowItemNode,heading:i.styler.symbolStyle});a.addEventListener("arcgisSmartMappingStylerPopoverClose",(()=>{(0,g.r)(a),setTimeout((()=>{this.symbolNodes[e].focus(),this.popoverNode=void 0,this.symbolNodes[e].classList.remove("selected")}),300)})),a.addEventListener("arcgisSmartMappingStylerPopoverDisconnected",(()=>{(0,g.r)(a),setTimeout((()=>{this.popoverNode=void 0,this.symbolNodes[e].classList.remove("selected")}),300)})),this.smartMappingState.classedSymbolSelectedIdx=e,(0,g.g)(t,{popoverNode:a,onChange:()=>{(0,n.u)(t),(0,s.f)(this.el),this.arcgisSmartMappingClassifyChange.emit({symbolChange:!0})}}),this.popoverNode=a,this.symbolNodes[e].classList.add("selected")}handleValueTextChange(e,t){const{smartMappingState:i}=this,a=t.currentTarget,o=(0,n.j)(i);if(o.classBreakInfos[e].label=a.value,this.labelNodes[e].textContent=a.value,this.inputNodes[e].value=a.value,""===a.value){const t=o.classBreakInfos[e],i=e>0?"> ":"";t.label=`${i} ${t.minValue.toLocaleString()} - ${t.maxValue.toLocaleString()}`,this.labelNodes[e].textContent=t.label,this.inputNodes[e].value=t.label}(0,n.u)(i),(0,s.f)(this.el)}get el(){return(0,s.g)(this)}};M.style=".classify-heading{padding-top:16px}.classify-block-section{border-top:1px solid #e0e0e0;overflow-wrap:anywhere}.block-section-padding{padding-top:6px}.disable-classify{opacity:var(--calcite-opacity-disabled)}.symbol{margin-left:2px;margin-right:2px}.symbol-is-white{background-color:#f0f0f0}.hidden{display:none}.label:focus,.symbol:focus{outline:2px solid var(--calcite-color-brand)}.label,.symbol-container{padding-top:5px;padding-bottom:5px}.selected{outline:1px solid var(--calcite-color-brand)}.method-button-content{padding-top:8px}";const I=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingDefaultSymbolChange=(0,s.c)(this,"arcgisSmartMappingDefaultSymbolChange",7),this.arcgisSmartMappingDefaultSymbolBeforeToggle=(0,s.c)(this,"arcgisSmartMappingDefaultSymbolBeforeToggle",7),this.manager=(0,u.u)(this),this.lastSettings={},this.smartMappingState=(0,r.u)()}async done(){this.lastSettings={},this.blockSectionNode&&(this.blockSectionNode.open=!1,this.blockSectionNode.classList.remove("open"))}componentWillLoad(){this.flowItemNode=(0,a.f)(this.el,"calcite-flow-item")}disconnectedCallback(){clearTimeout(this.labelChangeHandle)}render(){const{smartMappingState:e}=this,{strings:t}=e,i=(0,n.j)(e),a=(0,n.a)(e);let o=t.defaultSymbol.showDefaultSymbol;if("color"===a){(0,n.b)(i,"color")||(o=t.defaultSymbol.showDefaultSymbolClassed)}else if("size"===a){(0,n.b)(i,"size")||(o=t.defaultSymbol.showDefaultSymbolClassed)}const l=i.defaultSymbol;return(0,s.h)("calcite-block-section",{key:"d830800a29428cd104a8db4e9b7945672443533c",text:o,open:!!l,"toggle-display":"switch",onCalciteBlockSectionToggle:e=>{this.arcgisSmartMappingDefaultSymbolBeforeToggle.emit(),this.handleDefaultSymbolToggle(e)},ref:e=>this.blockSectionNode=e},this.renderDefaultSymbolContent())}renderDefaultSymbolContent(){const{smartMappingState:e}=this,t=(0,n.j)(e);let i;return i=t.defaultSymbol?t.defaultSymbol:this.lastSettings.defaultSymbol?this.lastSettings.defaultSymbol:(0,n.m)(e),i?(0,s.h)("div",{class:"symbol-button-content block-section-padding"},(0,s.h)("arcgis-smart-mapping-symbol-button",{symbol:i,type:"default",popoverReferenceElement:this.flowItemNode,onArcgisSmartMappingSymbolButtonSymbolChange:()=>{this.lastSettings.defaultSymbol=t.defaultSymbol,(0,s.f)(this.el)}}),this.renderLabel()):(0,s.h)(s.F,null)}renderLabel(){const{smartMappingState:e}=this,{strings:t}=e,i=(0,n.j)(e).defaultLabel||t.defaultSymbol.other;return(0,s.h)("calcite-label",null,t.defaultSymbol.label,(0,s.h)("calcite-input",{type:"text",value:i,onCalciteInputChange:()=>{clearTimeout(this.labelChangeHandle),this.defaultLabelNode.value?this.handleLabelChange():this.labelChangeHandle=setTimeout((()=>this.handleLabelChange()),3e3)},onFocusout:e=>{e.preventDefault(),e.stopPropagation(),this.handleLabelChange()},onKeyUp:()=>{clearTimeout(this.labelChangeHandle),this.defaultLabelNode.value?this.handleLabelChange():this.labelChangeHandle=setTimeout((()=>this.handleLabelChange()),3e3)},ref:e=>this.defaultLabelNode=e}))}handleDefaultSymbolToggle(e){const{smartMappingState:t}=this,{strings:i}=t,s=(0,n.j)(t);if(e.currentTarget.open)if(this.blockSectionNode.classList.add("open"),this.lastSettings.defaultSymbol)s.defaultSymbol=this.lastSettings.defaultSymbol,s.defaultLabel=this.lastSettings.defaultLabel||i.defaultSymbol.other;else{const e=(0,n.m)(t);s.defaultSymbol=e,s.defaultLabel=s.defaultLabel||i.defaultSymbol.other,this.lastSettings.defaultSymbol=s.defaultSymbol,this.lastSettings.defaultLabel=s.defaultLabel}else this.blockSectionNode.classList.remove("open"),this.lastSettings.defaultSymbol=s.defaultSymbol,this.lastSettings.defaultLabel=s.defaultLabel,s.defaultSymbol=void 0,s.defaultLabel=void 0;(0,n.u)(t),this.arcgisSmartMappingDefaultSymbolChange.emit()}handleLabelChange(){const{smartMappingState:e}=this,{strings:t}=e,i=(0,n.j)(e);this.defaultLabelNode.value?i.defaultLabel=this.defaultLabelNode.value:(i.defaultLabel=t.defaultSymbol.other,this.defaultLabelNode.value=t.defaultSymbol.other),(0,n.u)(e)}get el(){return(0,s.g)(this)}};I.style=".open{border-bottom:1px solid #e0e0e0}.block-section-padding{padding-top:6px}";const N=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingDividedByChange=(0,s.c)(this,"arcgisSmartMappingDividedByChange",7),this.arcgisSmartMappingDividedByError=(0,s.c)(this,"arcgisSmartMappingDividedByError",7),this.manager=(0,u.u)(this),this.smartMappingState=(0,r.u)(),this.rendererSubtype=void 0,this.normalizationField=void 0,this.fieldPos=void 0}componentWillLoad(){this.flowItemNode=(0,a.f)(this.el,"calcite-flow-item")}render(){const{smartMappingState:e}=this,{fields:t,strings:i}=e,a=(0,n.j)(e),o=(0,n.a)(e),l=a.authoringInfo,r=(0,n.b)(a,this.rendererSubtype),d=(0,n.G)(a,"reference-size"),c="relationship"===o||"relationship"===this.rendererSubtype,h=c?0===this.fieldPos?l.field1.field:l.field2.field:r?r.field:a.field,p=c?0===this.fieldPos?l.field1.normalizationField:l.field2.normalizationField:r?r.normalizationField:d?d.normalizationField:a.normalizationField;return(0,s.h)("arcgis-smart-mapping-attribute-input",{key:"f015121ba85cdf99273046ab7045e2c7f8375e0c",fieldList:t.filter((e=>e.layerField.name!==h&&e.simpleFieldType===n.q.NUMBER)),popoverReferenceElement:this.flowItemNode,label:i.transparency.dividedBy,mode:"remove",selectedField:p?{field:p,simpleFieldType:n.q.NUMBER}:void 0,onArcgisSmartMappingAttributeInputChange:e=>{if(e.detail){const t=e.detail;this.normalize(t.field)}else this.normalize(e.detail)}})}normalize(e){const{smartMappingState:t}=this,i=(0,n.j)(t),a=(0,n.a)(t),o=i.authoringInfo,r="univariate-color-size"===o?.type,h="class-breaks-color"===o?.type,p="class-breaks-size"===o?.type,u="relationship"===a||"relationship"===this.rendererSubtype,m=(0,n.G)(i,"reference-size");let g;if(h?g=d.e:p?g=c.k:r?g=S.b:"color"===this.rendererSubtype?(g=d.b,["color-age","color-age-size"].includes(a)&&(g=d.d)):"size"===this.rendererSubtype?(g=c.f,["size-age","color-size-age","type-size-age"].includes(a)&&(g=c.h)):u&&(g=f.a),!g)return;const b={};u?0===this.fieldPos?b.normalizationField1=e:b.normalizationField2=e:b.normalizationField=e,(0,l.r)(g(t,b),this.flowItemNode).then((e=>{if(r||h||p||u){if("relationship-size"===a){e.renderer.backgroundFillSymbol=i.backgroundFillSymbol;const t=(0,n.b)(i,"size"),s=(0,n.G)(i,"size");e.renderer.visualVariables=e.renderer.visualVariables||[],e.renderer.visualVariables.push(t),e.renderer.authoringInfo=e.renderer.authoringInfo||{},e.renderer.authoringInfo.visualVariables=e.renderer.authoringInfo.visualVariables||[],e.renderer.authoringInfo.visualVariables.push(s)}(0,n.u)(t,e.renderer)}else if("color"===this.rendererSubtype)["color-size","color-age-size","color-size-age"].includes(a)?(this.switchOutVisualVariable(e),(0,n.u)(t)):(0,n.u)(t,e.renderer);else if("size"===this.rendererSubtype)if(["color-size","color-age-size","color-size-age","type-size","type-size-age","relationship-size"].includes(a))m?(0,c.l)(t).then((e=>(0,n.u)(t,e)),(e=>this.arcgisSmartMappingDividedByError.emit(e))):(this.switchOutVisualVariable(e),(0,n.u)(t));else if(m){const s=(0,n.G)(e.renderer,"reference-size");i.authoringInfo.visualVariables=(0,n.W)(i,"reference-size")||[],i.authoringInfo.visualVariables.push(s),(0,c.l)(t).then((e=>(0,n.u)(t,e)),(e=>this.arcgisSmartMappingDividedByError.emit(e)))}else(0,n.u)(t,e.renderer);else(0,n.u)(t);(0,s.f)(this.el),this.arcgisSmartMappingDividedByChange.emit()}),(e=>this.arcgisSmartMappingDividedByError.emit(e)))}switchOutVisualVariable(e){const{smartMappingState:t}=this,i=(0,n.j)(t);i.visualVariables=(0,n.V)(i,this.rendererSubtype)||[];const s=(0,n.b)(e.renderer,this.rendererSubtype);i.visualVariables.push(s),i.authoringInfo.visualVariables=(0,n.W)(i,this.rendererSubtype)||[];const a=(0,n.G)(e.renderer,this.rendererSubtype);a&&i.authoringInfo.visualVariables.push(a),(0,n._)(t,i)}get el(){return(0,s.g)(this)}},C=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingInfoPopoverClose=(0,s.c)(this,"arcgisSmartMappingInfoPopoverClose",7),this.arcgisSmartMappingInfoPopoverDisconnected=(0,s.c)(this,"arcgisSmartMappingInfoPopoverDisconnected",7),this.manager=(0,u.u)(this),this.onOpen=()=>{requestAnimationFrame((async()=>await(this.panelNode?.setFocus())))},this.props=void 0,this.referenceElement=void 0,this.open=!1,this.smartMappingState=void 0}async reposition(){await(this.popoverNode?.reposition())}async setFocus(){await(this.panelNode?.setFocus())}async setOpen(e){this.popoverNode&&(this.popoverNode.open=e,e&&(await(this.panelNode?.setFocus()),await this.popoverNode.reposition()))}disconnectedCallback(){this.arcgisSmartMappingInfoPopoverDisconnected.emit()}render(){const{props:e,referenceElement:t,open:i}=this,{title:a,moreInfo:n,helpId:o}=e,{config:l,strings:r}=this.smartMappingState,{helpBase:d,helpMap:c}=l,h=r.tile.info.title.replace("${title}",a);return(0,s.h)(s.H,{key:"aacb193ec5935d453ed75059331061bc1ba28e5b",class:"js-app-flyout arcgis-smart-mapping-popover"},(0,s.h)("calcite-popover",{key:"d5b72ce23d51e4d841886452ecbb2ac88f18763d",open:i,placement:"auto",offsetSkidding:5,label:"",overlayPositioning:"fixed",referenceElement:t,onCalcitePopoverOpen:this.onOpen,ref:e=>this.popoverNode=e},(0,s.h)("calcite-panel",{key:"028435fe163face66f6d6ae29d97eee9f5e845b7",class:"info-panel",heading:h,closable:!0,ref:e=>this.panelNode=e,onCalcitePanelClose:()=>{this.arcgisSmartMappingInfoPopoverClose.emit(),setTimeout((()=>t.parentElement.focus()),300)}},(0,s.h)("div",{key:"b2a54a81821dcf84882222885ca2af43e735686e",class:"info"},(0,s.h)("div",{key:"303fd7a600b1afda63f3892a0878eb606287842d"},n),o&&c?(0,s.h)("div",{class:"info-help"},(0,s.h)("calcite-button",{appearance:"solid",label:r.tile.info.learnMore,class:"info-help-button",slot:"footer",onClick:()=>window.open(`${d}${c[o]}`,"_blank")},r.tile.info.learnMore)):null))))}get el(){return(0,s.g)(this)}};C.style=".info{padding:10px;background-color:white}.info-panel{max-width:320px}.info-help{padding-top:10px;justify-content:flex-end;display:flex}.info-help-button{display:flex;flex-flow:row-reverse}";const w=class{constructor(e){(0,s.r)(this,e),this.smartMappingCompleteClose=(0,s.c)(this,"smartMappingCompleteClose",7),this.arcgisSmartMappingPanelsSizeClose=(0,s.c)(this,"arcgisSmartMappingPanelsSizeClose",7),this.arcgisSmartMappingPanelsSizeBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsSizeBackClick",7),this.arcgisSmartMappingPanelsSizeError=(0,s.c)(this,"arcgisSmartMappingPanelsSizeError",7),this.arcgisSmartMappingAuthRefSizeVisVarChange=(0,s.c)(this,"arcgisSmartMappingAuthRefSizeVisVarChange",7),this.manager=(0,u.u)(this),this.smartMappingState=(0,r.u)(),this.handleDone=()=>{this.arcgisSmartMappingPanelsSizeClose.emit("save")},this.handleCancel=()=>{const{originalRenderer:e,originalFeatureReduction:t,smartMappingState:i}=this;(0,n.h)(i,e,t),this.arcgisSmartMappingPanelsSizeClose.emit("cancel")},this.hideTransparency=!1,this.hideRotation=!1,this.menuOpen=!1,this.showBackButton=!1,this.selected=!1,this.beforeBack=void 0,this.visualizationOpen=!1}async setFocus(){await(this.flowItemNode?.setFocus())}async componentWillLoad(){this.visualizationOpen=!0;const{layer:e,modules:t}=this.smartMappingState,i=(0,n.j)(this.smartMappingState);this.originalRenderer=i.toJSON(),this.originalFeatureReduction="featureReduction"in e&&e.featureReduction?t.esriLang.clone(e.featureReduction):void 0}componentDidLoad(){requestAnimationFrame((async()=>await(this.flowItemNode?.setFocus()))),this.scaleHandle=(0,S.w)(this.smartMappingState,this.flowItemNode,(()=>this.smartMappingCompleteClose.emit("cancel")));const e=(0,n.j)(this.smartMappingState);(0,n.G)(e,"reference-size")&&(this.referenceSizeScaleHandle=this.getReferenceSizeScaleHandle())}disconnectedCallback(){this.scaleHandle?.remove(),this.referenceSizeScaleHandle?.remove()}render(){const{layer:e,hideLayerTitle:t,strings:i}=this.smartMappingState;return(0,s.h)(s.H,{key:"396883c14faae2717564b06f83ba13a49b30e8f5",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"3d32553c5f34fcb3c69048d02b426d82828b3d88",heading:i.panels.styleOptions,description:t?void 0:e.title,class:"flow-item",closable:(0,n.C)(this.el),showBackButton:this.showBackButton,selected:this.selected,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:e=>{e.stopPropagation(),this.arcgisSmartMappingPanelsSizeBackClick.emit()},ref:e=>this.flowItemNode=e},this.renderDoneButton(),this.renderCancelButton(),this.renderVisualization(),this.renderTransparency(),this.renderRotation()))}renderDoneButton(){const{layer:e,strings:t}=this.smartMappingState;return e?(0,s.h)("calcite-button",{slot:"footer",label:t.done,onClick:this.handleDone,appearance:"solid",width:"half"},t.done):(0,s.h)(s.F,null)}renderCancelButton(){const{layer:e,strings:t}=this.smartMappingState;return e?(0,s.h)("calcite-button",{slot:"footer",label:t.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},t.cancel):(0,s.h)(s.F,null)}renderVisualization(){const{visualizationOpen:e,hideTransparency:t,hideRotation:i,smartMappingState:a}=this,{strings:o}=a,l=(0,n.a)(a),r=(0,n.j)(a),d=["size-age","color-size-age","type-size-age"].includes(l),c=["chart-size","predominance-size"].includes(l),h=(0,n.b)(r,"size"),p=(0,n.G)(r,"reference-size"),u=h?h.field?(0,n.o)(a,h.field)?.label:h.valueExpressionTitle||o.expression:p?p.field:r.field?(0,n.o)(a,r.field)?.label:r.valueExpressionTitle||o.expression,m=(0,n.o)(a,h?.field||r.field),g=m?.simpleFieldType===n.q.DATE,f="chart-size"===l;return(0,s.h)("calcite-block",{class:"size-block",key:"size-visualization",heading:d?o.panels.size.sizeAgeStyle:g?o.panels.size.sizeStyleDate:f?o.panels.size.sizeStyleChart:o.panels.size.sizeStyle,collapsible:!t||!i,open:e,onCalciteBlockOpen:()=>this.visualizationOpen=!0,onCalciteBlockClose:()=>this.visualizationOpen=!1},(0,s.h)("div",null,d||c?null:(0,s.h)("calcite-label",{class:"attribute-name"},u),this.renderAge(),this.renderTheme(),this.renderDividedBy(),this.renderReferenceSizeButton(),this.renderSymbol(),this.renderSizeSlider(),this.renderSizeRange(),this.renderBackgroundStyle(),this.renderDefaultSymbol(),this.renderShowInLegend(),this.renderClassify()))}renderAge(){const{smartMappingState:e}=this,t=(0,n.a)(e);return["size-age","color-size-age"].includes(t)?(0,s.h)("arcgis-smart-mapping-age",{rendererSubtype:"size",onArcgisSmartMappingAgeChange:()=>{this.sliderNode.updateStatistics()},onArcgisSmartMappingAgeError:e=>this.arcgisSmartMappingPanelsSizeError.emit(e.detail)}):(0,s.h)(s.F,null)}renderTheme(){const{smartMappingState:e}=this,t=(0,n.j)(e),i=(0,n.b)(t,"size"),a=(0,n.G)(t,"reference-size");if(!i&&!a)return(0,s.h)(s.F,null);const o=(0,n.a)(e);return["chart-size","predominance-size"].includes(o)?(0,s.h)(s.F,null):(0,s.h)("arcgis-smart-mapping-theme-button",{ref:e=>this.themeButtonNode=e,rendererSubtype:"size",onArcgisSmartMappingThemeButtonBeforeOpen:()=>(0,n.B)(),onArcgisSmartMappingThemeButtonChange:t=>{const{layer:r,mapView:d}=this.smartMappingState,h=(0,n.M)(a),p="reference-size"===t.detail,u=!h&&p||h&&!p;let m=c.f;["size-age","color-size-age"].includes(o)?m=c.h:u&&(m=c.f);const g={theme:t.detail,discardMinMax:!0};p&&(g.referenceSizeOptions={symbolStyle:"circle"}),u&&(g.layer=r,g.mapView=d,g.fieldInfos=[{field:i?i.field:a.field}],g.noReuse=!0),(0,l.r)(m(e,g),this.flowItemNode).then((async t=>{if(u)if(["type-size","relationship-size"].includes(o)){const{modules:i}=this.smartMappingState,s=(0,n.j)(e);s.visualVariables=t.renderer.visualVariables,s.authoringInfo.visualVariables=t.renderer.authoringInfo.visualVariables,s.uniqueValueInfos.forEach((s=>{const a=(0,n.Z)(e,s?.symbol)||new i.EsriColor("gray"),o=t.renderer.classBreakInfos[0].symbol.clone();"cim"===o.type?i.cimSymbolUtils.applyCIMSymbolColor(o,a,{layersToColor:"fill-and-outline"}):(0,n.X)(e,o,a),s.symbol=o})),s.defaultSymbol=void 0,s.defaultLabel=void 0,s.backgroundFillSymbol=void 0,(0,n.u)(e,s)}else if("color-size"===o){const{modules:i,useFeatureReduction:s}=this.smartMappingState,a=(0,n.j)(e),o=(0,n.b)(a,"color"),l=(0,n.G)(a,"color"),{renderer:c}=await i.ColorCreator.createContinuousRenderer({layer:r,view:d,field:o.field,valueExpression:o.valueExpression??void 0,valueExpressionTitle:o.valueExpressionTitle??void 0,normalizationField:o.normalizationField??void 0,theme:l?.theme,colorScheme:(0,n.Y)(e),forBinning:"binning"===r.featureReduction?.type&&s});if(t.renderer.visualVariables.push(o),c.authoringInfo?.visualVariables?.length){const e=(0,n.G)(c,"color");t.renderer.authoringInfo.visualVariables.push(e)}t.renderer.field=o.field,t.renderer.valueExpression=o.valueExpression,t.renderer.valueExpressionTitle=o.valueExpressionTitle,t.renderer.normalizationField=o.normalizationField,(0,n.u)(e,t.renderer)}else(0,n.u)(e,t.renderer);else{const i=(0,n.j)(e);i.visualVariables=(0,n.V)(i,"size")||[],i.visualVariables.push((0,n.b)(t.renderer,"size")),i.authoringInfo.visualVariables=(0,n.W)(i,"size")||[],i.authoringInfo.visualVariables.push((0,n.G)(t.renderer,"size")),(0,n.u)(e)}(0,s.f)(this.el),this.themeButtonNode&&(0,s.f)(this.themeButtonNode),this.sliderNode&&(0,s.f)(this.sliderNode),this.sizeRangeNode&&(0,s.f)(this.sizeRangeNode),this.backgroundSymbolNode&&(0,s.f)(this.backgroundSymbolNode),!h&&p&&this.defaultSymbolNode.done()}),(e=>{(0,s.f)(this.themeButtonNode),this.arcgisSmartMappingPanelsSizeError.emit(e)}))}})}renderDividedBy(){const{smartMappingState:e}=this,{fields:t}=e,i=(0,n.j)(e),a=(0,n.a)(e);if(["size-age","color-size-age"].includes(a))return(0,s.h)(s.F,null);if((0,n.F)(e,t).number<2)return(0,s.h)(s.F,null);const o=(0,n.b)(i,"size");if(o){const t=(0,n.o)(e,o.field),i={field:o.field,expression:o.valueExpression,expressionTitle:o.valueExpressionTitle,simpleFieldType:t?t.simpleFieldType:n.q.NUMBER};if(i.expression||i.simpleFieldType!==n.q.NUMBER)return(0,s.h)(s.F,null)}else if(i.valueExpression)return(0,s.h)(s.F,null);return(0,s.h)("arcgis-smart-mapping-divided-by",{rendererSubtype:"size",normalizationField:(o?o.normalizationField:i.normalizationField)??void 0,onArcgisSmartMappingDividedByChange:()=>{(0,s.f)(this.el),(0,s.f)(this.sliderNode),this.sliderNode.updateStatistics(),this.sizeRangeNode&&(0,s.f)(this.sizeRangeNode),this.classifyNode&&(0,s.f)(this.classifyNode)},onArcgisSmartMappingDividedByError:e=>this.arcgisSmartMappingPanelsSizeError.emit(e.detail)})}renderReferenceSizeButton(){const{smartMappingState:e}=this,t=(0,n.j)(e);return(0,n.G)(t,"reference-size")?(0,s.h)("arcgis-smart-mapping-symbol-pair-button",{symbolType:"reference-size",onArcgisSmartMappingSymbolPairButtonBeforeOpen:()=>(0,n.B)(),onArcgisSmartMappingSymbolPairButtonChange:()=>{(0,s.f)(this.el),(0,s.f)(this.symbolPairButtonNode),this.sliderNode&&(0,s.f)(this.sliderNode),this.rotationNode&&(0,s.f)(this.rotationNode),this.symbolButtonNode&&(0,s.f)(this.symbolButtonNode),this.sizeRangeNode&&(0,s.f)(this.sizeRangeNode)},onArcgisSmartMappingSymbolPairButtonError:e=>this.arcgisSmartMappingPanelsSizeError.emit(e.detail),ref:e=>{e&&(this.symbolPairButtonNode=e)}}):(0,s.h)(s.F,null)}renderSymbol(){const{smartMappingState:e}=this,t=(0,n.j)(e),i=(0,n.a)(e),a=(0,n.G)(t,"reference-size");if("pie-chart"===t.type||["type-size","color-size","relationship-size"].includes(i)&&a)return(0,s.h)(s.F,null);const o=this.getSymbol();return(0,s.h)("arcgis-smart-mapping-symbol-button",{symbol:o,type:"size",isReferenceSize:(0,n.M)(a),ref:e=>{e&&(this.symbolButtonNode=e)},onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,s.f)(this.el),this.sliderNode&&(0,s.f)(this.sliderNode),this.classifyNode&&(0,s.f)(this.classifyNode),this.rotationNode&&(0,s.f)(this.rotationNode)}})}renderSizeSlider(){return(0,s.h)("arcgis-smart-mapping-size-slider",{ref:e=>{e&&(this.sliderNode=e)},onArcgisSmartMappingSizeSliderChange:()=>{(0,s.f)(this.el),this.sliderNode&&(0,s.f)(this.sliderNode),this.sizeRangeNode&&(0,s.f)(this.sizeRangeNode),this.classifyNode&&(0,s.f)(this.classifyNode)},onArcgisSmartMappingSizeSliderError:e=>this.arcgisSmartMappingPanelsSizeError.emit(e.detail)})}renderSizeRange(){return(0,s.h)("arcgis-smart-mapping-size-range-slider",{onArcgisSmartMappingSizeRangeSliderError:e=>this.arcgisSmartMappingPanelsSizeError.emit(e.detail),ref:e=>{e&&(this.sizeRangeNode=e)}})}renderBackgroundStyle(){const{smartMappingState:e}=this,{mapImageSublayer:t}=e,i=(0,n.a)(e);return t&&["predominance-size","type-size","relationship-size"].includes(i)?(0,s.h)(s.F,null):(0,s.h)("arcgis-smart-mapping-background-symbol",{ref:e=>{e&&(this.backgroundSymbolNode=e)}})}renderDefaultSymbol(){const{smartMappingState:e}=this,t=(0,n.a)(e);return["chart","chart-size"].includes(t)?(0,s.h)(s.F,null):(0,s.h)("arcgis-smart-mapping-default-symbol",{ref:e=>{e&&(this.defaultSymbolNode=e)},onArcgisSmartMappingDefaultSymbolBeforeToggle:()=>(0,n.B)(),onArcgisSmartMappingDefaultSymbolChange:()=>{this.symbolButtonNode&&(0,s.f)(this.symbolButtonNode)}})}renderShowInLegend(){const{smartMappingState:e}=this,{strings:t}=e,i=(0,n.j)(e),a=(0,n.b)(i,"size");if(!a)return(0,s.h)(s.F,null);const o=a.legendOptions,l=!o||!1!==o.showLegend;return(0,s.h)("calcite-label",{layout:"inline-space-between",class:"legend-toggle-padding"},t.panels.size.includeInLegend,(0,s.h)("calcite-switch",{scale:"s",checked:l,onCalciteSwitchChange:()=>this.handleIncludeInLegendToggle()}))}renderClassify(){const{smartMappingState:e}=this,t=(0,n.j)(e),i=(0,n.a)(e),a=this.getFieldInfo().simpleFieldType===n.q.DATE,o=["size-age","color-size-age","type-size-age"].includes(i),l=(0,n.G)(t,"reference-size");return"size"!==i||a||o||l?(0,s.h)(s.F,null):(0,s.h)("arcgis-smart-mapping-classify",{ref:e=>this.classifyNode=e,onArcgisSmartMappingClassifyChange:e=>{const t=e.detail;(t?.closePopovers||t?.classesChange)&&(0,n.B)(),(0,s.f)(this.el),this.sliderNode&&(0,s.f)(this.sliderNode),(t?.toggle||t?.classesChange||!t?.symbolChange&&!t?.closePopovers)&&(this.sizeRangeNode&&(0,s.f)(this.sizeRangeNode),this.sliderNode.updateStatistics()),this.classifyNode&&(0,s.f)(this.classifyNode),this.symbolButtonNode&&(0,s.f)(this.symbolButtonNode),this.defaultSymbolNode&&(0,s.f)(this.defaultSymbolNode),this.rotationNode&&(0,s.f)(this.rotationNode)},onArcgisSmartMappingClassifyError:e=>this.arcgisSmartMappingPanelsSizeError.emit(e.detail)})}renderTransparency(){const{hideTransparency:e,smartMappingState:t}=this;if(e)return(0,s.h)(s.F,null);const i=(0,n.j)(t),a=(0,n.b)(i,"opacity");return(0,s.h)("arcgis-smart-mapping-transparency",{open:!!a,onArcgisSmartMappingSymbolTransparencyError:({detail:e})=>this.arcgisSmartMappingPanelsSizeError.emit(e)})}renderRotation(){const{hideRotation:e,smartMappingState:t}=this;if(e)return(0,s.h)(s.F,null);const i=(0,n.j)(t),a=(0,n.b)(i,"opacity"),o=(0,n.b)(i,"rotation");return(0,s.h)("arcgis-smart-mapping-rotation",{open:!a&&!!o,ref:e=>this.rotationNode=e,onArcgisSmartMappingRotationError:({detail:e})=>this.arcgisSmartMappingPanelsSizeError.emit(e)})}getSymbol(){const{smartMappingState:e}=this,{modules:t}=e,i=((0,n.j)(e).type,(0,n.j)(e)),s="class-breaks"===(0,n.j)(e).type?i.classBreakInfos:i.uniqueValueInfos,a=(0,n.a)(e);let o;return["color-size","color-age-size","color-size-age","type-size","type-size-age","predominance-size","relationship-size"].includes(a)?(o=s.length?s[0].symbol.clone():(0,n.m)(e,a),(0,n.X)(e,o,new t.EsriColor({r:149,g:149,b:149,a:1}))):o=s.length?s[s.length-1].symbol.clone():(0,n.m)(e,a),o}handleIncludeInLegendToggle(){const{smartMappingState:e}=this,t=(0,n.j)(e),i=(0,n.b)(t,"size"),s=i.legendOptions;s&&!1===s.showLegend?s.title?s.showLegend=!0:i.legendOptions=void 0:(i.legendOptions=s||{},i.legendOptions.showLegend=!1),(0,n.u)(e)}getFieldInfo(){const{smartMappingState:e}=this,t=(0,n.a)(e),i=(0,n.f)(e);return["color-size","color-age-size","color-size-age","type-size","type-size-age"].includes(t)&&i.length>1?i[1]:"relationship-size"===t?i[2]:i[0]}getReferenceSizeScaleHandle(){const{smartMappingState:e}=this,{mapView:t}=e;let i=t.scale;return t.watch("scale",(0,p.d)((t=>{const s=(0,n.j)(e),a=(0,n.G)(s,"reference-size"),o=i/t;i=t,a?.referenceSizeScale&&(a.referenceSizeScale=t,a.sizeStops.forEach((e=>e.size*=o)),this.arcgisSmartMappingAuthRefSizeVisVarChange.emit(o))}),300))}get el(){return(0,s.g)(this)}};w.style=":host{width:100%;display:none}:host([selected]){display:flex}.flow-item{height:100%}.size-block{overflow-x:hidden}.attribute-name{word-break:break-all}.legend-toggle-padding{padding-top:12px;padding-bottom:12px}";const k=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingSizeRangeSliderError=(0,s.c)(this,"arcgisSmartMappingSizeRangeSliderError",7),this.manager=(0,u.u)(this),this.smartMappingState=(0,r.u)()}arcgisSmartMappingAuthRefSizeVisVarChangeHandler({detail:e}){const t=this.rangeSliderNode.values,i=Math.min(...t)*e,s=Math.max(...t)*e;this.rangeSliderNode.values=[i,s],this.minRangeNode.value=`${Math.round(this.rangeSliderNode.values[0])}`,this.maxRangeNode.value=`${Math.round(this.rangeSliderNode.values[1])}`}componentDidLoad(){(0,z.i)(this.el.shadowRoot,this.smartMappingState.modules.esriConfig),this.flowItemNode=(0,a.f)(this.el,"calcite-flow-item")}disconnectedCallback(){clearTimeout(this.minWatchHandle),clearTimeout(this.maxWatchHandle),this.scaleWatchHandle?.remove()}render(){const{smartMappingState:e}=this,{mapImageSublayer:t,modules:i,strings:a}=e,o=(0,n.j)(e),l=o.authoringInfo,r=(0,n.b)(o,"size"),d=(0,n.G)(o,"reference-size"),c="above-and-below"===l?.univariateTheme,h=!!r&&!(0,n.M)(r.minSize),p=!!r&&"number"==typeof r.minSize,u=!h&&!p;let[m,g]=(0,b.a)(e);if([m,g]=[Math.round(m/.75),Math.round(g/.75)],m>g&&([m,g]=[g,m]),this.rangeSliderNode){if(m!==this.rangeSliderNode.values[0]||g!==this.rangeSliderNode.values[1]||!(0,n.M)(this.rangeSliderNode.values[1])){const e={min:Math.max(0,Math.min(1,m-10)),max:Math.min(g+10,d?Number.POSITIVE_INFINITY:100),values:m===g?[m]:[m,g]};this.minRangeNode.value=`${m}`,this.maxRangeNode.value=`${g}`,this.rangeSliderNode.set(e)}}else{const e={min:Math.max(1,Math.min(1,m-10)),max:Math.min(g+10,d?Number.POSITIVE_INFINITY:100),values:m===g?[m]:[m,g],visibleElements:{labels:!0},precision:0,labelInputsEnabled:!0,labelFormatFunction:e=>e.toFixed(0)};this.rangeSliderNode=new i.Slider(e)}return(0,s.h)(s.H,{key:"a5654648372dcee6f6358596f872c04c1ec95210"},(0,s.h)("div",{key:"ead939556c8e95c0beea428b7485ec4cfb4a2257",class:"size-range-block"},(0,s.h)("calcite-label",{key:"d3b6bcc4dd05eaf8556a867bb1eae28af3ed50d1"},a.sizeRangeSlider.sizeRange),(0,s.h)("div",{key:"5755dc317ef0ca7a3b7a6afcc9940d91dc3d01d8",class:"range-slider range-slider-bottom-label",ref:e=>{e&&this.afterSizeRangeCreate(e)}}),(0,s.h)("div",{key:"6197d15866e6cb3264d7003aab085e12a280c33f",dir:"ltr",class:"size-range"},(0,s.h)("div",{key:"9d54ecd80485d194d0979e091e0f69d915c34790",class:"size-range-item"},(0,s.h)("calcite-input-number",{key:"2a3076449b4ef5bb6ae6db660f10265f8dd69d89",value:`${m}`,min:1,max:d?void 0:100,step:1,scale:"s",suffixText:a.sizeRangeSlider.px,ref:e=>{e&&(this.minRangeNode=e)},onCalciteInputNumberInput:()=>{clearTimeout(this.minWatchHandle);const e=this.rangeSliderNode.values,t=Number.parseInt(this.minRangeNode.value);if(this.minRangeNode.value&&t>=this.minRangeNode.min&&(!e[1]||t<e[1])){const i=Math.min(t,100);this.minRangeNode.value=`${i}`,e[1]||(this.maxRangeNode.value=`${i}`);const s=e[1]?[.75*i,.75*e[1]]:[.75*i];this.rangeSliderNode.values=e[1]?[Number.parseInt(this.minRangeNode.value),e[1]]:[Number.parseInt(this.minRangeNode.value)],this.handleSizeRangeValuesChange(s)}else this.minWatchHandle=setTimeout((()=>{const t=this.rangeSliderNode.values;this.minRangeNode.value=`${t[0]}`,e[1]||(this.maxRangeNode.value=`${t[0]}`);const i=t[1]?[.75*t[0],.75*t[1]]:[.75*t[0]];this.handleSizeRangeValuesChange(i)}),3e3)},label:a.sizeRangeSlider.min})),(0,s.h)("div",{key:"70bc90d3465e9e7974f3d8c8a68c3272fcb48f22",class:"size-range-item"},(0,s.h)("calcite-input-number",{key:"7d4b1cc09ac825e467daf32bdd420f71013dffd6",value:`${g}`,min:1,max:d?void 0:100,step:1,scale:"s",suffixText:a.sizeRangeSlider.px,ref:e=>{e&&(this.maxRangeNode=e)},onCalciteInputNumberInput:()=>{clearTimeout(this.maxWatchHandle);const e=this.rangeSliderNode.values,t=Number.parseInt(this.maxRangeNode.value);if(this.maxRangeNode.value&&(!e[1]||t>e[0])&&(t<101||d)){const i=d?t:Math.min(t,100);this.maxRangeNode.value=`${i}`,e[1]||(this.minRangeNode.value=`${i}`);const s=e[1]?[.75*e[0],.75*i]:[.75*i];this.rangeSliderNode.values=e[1]?[e[0],Number.parseInt(this.maxRangeNode.value)]:[Number.parseInt(this.maxRangeNode.value)],this.handleSizeRangeValuesChange(s)}else this.maxWatchHandle=setTimeout((()=>{const e=this.rangeSliderNode.values;this.maxRangeNode.value=`${e[1]??e[0]}`,e[1]||(this.minRangeNode.value=`${e[0]}`);const t=e[1]?[.75*e[0],.75*e[1]]:[.75*e[0]];this.handleSizeRangeValuesChange(t)}),3e3)},label:a.sizeRangeSlider.min}))),r&&!c&&!t&&(0,s.h)("calcite-label",{key:"11558adf33d1a83a113d9e81b1e388783827a3ac",scale:"s",layout:"inline",class:"size-range-bottom-border"},(0,s.h)("calcite-checkbox",{key:"3431bcb85bbd11b57b77d6d101e26f7889ddea2c",scale:"s",checked:u,onCalciteCheckboxChange:e=>{this.handleSizeRangeChange(e.target.checked?"automatic":"fixed")},ref:e=>this.adjustSizeNode=e}),a.sizeRangeSlider.adjustSizeAutomatically),d&&this.renderRegenerate()))}renderRegenerate(){const{strings:e}=this.smartMappingState;return(0,s.h)("div",{class:"top-bottom-margin-small"},(0,s.h)("calcite-button",{appearance:"outline-fill",kind:"neutral",width:"full",onClick:()=>{this.handleSizeRangeChange("automatic")},label:e.sizeRangeSlider.regenerate},e.sizeRangeSlider.regenerate))}async handleSizeRangeValuesChange(e){const{smartMappingState:t}=this,i=(0,n.j)(t),s=(0,n.b)(i,"size"),a=i.classBreakInfos,o=(0,n.G)(i,"reference-size");if(o){o.sizeStops[0].size=e[0],o.sizeStops[1].size=e[1];const i=await(0,c.l)(t);return void(0,n.u)(t,i)}const l=s?s.minSize/.75:a[0].symbol.size/.75,r=s?s.maxSize/.75:a[a.length-1].symbol.size/.75,d=e[0]/.75,h=e[1]?e[1]/.75:e[0]/.75;l===d&&r===h||((0,b.b)(t,e),e.length>1&&(this.maxRangeNode.min=d+this.maxRangeNode.step,this.minRangeNode.max=h-this.minRangeNode.step),(0,n.u)(t))}afterSizeRangeCreate(e){if(this.rangeSliderNode.container)e.append(this.rangeSliderNode.container);else{const t=document.createElement("div");e.append(t),this.rangeSliderNode.container=t,this.createRangeSliderChangeEvents()}}createRangeSliderChangeEvents(){const{smartMappingState:e}=this,{mapView:t}=e;this.rangeSliderNode&&(this.rangeSliderNode.on("thumb-change",(e=>{const t=this.rangeSliderNode.values;0===e.index?t[1]&&t[0]>=t[1]&&(t[0]=e.oldValue):1===e.index&&t[1]<=t[0]&&(t[1]=e.oldValue),this.minRangeNode.value=`${Math.round(t[0])}`,this.maxRangeNode.value=`${Math.round(t[1])??Math.round(t[0])}`;const i=t[1]?[.75*t[0],.75*t[1]]:[.75*t[0]];this.handleSizeRangeValuesChange(i)})),this.rangeSliderNode.on("thumb-drag",(t=>{const i=(0,n.j)(e);if((0,n.G)(i,"reference-size")&&["start","drag"].includes(t.state))return;const s=this.rangeSliderNode.values;if(0===t.index){if(s[1]&&s[0]>=s[1])return void(s[0]-=1)}else if(1===t.index&&s[1]<=s[0])return void(s[1]+=1);this.minRangeNode.value=`${Math.round(s[0])}`,this.maxRangeNode.value=`${Math.round(s[1])??Math.round(s[0])}`;const a=s[1]?[.75*s[0],.75*s[1]]:[.75*s[0]];this.handleSizeRangeValuesChange(a)})),this.rangeSliderNode.on("segment-drag",(()=>{const e=this.rangeSliderNode.values;this.minRangeNode.value=`${Math.round(e[0])}`,this.maxRangeNode.value=`${Math.round(e[1])??Math.round(e[0])}`;const t=e[1]?[.75*e[0],.75*e[1]]:[.75*e[0]];this.handleSizeRangeValuesChange(t)})),this.scaleWatchHandle=t.watch("scale",(()=>{const t=(0,n.j)(e);if((0,n.b)(t,"size")){let[t,i]=(0,b.a)(e);[t,i]=[Math.round(t/.75),Math.round(i/.75)],t>i&&([t,i]=[i,t]),this.rangeSliderNode?.set({values:t===i?[t]:[t,i],min:Math.max(1,Math.min(1,t-10)),max:Math.min(i+10,100)}),this.minRangeNode.value=`${Math.round(this.rangeSliderNode.values[0])}`,this.maxRangeNode.value=Math.round(this.rangeSliderNode.values[1])?.toString()??Math.round(this.rangeSliderNode.values[0]).toString()}})))}async handleSizeRangeChange(e){const{smartMappingState:t}=this,i=(0,n.j)(t),a=(0,n.b)(i,"size"),o=(0,n.G)(i,"reference-size");if("fixed"===e){if(!a.minSize.stops)return;[a.minSize,a.maxSize]=(0,b.a)(t),(0,n.u)(t),(0,s.f)(this.el)}else{const e=(0,n.a)(t);let i=c.f;"predominance-size"===e?i=y.a:"chart-size"===e?i=S.d:["size-age","color-size-age","type-size-age"].includes(e)&&(i=c.h),(0,l.r)(i(t,{sizeOptimizationEnabled:!0}),this.flowItemNode).then((async e=>{if(o){const i=(0,n.G)(e.renderer,"reference-size");o.sizeStops.forEach(((e,t)=>e.size=i.sizeStops[t].size));const s=await(0,c.l)(t,{sizeOptimizationEnabled:!0,sizeStops:o.sizeStops});(0,n.u)(t,s)}else(0,n.u)(t,e.renderer);(0,s.f)(this.el)}),(e=>{this.adjustSizeNode&&(this.adjustSizeNode.checked=!1),this.arcgisSmartMappingSizeRangeSliderError.emit(e)}))}}get el(){return(0,s.g)(this)}};k.style=".size-range-block{border-bottom:1px solid #e0e0e0}.range-slider{height:40px;background-color:transparent;position:relative;width:95%;margin:15px auto 0 auto}.size-range{display:flex;justify-content:space-between;margin-bottom:15px}.size-range-item{width:48%;display:flex;flex-flow:column;justify-content:space-between}.esri-slider__label{text-decoration:underline}.esri-slider__label:hover{border:1px solid #bbb;background-color:#f3f3f3;text-decoration:none;z-index:1}.top-bottom-margin-small{margin:10px 0}";const T=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingSizeSliderChange=(0,s.c)(this,"arcgisSmartMappingSizeSliderChange",7),this.arcgisSmartMappingSizeSliderError=(0,s.c)(this,"arcgisSmartMappingSizeSliderError",7),this.manager=(0,u.u)(this),this.currentStopValues=[],this.currentBreakValues=[],this.zigzagClick=!1,this.styleSheetStatus="not-loaded",this.smartMappingState=(0,r.u)(),this.histogramStatus=n.s.MISSING,this.statisticsStatus=n.s.MISSING,this.sliderZoomed=!1}arcgisSmartMappingAuthRefSizeVisVarChangeHandler(){const{smartMappingState:e}=this,t=(0,n.j)(e),i=(0,n.G)(t,"reference-size");i?.referenceSizeScale&&(this.currentStopValues=[i.sizeStops[0].value,i.sizeStops[1].value],this.sizeSlider.stops.forEach(((e,t)=>e.size=i.sizeStops[t].size)))}async updateStatistics(){this.statisticsStatus=n.s.MISSING,this.statistics=void 0,this.histogramStatus=n.s.MISSING,this.histogram=void 0,this.sizeSlider?.destroy(),this.sizeSlider=void 0,this.sliderZoomed=!1,this.getStatistics()}componentWillLoad(){this.getStatistics()}componentDidLoad(){this.flowItemNode=(0,a.f)(this.el,"calcite-flow-item")}disconnectedCallback(){this.scaleHandle?.remove()}render(){const{config:e}=this.smartMappingState;return(0,s.h)(s.H,{key:"e6359942d686d0d4505aade9d45de0acbbf6e5da"},(0,s.h)("link",{key:"c367688a6de0d2e7b3f71a40c5e24dbc1cf6e727",rel:"stylesheet",href:`${e.jsapiUrl}/themes/light/main.css`,onLoad:()=>{this.styleSheetStatus="loaded",(0,s.f)(this.el)},onError:()=>{this.styleSheetStatus="failed",(0,s.f)(this.el)}}),"loaded"===this.styleSheetStatus?this.renderSizeSlider():"not-loaded"===this.styleSheetStatus?this.renderSizeSliderLoading():null)}renderSizeSlider(){const{statisticsStatus:e,histogramStatus:t,sliderZoomed:i,smartMappingState:a}=this,{strings:o}=a,l=(0,n.j)(a),r=(0,n.b)(l,"size"),d=(0,n.G)(l,"reference-size");if(e===n.s.FAILED||e===n.s.MISSING||r?.stops&&1===r.stops.length||!r&&!d&&1===l.classBreakInfos.length)return this.sizeSlider&&(this.sizeSlider.destroy(),this.sizeSlider=void 0),(0,s.h)(s.F,null);if(e===n.s.IN_PROGRESS||t===n.s.IN_PROGRESS&&!this.sizeSlider)return this.renderSizeSliderLoading();{const e=this.prepareSizeSlider();let t=!1;if((r||d)&&!i){const e=(0,n.G)(l,"size"),i=(0,n.aI)(this.getZoomStops(),e?e?.minSliderValue:d?.minSliderValue,e?e?.maxSliderValue:d?.maxSliderValue);(i?.minMaxSame||!(0,n.M)(i?.min)&&!(0,n.M)(i?.max))&&(t=!0,this.zoomButtonNode&&(this.zoomButtonNode.disabled=!0))}return r?this.currentStopValues=[r.minDataValue,r.maxDataValue]:d?this.currentStopValues=[d.sizeStops[0].value,d.sizeStops[1].value]:this.currentBreakValues=l.classBreakInfos.map((e=>({min:e.minValue,max:e.maxValue}))),(e||this.sizeSlider)&&this.sizeSlider.min!==this.sizeSlider.max?(0,s.h)("div",{class:"slider-box"},(0,s.h)("calcite-label",null,o.panels.size.dataRange),(0,s.h)("div",{class:"slider-box-buttons-front"},!d&&this.renderInvertButton(),(r||d)&&(0,s.h)(s.F,null,(0,s.h)("div",null,"\xa0"),this.renderZoomButton(t),(0,s.h)("div",null,"\xa0"),this.renderResetButton())),(0,s.h)("div",{ref:e=>{e&&this.afterSizeSliderCreate(e)}})):this.sizeSlider&&this.sizeSlider.min===this.sizeSlider.max?(0,s.h)(s.F,null):this.renderSizeSliderLoading()}}renderSizeSliderLoading(){const{strings:e}=this.smartMappingState;return(0,s.h)("div",{class:"slider-box"},(0,s.h)("calcite-loader",{label:e.loading}))}renderInvertButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("arcgis-smart-mapping-action",{text:e.panels.size.invertSlider,icon:"arrowUpDown",onClick:()=>this.handleInvertSlider()})}renderZoomButton(e){const{strings:t}=this.smartMappingState,{sliderZoomed:i}=this;return(0,s.h)("arcgis-smart-mapping-action",{text:t.panels.size.zoomSlider,icon:i?"magnifyingGlassMinus":"magnifyingGlassPlus",disabled:e,onClick:()=>this.handleZoomSlider(),ref:e=>this.zoomButtonNode=e})}renderResetButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("arcgis-smart-mapping-action",{text:e.panels.size.resetSlider,icon:"undo",onClick:()=>this.handleResetSlider()})}prepareSizeSlider(){const{statistics:e,histogram:t,histogramStatus:i,sliderZoomed:s,smartMappingState:a}=this,{mapView:l,modules:r}=a,d=(0,n.j)(a),h=(0,n.a)(a),p=["size-age","color-size-age","type-size-age"].includes(h),u="class-breaks"===d.type?d.classBreakInfos:d.uniqueValueInfos,g=this.getFieldInfo().simpleFieldType===n.q.DATE,f=(0,n.b)(d,"size"),S=(0,n.G)(d,"size"),b=(0,n.G)(d,"size"),y=["color-size","color-age-size","color-size-age","type-size","type-size-age","predominance-size","chart-size","relationship-size"].includes(h)?null:(0,n.Z)(a,u[u.length-1].symbol);let z,v;if(b?(z=b.minSliderValue,v=b.maxSliderValue):S?(z=S.minSliderValue,v=S.maxSliderValue):(z=u[0].minValue,v=u[u.length-1].maxValue),({min:z,max:v}=(0,n.ag)({min:z,max:v})),i===n.s.IN_PROGRESS)return!1;if(!this.sizeSlider||f&&this.sizeSlider.breaks||!f&&!S&&this.sizeSlider.stops){this.sizeSlider?.destroy();const i={histogramConfig:{bins:t?.bins,average:Math.round(10*e.avg)/10,standardDeviation:e.stddev,standardDeviationCount:1},min:z??e.min,max:v??e.max,style:y?{trackFillColor:y||null}:null};if(f||S)g&&!p&&(i.hasTimeData=!0,(0,o.a)(a,i,l.timeZone)),i.stops=(0,c.m)(a),i.precision=(0,m.g)(i.stops),this.sizeSlider=new r.SizeSlider(i),this.sizeSlider&&this.sizeSlider.min===this.sizeSlider.max&&this.sizeSlider.set(i);else{const e=(0,n.j)(a);i.histogramConfig.min=e.classBreakInfos[0].minValue,i.histogramConfig.max=e.classBreakInfos[e.classBreakInfos.length-1].maxValue,this.sliderZoomed=!1,i.breaks=(0,c.n)(a),i.precision=(0,m.g)(i.breaks),this.sizeSlider=new r.ClassedSizeSlider(i),this.sizeSlider&&this.sizeSlider.min===this.sizeSlider.max&&this.sizeSlider.set(i)}this.createSizeSliderChangeEvents()}else{const i=this.sizeSlider;if("dragging"===i.slider?.state)return!0;const r={histogramConfig:{bins:t?.bins,average:Math.round(10*e.avg)/10,standardDeviation:e.stddev,standardDeviationCount:1},min:z??e.min,max:v??e.max,style:y?{trackFillColor:y||null}:null};f||S?(r.stops=(0,c.m)(a),r.precision=(0,m.g)(r.stops),r.hasTimeData=g&&!p,g&&!p&&(0,o.a)(a,r,l.timeZone),s?this.zigzagClick||(r.zoomOptions=(0,n.aI)(this.getZoomStops(),b?b?.minSliderValue:S?.minSliderValue,b?b?.maxSliderValue:S?.maxSliderValue)):r.zoomOptions=null):(r.breaks=(0,c.n)(a),r.precision=(0,m.g)(r.breaks)),this.sliderZoomed&&this.adjustedZoomOptions&&!this.zigzagClick&&(r.zoomOptions=this.adjustedZoomOptions,"min"===this.zoomAdjustment?(this.sizeSlider.slider.min=r.zoomOptions.min,r.zoomOptions.min=null):(this.sizeSlider.slider.max=r.zoomOptions.max,r.zoomOptions.max=null)),this.adjustedZoomOptions=void 0,this.zoomAdjustment=void 0,this.sizeSlider.set(r),this.zigzagClick=!1}return(0,n.M)(this.sizeSlider)}handleInvertSlider(){const{smartMappingState:e}=this,t=(0,n.j)(e),i=(0,n.b)(t,"size");if(i)[i.minSize,i.maxSize]=[i.maxSize,i.minSize];else{const i=t.classBreakInfos.map((t=>(0,n.$)(e,t.symbol)));i.reverse(),t.classBreakInfos.forEach(((t,s)=>{const a=t.symbol;(0,n.a0)(e,a,i[s])}))}(0,n.u)(e),this.arcgisSmartMappingSizeSliderChange.emit()}handleZoomSlider(e){const{smartMappingState:t}=this;if(this.histogramStatus===n.s.IN_PROGRESS)return;const{statistics:i}=this,s=(0,n.j)(t);this.sliderZoomed=(0,n.M)(e)?!!e:!this.sliderZoomed;const a=(0,n.b)(s,"size"),o=(0,n.G)(s,"reference-size");a||o||(this.sliderZoomed=!1);const l=this.getFieldInfo(),r=this.getNormalizationField(),d=(0,n.G)(s,"size"),c=this.sliderZoomed?(0,n.aI)(this.getZoomStops(),d?d.minSliderValue:o?o.minSliderValue:i.min,d?d.maxSliderValue:o?o.maxSliderValue:i.max):null,h=d?d.minSliderValue===d.maxSliderValue:o?.minSliderValue===o?.maxSliderValue;this.getHistogram(l,r,i,(c?.min||(h?i.min:d?.minSliderValue??o?.minSliderValue??i.min))??void 0,(c?.max||(h?i.max:d?.maxSliderValue??o?.maxSliderValue??i.max))??void 0)}handleResetSlider(){const{smartMappingState:e}=this,{modules:t}=e,i=(0,n.j)(e),a=(0,n.a)(e);this.sliderZoomed=!1;const o=(0,n.b)(i,"size"),r=(0,n.G)(i,"reference-size"),d=(0,n.G)(i,"size"),p=this.getFieldInfo(),u=this.getNormalizationField();let m;"size"===a||r&&("type-size"===a||"color-size"===a)?m=c.f:"size-age"===a?(p.field=d?.field,m=c.h):"color-size-age"===a?(p.field=d?.field,m=c.i):"color-age-size"===a?m=c.j:"color-size"===a?m=c.g:"type-size"!==a||r?"type-size-age"===a?(p.field=d?.field,m=h.d):["predominance-size","relationship-size","chart-size"].includes(a)&&(m=c.c):m=h.b,m&&(0,l.r)(m(e,{fieldInfos:["predominance-size","relationship-size","chart-size"].includes(a)?r?[{field:r.field}]:[{field:o.field,expression:o.valueExpression,expressionTitle:o.valueExpressionTitle}]:!r||"type-size"!==a&&"color-size"!==a?(0,n.f)(e):[{field:r.field}],normalizationField:u,sizeOptimizationEnabled:"object"==typeof o?.minSize,noReuse:!0,discardMinMax:!0,referenceSizeOptions:r?{symbolStyle:r.referenceSizeSymbolStyle}:void 0},"size"),this.flowItemNode).then((async i=>{if(0===i.statistics?.count){const[e,t]=this.getDefaultDataRange(p),s=e,a=t;i.statistics.min=s,i.statistics.max=a,i.statistics.avg=(a+s)/2,this.statistics=i.statistics,this.statisticsStatus=n.s.SUCCESS}else i.statistics&&(0,n.M)(i.statistics.min)&&(0,n.M)(i.statistics.max)&&i.statistics.min<=i.statistics.max?(i.statistics=(0,n.ag)(i.statistics),this.statistics=i.statistics,this.statisticsStatus=n.s.SUCCESS,this.getHistogram(p,u,i.statistics,i.statistics.min,i.statistics.max)):this.statisticsStatus=n.s.FAILED;if(r){const s=(0,n.G)(i.renderer,"reference-size");r.sizeStops=t.esriLang.clone(s.sizeStops),r.minSliderValue=this.statistics.min,r.maxSliderValue=this.statistics.max,(0,c.l)(e).then((t=>(0,n.u)(e,t)),(e=>this.arcgisSmartMappingSizeSliderError.emit(e)))}else{const t=(0,n.b)(i.renderer,"size");o.minDataValue=t.minDataValue,o.maxDataValue=t.maxDataValue,d.minSliderValue=this.statistics.min,d.maxSliderValue=this.statistics.max,(0,n.u)(e)}(0,s.f)(this.el),this.arcgisSmartMappingSizeSliderChange.emit()}),(e=>this.arcgisSmartMappingSizeSliderError.emit(e)))}afterSizeSliderCreate(e){if(this.sizeSlider.container)e.append(this.sizeSlider.container);else{const t=document.createElement("div");t.classList.add("slider-container"),e.append(t),this.sizeSlider.container=t}}getStatistics(){const{smartMappingState:e}=this,{layer:t,useFeatureReduction:i,mapView:s,modules:a}=e,o=t,l=(0,n.j)(e);let r,d;const c=(0,n.G)(l,"reference-size")||{},h=this.getFieldInfo(),p=this.getNormalizationField(),u=(0,n.G)(l,"size")||{};r=u.minSliderValue??c.minSliderValue,d=u.maxSliderValue??c.maxSliderValue;const m=l.authoringInfo;if("equal-interval"===m?.classificationMethod){const e=l.classBreakInfos;r=e[0].minValue,d=e[e.length-1].maxValue}this.statisticsStatus=n.s.IN_PROGRESS,this.statistics||a.summaryStatistics({layer:o,view:s,field:h.field??void 0,valueExpression:h.expression??void 0,normalizationField:p,forBinning:"featureReduction"in o&&"binning"===o.featureReduction?.type&&i,outStatisticTypes:{exclude:["median"]}}).then((e=>{if(0===e.count){const[t,i]=this.getDefaultDataRange(h),s=u.minSliderValue||t,a=u.maxSliderValue||i;e.min=s,e.max=a,e.avg=(a+s)/2,(0,n.M)(u.minSliderValue)||(u.minSliderValue=s,u.maxSliderValue=a)}else if(!(0,n.M)(e.avg)||!(0,n.M)(e.min)||!(0,n.M)(e.max))return void(this.statisticsStatus=n.s.FAILED);e=(0,n.ag)(e),r=r??e.min,d=d??e.max,r===d&&(r=e.min,d=e.max),this.statistics=e,this.statisticsStatus=n.s.SUCCESS,this.getHistogram(h,p,e,r,d)}),(e=>{console.log(e),this.statisticsStatus=n.s.FAILED}))}getHistogram(e,t,i,s,a){const{smartMappingState:o}=this,{layer:l,useFeatureReduction:r,mapView:d,modules:c}=o,h=l;if(!(i=i||this.statistics)||0===i.count)return;this.histogramStatus=n.s.IN_PROGRESS;const p=(0,n.j)(o),u=(0,n.G)(p,"reference-size");u&&void 0!==s&&u.sizeStops[0].value<s&&(s=u.sizeStops[0].value),u&&void 0!==a&&u.sizeStops[1].value>a&&(a=u.sizeStops[1].value),c.histogram({layer:h,view:d,field:e.field??void 0,valueExpression:e.expression??void 0,numBins:50,minValue:(0,n.M)(s)?s:i.min??void 0,maxValue:(0,n.M)(a)?a:i.max??void 0,normalizationField:t,forBinning:"featureReduction"in h&&"binning"===h.featureReduction?.type&&r}).then((e=>{this.histogram=e,this.histogramStatus=n.s.SUCCESS}),(()=>{this.histogramStatus=n.s.FAILED}))}onMinMaxChange(e,t,i){const{statistics:s,smartMappingState:a}=this,o=(0,n.j)(a),l=(0,n.b)(o,"size"),r=(0,n.G)(o,"reference-size"),d=(0,n.G)(o,"size")||{};if(!l&&!r){const i=o.classBreakInfos[0],s=o.classBreakInfos[o.classBreakInfos.length-1];i.minValue=e,i.label=(0,n.at)(i,this.sizeSlider.precision),s.maxValue=t,s.label=(0,n.at)(s,this.sizeSlider.precision)}d&&("min"===i?d.minSliderValue=e:d.maxSliderValue=t),r&&("min"===i?r.minSliderValue=e:r.maxSliderValue=t);const c=l||r?(0,n.aI)(this.getZoomStops(),d?d.minSliderValue:r?.minSliderValue,d?d.maxSliderValue:r?.maxSliderValue):null;this.zoomButtonNode&&(this.sliderZoomed?this.zoomButtonNode.disabled=!1:!c||c.minMaxSame||!(0,n.M)(c.min)&&!(0,n.M)(c.max)?this.zoomButtonNode.disabled=!0:this.zoomButtonNode.disabled=!1),this.sliderZoomed&&(this.adjustedZoomOptions=this.sizeSlider.zoomOptions,"min"===i?(this.adjustedZoomOptions.min=e,this.zoomAdjustment="min"):(this.adjustedZoomOptions.max=t,this.zoomAdjustment="max"));const h=this.getFieldInfo(),p=this.getNormalizationField();this.getHistogram(h,p,s,e,t);(e===d?.minSliderValue&&t===d?.maxSliderValue||e===r?.minSliderValue&&t===r?.maxSliderValue)&&(this.sliderZoomed=!1),o.authoringInfo.classificationMethod="manual",this.arcgisSmartMappingSizeSliderChange.emit()}createSizeSliderChangeEvents(){const{smartMappingState:e}=this,t=(0,n.j)(e),i=(0,n.a)(e),a=(0,n.b)(t,"size"),o=(0,n.G)(t,"reference-size"),l=["size-age","color-size-age","type-size-age"].includes(i),r=this.getFieldInfo().simpleFieldType===n.q.DATE;this.sizeSlider&&(this.sizeSlider.watch("zoomOptions",((e,t)=>{this.sliderZoomed&&(t?.min&&!e?.min||t?.max&&!e?.max)&&(this.zigzagClick=!0,this.handleZigzagClick(e))})),this.sizeSlider.on("min-change",(e=>{a||o?e.value>this.currentStopValues[0]?(this.sizeSlider.stops.forEach(((e,t)=>{e.value=this.currentStopValues[t]})),this.onMinMaxChange(this.currentStopValues[0],this.sizeSlider.slider.max,"min")):this.onMinMaxChange(e.value,this.sizeSlider.slider.max,"min"):e.value>this.currentBreakValues[0].max?this.onMinMaxChange(this.currentBreakValues[0].max,this.sizeSlider.slider.max,"min"):this.onMinMaxChange(e.value,this.sizeSlider.slider.max,"min")})),this.sizeSlider.on("max-change",(e=>{a||o?e.value<this.currentStopValues[this.currentStopValues.length-1]?(this.sizeSlider.stops.forEach(((e,t)=>{e.value=this.currentStopValues[t]})),this.onMinMaxChange(this.sizeSlider.slider.min,this.currentStopValues[this.currentStopValues.length-1],"max")):this.onMinMaxChange(this.sizeSlider.slider.min,e.value,"max"):e.value<this.currentBreakValues[this.currentBreakValues.length-1].min?this.onMinMaxChange(this.sizeSlider.slider.min,this.currentBreakValues[this.currentBreakValues.length-1].min,"max"):this.onMinMaxChange(this.sizeSlider.slider.min,e.value,"max")})),this.sizeSlider.on("thumb-change",(e=>{if(a||o){const t=this.sizeSlider.stops;if(r&&!l&&0===e.value)return void(0,s.f)(this.el);this.updateRendererStops(t)}else this.updateRendererBreaks(this.sizeSlider.breaks)})),this.sizeSlider.on("thumb-drag",(t=>{const i=(0,n.j)(e),s=(0,n.G)(i,"reference-size");if(!s||!["start","drag"].includes(t.state))if(a||s){const e=this.sizeSlider.stops;this.updateRendererStops(e)}else this.updateRendererBreaks(this.sizeSlider.breaks)})),this.sizeSlider.on("segment-drag",(()=>{if((0,n.b)(t,"size")||o){const e=this.sizeSlider.stops;this.updateRendererStops(e)}})))}updateRendererStops(e){const{smartMappingState:t}=this,i=(0,n.j)(t),s=(0,n.b)(i,"size"),a=(0,n.G)(i,"size"),o=(0,n.G)(i,"reference-size");s?.stops||o?.sizeStops?(5===e.length&&(e[0].label=`< ${e[0].value}`,e[1].label=`${e[1].value}`,e[2].label=`${e[2].value}`,e[3].label=`${e[3].value}`,e[4].label=`> ${e[4].value}`),s?s.stops=e:o?.sizeStops.forEach(((t,i)=>t.value=e[i].value))):s&&(s.minDataValue=e[0].value,s.maxDataValue=e[1].value),this.currentStopValues=e.map((e=>e.value));const l=(0,n.aI)(this.getZoomStops(),a?a.minSliderValue:o?.minSliderValue,a?a.maxSliderValue:o?.maxSliderValue);this.sliderZoomed?this.zoomButtonNode.disabled=!1:!l||l.minMaxSame||!(0,n.M)(l.min)&&!(0,n.M)(l.max)?this.zoomButtonNode.disabled=!0:this.zoomButtonNode.disabled=!1,o?(0,c.l)(t).then((e=>(0,n.u)(t,e)),(e=>this.arcgisSmartMappingSizeSliderError.emit(e))):(0,n.u)(t)}updateRendererBreaks(e){const{smartMappingState:t}=this,i=(0,n.j)(t);i.authoringInfo.classificationMethod="manual",i.classBreakInfos.forEach(((t,i)=>{if(t.minValue!==e[i].min||t.maxValue!==e[i].max){t.minValue=e[i].min,t.maxValue=e[i].max;const s=i>0?"> ":"";t.label=`${s} ${(0,n.at)(t,this.sizeSlider.precision)}`,this.currentBreakValues[i].min=e[i].min,this.currentBreakValues[i].max=e[i].max}})),(0,n.u)(t),this.arcgisSmartMappingSizeSliderChange.emit()}getDefaultDataRange(e){if(e.simpleFieldType===n.q.DATE){const e=(new Date).getFullYear();return[new Date(`1/1/${e}`).getTime(),new Date(`12/31/${e}`).getTime()]}return[0,100]}getFieldInfo(){const{smartMappingState:e}=this,t=(0,n.j)(e),i=(0,n.a)(e),s=(0,n.b)(t,"size"),a=(0,n.f)(e),o=["color-size","color-age-size","color-size-age","type-size","type-size-age"].includes(i)&&a.length>1?a[1]:"relationship-size"===i?a[2]:a[0];return o.expression=s?.valueExpression??t.valueExpression??null,o.expressionTitle=s?.valueExpressionTitle??t.valueExpressionTitle??null,o}handleZigzagClick(e){const{statistics:t,smartMappingState:i}=this,s=(0,n.j)(i),a=(0,n.G)(s,"reference-size")||{},o=(0,n.G)(s,"size")||{},l=this.getFieldInfo(),r=this.getNormalizationField(),d=o?o.minSliderValue===o.maxSliderValue:a.minSliderValue===a.maxSliderValue;this.getHistogram(l,r,t,e?.min??(d?t.min:o?.minSliderValue??a?.minSliderValue??t.min),e?.max??(d?t.max:o?.maxSliderValue??a?.maxSliderValue??t.max)),e||(this.sliderZoomed=!1)}getNormalizationField(){const{smartMappingState:e}=this,t=(0,n.j)(e),i=(0,n.b)(t,"size"),s=(0,n.G)(t,"reference-size");return i?i.normalizationField:s?s.normalizationField:t.normalizationField}getZoomStops(){const{smartMappingState:e}=this,t=(0,n.j)(e),i=(0,n.b)(t,"size"),s=(0,n.G)(t,"reference-size");return i?[{value:i.minDataValue},{value:i.maxDataValue}]:[{value:s?.sizeStops[0].value},{value:s?.sizeStops[1].value}]}get el(){return(0,s.g)(this)}};T.style=".slider-box {\n  height: 320px;\n\n  .esri-size-slider,\n  .esri-classed-size-slider {\n    min-width: 200px;\n  }\n\n  .esri-size-slider .esri-slider .esri-slider__content,\n  .esri-classed-size-slider .esri-slider .esri-slider__content {\n    height: 175px;\n  }\n\n  .esri-size-slider__histogram-container,\n  .esri-classed-size-slider__histogram-container {\n    width: 85px;\n  }\n\n  .esri-size-slider .esri-slider .esri-slider__label,\n  .esri-size-slider .esri-slider .esri-slider__min,\n  .esri-size-slider .esri-slider .esri-slider__max,\n  .esri-classed-size-slider .esri-slider .esri-slider__label,\n  .esri-classed-size-slider .esri-slider .esri-slider__min,\n  .esri-classed-size-slider .esri-slider .esri-slider__max {\n    text-decoration: underline;\n  }\n  .esri-size-slider .esri-slider .esri-slider__label:hover,\n  .esri-size-slider .esri-slider .esri-slider__min:hover,\n  .esri-size-slider .esri-slider .esri-slider__max:hover,\n  .esri-classed-size-slider .esri-slider .esri-slider__label:hover,\n  .esri-classed-size-slider .esri-slider .esri-slider__min:hover,\n  .esri-classed-size-slider .esri-slider .esri-slider__max:hover {\n    border: 1px solid #bbb;\n    background-color: #f3f3f3;\n    text-decoration: none;\n    z-index: 1;\n  }\n}\n\n.slider-box-buttons-front {\n  display: flex;\n}\n\n.slider-container {\n  overflow: hidden;\n}\n";const V=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingSymbolPairButtonChange=(0,s.c)(this,"arcgisSmartMappingSymbolPairButtonChange",7),this.arcgisSmartMappingSymbolPairButtonBeforeOpen=(0,s.c)(this,"arcgisSmartMappingSymbolPairButtonBeforeOpen",7),this.arcgisSmartMappingSymbolPairButtonError=(0,s.c)(this,"arcgisSmartMappingSymbolPairButtonError",7),this.manager=(0,u.u)(this),this.smartMappingState=(0,r.u)(),this.symbolType=void 0}arcgisSmartMappingClosePopoversHandler(){this.symbolPairPopoverNode&&(this.symbolPairPopoverNode.parentNode?.removeChild(this.symbolPairPopoverNode),this.symbolPairPopoverNode=void 0)}componentWillLoad(){const{strings:e}=this.smartMappingState;this.flowItemNode=(0,a.f)(this.el,"calcite-flow-item"),this.allSymbolPairs="above-and-below"===this.symbolType?[["single",e.symbolPairButton.singleSymbol],["circle",e.symbolPairButton.circles],["square",e.symbolPairButton.squares],["caret",e.symbolPairButton.chevrons],["circle-caret",e.symbolPairButton.circlesChevrons],["arrow",e.symbolPairButton.arrows],["circle-arrow",e.symbolPairButton.circleArrows],["plus-minus",e.symbolPairButton.plusMinus],["circle-plus-minus",e.symbolPairButton.circlePlusMinus],["happy-sad",e.symbolPairButton.faces],["triangle",e.symbolPairButton.triangles],["thumb",e.symbolPairButton.thumbs]]:[["circle",e.symbolPairButton.circles],["square",e.symbolPairButton.squares],["diamond",e.symbolPairButton.diamonds],["hexagon-pointy",e.symbolPairButton.hexagonsPointy],["hexagon-flat",e.symbolPairButton.hexagonsFlat]]}render(){const{smartMappingState:e}=this,{strings:t}=e,i=(0,n.j)(e),a=i.authoringInfo,o=(0,n.G)(i,"reference-size"),l="above-and-below"===this.symbolType?a.univariateSymbolStyle:o?.referenceSizeSymbolStyle;let r=t.symbolPairButton.singleSymbol;return this.allSymbolPairs.forEach((e=>{l===e[0]&&(r=e[1])})),"custom"===l&&(r=t.symbolPairButton.custom),(0,s.h)("calcite-label",{key:"3eab52f4ed41130d4a1fba873c32c1f516ab88cb"},"above-and-below"===this.symbolType?t.symbolPairButton.symbolPair:t.symbolPairButton.referenceSizeShape,(0,s.h)("calcite-button",{key:"56c4edb12bb5e42db4d62e1863be2a3af66efb95",ref:e=>this.symbolPairButtonNode=e,alignment:"icon-end-space-between",iconEnd:"chevron-down",appearance:"outline-fill",width:"full",role:"button",kind:"neutral","aria-haspopup":"true",label:t.symbolPairButton.symbolPair,onClick:()=>this.toggleSymbolPairPopover()},r))}toggleSymbolPairPopover(){if(this.symbolPairPopoverNode)return void this.closeSymbolPairPopover();const{smartMappingState:e}=this;this.arcgisSmartMappingSymbolPairButtonBeforeOpen.emit();const t=document.createElement("arcgis-smart-mapping-symbol-pair-popover");t.smartMappingState=e,this.symbolPairPopoverNode=t,t.popoverProps={refElement:this.flowItemNode,placement:"leading",offsetDistance:0,popoverWidth:1.05*this.flowItemNode.getBoundingClientRect().width,overlayPositioning:"absolute",flipDisabled:!1,triggerDisabled:!1},t.symbolPairs=this.allSymbolPairs,t.addEventListener("arcgisSmartMappingSymbolPairPopoverClose",(()=>this.closeSymbolPairPopover())),t.addEventListener("arcgisSmartMappingSymbolPairPopoverChange",(t=>{this.closeSymbolPairPopover();const{layer:i,mapView:a}=this.smartMappingState,o=t.detail,r=(0,n.j)(e),d=(0,n.G)(r,"reference-size"),h="above-and-below"===this.symbolType?{symbolStyle:o}:{layer:i,view:a,fieldInfos:[{field:d?.field}],theme:"reference-size",referenceSizeOptions:{symbolStyle:o},normalizationField:d?.normalizationField},p="above-and-below"===this.symbolType?S.b:c.f;(0,l.r)(p(e,h),this.flowItemNode).then((async t=>{if(d){const t=await(0,c.l)(e,{referenceSizeOptions:{symbolStyle:o}});t&&(0,n.u)(e,t)}else(0,n.u)(e,t.renderer);(0,s.f)(this.el),this.arcgisSmartMappingSymbolPairButtonChange.emit()}),(e=>this.arcgisSmartMappingSymbolPairButtonError.emit(e)))})),t.addEventListener("arcgisSmartMappingSymbolPairPopoverDisconnected",(()=>this.closeSymbolPairPopover())),document.body.appendChild(t)}closeSymbolPairPopover(){this.symbolPairPopoverNode&&(this.symbolPairPopoverNode.parentNode?.removeChild(this.symbolPairPopoverNode),this.symbolPairPopoverNode=void 0,setTimeout((()=>{this.symbolPairButtonNode?.setFocus()}),300))}get el(){return(0,s.g)(this)}};V.style=".symbol-pair-name{display:flex;padding:6px;justify-content:space-between;align-items:center;border-radius:0;cursor:pointer;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-1);outline-color:var(--calcite-color-foreground-3);outline-width:1px;outline-style:solid;box-shadow:transparent 0px 0px 0px 1px inset}.symbol-pair-name:hover{outline-width:2px}.symbol-pair-name:focus{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3);outline:2px solid var(--calcite-color-brand);outline-offset:2px}";const P=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingSymbolPairPopoverClose=(0,s.c)(this,"arcgisSmartMappingSymbolPairPopoverClose",7),this.arcgisSmartMappingSymbolPairPopoverChange=(0,s.c)(this,"arcgisSmartMappingSymbolPairPopoverChange",7),this.arcgisSmartMappingSymbolPairPopoverDisconnected=(0,s.c)(this,"arcgisSmartMappingSymbolPairPopoverDisconnected",7),this.manager=(0,u.u)(this),this.resizeObserver=new ResizeObserver((e=>{const t=e.pop();this.width=1.05*t.contentRect.width})),this.popoverProps=void 0,this.symbolPairs=void 0,this.smartMappingState=void 0,this.width=void 0}async setFocus(){await(this.calcitePopoverNode?.setFocus())}componentDidLoad(){requestAnimationFrame((async()=>await(this.calcitePopoverNode?.setFocus()))),this.resizeObserver.observe(this.popoverProps.refElement)}disconnectedCallback(){this.arcgisSmartMappingSymbolPairPopoverDisconnected.emit(),this.resizeObserver.unobserve(this.popoverProps.refElement)}render(){const{smartMappingState:e}=this,{isRTL:t,strings:i}=e,a=(0,n.j)(e),o=(0,n.G)(a,"reference-size"),l=this.popoverProps,r=l.refElement.getBoundingClientRect().height-105-50,d=o?i.symbolPairButton.referenceSizeShape:i.symbolPairButton.symbolPair;return(0,s.h)(s.H,{key:"cfa81d8ccf70379bc27021ee4f57f27bda306db3",class:"js-app-flyout"},(0,s.h)("calcite-popover",{key:"a492e6422598d44d29b734c8a5c022c935d3fc48",class:"js-app-flyout symbol-pair-popover",ref:e=>this.calcitePopoverNode=e,dir:t?"rtl":"ltr",placement:"leading-start",open:!0,heading:d,closable:!0,pointerDisabled:!0,referenceElement:l.refElement,offsetDistance:l.offsetDistance||10-(l.popoverWidth||this.width),offsetSkidding:105,overlayPositioning:l.overlayPositioning,triggerDisabled:l.triggerDisabled,label:d,onCalcitePopoverClose:()=>this.arcgisSmartMappingSymbolPairPopoverClose.emit(),style:{width:`${this.width||l.popoverWidth}px`}},(0,s.h)("div",{key:"eb7360fc1aa5d905ee4139fb2748a31ca7d8f6ef",class:"content",style:{maxHeight:.9*r+"px"}},(0,s.h)("calcite-list",{key:"34bbab44b8ca7e4e07f33f83c42e0100bd3feb0d",label:d,selectionMode:"single-persist"},this.renderItems()))))}renderItems(){const{smartMappingState:e}=this,t=(0,n.j)(e),i=t.authoringInfo,s=(0,n.G)(t,"reference-size"),a=s?s.referenceSizeSymbolStyle:i.univariateSymbolStyle||"single",o=[];return this.symbolPairs.forEach((e=>o.push(this.renderItem(e[0],e[1],a===e[0])))),o}renderItem(e,t,i){const{smartMappingState:a}=this,o=(0,n.j)(a),l=o.authoringInfo,r=(0,n.G)(o,"reference-size"),d=`${e.charAt(0).toUpperCase()}${e.slice(1)}.svg`,c=r?`ReferenceSize_${d}`:d;return(0,s.h)("calcite-list-item",{label:t,selected:i,onClick:()=>{(r?r.referenceSizeSymbolStyle:l.univariateSymbolStyle||"single")!==e&&this.arcgisSmartMappingSymbolPairPopoverChange.emit(e)},onKeyDown:t=>{" "!==t.key&&"Enter"!==t.key||(t.preventDefault(),t.stopPropagation(),this.arcgisSmartMappingSymbolPairPopoverChange.emit(e))}},"single"!==e?(0,s.h)("calcite-action",{scale:"s",slot:"actions-end",text:"symbol-pair-symbols"},(0,s.h)("div",{style:{width:"32px",height:"32px",backgroundImage:`url(${(0,s.a)("./assets/smart-mapping-symbol-pair-images/")}${c})`}})):null)}get el(){return(0,s.g)(this)}};var F;P.style=".symbol-pair-popover{--calcite-popover-z-index:100;}.content{overflow-y:auto}",function(e){e.highToLow="HighToLow.svg",e.aboveAndBelow="AboveAndBelow.svg",e.above="Above.svg",e.below="Below.svg",e.centeredOn="CenteredOn.svg",e.extremes="Extremes.svg",e.referenceSize="ReferenceSize.svg"}(F||(F={}));const B=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingThemeButtonChange=(0,s.c)(this,"arcgisSmartMappingThemeButtonChange",7),this.arcgisSmartMappingThemeButtonBeforeOpen=(0,s.c)(this,"arcgisSmartMappingThemeButtonBeforeOpen",7),this.manager=(0,u.u)(this),this.open=!1,this.themeInfos=[],this.smartMappingState=(0,r.u)(),this.rendererSubtype=void 0,this.buttonVersion="default"}async setFocus(){"minimal"===this.buttonVersion?await this.buttonNode.setFocus():this.buttonNode?.focus()}componentWillLoad(){this.populateThemeInfo(),this.setSelection()}componentWillUpdate(){const e=(0,n.H)(this.smartMappingState,this.rendererSubtype);this.selectedThemeInfo?.value!==e&&this.setSelection()}disconnectedCallback(){(0,n.B)()}render(){return(0,s.h)(s.H,{key:"55f7dcecacb2cb759b578d29af6c09ae90bc21a0"},"minimal"===this.buttonVersion?this.renderMinimalButton():this.renderDefaultButton())}renderDefaultButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-label",null,e.themeButton.theme,(0,s.h)("div",{class:"theme-button",role:"button",tabindex:"0","aria-haspopup":"true","aria-label":e.themeButton.selectTheme,ref:e=>this.buttonNode=e,onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.openThemeDropdown())},onClick:()=>this.openThemeDropdown()},(0,s.h)("div",{class:"theme-content"},(0,s.h)("div",{class:"theme-button-icon",style:{backgroundImage:`url(${(0,s.a)("./assets/smart-mapping-dropdown-images/")}${this.selectedThemeInfo.iconPath})`}}),(0,s.h)("div",{class:"theme-sub-content"},(0,s.h)("div",{class:"theme-button-text"},(0,s.h)("div",{class:"theme-button-title"},this.selectedThemeInfo.title),(0,s.h)("div",{class:"theme-button-msg"},this.selectedThemeInfo.msg)),(0,s.h)("div",null,(0,s.h)("calcite-icon",{scale:"s",icon:"chevron-down"}))))))}renderMinimalButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-label",{onClick:e=>e.stopImmediatePropagation()},e.themeButton.theme,(0,s.h)("calcite-button",{class:"calcite-theme-button",alignment:"icon-end-space-between",iconEnd:"chevron-down",appearance:"outline-fill",width:"full",role:"button",kind:"neutral","aria-haspopup":"true",label:e.themeButton.selectTheme,ref:e=>this.buttonNode=e,onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.openThemeDropdown())},onClick:()=>this.openThemeDropdown()},this.selectedThemeInfo.title))}setSelection(){const{smartMappingState:e}=this,t=(0,n.j)(e),i=t.authoringInfo,s=(0,n.G)((0,n.j)(e),"color"),a=(0,n.G)((0,n.j)(e),"size"),o=(0,n.G)(t,"reference-size")&&"size"===this.rendererSubtype?"reference-size":i?.univariateTheme||("size"===this.rendererSubtype?a?.theme:s?.theme);this.selectedThemeInfo=o?this.themeInfos.find((e=>e.value===o)):this.themeInfos.find((e=>"high-to-low"===e.value)),this.themeInfos.forEach((e=>{e.selected=e.value===this.selectedThemeInfo.value}))}closeDropdown(){this.open=!1,this.dropdownNode&&(this.dropdownNode.parentNode?.removeChild(this.dropdownNode),this.dropdownNode=void 0,this.buttonNode.classList.remove("active"))}openThemeDropdown(){const{smartMappingState:e}=this;if(this.open)this.closeDropdown();else{this.arcgisSmartMappingThemeButtonBeforeOpen.emit();const t=document.createElement("arcgis-smart-mapping-dropdown");t.smartMappingState=e,t.buttonNode=this.buttonNode,t.infos=this.themeInfos,this.dropdownNode=t,t.addEventListener("arcgisSmartMappingDropdownClose",(e=>{this.closeDropdown(),"Escape"===e.detail&&this.setFocus()})),t.addEventListener("arcgisSmartMappingDropdownChange",(e=>this.setTheme(e.detail))),t.addEventListener("arcgisSmartMappingDropdownDisconnected",(()=>this.closeDropdown())),this.buttonNode.classList.add("active"),document.body.appendChild(t),this.open=!0}}setTheme(e){const{smartMappingState:t}=this,i=(0,n.H)(t,this.rendererSubtype),s=e.value;if(s===i)return this.closeDropdown(),void setTimeout((()=>{this.setFocus()}),300);for(let e=0;e<this.themeInfos.length;e++)this.themeInfos[e].selected=this.themeInfos[e].value===s;this.selectedThemeInfo=e,this.arcgisSmartMappingThemeButtonChange.emit(s),this.closeDropdown(),setTimeout((()=>{this.setFocus()}),300)}populateThemeInfo(){const{smartMappingState:e}=this,{layer:t,mapImageSublayer:i,strings:s}=e,a=i&&t.version>=11,o=(0,n.a)(e),l=["color-age","size-age"].includes(o)||"size"!==this.rendererSubtype&&["color-age-size"].includes(o)||"size"===this.rendererSubtype&&["color-size-age","type-size-age"].includes(o),r=(0,n.j)(e),d=r.authoringInfo,c="univariate-color-size"===d?.type,h="color-size"===o&&c?(0,n.b)((0,n.j)(e),"size"):(0,n.b)((0,n.j)(e),this.rendererSubtype),p=(0,n.G)(r,"reference-size"),u=h?h.field:p?p.field:r.field,m=(0,n.o)(e,u),g=m?.simpleFieldType===n.q.DATE&&!l,f="color-size"===o&&c?"ColorAndSize_":"color"===this.rendererSubtype?"Color_":"Size_";this.themeInfos.push({value:"high-to-low",title:g?s.themeButton.newToOld:s.themeButton.highToLow,msg:g?s.themeButton[this.rendererSubtype].newToOldMsg:s.themeButton[this.rendererSubtype].highToLowMsg,iconPath:`${f}${F.highToLow}`,selected:!1}),"color"!==o&&("color-size"!==o||"size"===this.rendererSubtype||i&&!a)||this.themeInfos.push({value:"above-and-below",title:g?s.themeButton.beforeAndAfter:s.themeButton.aboveAndBelow,msg:g?s.themeButton[this.rendererSubtype].beforeAndAfterMsg:s.themeButton[this.rendererSubtype].aboveAndBelowMsg,iconPath:`${f}${F.aboveAndBelow}`,selected:!1}),this.themeInfos.push({value:"above",title:g?s.themeButton.after:s.themeButton.above,msg:g?s.themeButton[this.rendererSubtype].afterMsg:s.themeButton[this.rendererSubtype].aboveMsg,iconPath:`${f}${F.above}`,selected:!1}),this.themeInfos.push({value:"below",title:g?s.themeButton.before:s.themeButton.below,msg:g?s.themeButton[this.rendererSubtype].beforeMsg:s.themeButton[this.rendererSubtype].belowMsg,iconPath:`${f}${F.below}`,selected:!1}),"color"===o&&(this.themeInfos.push({value:"centered-on",title:s.themeButton.centered,msg:s.themeButton[this.rendererSubtype].centeredMsg,iconPath:`${f}${F.centeredOn}`,selected:!1}),this.themeInfos.push({value:"extremes",title:s.themeButton.extremes,msg:s.themeButton[this.rendererSubtype].extremesMsg,iconPath:`${f}${F.extremes}`,selected:!1})),!i&&"size"===this.rendererSubtype&&(0,n.M)(m)&&(0,n.z)(e)&&!g&&this.themeInfos.push({value:"reference-size",title:s.themeButton.referenceSize,msg:s.themeButton.size.referenceSizeMsg,iconPath:`${f}${F.referenceSize}`,selected:!1})}get el(){return(0,s.g)(this)}};B.style=".theme-button{display:flex;padding:6px;justify-content:space-between;align-items:center;border-radius:0;cursor:pointer;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-1);border-color:var(--calcite-color-foreground-3);border-width:1px;border-style:solid;box-shadow:transparent 0px 0px 0px 1px inset}.theme-button:hover{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3)}.theme-button:active{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3)}.theme-button:focus{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3);outline:2px solid var(--calcite-color-brand);outline-offset:2px}.theme-button.active,.calcite-theme-button.active{outline:1px solid var(--calcite-ui-focus-color, var(--calcite-color-brand))}.theme-content{display:flex;align-items:center;width:100%}.theme-sub-content{display:flex;justify-content:space-between;align-items:center;width:100%}.theme-button-icon{min-width:16px;background-repeat:no-repeat;height:48px;padding:0;display:inline-block}.theme-button-text{display:inline-block;padding:0 10px}.theme-button-title{font-weight:bold}.theme-button-msg{font-size:80%;line-height:16px}";const E=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingTileSelect=(0,s.c)(this,"arcgisSmartMappingTileSelect",7),this.arcgisSmartMappingTileOptions=(0,s.c)(this,"arcgisSmartMappingTileOptions",7),this.arcgisSmartMappingTileThemeChange=(0,s.c)(this,"arcgisSmartMappingTileThemeChange",7),this.arcgisSmartMappingTileError=(0,s.c)(this,"arcgisSmartMappingTileError",7),this.manager=(0,u.u)(this),this.documentClickHandler=void 0,this.panelScrollHandler=void 0,this.smartMappingState=(0,r.u)(),this.keyupEventHandler=e=>{const{selected:t}=this;" "!==e.key&&"Enter"!==e.key||(e.stopPropagation(),this.removeInfoPopover(),t?this.arcgisSmartMappingTileOptions.emit():this.arcgisSmartMappingTileSelect.emit(),e.preventDefault())},this.keydownEventHandler=e=>{" "===e.key&&(e.stopPropagation(),e.preventDefault())},this.clickEventHandler=e=>{const{selected:t}=this;"CALCITE-CHECKBOX"!==e?.target?.nodeName&&"ARCGIS-SMART-MAPPING-THEME-BUTTON"!==e?.target?.nodeName&&(e.stopPropagation(),this.removeInfoPopover(),t?this.arcgisSmartMappingTileOptions.emit():this.arcgisSmartMappingTileSelect.emit(),e.preventDefault())},this.checkboxChangeHandler=e=>{const{selected:t}=this;e.preventDefault();const i=e.target;i.checked?(this.removeInfoPopover(),t?this.arcgisSmartMappingTileOptions.emit():this.arcgisSmartMappingTileSelect.emit()):i.checked=!0},this.tileType="default",this.type=void 0,this.selected=!1,this.fields=void 0}async setFocus(){requestAnimationFrame((()=>this.tileNode?.focus()))}componentWillLoad(){this.tileInfo=function(e,t,i){const{selectedFields:s,strings:a}=e;let o=(0,n.i)(e)?"raster":(0,n.A)(e);"multipoint"===o&&(o="point");let l=s.length;(0,n.M)(l)||(l=1);const r=(0,n.i)(e)?(0,n.g)(e):(0,n.a)(e);let d=!1,c=!1;switch(s.length&&(d=s[0].simpleFieldType===n.q.DATE||"date-only"===(0,n.o)(e,s[0].field)?.layerField?.type,c=d,s.length>1&&(c=s[1].simpleFieldType===n.q.DATE)),t){case"simple":default:return{title:a.tile.simpleStyle,moreInfo:a.tile.tooltips.location,helpId:"120003675",imageFile:`${o}/Simple.png`};case"color":return{title:d?a.tile.colorStyleDate:a.tile.colorStyle,subText:["gallery","assist"].includes(i)?"":s[0].expressionTitle||s[0].featureReductionExpressionTitle||(0,n.o)(e,s[0].field).label,moreInfo:d?a.tile.tooltips.colorDate:a.tile.tooltips.color,helpId:d?"120003262":"120003251",imageFile:d?`${o}/Color_Time.png`:`${o}/Color.png`};case"size":return{title:"chart-size"!==r||["gallery","assist"].includes(i)?1===l&&d||2===l&&c?a.tile.sizeStyleDate:a.tile.sizeStyle:a.tile.sizeStyleChart,subText:["gallery","assist"].includes(i)?"":"chart-size"===r||"predominance-size"===r?a.sumOfCategories:s[1].expressionTitle||s[1].featureReductionExpressionTitle||(0,n.o)(e,s[1].field)?.label,moreInfo:"predominance-size"===r?a.tile.tooltips.sizeForPredominance:1===l&&d||2===l&&c?a.tile.tooltips.sizeDate:a.tile.tooltips.size,helpId:1===l&&d||2===l&&c?"120003263":"120003252",imageFile:"chart-size"!==r||["gallery","assist"].includes(i)?1===l&&d||2===l&&c?`${o}/Size_Time.png`:`${o}/Size.png`:`${o}/ChartSizeSize.jpg`};case"type":return{title:d?a.tile.typeStyleDate:a.tile.typeStyle,subText:!["gallery","assist"].includes(i)&&null!=r&&["type-size","type-size-age"].includes(r)?s[0].expressionTitle||s[0].featureReductionExpressionTitle||(0,n.o)(e,s[0].field).label:"",moreInfo:d?a.tile.tooltips.typeDate:a.tile.tooltips.type,helpId:d?"120003266":"120003260",imageFile:`${o}/Type.png`};case"color-age":return{title:a.tile.colorAgeStyle,subText:["gallery","assist"].includes(i)?"":s[0].expressionTitle||s[0].featureReductionExpressionTitle||(0,n.o)(e,s[0].field).label,moreInfo:a.tile.tooltips.colorAge,helpId:"120003264",imageFile:`${o}/Color_Age.png`};case"size-age":return{title:a.tile.sizeAgeStyle,subText:["gallery","assist"].includes(i)?"":s[1].expressionTitle||s[1].featureReductionExpressionTitle||(0,n.o)(e,s[1].field)?.label,moreInfo:a.tile.tooltips.sizeAge,helpId:"120003265",imageFile:`${o}/Size_Age.png`};case"color-size":return{title:a.tile.colorSizeStyle,moreInfo:d?c?a.tile.tooltips.colorDate_SizeDate:a.tile.tooltips.colorDate_Size:c?a.tile.tooltips.color_SizeDate:a.tile.tooltips.color_Size,helpId:"120003254",imageFile:d||c?`${o}/ColorSize_Time.png`:`${o}/ColorSize.png`};case"color-age-size":return{title:a.tile.colorAgeSizeStyle,moreInfo:a.tile.tooltips.colorAge_Size,helpId:"120003267",imageFile:`${o}/ColorSize_Age.png`};case"color-size-age":return{title:a.tile.colorSizeAgeStyle,moreInfo:a.tile.tooltips.color_SizeAge,helpId:"120003267",imageFile:`${o}/ColorSize_Age.png`};case"type-size":return{title:a.tile.typeSizeStyle,moreInfo:d?a.tile.tooltips.typeDate_Size:c?a.tile.tooltips.type_SizeDate:a.tile.tooltips.type_Size,helpId:"120003261",imageFile:c?`${o}/TypeSize_Time.png`:`${o}/TypeSize.png`};case"type-size-age":return{title:a.tile.typeSizeAgeStyle,moreInfo:a.tile.tooltips.type_SizeAge,helpId:"120003268",imageFile:`${o}/TypeSize_Age.png`};case"dot-density":return{title:a.tile.dotDensityStyle,moreInfo:a.tile.tooltips.dotDensity,helpId:"120003253",imageFile:`${o}/DotDensity.png`};case"heatmap":return{title:a.tile.heatmapStyle,moreInfo:a.tile.tooltips.heatMap,helpId:"120003250",imageFile:`${o}/HeatMap.png`};case"relationship":return{title:a.tile.relationshipStyle,subText:["gallery","assist"].includes(i)||"relationship-size"!==r?"":[(0,n.o)(e,s[0].field).label,(0,n.o)(e,s[1].field).label],moreInfo:a.tile.tooltips.relationship,helpId:"120003258",imageFile:`${o}/Relationship.png`};case"relationship-size":return{title:a.tile.relationshipSizeStyle,moreInfo:a.tile.tooltips.relationshipSize,helpId:"120003259",imageFile:`${o}/RelationshipSize.png`};case"predominance":return{title:a.tile.predominanceStyle,moreInfo:a.tile.tooltips.predominance,helpId:"120003256",imageFile:`${o}/Predominance.png`};case"predominance-size":return{title:a.tile.predominanceSizeStyle,moreInfo:a.tile.tooltips.predominanceSize,helpId:"120003257",imageFile:`${o}/PredominanceSize.png`};case"chart":return{title:"chart-size"!==r||["gallery","assist"].includes(i)?a.tile.chartStyle:a.tile.chartStyleColor,moreInfo:a.tile.tooltips.chart,helpId:"120003729",imageFile:`${o}/Chart.jpg`};case"chart-size":return{title:a.tile.chartSizeStyle,moreInfo:a.tile.tooltips.chartSize,helpId:"120003730",imageFile:`${o}/ChartSize.jpg`};case"compare":return{title:a.tile.compareStyle,moreInfo:a.tile.tooltips.compare,helpId:"120003255",imageFile:`${o}/Ratio.png`};case"raster-stretch":return{title:a.tile.symbologyStretchStyle,moreInfo:a.tile.tooltips.stretch,helpId:"120003269",imageFile:`${o}/stretch.png`};case"raster-rgb":return{title:a.tile.symbologyRGBStyle,moreInfo:a.tile.tooltips.rgb,helpId:"120003270",imageFile:`${o}/rgb.png`};case"raster-unique-value":return{title:a.tile.symbologyUniqueValuesStyle,moreInfo:a.tile.tooltips.uniqueValues,helpId:"120003271",imageFile:`${o}/uniqueValues.png`};case"raster-shaded-relief":return{title:a.tile.symbologyShadedReliefStyle,moreInfo:a.tile.tooltips.shadedRelief,helpId:"120003273",imageFile:`${o}/shadedRelief.png`};case"raster-vector-field":return{title:a.tile.symbologyVectorFieldStyle,moreInfo:a.tile.tooltips.vectorField,helpId:"120003275",imageFile:`${o}/vectorField.png`};case"raster-colormap":return{title:a.tile.symbologyColormapStyle,moreInfo:a.tile.tooltips.colormap,helpId:"120003274",imageFile:`${o}/colormap.png`};case"raster-class-breaks":return{title:a.tile.symbologyClassBreaksStyle,moreInfo:a.tile.tooltips.classify,helpId:"120003272",imageFile:`${o}/classBreaks.png`};case"raster-flow":return{title:a.tile.rasterFlowStyle,moreInfo:a.tile.tooltips.flow,helpId:"120003676",imageFile:`${o}/flow.png`}}}(this.smartMappingState,this.type,this.tileType)}componentDidLoad(){this.flowItemNode=(0,a.f)(this.el,"calcite-flow-item")}disconnectedCallback(){this.removeInfoPopover()}render(){const{selected:e,tileInfo:t,tileType:i,smartMappingState:a}=this,{title:n,imageFile:o}=t,{strings:l}=a,r="rtl"===(0,u.a)(this.el),d={tile:!0,"tile-selected":e},c={"tile-image":"assist"!==i,"tile-image-selected":"gallery"===i&&e,rtl:r},h={"tile-check":!0,rtl:r};return(0,s.h)(s.H,{key:"1983a38e71c07c4ca386a480a92127db245b1a9e","aria-label":`${n} ${e?"assist"===i?l.tile.customize:l.tile.styleOptions:l.tile.selectStyle}`,"aria-selected":e,role:"button",tabindex:"0"},(0,s.h)("div",{key:"5e2f3018c519e2da81de488a1fc6fdc61fb12ebf",class:d,tabindex:"0",ref:e=>{e&&(this.tileNode=e,this.addTileListeners(e))}},(0,s.h)("div",{key:"cc0ec99b16e5e9ff5cc2cb4218c170b3fceb9430",class:c,style:{backgroundImage:`url(${(0,s.a)("./assets/smart-mapping-thumbnails/")}${o})`},"aria-hidden":"true"}),("gallery"===i||"assist"===i)&&(0,s.h)("div",{key:"298756020348f6de84598dc747a89fda2c1618d5",class:h,"aria-label":"","aria-hidden":"true"},(0,s.h)("calcite-checkbox",{key:"03a173b6c08e7662ee0520c1e919d9875de02356",name:"style-tile-check-name",checked:e,tabindex:"-1",onCalciteCheckboxChange:this.checkboxChangeHandler})),this.renderTileLink()))}renderTheme(){const{smartMappingState:e}=this,{layer:t}=e,{tileType:i,type:a}=this;if("imagery"===t.type||"imagery-tile"===t.type)return(0,s.h)(s.F,null);if("assist"===i)return(0,s.h)(s.F,null);const o=(0,n.a)(e);if("chart-size"===o)return(0,s.h)(s.F,null);if(!["color","size","color-age","size-age","color-size"].includes(a))return(0,s.h)(s.F,null);if(!["color","size","color-age","size-age","color-size","color-age-size","color-size-age","type-size","type-size-age","relationship-size"].includes(o))return(0,s.h)(s.F,null);if("gallery"===i&&["type-size","relationship-size","color-age-size","color-size-age","type-size-age"].includes(o))return(0,s.h)(s.F,null);const l=(0,n.j)(e),r=l.authoringInfo,d="univariate-color-size"===r?.type,c=(0,n.G)(l,"reference-size");if("gallery"===i&&"color-size"===o&&!d)return(0,s.h)(s.F,null);const h=(0,n.b)(l,"color");if("gallery"===i&&"color"===o&&!h)return(0,s.h)(s.F,null);const p=(0,n.b)(l,"size");if("gallery"===i&&"size"===o&&!p&&!c)return(0,s.h)(s.F,null);const u="color-age"===a?"color":"size-age"===a?"size":"color-size"===a?"colorSize":a;return(0,s.h)("arcgis-smart-mapping-theme-button",{ref:e=>this.themeButtonNode=e,rendererSubtype:u,buttonVersion:"minimal",onArcgisSmartMappingThemeButtonChange:e=>this.changeTheme(e)})}changeTheme(e){const{smartMappingState:t}=this,{layer:i,mapView:a}=t,{type:o}=this,r=(0,n.j)(t),h=(0,n.a)(t),p=(0,n.b)(r,"size"),u=(0,n.G)((0,n.j)(t),"reference-size"),m=r.authoringInfo,g="univariate-color-size"===m?.type;if("color"!==o&&"color-age"!==o||!["color","color-age","color-size","color-age-size","color-size-age"].includes(h))if("size"!==o&&"size-age"!==o||!["size","size-age","color-size","color-age-size","color-size-age","type-size","type-size-age","relationship-size"].includes(h))"color-size"===o&&g&&(0,l.r)((0,S.b)(t,{theme:e.detail}),this.flowItemNode).then((e=>{(0,n.u)(t,e.renderer),(0,s.f)(this.el),(0,s.f)(this.themeButtonNode)}),(e=>{(0,s.f)(this.themeButtonNode),this.arcgisSmartMappingTileError.emit(e)}));else{const o=u,r="reference-size"===e.detail,d=!o&&r||o&&!r;let m=c.f;["size-age","color-size-age","type-size-age"].includes(h)?m=c.h:d&&(m=c.f);const g={theme:e.detail};r&&(g.referenceSizeOptions={symbolStyle:"circle"}),d&&(g.layer=i,g.mapView=a,g.fieldInfos=[{field:p?p.field:u?.field}],g.noReuse=!0),(0,l.r)(m(t,g),this.flowItemNode).then((async o=>{if(d)if(["type-size","relationship-size"].includes(h)){const{smartMappingState:e}=this,{modules:t}=e,i=(0,n.j)(e);i.visualVariables=o.renderer.visualVariables,i.authoringInfo.visualVariables=o.renderer.authoringInfo.visualVariables,i.uniqueValueInfos.forEach((i=>{const s=(0,n.Z)(e,i?.symbol)||new t.EsriColor("gray"),a=o.renderer.classBreakInfos[0].symbol.clone();"cim"===a.type?t.cimSymbolUtils.applyCIMSymbolColor(a,s,{layersToColor:"fill-and-outline"}):(0,n.X)(e,a,s),i.symbol=a})),i.defaultSymbol=void 0,i.defaultLabel=void 0,i.backgroundFillSymbol=void 0,(0,n.u)(e,i)}else if("color-size"===h){const{smartMappingState:e}=this,{modules:t,useFeatureReduction:s}=e,l=(0,n.j)(e),r=(0,n.b)(l,"color"),d=(0,n.G)(l,"color"),{renderer:c}=await t.ColorCreator.createContinuousRenderer({layer:i,view:a,field:r.field,valueExpression:r.valueExpression??void 0,valueExpressionTitle:r.valueExpressionTitle??void 0,normalizationField:r.normalizationField??void 0,theme:d?.theme,colorScheme:(0,n.Y)(e),forBinning:"binning"===i.featureReduction?.type&&s});if(o.renderer.visualVariables.push(r),c.authoringInfo?.visualVariables?.length){const e=(0,n.G)(c,"color");o.renderer.authoringInfo.visualVariables.push(e)}o.renderer.field=r.field,o.renderer.valueExpression=r.valueExpression,o.renderer.valueExpressionTitle=r.valueExpressionTitle,o.renderer.normalizationField=r.normalizationField,(0,n.u)(e,o.renderer)}else(0,n.u)(t,o.renderer);else if(["size","size-age"].includes(h))(0,n.u)(t,o.renderer);else{const e=(0,n.j)(t);e.visualVariables=(0,n.V)(e,"size")||[],e.visualVariables.push((0,n.b)(o.renderer,"size")),e.authoringInfo.visualVariables=(0,n.W)(e,"size")||[],e.authoringInfo.visualVariables.push((0,n.G)(o.renderer,"size")),(0,n.u)(t)}(0,s.f)(this.el),(0,s.f)(this.themeButtonNode),this.arcgisSmartMappingTileThemeChange.emit(e.detail)}),(async e=>{(0,s.f)(this.themeButtonNode),this.arcgisSmartMappingTileError.emit(e)}))}else{let i=d.b;["color-age","color-age-size"].includes(h)&&(i=d.d),(0,l.r)(i(t,{theme:e.detail}),this.flowItemNode).then((e=>{if(["color-size","color-age-size","color-size-age"].includes(h)){const i=(0,n.j)(t);i.visualVariables=(0,n.V)(i,"color")||[],i.visualVariables.push((0,n.b)(e.renderer,"color")),i.authoringInfo.visualVariables=(0,n.W)(i,"color")||[],i.authoringInfo.visualVariables.push((0,n.G)(e.renderer,"color")),(0,n.u)(t)}else(0,n.u)(t,e.renderer);(0,s.f)(this.el),(0,s.f)(this.themeButtonNode)}),(e=>{(0,s.f)(this.themeButtonNode),this.arcgisSmartMappingTileError.emit(e)}))}}renderTileLink(){const{selected:e,tileInfo:t,tileType:i,fields:a,smartMappingState:n}=this,{title:o,subText:l}=t,{strings:r}=n;return(0,s.h)("div",{class:"style-link","aria-label":o},(0,s.h)("div",{class:"style-link-title "+("gallery"===i?"info":"")},(0,s.h)("div",{"aria-hidden":"true"},o),"gallery"===i&&(0,s.h)("calcite-button",{class:"style-link-info",scale:"s",iconStart:"information",appearance:"transparent",kind:"neutral",onClick:e=>this.handleInfoClick(e),label:r.tile.moreInfo,ref:e=>{e&&(this.infoIconNode=e,e.addEventListener("keyup",(e=>{e.stopPropagation(),(" "===e.key||!this.infoPopoverNode&&"Enter"===e.key)&&this.handleInfoClick(e)})),e.addEventListener("keydown",(e=>{" "===e.key&&(e.stopPropagation(),e.preventDefault())})))}}),"gallery"!==i&&l&&(0,s.h)("div",{class:"style-link-sub-text"},"string"==typeof l?l:l.map((e=>(0,s.h)("div",null,e)))),"assist"===i&&!!a?.length&&(0,s.h)("div",{class:"style-link-sub-text"},`${r.tile.fields} ${a.toString().replace(",",", ")}`)),"assist"!==i&&(e||"gallery"!==i)&&this.renderTheme(),(e||!["gallery","assist"].includes(i))&&this.renderStyleOptions())}renderStyleOptions(){const{tileType:e,smartMappingState:t}=this,{strings:i}=t;return(0,s.h)("calcite-button",{appearance:"outline-fill",width:"full",scale:"s",kind:"assist"===e?"neutral":"brand",label:"assist"===e?i.tile.customize:i.tile.styleOptions},"assist"===e?i.tile.customize:i.tile.styleOptions)}handleInfoClick(e){e.stopPropagation();const{tileInfo:t,flowItemNode:i,smartMappingState:s}=this,{title:a,moreInfo:n,helpId:o}=t,{config:l,strings:r}=s;this.removeInfoPopover(),this.infoPopoverNode=document.createElement("arcgis-smart-mapping-info-popover"),this.infoPopoverNode.smartMappingState=s,this.infoPopoverNode.props={title:a,moreInfo:n,helpId:o,config:l,flowItemNode:i,strings:r},this.infoPopoverNode.referenceElement=this.infoIconNode,this.infoPopoverNode.addEventListener("arcgisSmartMappingInfoPopoverClose",(e=>{e.stopPropagation(),this.removeInfoPopover(),setTimeout((()=>{this.infoIconNode.setFocus()}),200)})),this.infoPopoverNode.addEventListener("arcgisSmartMappingInfoPopoverDisconnected",(e=>{e.stopPropagation(),this.removeInfoPopover()})),document.body.appendChild(this.infoPopoverNode),this.infoPopoverNode.setOpen(!0),setTimeout((()=>{this.infoPopoverNode.setFocus()}),100),setTimeout((()=>{this.documentClickHandler=e=>{(0,v.i)(e.target)||(this.removeInfoPopover(),setTimeout((()=>{this.infoIconNode.setFocus()}),200))},document.addEventListener("click",this.documentClickHandler),this.panelScrollHandler=()=>{this.removeInfoPopover()},i?.addEventListener("calciteFlowItemScroll",this.panelScrollHandler)}),100)}removeInfoPopover(){const{flowItemNode:e}=this;document.body.querySelectorAll(".arcgis-smart-mapping-popover").forEach((e=>document.body.removeChild(e))),this.infoPopoverNode=void 0,this.documentClickHandler&&(document.removeEventListener("click",this.documentClickHandler),this.documentClickHandler=void 0),this.panelScrollHandler&&(e?.removeEventListener("calciteFlowItemScroll",this.panelScrollHandler),this.panelScrollHandler=void 0)}addTileListeners(e){e.addEventListener("keyup",this.keyupEventHandler),e.addEventListener("keydown",this.keydownEventHandler),e.addEventListener("click",this.clickEventHandler)}get el(){return(0,s.g)(this)}};E.style=".tile {\n  background-color: white;\n  position: relative;\n  margin: 6px;\n  cursor: pointer;\n  box-shadow:\n    0 1px 10px 2px rgba(0, 0, 0, 0.05),\n    0 0 0 1px #e0e0e0;\n  transition: box-shadow 125ms ease-in-out;\n}\n\n.tile:hover {\n  z-index: 5;\n  box-shadow:\n    0 1px 0 2px rgba(0, 0, 0, 0.05),\n    0 0 0 1px #e0e0e0;\n}\n\n.tile:focus {\n  outline: 2px solid var(--calcite-color-brand);\n}\n\n.tile-selected {\n  box-shadow:\n    0 1px 10px 2px rgba(0, 0, 0, 0.05),\n    0 0 0 1px var(--calcite-color-brand);\n}\n\n.tile-selected:focus {\n  box-shadow:\n    0 1px 10px 2px rgba(0, 0, 0, 0.05),\n    0 0 0 2px var(--calcite-color-brand);\n}\n\n.tile-selected:hover {\n  z-index: 5;\n  box-shadow:\n    0 1px 0 2px rgba(0, 0, 0, 0.05),\n    0 0 0 1px var(--calcite-color-brand);\n}\n\n.tile-check {\n  position: absolute;\n  top: 10px;\n  right: 10px;\n}\n.tile-check.rtl {\n  right: auto;\n  left: 10px;\n}\n.style-link {\n  padding: 9px 9px;\n}\n\n.style-link-title {\n  font-weight: bold;\n  padding-bottom: 5px;\n}\n.style-link-title.info {\n  display: flex;\n}\n.style-link-sub-text {\n  font-size: 80%;\n  padding: 0 0 6px 0;\n  font-weight: normal;\n}\n.style-link-options {\n  color: #0079c1;\n  display: flex;\n  flex-direction: row nowrap;\n  svg {\n    fill: #0079c1;\n  }\n}\n.tile-image {\n  height: 100px;\n  width: 100%;\n  background-size: cover;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.tile-image-selected {\n  height: 68px;\n}\n.tile-image.rtl {\n  transform: scaleX(-1);\n}\n.style-sub-text {\n  font-size: 80%;\n  padding: 0 0 6px 0;\n}\n.style-link-info {\n  height: 18px;\n  margin-top: -2px;\n  margin-inline-start: 5px;\n}\n"},13898:(e,t,i)=>{function s(e,t,i){t.labelFormatFunction=t=>l(e,t,i,"short-date"),t.inputFormatFunction=t=>l(e,t,i,"short-date"),t.inputParseFunction=e=>function(e,t){if(!e)return e;let i;if(t&&"system"!==t)if("unknown"===t)i=e;else{const s=new Date;i=e+(new Date(s.toLocaleString("en-US",{timeZone:"utc"})).getTime()-new Date(s.toLocaleString("en-US",{timeZone:t})).getTime())}else{i=e+6e4*(new Date).getTimezoneOffset()}return console.log("mapTZToUTC",e," - ",new Date(e).toISOString()," - ",new Date(i).toISOString()),i}(Date.parse(e),i)}function a(e,t){let i;if(t&&"system"!==t)if("unknown"===t)i=new Date(e).toISOString();else{const s=(new Date).getTimezoneOffset(),a=new Date(e).toLocaleString("en-US",{timeZone:t});i=new Date(new Date(a).getTime()-6e4*s).toISOString()}else{const t=(new Date).getTimezoneOffset();i=new Date(e-6e4*t).toISOString()}return i}function n(e,t,i){let s;if(t&&"system"!==t)if("unknown"===t)s=new Date(e).toISOString();else{const i=(new Date).getTimezoneOffset(),a=new Date(e).toLocaleString("en-US",{timeZone:t});s=new Date(new Date(a).getTime()-6e4*i).toISOString()}else{const t=(new Date).getTimezoneOffset();s=new Date(e-6e4*t).toISOString()}return s=i?s.substring(11,19):s.substring(11,16),s}function o(e,t){let i,s=new Date(e);if(s=new Date(s.getTime()-6e4*s.getTimezoneOffset()),t&&"system"!==t)if("unknown"===t)i=s.getTime();else{const e=new Date(s.toLocaleString("en-US",{timeZone:"utc"})).getTime()-new Date(s.toLocaleString("en-US",{timeZone:t})).getTime();i=s.getTime()+e}else{const e=(new Date).getTimezoneOffset();i=s.getTime()+6e4*e}return i}function l(e,t,i,s){const{modules:a}=e;let n;return n="unknown"===i?a.intl.formatDate(t,{...a.intl.convertDateFormatToIntlOptions(s||"short-date-short-time"),timeZone:"utc",timeZoneName:"shortOffset"}):a.intl.formatDate(t,{...a.intl.convertDateFormatToIntlOptions(s||"short-date-short-time"),timeZone:i}),n}i.d(t,{a:()=>s,b:()=>n,d:()=>o,u:()=>a})},58325:(e,t,i)=>{i.d(t,{a:()=>a,d:()=>s,t:()=>n});const s=(e,t)=>{let i,s="idle";const a=async(...a)=>await new Promise((n=>{switch(s){case"flushed":s="idle",i?(clearTimeout(i),n(e(...a))):n(null);break;case"invoked":clearTimeout(i),s="idle",n(e(...a));break;case"cancelled":clearTimeout(i),s="idle",n(null);break;default:i&&clearTimeout(i),s="pending",i=setTimeout((()=>{s="idle",n(e(...a))}),t)}}));return a.flush=async function(...e){return s="flushed",await a(...e)},a.invoke=async function(...e){return s="invoked",await a(...e)},a.cancel=async function(...e){return s="cancelled",await a(...e)},a.getStatus=function(){return s},a},a=(e,t)=>{let i;return async(...s)=>await new Promise((a=>{i||(i=setTimeout((()=>{clearTimeout(i),i=void 0,a(e(...s))}),t))}))};function n(e){return new Promise((t=>setTimeout(t,e)))}},76133:(e,t,i)=>{function s(e){if("ARCGIS-SMART-MAPPING-INFO-POPOVER"===e?.tagName)return!0;{let t=e?.parentElement;for(;t;){if("ARCGIS-SMART-MAPPING-INFO-POPOVER"===t.tagName)return!0;t=t.parentElement}}return!1}i.d(t,{i:()=>s})},98518:(e,t,i)=>{i.d(t,{a:()=>l,b:()=>o,g:()=>h,u:()=>n});var s=i(68180),a=i(99592);i(97127);function n(e,t){const{modules:i}=e,n=(0,a.j)(e),o=i.esriLang.clone(n.classBreakInfos);n.classBreakInfos=[],o.forEach(((i,a)=>{i=function(e,t,i,a,n){if((0,s.i)(i))if(0===i);else if(i<1){const s=Math.round(1/i);t.minValue="first"===n?Math.floor(t.minValue/i)/s:Math.round(t.minValue/i)/s,t.maxValue="last"===n?Math.ceil(t.maxValue/i)/s:Math.round(t.maxValue/i)/s,t.label=`${a>0?"> ":""}${t.minValue.toLocaleString(e.fullLocale,{maximumSignificantDigits:15})} - ${t.maxValue.toLocaleString(e.fullLocale,{maximumSignificantDigits:15})}`}else t.minValue="first"===n?Math.floor(t.minValue/i)*i:Math.round(t.minValue/i)*i,t.maxValue="last"===n?Math.ceil(t.maxValue/i)*i:Math.round(t.maxValue/i)*i,t.label=`${a>0?"> ":""}${t.minValue.toLocaleString()} - ${t.maxValue.toLocaleString()}`;return t}(e,i,t,a,0===a?"first":a===o.length-1?"last":void 0),n.addClassBreakInfo({minValue:i.minValue,maxValue:i.maxValue,symbol:i.symbol,label:i.label})}))}function o(e,t){const i=(0,a.j)(e).classBreakInfos;let s=t,n=Number.POSITIVE_INFINITY;i.forEach((e=>{s||(s=Math.max(r(e.minValue),r(e.maxValue))),n=Math.min(n,e.maxValue-e.minValue)}));const o=[];return n>1e7?(o.push(1e7),o.push(1e6),o.push(1e5),o.push(1e4),o.push(1e3),o.push(100),o.push(10),s>0&&o.push(1),s>1&&o.push(.1),s>2&&o.push(.01)):n>1e6?(o.push(1e6),o.push(1e5),o.push(1e4),o.push(1e3),o.push(100),o.push(10),s>0&&o.push(1),s>1&&o.push(.1),s>2&&o.push(.01)):n>1e5?(o.push(1e5),o.push(1e4),o.push(1e3),o.push(100),o.push(10),s>0&&o.push(1),s>1&&o.push(.1),s>2&&o.push(.01)):n>1e4?(o.push(1e4),o.push(1e3),o.push(100),o.push(10),s>0&&o.push(1),s>1&&o.push(.1),s>2&&o.push(.01)):n>1e3?(o.push(1e3),o.push(100),o.push(10),s>0&&o.push(1),s>1&&o.push(.1),s>2&&o.push(.01),s>3&&o.push(.001)):n>100?(o.push(100),o.push(10),s>0&&o.push(1),s>1&&o.push(.1),s>2&&o.push(.01),s>3&&o.push(.001),s>4&&o.push(1e-4),s>5&&o.push(1e-5)):n>10?(o.push(10),s>0&&o.push(1),s>1&&o.push(.1),s>2&&o.push(.01),s>3&&o.push(.001),s>4&&o.push(1e-4),s>5&&o.push(1e-5),s>6&&o.push(1e-6)):n>1?(s>0&&o.push(1),s>1&&o.push(.1),s>2&&o.push(.01),s>3&&o.push(.001),s>4&&o.push(1e-4),s>5&&o.push(1e-5),s>6&&o.push(1e-6)):n>.1?(s>1&&o.push(.1),s>2&&o.push(.01),s>3&&o.push(.001),s>4&&o.push(1e-4),s>5&&o.push(1e-5),s>6&&o.push(1e-6)):n>.01?(s>2&&o.push(.01),s>3&&o.push(.001),s>4&&o.push(1e-4),s>5&&o.push(1e-5),s>6&&o.push(1e-6)):n>.001?(s>3&&o.push(.001),s>4&&o.push(1e-4),s>5&&o.push(1e-5),s>6&&o.push(1e-6),s>7&&o.push(1e-7)):n>1e-4?(s>4&&o.push(1e-4),s>5&&o.push(1e-5),s>6&&o.push(1e-6),s>7&&o.push(1e-7),s>8&&o.push(1e-8)):n>1e-5&&(s>5&&o.push(1e-5),s>6&&o.push(1e-6),s>7&&o.push(1e-7),s>8&&o.push(1e-8),s>9&&o.push(1e-9)),o}function l(e){const t=(0,a.j)(e);let i=1e10;return t.classBreakInfos.forEach((e=>{i=Math.min(i,d(e.minValue)),i=Math.min(i,d(e.maxValue))})),i}function r(e){let t=1;for(;Math.round(e*t)/t!==e;)t*=10;return Math.log(t)/Math.LN10}function d(e){let t=1e-8;for(;c(Math.round(e/t)*t)===e;)t*=10;return t/10}function c(e){return Number.parseFloat(e.toPrecision(12))}function h(e){let t=0;e.forEach((e=>{(0,s.i)(e.value)?t=Math.max(r(c(e.value)),t):((0,s.i)(e.minValue)&&(t=Math.max(r(c(e.minValue)),t)),(0,s.i)(e.maxValue)&&(t=Math.max(r(c(e.maxValue)),t)),(0,s.i)(e.min)&&(t=Math.max(r(c(e.min)),t)),(0,s.i)(e.max)&&(t=Math.max(r(c(e.max)),t)))})),t=Math.min(t,3);const i=e[0],a=e[e.length-1],n=Math.min(i.minValue??i.min??i.value,a.minValue??a.min??a.value),o=Math.max(i.maxValue??i.max??i.value,a.maxValue??a.max??a.value)-n;return o/e.length<2e-7?t=8:o/e.length<2e-6?t=7:o/e.length<2e-5?t=6:o/e.length<2e-4?t=5:o/e.length<.002?t=4:o/e.length<.02?t=3:o/e.length<.2?t=Math.max(t,2):o/e.length<2&&(t=Math.max(t,1)),Math.round(t)}},42444:(e,t,i)=>{function s(e,t){if(!e||!t)return;let i=t.assetsPath;i.endsWith("/")||(i+="/"),e?.firstElementChild?.insertAdjacentHTML("beforebegin",`<link rel="stylesheet" href="${i}esri/themes/light/main.css" />`)}i.d(t,{i:()=>s})},79323:(e,t,i)=>{i.d(t,{a:()=>l,b:()=>r,c:()=>o,d:()=>d});i(68180);var s=i(99592),a=(i(97127),i(58944)),n=i(67751);async function o(e,t){const i=(0,s.a)(e),n=(t=t||{}).fieldInfos.length>1?t.fieldInfos[1]:t.fieldInfos[0];if((0,a.s)(e,{fieldInfos:[n]})&&["color-size","type-size"].includes(i)){if((0,s.b)((0,s.j)(e),"size")&&(0,s.j)(e).authoringInfo)return await c(e,(0,s.j)(e),t)}return await(0,a.c)(e,{...t,fieldInfos:[t.fieldInfos[1]]}).then((async i=>await c(e,i.renderer,t)))}async function l(e,t){const i=(0,s.a)(e),n=(t=t||{}).fieldInfos.length>1?t.fieldInfos[1]:t.fieldInfos[0];if((0,a.s)(e,{fieldInfos:[n]})&&["color-size-age","type-size-age"].includes(i)){if((0,s.b)((0,s.j)(e),"size")&&(0,s.j)(e).authoringInfo)return await c(e,(0,s.j)(e),t)}return await(0,a.a)(e,{...t,fieldInfos:[t.fieldInfos[1]]}).then((async i=>await c(e,i.renderer,t)))}async function r(e,t,i){return t=t||{},await(0,a.f)(e,{...t,fieldInfos:t.fieldInfos?[t.fieldInfos[1]]:null}).then((async a=>await(0,n.a)(e,{...t,fieldInfos:t.fieldInfos?[t.fieldInfos[0]]:null}).then((t=>(h(e,t.renderer,a.renderer),t.backgroundFillSymbol=(0,s.j)(e).backgroundFillSymbol,"size"===i&&(t.statistics=a.statistics),t)))))}async function d(e,t,i){const{modules:o}=e;return t=t||{},await(0,a.h)(e,{...t,fieldInfos:t.fieldInfos?[t.fieldInfos[1]]:null}).then((async a=>{if(delete t.units,delete t.startTime,delete t.endTime,(0,s.T)(t)){const t=(0,s.j)(e).clone();t.visualVariables=(0,s.V)(t,"size")||[];const i=(0,s.b)(a.renderer,"size");t.visualVariables.push(i),t.authoringInfo=t.authoringInfo||new o.AuthoringInfo({}),t.authoringInfo.visualVariables=(0,s.W)(t,"size")||[];const n=(0,s.G)(a.renderer,"size");return t.authoringInfo.visualVariables.push(n),{renderer:t}}return await(0,n.a)(e,{...t,fieldInfos:t.fieldInfos?[t.fieldInfos[0]]:null}).then((t=>(h(e,t.renderer,a.renderer),t.backgroundFillSymbol=(0,s.j)(e).backgroundFillSymbol,"size"===i&&(t.statistics=a.statistics),t)))}))}async function c(e,t,i){const a=(0,s.a)(e);if((0,n.s)(e,i)&&["type","type-size","type-size-age"].includes(a)){const i=(0,s.j)(e).clone();return h(e,i,t),{renderer:i}}return await(0,n.c)(e,{...i,fieldInfos:[i.fieldInfos[0]]}).then((i=>(h(e,i.renderer,t),i)))}function h(e,t,i){const{modules:a}=e;t.visualVariables=(0,s.V)(t,"size")||[],t.visualVariables=(0,s.V)(t,"size","auto")||[];const n=(0,s.b)(i,"size");t.visualVariables.push(n),t.authoringInfo=t.authoringInfo||new a.AuthoringInfo({}),t.authoringInfo.visualVariables=(0,s.W)(t,"size")||[];const o=(0,s.G)(i,"size");if(t.authoringInfo.visualVariables.push(o),(0,s.z)(e)){const a=i.classBreakInfos?.length?i.classBreakInfos[0].symbol:i.uniqueValueInfos?.length?i.uniqueValueInfos[0].symbol:(0,s.m)(e,"type-size"),n=t.uniqueValueInfos.slice();n.forEach((t=>{const i=(0,s.Z)(e,t.symbol);t.symbol=a.clone(),(0,s.X)(e,t.symbol,i)})),t.uniqueValueInfos=n,t.backgroundFillSymbol=i.backgroundFillSymbol;const o=(0,s.b)(i,"size","outline");o&&t.visualVariables.push(o)}}}}]);