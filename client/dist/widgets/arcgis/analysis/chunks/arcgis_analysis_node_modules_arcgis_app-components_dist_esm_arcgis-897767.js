/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-897767.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-897767"],{42555:(e,t,n)=>{n.r(t),n.d(t,{arcgis_scheduler:()=>O});var a=n(19564),i=n(5019),s=n(66507);n(91102),n(73807),n(89261),n(98034),n(99004);function r(e,t){let n=parseInt(e,10);return!isNaN(n)&&t&&(n+=t),n>7?n=1:n<1&&(n=7),n.toString()}function l(e,t){let n=parseInt(e,10);return!isNaN(n)&&t&&(n+=t),n>31?n=1:n<1&&(n=31),n.toString()}function h(e,t,n,a){function i(e){const t=e.getUTCFullYear(),n=e.getUTCMonth();return new Date(t,n+1,0).getUTCDate()}const s=a?new Date(a):new Date,r=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),Number(e),Number(t)));let l=r.getDate()-r.getUTCDate();if(l>1)l-=i(r);else if(l<-1){l+=i(new Date(Date.UTC(r.getUTCFullYear(),r.getUTCMonth()-1,1)))}return n?0==l?l:-1*l:l}function o(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function d(e,t=!1){const n=new Date(e.valueOf());if(n.setHours(0,0,0,0),t){const e=new Date;n.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}return n.valueOf()}function c(e){const t=new Date,n=e.split(":");return t.setHours(parseInt(n[0]||"0")),t.setMinutes(parseInt(n[1]||"0")),t.setSeconds(parseInt(n[2]||"0")),{minute:t.getUTCMinutes().toString(),hour:t.getUTCHours().toString(),dayOffset:h(t.getUTCHours().toString(),t.getUTCMinutes().toString(),!0)}}class u{constructor(e){this.data=e,this.cron={minute:"*",hour:"*",dayOfMonth:"*",month:"*",dayOfWeek:"?"}}build(){try{switch(this.data.repeatType){case i.R.DAY:this.buildDaily();break;case i.R.WEEK:this.buildWeekly();break;case i.R.MONTH:this.buildMonthly();break;default:throw new Error("Invalid repeat type.")}const e=this.toCronExpression();return{result:{cron:this.cron,expression:e}}}catch(e){return{error:{code:"unhandledError",message:e.message||e.toString()||"Unhandled error"}}}}toCronExpression(){return`${this.cron.minute} ${this.cron.hour} ${this.cron.dayOfMonth} ${this.cron.month} ${this.cron.dayOfWeek}`}buildDaily(){if(this.data.beginningOn&&this.data.dailyTime){const e=c(this.data.dailyTime);this.cron.minute=e.minute,this.cron.hour=e.hour,this.cron.dayOfMonth=`*/${this.data.dailyRepeatInterval}`}}buildWeekly(){var e;if(null!==this.data.beginningOn&&void 0!==this.data.beginningOn&&null!==this.data.weeklyTime&&void 0!==this.data.weeklyTime&&null!==this.data.weeklyDaysOfWeek&&void 0!==this.data.weeklyDaysOfWeek){const t=c(this.data.weeklyTime);this.cron.minute=t.minute.toString(),this.cron.hour=t.hour.toString(),this.cron.dayOfMonth="?";let n=[];0===this.data.weeklyDaysOfWeek.length||(1===this.data.weeklyDaysOfWeek.length&&function(e){if(/^\d+-\d+$/.test(e)){const[t,n]=e.split("-").map(Number);return t<=n}return!1}(this.data.weeklyDaysOfWeek[0])?(n=null===(e=function(e){if(!/^\d+-\d+$/.test(e))return;const[t,n]=e.split("-").map(Number);if(t>n)return;const a=[];for(let e=t;e<=n;e++)a.push(e.toString());return a}(this.data.weeklyDaysOfWeek[0]))||void 0===e?void 0:e.map((e=>r(e,t.dayOffset))),this.cron.dayOfWeek=n.join(",")):1===this.data.weeklyDaysOfWeek.length&&"*"===this.data.weeklyDaysOfWeek[0]?this.cron.dayOfWeek="*":(n=this.data.weeklyDaysOfWeek.map((e=>r(e,t.dayOffset))),this.cron.dayOfWeek=n.join(",")))}}buildMonthly(){if(this.data.monthlyTime){const{minute:e,hour:t,dayOffset:n}=c(this.data.monthlyTime);this.cron.minute=e,this.cron.hour=t,this.data.monthlyDayOfMonth&&(this.cron.dayOfMonth=l(this.data.monthlyDayOfMonth,n))}this.data.monthlyRepeatInterval&&(this.cron.month=`*/${this.data.monthlyRepeatInterval}`)}}function y(e){return{beginningOn:(null==e?void 0:e.beginningOn)||m(new Date),repeatType:(null==e?void 0:e.repeatType)||i.R.DAY,dailyRepeatInterval:(null==e?void 0:e.dailyRepeatInterval)||"1",dailyTime:(null==e?void 0:e.dailyTime)||"00:00",weeklyDaysOfWeek:(null==e?void 0:e.weeklyDaysOfWeek)||[],weeklyTime:(null==e?void 0:e.weeklyTime)||"00:00",monthlyDayOfMonth:(null==e?void 0:e.monthlyDayOfMonth)||"",monthlyRepeatInterval:(null==e?void 0:e.monthlyRepeatInterval)||"1",monthlyTime:(null==e?void 0:e.monthlyTime)||"00:00",endingOnType:(null==e?void 0:e.endingOnType)||i.E.NEVER,endingOnDate:(null==e?void 0:e.endingOnDate)||m(new Date),endingOnCount:(null==e?void 0:e.endingOnCount)||null}}function m(e){return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`}function g(e){const[t,n,a]=e.split("-").map(Number);return new Date(t,n-1,a)}function p(){const e=new Date;return e.setHours(0,0,0,0),e}function f(e,t,n){return(0,a.h)("slot",Object.assign({name:e},t?{onSlotchange:t}:{}),n)}function D(e){const t=new u(e),{result:n}=t.build();return{schedulerResponse:{startDate:e.beginningOn?d(g(e.beginningOn),!0).toString():"",endDate:"date"===e.endingOnType&&e.endingOnDate?d(g(e.endingOnDate),!0).toString():"",maxOccurrence:"count"===e.endingOnType?e.endingOnCount:0,cronExpression:n.expression,cronSchedule:n.cron},schedulerInputValues:e}}class b{constructor(e){this.startDateInMillisecondsStr="",this.endDateInMillisecondsStr="",this.dayOfWeekArray=[],this.startDate="",this.startDateAsDate=null,this.endingOn="never",this.endDate="",this.endDateAsDate=null,this.maxOccurrence=0;const{startDate:t,endDate:n,maxOccurrence:a,cronSchedule:i}=e;(null==t?void 0:t.length)>0&&!isNaN(Number(t))&&(this.startDateInMillisecondsStr=t),(null==n?void 0:n.length)>0&&!isNaN(Number(n))&&(this.endDateInMillisecondsStr=n),a&&(this.maxOccurrence=a),this.cronSchedule=i,this.parseCronIntervalType()}parseCronIntervalType(){const{dayOfMonth:e,dayOfWeek:t,month:n}=this.cronSchedule;"*"!==e&&"?"!==e&&"*"===n&&(this.cronIntervalType=i.R.DAY),"?"===e&&"*"!==t&&"?"!==t&&(this.cronIntervalType=i.R.WEEK),"*"!==n&&(this.cronIntervalType=i.R.MONTH)}parseCronInterval(e){const t=(e||"").split("/"),n=t.length>1?t[1]:null;return n||""}parseCronTime(){const{hour:e,minute:t}=this.cronSchedule,n=new Date;n.setUTCHours(Number(e),Number(t));return{localTimeString:`${n.getHours()}:${n.getMinutes()}`,daysOffset:h(e,t,!1)}}setCronForMonth(){const{dayOfMonth:e,month:t}=this.cronSchedule,{localTimeString:n,daysOffset:a}=this.parseCronTime();this.monthlyTime=n,this.monthlyCronInterval=this.parseCronInterval(t||""),this.dayOfMonth=l(e,a)}setCronForWeek(){const{dayOfWeek:e}=this.cronSchedule;if(!e)return;const{localTimeString:t,daysOffset:n}=this.parseCronTime();this.weeklyTime=t,this.dayOfWeekArray=e.split(",").map((e=>r(e,n))).filter((e=>i.D.includes(Number(e)))).map(String)}setCronForDay(){const{dayOfMonth:e}=this.cronSchedule;this.dailyCronInterval=this.parseCronInterval(e||"");const{localTimeString:t}=this.parseCronTime();this.dailyTime=t}setCron(){switch(this.cronIntervalType){case i.R.DAY:this.setCronForDay();break;case i.R.WEEK:this.setCronForWeek();break;case i.R.MONTH:this.setCronForMonth()}}parse(){try{if(this.cronSchedule&&this.setCron(),this.startDateInMillisecondsStr.length>0){const e=Number(this.startDateInMillisecondsStr);this.startDate=o(new Date(e)),this.startDateAsDate=new Date(e)}if(this.endDateInMillisecondsStr.length>0){this.endingOn=i.E.DATE;const e=Number(this.endDateInMillisecondsStr);this.endDate=o(new Date(e)),this.endDateAsDate=new Date(e)}return this.maxOccurrence>0&&(this.endingOn=i.E.COUNT),{result:{beginningOn:this.startDate,beginningOnAsDate:this.startDateAsDate,repeatType:this.cronIntervalType,dailyRepeatInterval:this.dailyCronInterval,endingOnType:this.endingOn,endingOnDate:this.endDate,endingOnDateAsDate:this.endDateAsDate,endingOnCount:this.maxOccurrence,weeklyDaysOfWeek:this.dayOfWeekArray,dailyTime:this.dailyTime,weeklyTime:this.weeklyTime,monthlyDayOfMonth:this.dayOfMonth,monthlyRepeatInterval:this.monthlyCronInterval,monthlyTime:this.monthlyTime}}}catch(e){return console.error("Error parsing the cron schedule:",e),{error:{code:"unhandledError",message:e.message||e.toString()||"Unhandled error"}}}}}const O=class{constructor(e){(0,a.r)(this,e),this.schedulerDataInitiated=(0,a.c)(this,"schedulerDataInitiated",7),this.schedulerDataChange=(0,a.c)(this,"schedulerDataChange",7),this.emitSchedulerDataChange=({oldValue:e,value:t,type:n})=>{const{schedulerResponse:a,schedulerInputValues:i}=D(this.schedulerData);this.schedulerDataChange.emit({oldValue:e,value:t,type:n,schedulerInputValues:i,schedulerResponse:a})},this.renderDailyRepeat=()=>{const{dailyRepeatIntervalLabel:e,dailyTimeLabel:t}=this.i18n,{dailyRepeatInterval:n,dailyTime:i}=this.schedulerData;return(0,a.h)("div",{class:"scheduler-main__row-container"},(0,a.h)("div",{class:"scheduler-main__field"},(0,a.h)("arcgis-scheduler-select",{name:"daily-repeat-interval",label:e,type:"daily-repeat-interval",inputValue:n,i18n:this.i18n})),(0,a.h)("div",{class:"scheduler-main__field"},(0,a.h)("arcgis-scheduler-input-time-picker",{name:"daily-time",label:t,type:"daily-time",overlayPositioning:this.overlayPositioning,inputValue:i})))},this.renderWeeklyRepeat=()=>{const{weeklyDaysOfWeekLabel:e,weeklyTimeLabel:t}=this.i18n,{weeklyDaysOfWeek:n,weeklyTime:i}=this.schedulerData;return(0,a.h)("div",{class:"scheduler-main__row-container"},(0,a.h)("div",{class:"scheduler-main__field"},(0,a.h)("arcgis-scheduler-combobox",{name:"day-of-week",label:e,overlayPositioning:this.overlayPositioning,inputValue:n,i18n:this.i18n})),(0,a.h)("div",{class:"scheduler-main__field"},(0,a.h)("arcgis-scheduler-input-time-picker",{name:"weekly-time",label:t,type:"weekly-time",overlayPositioning:this.overlayPositioning,inputValue:i})))},this.renderMonthlyRepeat=()=>{const{monthlyDayOfMonth:e,monthlyRepeatInterval:t,monthlyTime:n}=this.schedulerData,{monthlyDayOfMonthLabel:i,monthlyDayOfMonthPlaceholder:s,monthlyRepeatIntervalLabel:r,monthlyTimeLabel:l}=this.i18n;return(0,a.h)(a.F,null,(0,a.h)("div",{class:"scheduler-main__row-container"},(0,a.h)("div",{class:"scheduler-main__field"},(0,a.h)("arcgis-scheduler-input-number",{name:"day-of-month",label:i,placeholder:s,type:"day-of-month",min:1,max:31,inputValue:e})),(0,a.h)("div",{class:"scheduler-main__field"},(0,a.h)("arcgis-scheduler-select",{name:"monthly-repeat-interval",label:r,type:"monthly-repeat-interval",inputValue:t,i18n:this.i18n}))),(0,a.h)("div",{class:"scheduler-main__row-container"},(0,a.h)("div",{class:"scheduler-main__field"},(0,a.h)("arcgis-scheduler-input-time-picker",{name:"monthly-time",label:l,type:"monthly-time",overlayPositioning:this.overlayPositioning,inputValue:n})),(0,a.h)("div",{class:"scheduler-main__field"})))},this.initialValues=void 0,this.overlayPositioning=void 0,this.i18n=null,this.schedulerData=y(),this.schedulerInitData=y()}arcgisInputChangeHandler(e){const{type:t,value:n}=e.detail;switch(t){case"beginning-on":this.schedulerData.beginningOn=n;break;case"repeat-type":this.schedulerData=Object.assign(Object.assign({},this.schedulerData),{repeatType:n,dailyRepeatInterval:this.schedulerInitData.dailyRepeatInterval,dailyTime:this.schedulerInitData.dailyTime,weeklyDaysOfWeek:this.schedulerInitData.weeklyDaysOfWeek,weeklyTime:this.schedulerInitData.weeklyTime,monthlyDayOfMonth:this.schedulerInitData.monthlyDayOfMonth,monthlyRepeatInterval:this.schedulerInitData.monthlyRepeatInterval,monthlyTime:this.schedulerInitData.monthlyTime});break;case"daily-repeat-interval":this.schedulerData.dailyRepeatInterval=n;break;case"daily-time":this.schedulerData.dailyTime=n;break;case"day-of-week":this.schedulerData.weeklyDaysOfWeek=n;break;case"weekly-time":this.schedulerData.weeklyTime=n;break;case"day-of-month":this.schedulerData.monthlyDayOfMonth=n;break;case"monthly-repeat-interval":this.schedulerData.monthlyRepeatInterval=n;break;case"monthly-time":this.schedulerData.monthlyTime=n;break;case"ending-on-type":this.schedulerData=Object.assign(Object.assign({},this.schedulerData),{endingOnType:n,endingOnDate:this.schedulerInitData.endingOnDate,endingOnCount:this.schedulerInitData.endingOnCount});break;case"ending-on-date":this.schedulerData.endingOnDate=n;break;case"ending-on-count":this.schedulerData.endingOnCount=n?Number(n):null}this.emitSchedulerDataChange(e.detail)}async getSchedulerResponse(){try{const{schedulerResponse:e}=D(this.schedulerData);return{result:e}}catch(e){return console.error("Error getting scheduler data:",e),{error:{code:"unhandledError",message:e.message||e.toString()||"Unhandled error"}}}}async parseTaskSchedule(e){try{return new b(e).parse()}catch(e){return console.error("Error parsing task schedule:",e),{error:{code:"unhandledError",message:e.message||e.toString()||"Unhandled error"}}}}async componentWillLoad(){try{const e=await(0,s.g)(this.el);if(this.i18n=e[0],this.initialValues){const{result:e}=new b(this.initialValues).parse();e&&(this.schedulerData=y(e),this.schedulerInitData=y(e))}this.schedulerDataInitiated.emit({schedulerInputValues:this.schedulerData})}catch(e){console.error("Error loading locale strings:",e)}}render(){const{beginningOn:e,repeatType:t,endingOnType:n,endingOnDate:s,endingOnCount:r}=this.schedulerData,{beginningOnLabel:l,repeatTypeLabel:h,endingOnTypeLabel:o,endingOnDateLabel:d,endingOnCountLabel:c,endingOnCountPlaceholder:u}=this.i18n;return(0,a.h)(a.H,{key:"78453f03279cc5839f5a6d398be82fe856583044"},(0,a.h)("div",{key:"76351d13579bb243c399ad3fe3dcea58865f4071",class:"scheduler-container"},(0,a.h)("header",{key:"362f974eb821052be8443b0476b0036d8b68da71",class:"scheduler-header"},f("scheduler-header")),(0,a.h)("main",{key:"c7ba04566f750a25dc361fb1beabe57d02cf2b22",class:"scheduler-main"},(0,a.h)("div",{key:"85ffa6c0d523230bc3dc594870f3ef61e29bc0fe",class:"scheduler-main__row-container"},(0,a.h)("div",{key:"102cbeffeb0ce85b149cac06bab0a069b951bb8f",class:"scheduler-main__field"},(0,a.h)("arcgis-scheduler-input-date-picker",{key:"1e9a8712ee3a87d8cb04aed9e9c95daa5398edf6",name:"beginning-on",label:l,type:"beginning-on",overlayPositioning:this.overlayPositioning,inputValue:e,min:m(p())})),(0,a.h)("div",{key:"b524746763b75bf1307ecad007cdd2849674090b",class:"scheduler-main__field"},(0,a.h)("arcgis-scheduler-select",{key:"c4d27fac32ba302bd3be6846649b57d04fd16b5f",name:"repeat-type",label:h,type:"repeat-type",inputValue:t,i18n:this.i18n}))),(0,a.h)("div",{key:"9f5eef8b5a831e825bb12afdde1addcb4a781479",class:"scheduler-main__row_container"},(0,a.h)("div",{key:"7ce52f3b12323ad01572adbbc2c9b1af1b661ef0",class:"scheduler-main__field"},t===i.R.DAY&&this.renderDailyRepeat(),t===i.R.WEEK&&this.renderWeeklyRepeat(),t===i.R.MONTH&&this.renderMonthlyRepeat())),(0,a.h)("div",{key:"1294b3b847170695de3787465762a1948b57e8e8",class:"scheduler-main__row-container"},(0,a.h)("div",{key:"fb044430ba2cf597dea26f962746d317b3dd72ac",class:"scheduler-main__field"},(0,a.h)("arcgis-scheduler-select",{key:"cb32d0b5b39697b2b4525d89e127660dc33fa0ca",name:"ending-on",label:o,type:"ending-on-type",inputValue:n,i18n:this.i18n})),(0,a.h)("div",{key:"d7ead2e3d5c34510792220237c69bc9a88f0413b",class:"scheduler-main__field"},n===i.E.DATE?(0,a.h)("arcgis-scheduler-input-date-picker",{label:d,name:"ending-on-date",type:"ending-on-date",overlayPositioning:this.overlayPositioning,inputValue:s}):n===i.E.COUNT?(0,a.h)("arcgis-scheduler-input-number",{label:c,name:"ending-on-count",placeholder:u,type:"ending-on-count",inputValue:r?r.toString():"",min:0}):null))),(0,a.h)("footer",{key:"0c8513f38641ca88496f600e19f10b4db3545565",class:"scheduler-footer"},f("scheduler-footer"))))}get el(){return(0,a.d)(this)}};O.style=".scheduler-container{display:flex;width:100%;flex-direction:column;gap:0.5rem}.scheduler-header{width:100%}.scheduler-main{display:flex;width:100%;flex-direction:column;gap:0.5rem}.scheduler-main__row-container{display:flex;width:100%;gap:0.5rem}.scheduler-main__field{flex:1 1 0%}.scheduler-footer{width:100%}"},5019:(e,t,n)=>{n.d(t,{D:()=>r,E:()=>s,R:()=>i,S:()=>a});const a={REPEAT_TYPE:"repeat-type",ENDING_ON_TYPE:"ending-on-type",DAILY_REPEAT_INTERVAL:"daily-repeat-interval",MONTHLY_REPEAT_INTERVAL:"monthly-repeat-interval"},i={DAY:"day",WEEK:"week",MONTH:"month"},s={NEVER:"never",DATE:"date",COUNT:"count"},r=[1,2,3,4,5,6,7]}}]);