/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-551ae8.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-551ae8"],{68180:(e,t,r)=>{r.d(t,{a:()=>a,b:()=>h,c:()=>v,d:()=>d,e:()=>f,f:()=>s,g:()=>l,h:()=>$,i:()=>u,j:()=>c,k:()=>y,l:()=>n,m:()=>p,n:()=>g,o:()=>w,p:()=>S,q:()=>x,s:()=>o,t:()=>m});var a,n,o,s,i=r(71480);function u(e){return null!=e}function c(e,t){const r=e.fieldName;if(r.includes(a.expression)){const e=t.get(r);return e?.title?e.title:r}return e.label?e.label:r}async function l(e){return new Map((await async function(e){return await new Promise(((t,r)=>{switch(d(e)){case o.feature:case o.ogcFeature:case o.stream:t(e.fields);break;case o.mapImage:{const a=e,n=a?.layer;n?.portalItem&&n.url.includes("https://demographics")&&n.url.includes(".arcgis.com")?n.portalItem?.fetchData().then((e=>{if(e?.thematicGroup){const r=new Map(a.fields.map((e=>[e.name,e]))),n=e.thematicGroup.fieldNames,o=[];n.forEach((e=>{r.has(e)&&o.push(r.get(e))})),t(o)}else t(a.fields)})).catch((e=>{r(new Error(e))})):t(a.fields);break}case o.imagery:{const r=e;t((r.fields||[]).concat(r.rasterFields||[]));break}case o.imageryTile:case o.wcs:t(e.rasterFields);break;default:t("fields"in e?e.fields??[]:[])}}))}(e)).filter((e=>e.visible)).map((e=>[e.name,e])))}function f(e){const t=new Map;return e?.expressionInfos&&e.expressionInfos.forEach((e=>{const r=`${a.expression}${e.name}`;t.set(r,e)})),t}function d(e){return"map-image"===e?.layer?.type?o.mapImage:"subtype-sublayer"===e?.type?o.subtype:"tile"===e?.layer?.type?o.tile:"scene"===e?.type?o.scene:"ogc-feature"===e?.type?o.ogcFeature:"imagery"===e?.type?o.imagery:"imagery-tile"===e?.type?o.imageryTile:"wfs"===e?.type?o.wfs:"wcs"===e?.type?o.wcs:"wms"===e?.layer?.type?o.wms:"csv"===e?.type?o.csv:"geojson"===e?.type?o.geojson:"stream"===e?.type?o.stream:"oriented-imagery"===e?.type?o.orientedImagery:"catalog"===e?.type?o.catalog:"catalog-footprint"===e?.type?o.catalogFootprint:"knowledge-graph-sublayer"===e?.type?o.knowledgeGraphSublayer:"voxel"===e?.type?o.voxel:o.feature}function p(e){if(e)switch(e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"multipoint":case"polyline":return e.extent?.center;default:return}}function y(e){return Number((100*(1-e)).toFixed(1))}function m(e){return Number((1-e/100).toFixed(3))}!function(e){e.expression="expression/",e.raster="Raster.",e.relationship="relationships/"}(a||(a={})),function(e){e.cluster="cluster",e.feature="feature",e.mapNotes="mapNotes"}(n||(n={})),function(e){e.catalog="catalog",e.catalogFootprint="catalog-footprint",e.csv="csv",e.feature="feature",e.geojson="geojson",e.imagery="imagery",e.imageryTile="imagery-tile",e.knowledgeGraphSublayer="knowledge-graph-sublayer",e.mapImage="map-image",e.ogcFeature="ogc-feature",e.orientedImagery="oriented-imagery",e.scene="scene",e.stream="stream",e.subtype="subtype",e.tile="tile",e.voxel="voxel",e.wcs="wcs",e.wfs="wfs",e.wms="wms"}(o||(o={})),function(e){e.bigInteger="big-integer",e.date="date",e.dateOnly="date-only",e.double="double",e.globalId="global-id",e.guid="guid",e.integer="integer",e.long="long",e.number="number",e.oid="oid",e.single="single",e.smallInteger="small-integer",e.string="string",e.timeOnly="time-only",e.timestampOffset="timestamp-offset"}(s||(s={}));const g=(e,t)=>{const r=[];return e?.fieldInfos?.forEach((e=>{e.fieldName?.includes(a.expression)?t&&r.push({name:e.fieldName.slice(a.expression.length),alias:e.fieldName.slice(a.expression.length),type:"string"}):r.push({name:e.fieldName,alias:e.label,type:"string"})})),r},h=async(e,t)=>{const[r,a]=await Promise.all([(0,i.g)(),(0,i.h)()]),n=new a;n.geometry=t.extent,n.mapExtent=t.extent,n.returnGeometry=!0,n.tolerance=6,n.layerOption="popup",n.width=t.width,n.height=t.height,n.layerIds=[e.id];const o=(await r.identify(e.layer.url,n))?.results,s=o?.[0]?.feature;return s},w=async(e,t,r)=>{const a=await e.whenLayerView(t),n=await a.queryAggregates();return await b(r,n.features?.[0])},b=async(e,t)=>{const r=await(0,i.j)(),a=await(0,i.k)();let n;if(t)n=t.clone();else{n=new r;const t=g(e,!1);if(t?.length){const e={};t.forEach((t=>{e[t.name]=""})),n.attributes=e}const o=new a;n.geometry=o}return n};function x(e,t){const r=t.startsWith("#"),a=t.startsWith(".");for((a||r)&&(t=t.slice(1));e;){if(r){if(e.id===t)return e}else if(a){if(e.classList.contains(t))return e}else if(e.tagName.toLowerCase()===t.toLowerCase())return e;e=e.parentElement??e.getRootNode()?.host??void 0}}async function v(e){if(d(e)===o.stream)return await Promise.resolve("point");if(e.geometryType)return await Promise.resolve(e.geometryType);if(d(e)===o.mapImage&&e?.layer?.sourceJSON?.layers){const t=e.layer?.sourceJSON.layers.find((t=>{if(t.id===e.id)return t}))?.geometryType?.toLowerCase();if(t)return t.indexOf("point")>-1?await Promise.resolve("point"):t.indexOf("line")>-1?await Promise.resolve("polyline"):t.indexOf("polygon")>-1?await Promise.resolve("polygon"):await Promise.resolve(t);{const t=e?.layer?.findSublayerById(e.id);if(t){const e=await(t?.createFeatureLayer());return e?(await e.load(),await Promise.resolve(e?.geometryType)):void await Promise.resolve()}return void await Promise.resolve()}}await Promise.resolve()}function $(e,t,r){let a="";if(/^raster.(?:item|service)pixelvalue/iu.test(e))a="number";else if(t.has(e)){const r=t.get(e);a=r.type?r.type.toLowerCase():""}else if(r.has(e)){const t=r.get(e);a=t.returnType?t.returnType.toLowerCase():""}else a="number";return a}async function S(e,t){return"feature"!==e.type||e.url?"feature"===e.type||"csv"===e.type||"scene"===e.type||"wfs"===e.type||"geojson"===e.type||"oriented-imagery"===e.type||"subtype-group"===e.type||"subtype-sublayer"===e.type||"catalog"===e.type||"catalog-footprint"===e.type?await e.queryFeatureCount():!t||"stream"!==e.type&&"ogc-feature"!==e.type?await Promise.reject(new Error(`Can't get feature count for layer of type ${e.type}.`)):await async function(e,t){const r=await t.whenLayerView(e);return await r.queryFeatureCount()}(e,t):await async function(e){const t=e.createQuery();t.outFields=["*"];const r=await e.queryFeatures(t);if(r.features?.length)return r.features.length;throw new Error("could not get feature count")}(e)}},53133:(e,t,r)=>{r.d(t,{a:()=>s,b:()=>i,c:()=>f,d:()=>o,e:()=>h,f:()=>g,g:()=>y,h:()=>m,l:()=>u,p:()=>d,s:()=>p});var a=r(36392);function n(e){return null!=e}const o=["bloom","dropShadow","blur","brightnessContrast","grayscale","hueRotate","saturate","invert","sepia"],s=["dropShadow_gray","strongDropShadow","dropShadow_transparency","dropShadow_blur","mutedBlur","mutedGray"],i=["bloom_gray","bloom_blur","bloom_transparency","mutedBlur","mutedGray"],u={bloom:{strength:2,radius:.75,threshold:.1},dropShadow:{line:{color:[0,0,0,255],xoffset:.75,yoffset:-.75,blurRadius:1.125},point:{color:[0,0,0,255],xoffset:1.125,yoffset:1.125,blurRadius:1.875},polygon:{color:[0,0,0,255],xoffset:1.125,yoffset:1.125,blurRadius:2.25}},blur:{radius:1.5},brightness:{amount:1.5},contrast:{amount:2},grayscale:{amount:1},hueRotate:{angle:100},saturate:{amount:1},invert:{amount:1},sepia:{amount:.7}},c=JSON.parse(JSON.stringify(u)),l=new Map;async function f(e,t,r){const a=Array.from(e.children).filter((e=>{if("calcite-list-item"===e.tagName.toLowerCase()){return e.querySelector("calcite-switch").checked}return!1})),o=await Promise.all(a.map((async e=>await async function(e,t,r){const a=e.value;switch(a){case"bloom":return await async function(e,t){const r=await e.callQuerySelectorAll("calcite-input");let a=b(r[0]),o=b(r[1]),s=b(r[2]);if(!n(a)||!n(o)||!n(s))return;a=Math.round(10*a)/10,o=x(Math.round(10*o)/10),s=Math.round(s),s/=100,c.bloom={strength:a,radius:o,threshold:s};const i=await e.callQuerySelector(".auto");if(i.checked){const{view:e}=t,r=e?.scale||1,n=2,i=1/n;return[{scale:.25*r,value:`bloom(${a*n}, ${o*n}pt, ${s})`},{scale:r,value:`bloom(${a}, ${o}pt, ${s})`},{scale:4*r,value:`bloom(${a*i}, ${o*i}pt, ${s})`}]}return`bloom(${a}, ${o}pt, ${s})`}(t.get(a),r);case"dropShadow":return await async function(e,t){const r=await e.callQuerySelector("calcite-color-picker"),a=function(e){const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:Number.parseInt(t[1],16),g:Number.parseInt(t[2],16),b:Number.parseInt(t[3],16)}:null}(r.value),o=await e.callQuerySelectorAll("calcite-input");let s=b(o[0]),i=b(o[1]),u=b(o[2]),l=b(o[3]);if(!(n(r.value)&&n(s)&&n(i)&&n(u)&&n(l)))return;s=x(Math.round(s)),i=x(Math.round(i)),u=x(Math.round(-u)),l=Math.round(l),l/=100,c.dropShadow[m(t)]={color:[a.r,a.g,a.b,255*l],xoffset:i,yoffset:u,blurRadius:s};const f=`rgba(${a.r}, ${a.g}, ${a.b}, ${l})`,d=await e.callQuerySelector(".auto");if(d.checked){const{view:e}=t,r=e?.scale||1,a=2,n=1/a;return[{scale:.25*r,value:`drop-shadow(${i*a}pt ${u*a}pt ${s*a}pt ${f})`},{scale:r,value:`drop-shadow(${i}pt ${u}pt ${s}pt ${f})`},{scale:4*r,value:`drop-shadow(${i*n}pt ${u*n}pt ${s*n}pt ${f})`}]}return`drop-shadow(${i}pt ${u}pt ${s}pt ${f})`}(t.get(a),r);case"blur":return await async function(e){const t=await e.callQuerySelector("calcite-input");let r=b(t);if(!n(r))return;return r=x(Math.round(10*r)/10),c.blur={radius:r},`blur(${r}pt)`}(t.get(a));case"brightnessContrast":return await async function(e){const t=await e.callQuerySelectorAll("calcite-input");let r=b(t[0]),a=b(t[1]);if(!n(r)||!n(a))return;return r=Math.round(r)/100,a=Math.round(a)/100,c.brightness={amount:r},c.contrast={amount:a},`brightness(${r}) contrast(${a})`}(t.get(a));case"grayscale":return await async function(e){const t=await e.callQuerySelector("calcite-input");let r=b(t);if(!n(r))return;return r=Math.round(r)/100,c.grayscale={amount:r},`grayscale(${r})`}(t.get(a));case"hueRotate":return await async function(e){const t=await e.callQuerySelector("calcite-input");let r=b(t);if(!n(r))return;return r=Math.round(r),c.hueRotate={angle:r},`hue-rotate(${r}deg)`}(t.get(a));case"saturate":return await async function(e){const t=await e.callQuerySelector("calcite-input");let r=b(t);if(!n(r))return;return r=Math.round(r)/100,c.saturate={amount:r},`saturate(${r})`}(t.get(a));case"invert":return await async function(e){const t=await e.callQuerySelector("calcite-input");let r=b(t);if(!n(r))return;return r=Math.round(r)/100,c.invert={amount:r},`invert(${r})`}(t.get(a));case"sepia":return await async function(e){const t=await e.callQuerySelector("calcite-input");let r=b(t);if(!n(r))return;return r=Math.round(r)/100,c.sepia={amount:r},`sepia(${r})`}(t.get(a))}return}(e,t,r))));let s,i="",u="";return o.forEach((e=>{e&&"string"==typeof e?s?s.forEach((t=>{t.value+=u+e})):i+=u+e:e&&"object"==typeof e&&(s?s.forEach((t=>{Array.from(e).filter((e=>t.scale===e.scale)).forEach((e=>t.value+=u+e.value))})):(s=e,s.forEach((e=>{e.value=i+u+e.value})))),u=" "})),s||i}function d(e){const{layer:t,modules:r,supportsFeatureEffects:a}=e,n=t;if(n.effect&&n.featureEffect)throw new Error("unsupported effect");if(n.featureEffect&&!a)throw new Error("unsupported effect");if(n.effect){const e=n.effect;if("string"==typeof e)return r.effectsUtils.toJSON(e);if(3===e.length){if(function(e){const t=[e[0].value,e[1].value,e[2].value];return!o.some((e=>{if("brightnessContrast"===e){const e="brightness",r="contrast";return t[0].indexOf(e)>-1&&t[0].indexOf(r)>-1?-1===t[1].indexOf(e)||-1===t[2].indexOf(e)||-1===t[1].indexOf(r)||-1===t[2].indexOf(r):-1!==t[0].indexOf(e)||-1!==t[0].indexOf(r)||(t[1].indexOf(e)>-1||t[2].indexOf(e)>-1||t[1].indexOf(r)>-1||t[2].indexOf(r)>-1)}{const r=g(e);return t[0].indexOf(r)>-1?-1===t[1].indexOf(r)||-1===t[2].indexOf(r):t[1].indexOf(r)>-1||t[2].indexOf(r)>-1}}))}(e))return r.effectsUtils.toJSON(e[1].value);throw new Error("unsupported effect")}throw new Error("unsupported effect")}if(n.featureEffect){const e=n.featureEffect;if(!e.excludedLabelsVisible||e.includedEffect&&"string"!=typeof e.includedEffect||e.excludedEffect&&"string"!=typeof e.excludedEffect||e.filter?.geometry)throw new Error("unsupported effect");{const t=e.toJSON(),r=e.includedEffect?t.includedEffect:[],a=e.excludedEffect?t.excludedEffect:[];let n;for(const e of l.keys()){const t=l.get(e);if(w(t.included,r)&&w(t.excluded,a)){n=e;break}}return n}}return null}function p(e){const{effectsJSON:t}=e;if(!t)return;const r=t.map((e=>e.type));o.sort(((e,t)=>{const a=r.indexOf(g(e)),n=r.indexOf(g(t));return a>-1&&n>-1&&a<n?-1:a>-1&&n>-1&&a>n?1:a>-1?-1:n>-1?1:0}))}function y(e,t){const{effectsJSON:r}=t,a=r&&Array.from(r)?.filter((t=>t.type===g(e)))?.[0];if(!a){if("dropShadow"===e){const r=m(t);return c[e][r]}return c[e]}return a}function m(e){const{layer:t}=e;let r="point";const a=t;return"csv"===t.type?r="point":a.geometryType&&(r="polyline"===a.geometryType?"line":["point","multipoint"].includes(a.geometryType)?"point":"polygon"),r}function g(e){switch(e){case"dropShadow":return"drop-shadow";case"hueRotate":return"hue-rotate";case"brightnessContrast":return"brightness";default:return e}}function h(e,t,r){const{modules:a}=r,{FeatureEffect:n}=a,o=l.get(e);return n.fromJSON({filter:{where:t},includedEffect:o.included,excludedEffect:o.excluded,showExcludedLabels:!0})}function w(e,t){const r=JSON.parse(JSON.stringify(e)),a=JSON.parse(JSON.stringify(t));if(r.length!==a.length)return!1;r.sort(((e,t)=>e.type.localeCompare(t.type))),a.sort(((e,t)=>e.type.localeCompare(t.type)));let n=!0;for(let e=0;e<r.length;e++){const t=r[e],o=a[e];if(Object.keys(t).length!==Object.keys(o).length){n=!1;break}if(n=Object.keys(t).every((e=>"string"==typeof t[e]&&"string"==typeof o[e]&&t[e]===o[e]||("number"==typeof t[e]&&"number"==typeof o[e]&&t[e]===o[e]||!(!t[e].length||t[e].length!==o[e].length||!t[e].every(((t,r)=>t===o[e][r])))))),!n)break}return n}function b(e){const t=Number(e.value);if(!n(t))return;const r=Math.min(e.max,Math.max(e.min,t));return e.value=`${r}`,r}function x(e){return Math.round(1e3*(0,a.p)(e))/1e3}l.set("dropShadow_gray",{included:[{type:"drop-shadow",color:[50,50,50,255],xoffset:1.5,yoffset:1.5,blurRadius:2.25}],excluded:[{type:"grayscale",amount:1},{type:"opacity",amount:.5}]}),l.set("strongDropShadow",{included:[{type:"drop-shadow",color:[0,0,0,255],xoffset:3,yoffset:3,blurRadius:3}],excluded:[]}),l.set("dropShadow_transparency",{included:[{type:"drop-shadow",color:[50,50,50,255],xoffset:1.5,yoffset:1.5,blurRadius:4.5}],excluded:[{type:"opacity",amount:.35}]}),l.set("dropShadow_blur",{included:[{type:"drop-shadow",color:[50,50,50,255],xoffset:1.5,yoffset:1.5,blurRadius:2.25}],excluded:[{type:"blur",radius:2.25},{type:"opacity",amount:.5}]}),l.set("bloom_gray",{included:[{type:"bloom",strength:1.3,radius:.6,threshold:0}],excluded:[{type:"grayscale",amount:1},{type:"opacity",amount:.5}]}),l.set("bloom_blur",{included:[{type:"bloom",strength:1.3,radius:.6,threshold:0}],excluded:[{type:"blur",radius:2.25},{type:"opacity",amount:.5}]}),l.set("bloom_transparency",{included:[{type:"bloom",strength:1.3,radius:.6,threshold:0}],excluded:[{type:"opacity",amount:.35}]}),l.set("mutedBlur",{included:[],excluded:[{type:"blur",radius:2.25},{type:"opacity",amount:.5}]}),l.set("mutedGray",{included:[],excluded:[{type:"grayscale",amount:1},{type:"opacity",amount:.5}]})},36392:(e,t,r)=>{r.d(t,{a:()=>n,p:()=>o});const a=96;function n(e){return e?e/72*a:0}function o(e){return e?72*e/a:0}}}]);