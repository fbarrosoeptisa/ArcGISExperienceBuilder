/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-378778.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-378778"],{23598:(e,t,s)=>{s.r(t),s.d(t,{arcgis_effects_popovers:()=>y});var a=s(28614),l=s(53133),n=s(97127),r=s(36392),o=s(68180);s(71480);const i="panel",c="auto",h="effects-content",u="bottom-space",p="switch",d=e=>{e.stopPropagation()},f=e=>{e.target.setFocus?.(),e.preventDefault()},g=e=>{const{disabled:t,min:s,max:l,step:n,value:r,units:o,classNames:i,label:c}=e;return(0,a.h)("div",{class:`select-number ${i}`},(0,a.h)("calcite-slider",{disabled:t,min:s,max:l,value:r,step:n,snap:!0,labelTicks:!0,ticks:l-s,minLabel:c,onCalciteSliderInput:t=>m(t,e)}),(0,a.h)("calcite-input",{type:"number",onClick:d,disabled:t,min:s,max:l,value:`${r}`,scale:"s",step:n,suffixText:o,onCalciteInputInput:t=>m(t,e),class:"select-number__input",label:c}))};function m(e,t){const{locale:s}=t,a=e.currentTarget,l=a.parentElement.querySelector("calcite-slider"),n=a.parentElement.querySelector("calcite-input"),r=Number(a.value),o=Math.min(t.max,Math.max(t.min,r));if(o===l.value&&`${o}`===n.value)return;l.value=o,n.value=`${o}`;const i=o.toLocaleString(s);n.querySelectorAll("input").forEach((e=>e.value=i)),t.onValueChange(o,a)}const y=class{constructor(e){(0,a.r)(this,e),this.arcgisApplyLayerEffect=(0,a.c)(this,"arcgisApplyLayerEffect",7),this.arcgisFilterChange=(0,a.c)(this,"arcgisFilterChange",7),this.arcgisClose=(0,a.c)(this,"arcgisClose",7),this.arcgisReady=(0,a.c)(this,"arcgisReady",7),this.manager=(0,n.u)(this),this.defaultExpression=!1,this.onOpen=()=>{setTimeout((()=>requestAnimationFrame((()=>this.closeNode?.setFocus()))),1)},this.onClose=()=>{this.filterNode?.closePopovers()},this.onPropChange=()=>{const{type:e}=this;this.arcgisApplyLayerEffect.emit({type:e})},this.onReset=()=>{const{type:e,props:t,popoverNode:s}=this,a=l.l[e];switch(e){case"bloom":{const e=s.querySelectorAll("calcite-input");e[0].value=`${a.strength}`,e[1].value=`${(0,r.a)(a.radius)}`,e[2].value=`${Math.round(100*a.threshold)}`;const t=s.querySelectorAll("calcite-slider");t[0].value=a.strength,t[1].value=(0,r.a)(a.radius),t[2].value=Math.round(100*a.threshold);break}case"dropShadow":{const e=(0,l.h)(t);s.querySelector("calcite-color-picker").value=this.rgb2Hex(a[e].color);const n=s.querySelectorAll("calcite-input");n[0].value=`${Math.round((0,r.a)(a[e].blurRadius))}`,n[1].value=`${Math.round((0,r.a)(a[e].xoffset))}`,n[2].value=""+-Math.round((0,r.a)(a[e].yoffset)),n[3].value=""+a[e].color[3]/255*100;const o=s.querySelectorAll("calcite-slider");o[0].value=Math.round((0,r.a)(a[e].blurRadius)),o[1].value=a[e].color[3]/255*100;const i=s.querySelectorAll("arcgis-xy-slider")[0];i.x=Math.round((0,r.a)(a[e].xoffset)),i.y=Math.round((0,r.a)(a[e].yoffset));break}case"blur":s.querySelector("calcite-input").value=`${(0,r.a)(a.radius)}`,s.querySelector("calcite-slider").value=(0,r.a)(a.radius);break;case"brightnessContrast":{const e=l.l.brightness,t=l.l.contrast,a=s.querySelectorAll("calcite-input");a[0].value=`${Math.round(100*e.amount)}`,a[1].value=`${Math.round(100*t.amount)}`;const n=s.querySelectorAll("calcite-slider");n[0].value=Math.round(100*e.amount),n[1].value=Math.round(100*t.amount);break}case"grayscale":case"saturate":case"invert":case"sepia":s.querySelector("calcite-input").value=""+100*a.amount,s.querySelector("calcite-slider").value=100*a.amount;break;case"hueRotate":s.querySelector("calcite-input").value=`${a.angle}`,s.querySelector("calcite-slider").value=a.angle}this.arcgisApplyLayerEffect.emit({type:e})},this.props=void 0,this.type=void 0,this.open=!1,this.referenceElement=void 0}async reposition(){this.popoverNode?.reposition()}async setFocus(){(this.filterNode||this.closeNode)?.setFocus()}async updateHeader(e){const{props:t,filterNode:s}=this,{strings:a}=t;s&&(s.closePopovers(),s.panelHeading=a.featureEffectsTitle[e]||a.effectsTitle[e])}async callQuerySelector(e){return this.el.shadowRoot?this.el.shadowRoot.querySelector(e):null}async callQuerySelectorAll(e){return this.el.shadowRoot?this.el.shadowRoot?.querySelectorAll(e):[]}async componentWillLoad(){const{props:e}=this,{layer:t}=e;t.featureEffect||(this.defaultExpression=!0)}componentDidLoad(){this.arcgisReady.emit(this.type)}render(){const{props:e,referenceElement:t,type:s,open:l}=this,{strings:r}=e,o=["featureEffect","dropShadow"].includes(s);return(0,a.h)(a.H,{key:"2d3185cc51b0b71e22a715167b9ce7dbe2feaf74",class:"js-app-flyout"},(0,a.h)("calcite-popover",{key:"c330eba6709d996b4eccb5c20956ee21a3f9c048",dir:(0,n.a)(this.el),pointerDisabled:!0,label:r.effectsTitle[s],offsetDistance:10,offsetSkidding:o?10:100,open:l,placement:"leading-start",triggerDisabled:!0,class:"arcgis-effects-popover popover",referenceElement:t,onCalcitePopoverOpen:this.onOpen,onCalcitePopoverClose:this.onClose,ref:e=>{this.popoverNode=e}},"featureEffect"===s?this.renderFeatureEffectProps():this.renderLayerEffectProps()))}renderLayerEffectProps(){const{props:e,referenceElement:t,type:s}=this,{strings:r}=e,o="rtl"===(0,n.a)(this.el),c=t.getBoundingClientRect();return(0,a.h)("calcite-panel",{closable:!1,heading:r.effectsTitle[s],class:i,style:{maxHeight:.9*c.height+"px"},ref:e=>this.panelNode=e},l.d.includes(s)?(0,a.h)("calcite-action",{text:r.effectsProps.reset,scale:"s",slot:"header-actions-end",title:r.effectsProps.reset,onClick:this.onReset},(0,a.h)("calcite-icon",{scale:"s",icon:o?"redo":"undo"})):null,(0,a.h)("calcite-action",{text:r.general.close,icon:"x",slot:"header-actions-end",title:r.general.close,ref:e=>this.closeNode=e,onClick:()=>{this.arcgisClose.emit(),this.open=!1,this.popoverNode.open=!1,this.panelNode.closed=!1}}),"bloom"===s?this.renderBloom():null,"dropShadow"===s?this.renderDropShadow():null,"blur"===s?this.renderBlur():null,"brightnessContrast"===s?this.renderBrightnessContrast():null,"grayscale"===s?this.renderGrayscale():null,"hueRotate"===s?this.renderHueRotate():null,"saturate"===s?this.renderSaturate():null,"invert"===s?this.renderInvert():null,"sepia"===s?this.renderSepia():null)}renderBloom(){const{props:e,type:t}=this,{layer:s,strings:n,locale:o}=e,i=s,d=(0,l.g)(t,e);return(0,a.h)("div",{class:h},(0,a.h)("calcite-label",{scale:"s",onClick:f},n.effectsProps.strength),(0,a.h)(g,{min:0,max:5,step:.1,locale:o,value:Math.round(10*d.strength)/10,classNames:u,label:n.effectsProps.strength,onValueChange:this.onPropChange}),(0,a.h)("calcite-label",{scale:"s",onClick:f},n.effectsProps.radius),(0,a.h)(g,{min:0,max:5,step:.1,locale:o,value:Math.round(10*(0,r.a)(d.radius))/10,classNames:u,label:n.effectsProps.radius,onValueChange:this.onPropChange}),(0,a.h)("calcite-label",{scale:"s",onClick:f},n.effectsProps.threshold),(0,a.h)(g,{min:0,max:100,step:1,locale:o,value:Math.round(100*d.threshold),classNames:u,label:n.effectsProps.threshold,onValueChange:this.onPropChange}),(0,a.h)("calcite-label",{layout:"inline-space-between",scale:"s",class:p},n.effectsProps.autoAdjust,(0,a.h)("calcite-switch",{checked:!(i.effect&&"string"==typeof i.effect),scale:"s",class:c,onCalciteSwitchChange:this.onPropChange})))}renderDropShadow(){const{props:e,type:t}=this,{layer:s,strings:n,locale:o}=e,i=s,d=(0,l.g)(t,e),m=this.rgb2Hex(d.color);return(0,a.h)("div",{class:h},(0,a.h)("calcite-label",{scale:"s"},n.effectsProps.color,(0,a.h)("calcite-color-picker",{scale:"m",value:m,savedDisabled:!0,onCalciteColorPickerInput:this.onPropChange})),(0,a.h)("calcite-label",{scale:"s"},n.effectsProps.width),(0,a.h)(g,{min:0,max:20,step:1,locale:o,value:Math.round((0,r.a)(d.blurRadius)),classNames:u,label:n.effectsProps.width,onValueChange:this.onPropChange}),(0,a.h)("calcite-label",{scale:"s"},n.effectsProps.offset,(0,a.h)("div",{class:"offset-div"},(0,a.h)("arcgis-xy-slider",{x:Math.round((0,r.a)(d.xoffset)),y:Math.round((0,r.a)(d.yoffset)),minX:-20,minY:-20,maxX:20,maxY:20,step:1,snappable:!0,onArcgisInput:e=>{e.stopPropagation();const t=e.currentTarget;this.xOffsetNode.value=`${Math.round(t.x)}`,this.yOffsetNode.value=`${Math.round(-t.y)}`,this.onPropChange()},ref:e=>this.xySliderNode=e}),(0,a.h)("div",null,(0,a.h)("calcite-label",{scale:"s"},n.effectsProps.xOffset,(0,a.h)("calcite-input",{scale:"s",type:"number",placeholder:n.effectsProps.xOffset,value:`${Math.round((0,r.a)(d.xoffset))}`,min:-20,max:20,onCalciteInputInput:e=>{const t=e.currentTarget;this.waitOnUser(e,(()=>{this.xySliderNode.x=Number.parseInt(t.value),this.onPropChange()}),0)},ref:e=>this.xOffsetNode=e})),(0,a.h)("calcite-label",{scale:"s"},n.effectsProps.yOffset,(0,a.h)("calcite-input",{scale:"s",type:"number",placeholder:n.effectsProps.yOffset,value:""+-Math.round((0,r.a)(d.yoffset)),min:-20,max:20,onCalciteInputInput:e=>{const t=e.currentTarget;this.waitOnUser(e,(()=>{this.xySliderNode.y=-Number.parseInt(t.value),this.onPropChange()}),0)},ref:e=>this.yOffsetNode=e}))))),(0,a.h)("calcite-label",{scale:"s",onClick:f},n.effectsProps.opacity),(0,a.h)(g,{min:0,max:100,step:1,locale:o,value:d.color[3]/255*100,classNames:u,label:n.effectsProps.opacity,onValueChange:this.onPropChange}),(0,a.h)("calcite-label",{layout:"inline-space-between",scale:"s",class:p},n.effectsProps.autoAdjust,(0,a.h)("calcite-switch",{checked:!(i.effect&&"string"==typeof i.effect),scale:"s",class:c,onCalciteSwitchChange:this.onPropChange})))}renderBlur(){const{props:e,type:t}=this,{strings:s,locale:n}=e,o=(0,l.g)(t,e);return(0,a.h)("div",{class:h},(0,a.h)("calcite-label",{scale:"s",onClick:f},s.effectsProps.strength),(0,a.h)(g,{min:0,max:30,step:.1,locale:n,value:Math.round(10*(0,r.a)(o.radius))/10,classNames:u,label:s.effectsProps.strength,onValueChange:this.onPropChange}))}renderBrightnessContrast(){const{props:e}=this,{strings:t,locale:s}=e,n=(0,l.g)("brightness",e),r=(0,l.g)("contrast",e);return(0,a.h)("div",{class:h},(0,a.h)("calcite-label",{scale:"s",onClick:f},t.effectsProps.brightness),(0,a.h)(g,{min:0,max:300,step:1,locale:s,value:Math.round(100*n.amount),classNames:u,label:t.effectsProps.brightness,onValueChange:this.onPropChange}),(0,a.h)("calcite-label",{scale:"s",onClick:f},t.effectsProps.contrast),(0,a.h)(g,{min:0,max:300,step:1,locale:s,value:Math.round(100*r.amount),classNames:u,label:t.effectsProps.contrast,onValueChange:this.onPropChange}))}renderGrayscale(){const{props:e,type:t}=this,{strings:s,locale:n}=e,r=(0,l.g)(t,e);return(0,a.h)("div",{class:h},(0,a.h)("calcite-label",{scale:"s",onClick:f},s.effectsProps.strength),(0,a.h)(g,{min:0,max:100,step:1,locale:n,value:100*r.amount,classNames:u,label:s.effectsProps.strength,onValueChange:this.onPropChange}))}renderHueRotate(){const{props:e,type:t}=this,{strings:s,locale:n}=e,r=(0,l.g)(t,e);return(0,a.h)("div",{class:h},(0,a.h)("calcite-label",{scale:"s",onClick:f},s.effectsProps.degrees),(0,a.h)(g,{min:0,max:360,step:1,locale:n,value:r.angle,classNames:u,label:s.effectsProps.degrees,onValueChange:this.onPropChange}))}renderSaturate(){const{props:e,type:t}=this,{strings:s,locale:n}=e,r=(0,l.g)(t,e);return(0,a.h)("div",{class:h},(0,a.h)("calcite-label",{scale:"s",onClick:f},s.effectsProps.strength),(0,a.h)(g,{min:0,max:200,step:1,locale:n,value:100*r.amount,classNames:u,label:s.effectsProps.strength,onValueChange:this.onPropChange}))}renderInvert(){const{props:e,type:t}=this,{strings:s,locale:n}=e,r=(0,l.g)(t,e);return(0,a.h)("div",{class:h},(0,a.h)("calcite-label",{scale:"s",onClick:f},s.effectsProps.strength),(0,a.h)(g,{min:0,max:100,step:1,locale:n,value:100*r.amount,classNames:u,label:s.effectsProps.strength,onValueChange:this.onPropChange}))}renderSepia(){const{props:e,type:t}=this,{strings:s,locale:n}=e,r=(0,l.g)(t,e);return(0,a.h)("div",{class:h},(0,a.h)("calcite-label",{scale:"s",onClick:f},s.effectsProps.strength),(0,a.h)(g,{min:0,max:100,step:1,locale:n,value:100*r.amount,classNames:u,label:s.effectsProps.strength,onValueChange:this.onPropChange}))}renderFeatureEffectProps(){const{props:e,defaultExpression:t}=this,{view:s,layer:l,strings:n}=e,r=function(e){const{layer:t}=e,{renderer:s}=t;if(s)switch(s.type){case"unique-value":return"predominance"===s.authoringInfo?.type?s.uniqueValueInfos[0].value:"relationship"===s.authoringInfo?.type?s.authoringInfo.field1.field:s.field;case"class-breaks":if(!s.visualVariables)return s.field;{let e=s.visualVariables.find((e=>"color"===e.type))?.field;if(e)return e;if(e=s.visualVariables.find((e=>"size"===e.type&&!e.target&&"$view.scale"!==e.valueExpression))?.field,e)return e}break;case"dot-density":return s.attributes?.[0].field}}(e);return(0,a.h)("arcgis-filter",{class:`${i} filter`,view:s,layer:l,hideLayerTitle:!0,noFilterMsg:n.filter.tipMsg,invalidHeading:n.filter.invalidHeading,invalidMsg:n.filter.invalidMsg,mode:"effects",defaultFieldName:r,defaultOperator:">",defaultExpression:!!r&&t,hideButtons:!0,closable:!0,panelMaxHeight:"80vh",onArcgisClose:()=>{this.arcgisClose.emit(),this.popoverNode.open=!1,this.open=!1,this.filterNode?.openPanel()},onArcgisChange:e=>this.arcgisFilterChange.emit(e.detail),ref:e=>this.filterNode=e})}rgb2Hex(e){return`#${this.componentToHex(Math.max(0,Math.min(255,e[0])))}${this.componentToHex(Math.max(0,Math.min(255,e[1])))}${this.componentToHex(Math.max(0,Math.min(255,e[2])))}`}componentToHex(e){const t=e.toString(16);return 1===t.length?`0${t}`:t}waitOnUser(e,t,s){const a=e.target;this.typingHandle&&(clearTimeout(this.typingHandle),this.typingHandle=void 0);const l=a.value,n=Number.parseFloat(l);l?(0,o.i)(a.min)&&(0,o.i)(a.max)&&(a.min>n||a.max<n)?this.typingHandle=setTimeout((()=>{this.typingHandle=void 0,a.min>n?(a.value=`${a.min}`,t(a)):a.max<n&&(a.value=`${a.max}`,t(a))}),750):l.startsWith("-")&&(0===n||Number.isNaN(n))||t(a):this.typingHandle=setTimeout((()=>{this.typingHandle=void 0,a.value=`${s}`,t(a)}),2e3)}get el(){return(0,a.g)(this)}};y.style=".popover {\n  --calcite-popover-z-index: 99;\n}\n\n.panel {\n  width: 291px; /* for FF */\n}\n.panel.filter {\n  min-height: 500px;\n  background-color: var(--calcite-color-background);\n}\n\n.effects-content {\n  padding: 1rem;\n  background-color: white;\n  max-height: 80vh;\n}\n\n.bottom-space {\n  margin-bottom: 1.8rem;\n}\n\n.bottom-space-little {\n  margin-bottom: 0.5rem;\n}\n\n.switch {\n  width: 100%;\n  display: flex;\n  justify-content: space-between;\n}\n\n.reset {\n  display: flex;\n  align-items: center;\n}\n\n.sub-header {\n  margin-left: 0.75rem;\n  margin-right: 0;\n}\n:dir(rtl) {\n  .sub-header {\n    margin-right: 0.75rem;\n    margin-left: 0;\n  }\n}\n\n.select-number {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  position: relative;\n\n  calcite-slider {\n    width: 58%;\n    height: 30px;\n    margin: 0 4px;\n\n    /* temp workaround for calcite issue #4126 */\n    overflow-wrap: normal;\n    word-break: normal;\n  }\n}\n\n.offset-div {\n  align-items: center;\n  display: flex;\n  justify-content: space-between;\n  gap: 16px;\n  margin-bottom: var(--calcite-spacing-md);\n}\n"}}]);