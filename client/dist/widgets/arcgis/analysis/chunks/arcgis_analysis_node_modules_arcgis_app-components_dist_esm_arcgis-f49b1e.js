/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f49b1e.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f49b1e"],{99004:(e,t,i)=>{i.d(t,{c:()=>a,g:()=>l});var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof self?self:{};function l(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}},5298:(e,t,i)=>{i.r(t),i.d(t,{arcgis_field_add_pages_add_field:()=>f});var a=i(19564),l=i(90079),r=i(4948),n=i(98034),s=i(44508),d=i(66484),o=i(18409),c=i(79238),u=i(47570),p=i(35162);i(18991),i(99004),i(91102),i(73807),i(86868),i(32084),i(61191),i(98821),i(32198),i(65174),i(62913),i(17233),i(57159),i(67336),i(33861),i(87382),i(82297),i(76246),i(748),i(97018),i(56288),i(93863),i(80015),i(24211);function m(e){return`${e}:00`}const h={esriFieldTypeInteger:"intDefaultValueError",esriFieldTypeBigInteger:"bigIntDefaultValueError",esriFieldTypeDouble:"doubleDefaultValueError"},f=class{constructor(e){(0,a.r)(this,e),this.arcgisWorkflowCancel=(0,a.c)(this,"arcgisWorkflowCancel",7),this.arcgisWorkflowComplete=(0,a.c)(this,"arcgisWorkflowComplete",7),this.arcgisWorkflowPrimaryButtonTextChange=(0,a.c)(this,"arcgisWorkflowPrimaryButtonTextChange",7),this.arcgisFieldAddFieldAdded=(0,a.c)(this,"arcgisFieldAddFieldAdded",7),this.arcgisWorkflowToggleNavigationEnabled=(0,a.c)(this,"arcgisWorkflowToggleNavigationEnabled",7),this.arcgisWorkflowCloseButtonEnabled=(0,a.c)(this,"arcgisWorkflowCloseButtonEnabled",7),this.selectedFieldValueType=null,this.showNullableToggle=!1,this.payload=void 0,this.layerAfterFieldAddition=void 0,this.nullValueInput=!0,this.payloadIsValid=!0,this.timeDateInputs=void 0,this.timeDatePickerIsValid=!0,this.fieldErrors={nameFieldError:null,lengthFieldError:null,bigIntDefaultValueError:null,doubleDefaultValueError:null,intDefaultValueError:null,timeDefaultValueFieldError:null,dateDefaultValueFieldError:null,timezoneDefaultValueFieldError:null,stringDefaultValueFieldError:null},this.nameFieldErrorTest=null,this.dateTimeDefaultValueIsValid=!0,this.dateTimeDefaultValueIsActive=!1,this.error=void 0,this.addInProgress=!1}async navigateToNextPage(){var e;const{i18n:t}=u.a,i=await(null===(e=this.descriptionRef)||void 0===e?void 0:e.getErrorMessage());if(i)return void(this.error={title:t.error,message:i.translatedMessage});if(!this.validatePayload())return this.payloadIsValid=!1,void(this.error={title:t.addFieldErrors.invalidFieldParameters,message:t.addFieldErrors.invalidInputsError});this.payload.type=u.a.selectedFieldType,this.payload.hasOwnProperty("defaultValue")&&!this.payload.defaultValue&&delete this.payload.defaultValue;const a={fields:[this.payload]},l=JSON.stringify(a);this.addInProgress=!0,this.disableModalButtons(!0),this.handleAddField(l)}handleFieldDescriptionInputChange(e){const{detail:t}=e;this.descriptionInput=t}async componentWillLoad(){var e,t;const{i18n:i,layer:a,selectedFieldType:l,options:r}=u.a;this.arcgisWorkflowPrimaryButtonTextChange.emit(i.addField),this.layerInfoToUpdate={},this.itemUrl=r?r.item.url:a.url;const n=null!==(e=null==a?void 0:a.portalItem)&&void 0!==e?e:r.item,s="Feature Layer"===a.type||"feature"===a.type;await this.loadAllModules(),await this.modules.IdentityManager.getCredential(n.url.replace("rest/services","rest/admin/services"));let d=0,o=a.popupTemplate;if(s){const e=new this.modules.FeatureLayer({url:`${this.itemUrl}/${null!==(t=null==a?void 0:a.layerId)&&void 0!==t?t:a.id}`,portalItem:n});await e.load(),d=await(null==e?void 0:e.queryFeatureCount()),a.popupTemplate||(o=e.popupTemplate)}else if(!a.popupTemplate&&"load"in a){o=(await a.load()).popupTemplate}switch(this.showNullableToggle=0===d,this.popupTemplate=o,await this.modules.request(this.itemUrl.replace("/rest/services","/rest/admin/services"),{query:{f:"json"},responseType:"json"}).then((async e=>{const t=e.data;this.maxFieldNameLength=t.maxFieldNameLength}),(()=>this.maxFieldNameLength=p.g)),this.payload={name:"",type:"",alias:"",nullable:!0,editable:!0},this.timeDateInputs={date:"",time:""},l){case"esriFieldTypeGlobalID":this.payload.name="GlobalID",this.payload.alias="GlobalID",this.payload.nullable=!1,this.payload.editable=!1,this.payload.defaultValue="NEWID() WITH VALUES";break;case"esriFieldTypeString":this.payload.length=256;break;case"esriFieldTypeTimestampOffset":this.timeDateInputs.timezone="";break;case"esriFieldTypeGUID":this.selectedFieldValueType="uniqueIdentifier"}this.handlePickerConditions()}componentDidLoad(){"esriFieldTypeTimestampOffset"===u.a.selectedFieldType&&(this.timeZoneEl.shadowRoot.childNodes[0].maxItems=8)}render(){const{error:e,fieldErrors:t,addInProgress:i}=this,{selectedFieldType:l,selectedFieldTypeCategory:r,i18n:n}=u.a,{nameFieldError:s}=t,o="esriFieldTypeTimeOnly"===l||"esriFieldTypeDateOnly"===l||"esriFieldTypeTimestampOffset"===l||"esriFieldTypeBigInteger"===l,p=n[r].types[l].title,m=n[r].types[l].description;return(0,a.h)(a.H,{key:"f4c65cca93ad3cb57c9e7a5d9066c7f484099ec0",class:{"overflow-hidden":i}},this.renderAddLoader(),(0,a.h)("div",{key:"ffdedc5ebe460974db5ffcadc77fb63cb2129945",class:"field-header-section"},(0,a.h)("div",{key:"7ed529cc165eec60608aa34a78793985b44d70cc",class:"field-type-header"},(0,a.h)("div",{key:"bdb3a41bf18cb164d0d5cda46957c75b2e4205f6",class:"field-type-text"},(0,a.h)("p",{key:"85d5dc0a5e3a66e6eb79adc1e257d8acb72ba41e",class:"field-type-title"},p),(0,a.h)("p",{key:"32d523cce527218e46e6491b1aaebadb95973534",class:"field-type-description",innerHTML:"esriFieldTypeBigInteger"===l?(0,d.i)(m):m})),(0,a.h)("div",{key:"71fe1be13c639fcda678a4ff843aba16c026a765",class:"field-type-icon"},(0,a.h)("calcite-icon",{key:"dd87aafe1928f3a8c9295d569846288fa4375055",icon:c.f[l]}))),(0,a.h)("hr",{key:"f34ebdbad586bca641589c1540679f6b641d3103",class:"line-breaker"}),o&&(0,a.h)("calcite-notice",{key:"aa48d39e8a850af2142f504fa757da650858eb36",open:!0,class:"new-field-type-notice",icon:"information",scale:"s"},(0,a.h)("div",{key:"75039c416eb661001f01dca92664f9d8e2ce9ab1",slot:"title"},n.newFieldTypeNotice))),"esriFieldTypeGlobalID"!==l?(0,a.h)("div",{class:"main-input-fields-container"},(0,a.h)("calcite-label",{class:"field-section"},n.fieldName,(0,a.h)("calcite-input",{status:null==s?void 0:s.status,required:!0,onCalciteInputInput:e=>{const t=e.target.value;this.handlePayloadInput(t,"name")}}),s&&(0,a.h)("calcite-input-message",{icon:null==s?void 0:s.icon,status:null==s?void 0:s.status},null==s?void 0:s.message)),(0,a.h)("calcite-label",{class:"field-section"},n.displayName,(0,a.h)("calcite-input",{onCalciteInputInput:e=>{const t=e.target.value;this.handlePayloadInput(t,"alias")}})),"esriFieldTypeString"===l&&(0,a.h)("calcite-label",{class:"field-section"},n.length,this.renderLengthField()),this.renderNullableToggle(),(0,a.h)("hr",{class:"line-breaker"}),"esriFieldTypeGUID"!==l&&(0,a.h)("calcite-label",{class:"field-section"},n.defaultValue,this.fieldsToShow.enableNormalPicker?"esriFieldTypeString"===l?this.renderTextDefaultValue():this.renderNumberDefaultValue():(0,a.h)("div",{class:"time-date-pickers"},this.fieldsToShow.enableDatePicker&&this.renderDatePicker(),this.fieldsToShow.enableTimePicker&&this.renderTimePicker(),this.fieldsToShow.enableTimezonePicker&&this.renderTimezonePicker())),this.renderFieldDescriptionArea(),(0,a.h)("calcite-label",{class:"field-section"},n.fieldValueType,this.renderFieldValueTypeCombobox())):(0,a.h)("calcite-notice",{open:!0,class:"global-id-notice",icon:"information",scale:"s"},(0,a.h)("div",{slot:"title"},n.addGlobalIDNotice)),(0,a.h)("arcgis-new-item-alert",{key:"02672e0d561db2c4b7ed00e43eb4ac1353205c23",heading:null==e?void 0:e.title,description:null==e?void 0:e.message,active:!!e,onAlertDismiss:()=>this.error=null}))}renderAddLoader(){const{addInProgress:e}=this,{i18n:t}=u.a;return(0,a.h)("div",{class:"loader-container "+(e?"active":"")},(0,a.h)("calcite-loader",{class:"loader",label:t.addingField,hidden:!e}),(0,a.h)("div",{class:"loader-text"},t.addingField))}renderNullableToggle(){const{i18n:e}=u.a;return(0,a.h)("calcite-label",{layout:"inline",class:"field-section"},(0,a.h)("calcite-switch",{id:"toggleNullValues",disabled:!this.showNullableToggle,checked:this.nullValueInput,onCalciteSwitchChange:e=>{this.nullValueInput=e.target.checked,this.handlePayloadInput(this.nullValueInput,"nullable")}}),e.allowNullValues,!this.showNullableToggle&&(0,a.h)("div",{class:"nullable-toggle-info"},(0,a.h)("calcite-icon",{id:"nullable-information",class:"nullable-info-tooltip",icon:"information",scale:"s"}),(0,a.h)("calcite-tooltip",{"reference-element":"nullable-information"},(0,a.h)("span",null,e.nullableTooltipInfo))))}renderTextDefaultValue(){const{stringDefaultValueFieldError:e}=this.fieldErrors;return(0,a.h)("div",null,(0,a.h)("calcite-input",{type:"text",onCalciteInputInput:e=>{const t=e.target.value;this.handlePayloadInput(t,"defaultValue")}}),e&&(0,a.h)("calcite-input-message",{class:"default-text-input-message",icon:null==e?void 0:e.icon,status:null==e?void 0:e.status},null==e?void 0:e.message))}renderNumberDefaultValue(){const{selectedFieldType:e}=u.a,{max:t,min:i}=function(e){let t,i;switch(e){case"esriFieldTypeBigInteger":t=Number.MAX_SAFE_INTEGER,i=Number.MIN_SAFE_INTEGER;break;case"esriFieldTypeDouble":default:t=p.b,i=p.c;break;case"esriFieldTypeInteger":t=p.M,i=p.a}return{max:t,min:i}}(e),l="esriFieldTypeDouble"===e,r=this.fieldErrors[h[e]];let n;const s=()=>{this.handlePayloadInput(n,"defaultValue"),this.inputNumberNode.value=this.payload.defaultValue};return(0,a.h)("calcite-input-number",{ref:e=>this.inputNumberNode=e,inputMode:"decimal",max:t,min:i,integer:!l,step:l?.01:1,status:r?"invalid":"idle","validation-icon":r?"exclamation-mark-triangle":null,"validation-message":r,onCalciteInputNumberInput:e=>{n=e.target.value,l||this.handlePayloadInput(n,"defaultValue")},onBlur:()=>{l&&s()}})}renderLengthField(){const{lengthFieldError:e}=this.fieldErrors;return(0,a.h)("calcite-input-number",{integer:!0,inputMode:"decimal",min:p.e,max:p.f,value:`${this.payload.length}`,required:!0,status:e?"invalid":"idle","validation-icon":e?"exclamation-mark-triangle":null,"validation-message":e,onCalciteInputNumberInput:e=>{const t=Number(e.target.value);this.handlePayloadInput(t,"length")}})}renderDatePicker(){const{dateDefaultValueFieldError:e}=this.fieldErrors;return(0,a.h)("calcite-input-date-picker",{placement:"bottom-start",overlayPositioning:"fixed",class:"time-date-picker "+(e?"error-active":""),required:!!e,status:e?"invalid":"idle","validation-icon":e?"exclamation-mark-triangle":null,"validation-message":e,onCalciteInputDatePickerChange:e=>{const t=e.target.value,i=Array.isArray(t)?t[0]:t;this.handleTimeDatePickerInputs(i,"date")}})}renderTimePicker(){const{timeDefaultValueFieldError:e}=this.fieldErrors;return(0,a.h)("calcite-input-time-picker",{class:"time-date-picker "+(e?"error-active":""),required:!!e,status:e?"invalid":"idle","validation-icon":e?"exclamation-mark-triangle":null,"validation-message":e,onCalciteInputTimePickerChange:e=>{const t=e.target.value;this.handleTimeDatePickerInputs(t,"time")}})}renderTimezonePicker(){const{timezoneDefaultValueFieldError:e}=this.fieldErrors;return(0,a.h)("calcite-input-time-zone",{clearable:!0,value:this.timeDateInputs.timezone||null,id:"timezonePickerInput",ref:e=>this.timeZoneEl=e,class:"time-date-picker "+(e?"error-active":""),status:e?"invalid":"idle","validation-icon":e?"exclamation-mark-triangle":null,"validation-message":e,onCalciteInputTimeZoneChange:e=>{const t=e.target.value;this.handleTimeDatePickerInputs(t,"timezone")}})}renderFieldValueTypeCombobox(){const{i18n:e,selectedFieldType:t}=u.a,i="esriFieldTypeDate"===(l=t)||"esriFieldTypeDateOnly"===l||"esriFieldTypeTimeOnly"===l||"esriFieldTypeTimestampOffset"===l?"esriFieldTypeTime":t;var l;const r=p.h[i].sort(),n=Object.keys(e.fieldValueTypes).filter((e=>!r.includes(e)&&"none"!==e)).sort();return(0,a.h)("calcite-combobox",{maxItems:7,label:e.fieldValueType,selectionMode:"single-persist",onCalciteComboboxChange:e=>{const t=e.target.value;this.selectedFieldValueType=t}},(0,a.h)("calcite-combobox-item-group",{label:e.suggestedHeader},r.map((i=>(0,a.h)("calcite-combobox-item",{value:i,textLabel:e.fieldValueTypes[i],selected:"esriFieldTypeGUID"===t&&"uniqueIdentifier"===i})))),(0,a.h)("calcite-combobox-item-group",{label:e.otherHeader},n.map((t=>(0,a.h)("calcite-combobox-item",{value:t,textLabel:e.fieldValueTypes[t]})))))}renderFieldDescriptionArea(){const{i18n:e}=u.a;return(0,a.h)("arcgis-field-description-input",{trimInput:!0,label:e.fieldDescription,placeholder:e.provideDescription,maxLength:p.i,ref:e=>this.descriptionRef=e})}async loadAllModules(){const[e,t,i,a,l]=await(0,n.l)(["esri/request","esri/layers/support/FeatureTemplate","esri/Graphic","esri/layers/FeatureLayer","esri/identity/IdentityManager"]);this.modules={request:e,FeatureTemplate:t,Graphic:i,FeatureLayer:a,IdentityManager:l}}async handleAddField(e){var t,i,a,l,r;const{layer:n,i18n:s}=u.a,{request:d}=this.modules;try{const s={layer:n},c=`${this.itemUrl}/${null!==(t=null==n?void 0:n.layerId)&&void 0!==t?t:n.id}`;await(0,o.A)(e,c,!1),await d(c,{query:{f:"json"},method:"post",responseType:"json"}).then((async e=>{s.serviceInfo=e.data,this.layerAfterFieldAddition=e.data}),(()=>this.handleError()));const p=(null!==(a=null===(i=s.serviceInfo)||void 0===i?void 0:i.fields)&&void 0!==a?a:null===(l=s.layer)||void 0===l?void 0:l.fields).filter((e=>e.name.toLowerCase()===this.payload.name.toLowerCase()&&(e.name!==this.payload.name&&(this.payload.name=e.name,s.name=e.name),!0)))[0];this.newFieldName=p.name;const m=function(e,t,i){let a={};switch(t.type){case"esriFieldTypeInteger":a.places=0,a.digitSeparator=!0;break;case"esriFieldTypeDouble":a.places=2,a.digitSeparator=!0;break;case i>=10:a.dateFormat="short-date-long-time"}const l={fieldName:t.name,label:t.alias,isEditable:t.editable,tooltip:"",visible:!0,format:a,stringFieldOption:"text-box"};e&&e.fieldInfos&&(e.fieldInfos.some((e=>e.fieldName===l.fieldName))||e.fieldInfos.push(l));return e}(this.popupTemplate,p,n.version);this.layerInfoToUpdate.popupInfo=m,s.popupInfo=m,this.updateTypesAndTemplatesOnLayer(),(null===(r=s.serviceInfo.templates)||void 0===r?void 0:r.length)?s.serviceInfo.templates.forEach((e=>{"esriFieldTypeGlobalID"!==u.a.selectedFieldType&&(e.prototype.attributes[p.name]=p.defaultValue||null)})):s.serviceInfo.types.forEach((e=>{e.templates.forEach((e=>{"esriFieldTypeGlobalID"!==u.a.selectedFieldType&&(e.prototype.attributes[p.name]=p.defaultValue||null)}))})),this.updateFeatureService(s,this.modules.request)}catch(e){console.error(e),this.addInProgress=!1,this.disableModalButtons(!1),this.error={title:s.addFieldErrors.genericAddFieldError.title,message:s.addFieldErrors.genericAddFieldError.description}}}updateTypesAndTemplatesOnLayer(){var e;const{layerAfterFieldAddition:t}=this,i=t;if(null===(e=i.templates)||void 0===e?void 0:e.length){const e=this.updateTemplatesList(i.templates);i.templates=e}else if(i.types){const e=i.types;i.types=[],e.forEach((e=>{e.templates=this.updateTemplatesList(e.templates),this.addType(i,e)}))}}updateTemplatesList(e){const{i18n:t}=u.a,{layerAfterFieldAddition:i}=this,{modules:a}=this,l=[];return(null!=e?e:[]).forEach((e=>{var r;const n=new a.FeatureTemplate;n.description=null!==(r=e.description)&&void 0!==r?r:"",n.name=e.name||t.newFeature,n.drawingTool=e.drawingTool||"point";const s={};i.fields.forEach((t=>{let i=!1;for(const a in e.prototype.attributes)if(a===t.name){i=!0,s[t.name]=e.prototype.attributes[t.name];break}!i&&t.editable&&(s[t.name]=t.defaultValue||null)}));const d=new a.Graphic({attributes:s});n.prototype=d,l.push(n)})),l}addType(e,t){if(e.types){e.types.some((e=>e.id===t.id))||e.types.push(t)}else e.types=[t]}async updateFeatureService(e,t){var i,a,n;const{portal:d}=r.c,{i18n:o,layer:c,options:p}=u.a,{payload:m}=this,h=null!==(i=null==c?void 0:c.portalItem)&&void 0!==i?i:p.item,f=e.serviceInfo.types.flatMap((e=>e.templates));let T=e.serviceInfo.templates;if(!T.length&&!f.length){const e={name:o.newFeature,description:"",drawingTool:"esriFeatureEditToolPoint",prototype:{attributes:{}}};this.layerAfterFieldAddition.fields.forEach((t=>{"esriFieldTypeGlobalID"!==u.a.selectedFieldType&&(e.prototype.attributes[t.name]=t.defaultValue||null)})),T=[e]}const E={templates:T,types:e.serviceInfo.types};let g=JSON.stringify(E);if(this.selectedFieldValueType||this.descriptionInput){m.description={value:this.descriptionInput?this.descriptionInput.replace(/"/g,"${addEscapeDash}").replace(/\n/g,"\\n"):"",fieldValueType:null!==(a=this.selectedFieldValueType)&&void 0!==a?a:""},m.domain=null,E.fields=[m];g=function(e,t,i){const a=e.indexOf(t),l=e.indexOf(i),r=e.slice(a,l).replace(/"/g,'\\"').replace(/\$\{addEscapeDash}/g,'\\\\\\"');return`${e.slice(0,a)}"${r}"${e.slice(l)}`}(JSON.stringify(E),'{"value"',',"domain"')}const y=`${this.itemUrl.replace("/rest/services","/rest/admin/services")}/${null!==(n=null==c?void 0:c.layerId)&&void 0!==n?n:c.id}/updateDefinition`,I={f:"json",updateDefinition:g};await t(y,{query:Object.assign(Object.assign({},I),{f:"json"}),method:"post",responseType:"json"}).then((async i=>{var a;if(null===(a=i.data)||void 0===a?void 0:a.success){const i=e.serviceInfo;if(i){const e=i.fields;e.forEach(((t,i)=>e[i].type=l.e[e[i].type])),this.layerInfoToUpdate.fields=e}const a=`${(0,s.g)(d)}content/items/${h.id}/data`;await t(a,{query:{f:"json"},method:"get",responseType:"json"}).then((async i=>{var a;const l=i.data;if((null==l?void 0:l.layers)||(null==l?void 0:l.tables)){const i=c.isTable,r=i?l.tables:l.layers,n=null==r?void 0:r.find((e=>{var t;return e.id===(null!==(t=null==c?void 0:c.layerId)&&void 0!==t?t:c.id)}));if(null==n?void 0:n.popupInfo){n.popupInfo.fieldInfos=[...e.popupInfo.fieldInfos];const l=`${(0,s.g)(d)}content/users/${h.owner}/items/${h.id}/update`,o=i?{tables:r}:{layers:r},c={f:"json",text:JSON.stringify(o)};(null===(a=d.sourceJSON)||void 0===a?void 0:a.isReadOnly)?this.handleError(!0):await t(l,{query:Object.assign({f:"json"},c),method:"post",responseType:"json"}).then((e=>{var t;(null===(t=e.data)||void 0===t?void 0:t.success)?this.handleSuccess():this.handleError()}),(()=>this.handleError()))}else this.handleSuccess()}else 200!==i.httpStatus||i.data&&"{}"!==JSON.stringify(i.data)?this.handleError():this.handleSuccess()}),(()=>this.handleError()))}}),(()=>this.handleError()))}validatePayload(){var e;return"esriFieldTypeGlobalID"!==u.a.selectedFieldType&&this.checkFieldErrors(),this.dateTimeDefaultValueIsValid&&(!this.fieldErrors.nameFieldError||"invalid"!==(null===(e=this.fieldErrors.nameFieldError)||void 0===e?void 0:e.status))&&!this.fieldErrors.lengthFieldError&&!this.fieldErrors.bigIntDefaultValueError&&!this.fieldErrors.doubleDefaultValueError&&!this.fieldErrors.intDefaultValueError}checkFieldErrors(){const{payload:e,fieldErrors:t,maxFieldNameLength:i}=this,{layer:a,selectedFieldType:l,i18n:r}=u.a,n=Object.assign({},t);switch(n.nameFieldError=function(e,t,i){const{addFieldErrors:a}=u.a.i18n,l={icon:"exclamation-mark-triangle",status:"invalid",message:null},r=e.toUpperCase(),n=p.s.includes(r),s=/[\`\~\@\#\$\%\^\&\*\(\)\\\-\+\=\|\,<>\?\/\{\}\.\!\'\[\]\:\;\n\r\s\"]/.test(e)||/[\`\~\@\#\$\%\^\&\*\(\)\\\-\+\=\|\,<>\?\/\{\}\.\!\'\[\]\:\;\n\r\d\_\"]/.test(e.charAt(0)),d=t.some((t=>t.name.toLowerCase()===e.toLowerCase())),o=e.length>i,c=+e[0],m=e.length>p.d;switch(!0){case!e.length:l.message=a.valueIsRequiredError;break;case!!c:case s:l.message=a.invalidNameInputInvalidCharactersError;break;case n:l.message=a.invalidNameInputSQLError;break;case d:l.message=a.existingFieldNameError;break;case o:l.message=a.lengthExceeds.replace("${maxFieldNameLength}",`${i}`);break;case m:l.icon="information",l.status="idle",l.message=u.a.i18n.fieldNameCharacterNotice}return l.message?l:null}(e.name,a.fields,i),!0){case"esriFieldTypeString"===l:n.lengthFieldError=function(e){const{addFieldErrors:t}=u.a.i18n,i=e<p.e,a=e>p.f;return i||a?t.outOfRangeValueError:null}(e.length),n.stringDefaultValueFieldError=e.defaultValue&&function(e,t){const{addFieldErrors:i}=u.a.i18n;return t.length>e?{icon:"information",status:"idle",message:i.defaultValueExceeds}:null}(e.length,e.defaultValue);break;case"esriFieldTypeInteger"===l:case"esriFieldTypeDouble"===l:case"esriFieldTypeBigInteger"===l:n[h[l]]=function(e,t){const{addFieldErrors:i}=u.a.i18n;switch(e){case"esriFieldTypeBigInteger":if(t>Number.MAX_SAFE_INTEGER||t<Number.MIN_SAFE_INTEGER)return i.outOfRangeValueError;break;case"esriFieldTypeDouble":if(t>p.b||t<p.c)return i.outOfRangeValueError;break;case"esriFieldTypeInteger":if(t>p.M||t<p.a)return i.outOfRangeValueError}return null}(l,e.defaultValue);break;case("esriFieldTypeDate"===l||"esriFieldTypeTimestampOffset"===l)&&!this.dateTimeDefaultValueIsValid:n.timeDefaultValueFieldError=this.timeDateInputs.time.length?null:r.addFieldErrors.valueIsRequiredError,n.dateDefaultValueFieldError=this.timeDateInputs.date.length?null:r.addFieldErrors.valueIsRequiredError,"esriFieldTypeTimestampOffset"===l&&(n.timezoneDefaultValueFieldError=this.timeDateInputs.timezone.length?null:r.addFieldErrors.valueIsRequiredError)}this.fieldErrors=Object.assign({},n)}handlePayloadInput(e,t){const{selectedFieldType:i}=u.a;let a=e;if("defaultValue"===t&&e)switch(i){case"esriFieldTypeTimeOnly":a=m(e);break;case"esriFieldTypeDouble":a=function(e){let t=e;if(null==e?void 0:e.includes(".")){const i=e.split(".");if(null==i?void 0:i.length){const e=i[1].length,a=Number(i[0]);a!==p.b&&a!==p.c||(t=Math.round(Number(t))),e>3&&(t=Number(t).toFixed(3))}}return`${t}`}(e)}this.payload[t]=a,this.checkFieldErrors()}checkIfTimeDatePickerValid(){const e=Object.values(this.timeDateInputs).every((e=>!!e)),t=Object.values(this.timeDateInputs).every((e=>!e));return this.dateTimeDefaultValueIsValid=e||t,this.dateTimeDefaultValueIsValid}handleTimeDatePickerInputs(e,t){const{selectedFieldType:i}=u.a;switch(i){case"esriFieldTypeDate":this.timeDateInputs[t]=e,this.timeDateInputs.date&&this.timeDateInputs.time?this.handlePayloadInput(function(e,t){const i=m(e);return Date.parse(`${t} ${i}`)}(this.timeDateInputs.time,this.timeDateInputs.date),"defaultValue"):this.timeDateInputs.date||this.timeDateInputs.time||(this.dateTimeDefaultValueIsValid=!0,this.handlePayloadInput("","defaultValue"));break;case"esriFieldTypeTimestampOffset":this.timeDateInputs[t]=e,this.timeDateInputs.date&&this.timeDateInputs.time&&this.timeDateInputs.timezone?this.handlePayloadInput(function(e,t,i){const a=Math.floor(Number(i)/60),l=a<0?-1*a:a,r=Number(i)%60;return`${e}T${t}:00${a<0?"-":"+"}${String(l).padStart(2,"0")}:${r>0?r:"00"}`}(this.timeDateInputs.date,this.timeDateInputs.time,this.timeDateInputs.timezone),"defaultValue"):this.timeDateInputs.date||this.timeDateInputs.time||this.timeDateInputs.timezone||(this.dateTimeDefaultValueIsValid=!0,this.handlePayloadInput("","defaultValue"));break;case"esriFieldTypeTimeOnly":case"esriFieldTypeDateOnly":this.handlePayloadInput(e,"defaultValue")}this.dateTimeDefaultValueIsActive=Object.values(this.timeDateInputs).some((e=>e.length>0)),this.checkIfTimeDatePickerValid()}handlePickerConditions(){const{selectedFieldType:e}=u.a,t="esriFieldTypeDate"===e||"esriFieldTypeTimestampOffset"===e,i=t||"esriFieldTypeTimeOnly"===e,a=t||"esriFieldTypeDateOnly"===e,l="esriFieldTypeTimestampOffset"===e,r=!i&&!a&&!l;this.fieldsToShow={enableNormalPicker:r,enableTimePicker:i,enableDatePicker:a,enableTimezonePicker:l}}disableModalButtons(e){this.arcgisWorkflowToggleNavigationEnabled.emit(!e),this.arcgisWorkflowCloseButtonEnabled.emit(!e)}handleSuccess(){(null===u.a||void 0===u.a?void 0:u.a.options)||this.displaySuccessAlert(),this.arcgisFieldAddFieldAdded.emit(this.newFieldName),(0,u.d)(),this.arcgisWorkflowComplete.emit("success")}displaySuccessAlert(){const{i18n:e}=u.a,t=document.createElement("calcite-alert");t.kind="success",t.icon="check-circle";const i=document.createElement("div");i.slot="message",i.innerHTML=e.fieldAdded,t.append(i),t.open=!0,t.autoClose=!0,document.body.append(t)}displayErrorAlert(){var e;const{i18n:t}=u.a;this.errorAlertNode&&(null===(e=this.errorAlertNode.parentElement)||void 0===e||e.removeChild(this.errorAlertNode),this.errorAlertNode=void 0);const i=this.errorAlertNode=document.createElement("calcite-alert");i.kind="danger",i.icon="exclamation-mark-triangle";const a=document.createElement("div");a.slot="message",a.innerHTML=t.fieldAdditionUnsuccessful,i.append(a),i.open=!0,i.autoClose=!0,document.body.append(i)}displayReadOnlyErrorAlert(){var e;const{i18n:t,layer:i}=u.a;this.errorAlertNode&&(null===(e=this.errorAlertNode.parentElement)||void 0===e||e.removeChild(this.errorAlertNode),this.errorAlertNode=void 0);const a=this.errorAlertNode=document.createElement("calcite-alert");a.kind="danger",a.autoCloseDuration="slow",a.icon="exclamation-mark-triangle";const l=document.createElement("div");l.slot="title",l.innerHTML=t.addFieldErrors.savingFailed.replace("${layerName}",i.title);const r=document.createElement("div");r.slot="message",r.innerHTML=t.addFieldErrors.readOnlyErrorMessage;const n=document.createElement("calcite-link");n.slot="link",n.innerHTML=t.addFieldErrors.healthDashboard,n.href="https://status.arcgis.com",n.target="_blank",a.appendChild(l),a.appendChild(r),a.appendChild(n),a.open=!0,a.autoClose=!0,document.body.append(a)}handleError(e){(null===u.a||void 0===u.a?void 0:u.a.options)?e?(this.arcgisFieldAddFieldAdded.emit(this.newFieldName),this.arcgisWorkflowCancel.emit("read-only-error")):this.arcgisWorkflowCancel.emit("error"):(e?(this.displayReadOnlyErrorAlert(),this.arcgisFieldAddFieldAdded.emit(this.newFieldName)):this.displayErrorAlert(),this.arcgisWorkflowCancel.emit())}get el(){return(0,a.d)(this)}};f.style=".field-type-block.sc-arcgis-field-add-pages-add-field{margin-bottom:1.25rem}.time-date-pickers.sc-arcgis-field-add-pages-add-field{display:flex;flex-direction:column;gap:0.75rem}.new-field-type-notice.sc-arcgis-field-add-pages-add-field{padding-bottom:1rem;color:var(--calcite-color-text-1)}.field-section.sc-arcgis-field-add-pages-add-field{margin-bottom:0.75rem}.global-id-notice.sc-arcgis-field-add-pages-add-field{color:var(--calcite-color-text-1)}.error-active.sc-arcgis-field-add-pages-add-field{margin-bottom:0.5rem}.loader-container.sc-arcgis-field-add-pages-add-field{position:absolute;top:0px;right:0px;z-index:40;display:none;height:100%;width:100%;overflow:hidden;padding:0px;background:rgba(255, 255, 255, 0.95)}.active.sc-arcgis-field-add-pages-add-field{display:flex;flex-direction:column;place-content:center;align-items:center;justify-items:center}.loader.sc-arcgis-field-add-pages-add-field{padding:0px}.loader-text.sc-arcgis-field-add-pages-add-field{text-align:center;font-size:1rem;font-weight:500;margin-right:6.25rem;margin-left:6.25rem}.character-notice-icon.sc-arcgis-field-add-pages-add-field{--calcite-ui-icon-color:var(--calcite-color-brand)}calcite-block.sc-arcgis-field-add-pages-add-field{border-width:2px;border-style:solid;border-color:var(--calcite-color-border-3)}.default-text-input-message.sc-arcgis-field-add-pages-add-field{--calcite-input-message-spacing-value:0.75rem}.field-type-header.sc-arcgis-field-add-pages-add-field{margin-top:0.5rem;margin-bottom:0.75rem;display:flex;align-items:center}.field-type-title.sc-arcgis-field-add-pages-add-field{margin-top:0px;margin-bottom:0px;font-size:1rem;font-weight:500;color:var(--calcite-color-text-1)}.field-type-description.sc-arcgis-field-add-pages-add-field{margin-top:0px;margin-bottom:0px;font-size:0.875rem}.field-type-icon.sc-arcgis-field-add-pages-add-field{margin-inline-start:auto}.line-breaker.sc-arcgis-field-add-pages-add-field{margin-bottom:1rem;border-width:1px;border-style:solid;border-color:var(--calcite-color-border-3)}.nullable-info-tooltip.sc-arcgis-field-add-pages-add-field{color:var(--calcite-color-text-3)}"},91102:(e,t,i)=>{i.d(t,{a:()=>d,c:()=>l,d:()=>o,g:()=>r,i:()=>n,s:()=>s});var a=i(73807);function l(e,t){return function e(i){return i?i.closest(t)||e(function(e){return e.getRootNode()}(i).host||null):null}(e)}function r(e){const t=l(e,".calcite-mode-dark, .calcite-mode-light");return(null==t?void 0:t.classList.contains("calcite-mode-dark"))?"dark":"light"}function n(e){let t=e;for(;null==t?void 0:t.parentNode;){if(t.parentNode===document)return!0;t=t.parentNode instanceof ShadowRoot?t.parentNode.host:t.parentNode}return!1}function s(e){return(new a.S).sanitize(e)}function d(e){const t=s(e),i=document.createElement("div");return i.innerHTML=t,i.textContent||i.innerText||""}function o(e){const t=document.createElement("textarea");return t.innerHTML=e,t.value}},98034:(e,t,i)=>{i.d(t,{e:()=>r,l:()=>n});var a,l=i(99004),r={exports:{}};a=r.exports,l.c,function(e){var t={Promise:"undefined"!=typeof window?window.Promise:void 0},i="4.24",a="next";function l(e){if(e.toLowerCase()===a)return a;var t=e&&e.match(/^(\d)\.(\d+)/);return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}function r(e){return void 0===e&&(e=i),"https://js.arcgis.com/".concat(e,"/")}function n(e){void 0===e&&(e=i);var t=r(e),n=l(e);if(n!==a&&3===n.major){var s=n.minor<=10?"js/":"";return"".concat(t).concat(s,"esri/css/esri.css")}return"".concat(t,"esri/themes/light/main.css")}function s(e){var t=document.createElement("link");return t.rel="stylesheet",t.href=e,t}function d(e,t){if(t){var i=document.querySelector(t);i.parentNode.insertBefore(e,i)}else document.head.appendChild(e)}function o(e){return document.querySelector('link[href*="'.concat(e,'"]'))}function c(e){return!e||l(e)?n(e):e}function u(e,t){var i=c(e),a=o(i);return a||d(a=s(i),t),a}var p={};function m(e){var t=document.createElement("script");return t.type="text/javascript",t.src=e,t.setAttribute("data-esri-loader","loading"),t}function h(e,t,i){var a;i&&(a=f(e,i));var l=function(){t(e),e.removeEventListener("load",l,!1),a&&e.removeEventListener("error",a,!1)};e.addEventListener("load",l,!1)}function f(e,t){var i=function(a){t(a.error||new Error("There was an error attempting to load ".concat(e.src))),e.removeEventListener("error",i,!1)};return e.addEventListener("error",i,!1),i}function T(e){void 0===e&&(e={}),p=e}function E(){return document.querySelector("script[data-esri-loader]")}function g(){var e=window.require;return e&&e.on}function y(e){void 0===e&&(e={});var i={};[p,e].forEach((function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(i[t]=e[t])}));var a=i.version,l=i.url||r(a);return new t.Promise((function(e,t){var r=E();if(r){var n=r.getAttribute("src");n!==l?t(new Error("The ArcGIS API for JavaScript is already loaded (".concat(n,")."))):g()?e(r):h(r,e,t)}else if(g())t(new Error("The ArcGIS API for JavaScript is already loaded."));else{var s=i.css;s&&u(!0===s?a:s,i.insertCssBefore),h(r=m(l),(function(){r.setAttribute("data-esri-loader","loaded"),e(r)}),t),document.body.appendChild(r)}}))}function I(e){return new t.Promise((function(t,i){var a=window.require.on("error",i);window.require(e,(function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];a.remove(),t(e)}))}))}function b(e,t){if(void 0===t&&(t={}),g())return I(e);var i=E(),a=i&&i.getAttribute("src");return!t.url&&a&&(t.url=a),y(t).then((function(){return I(e)}))}e.utils=t,e.loadModules=b,e.getScript=E,e.isLoaded=g,e.loadScript=y,e.setDefaultOptions=T,e.loadCss=u,Object.defineProperty(e,"__esModule",{value:!0})}(a);const n=async(e,t)=>(await r.exports.loadModules(e,t)).map((e=>e.__esModule&&e.default?e.default:e))},47570:(e,t,i)=>{i.d(t,{a:()=>l,d:()=>r});const a=(0,i(18991).c)({itemData:null,layer:null,selectedFieldType:null,selectedFieldTypeCategory:null,i18n:null,options:null}),l=a.state,r=a.dispose},66484:(e,t,i)=>{i.d(t,{a:()=>d,c:()=>o,g:()=>r,h:()=>l,i:()=>n,r:()=>s});var a=i(91102);function l(e){const t=document.createElement("textarea");return t.innerHTML=e,t.innerText}function r(e){return function(e){return null==e?void 0:e.replace(/&#10;&#13;|&#10;|&#13;|\r\n|\r|\n/g,"<br>")}(function(e){return null==e?void 0:e.replace(/(?:\r)/g,"&#10;").replace(/(?:\n)/g,"&#13;")}(function(e){return null==e?void 0:e.replace(/(https?:\/\/[^\s]+)/g,(e=>`<a href="${e}" target="_blank">${e}</a>`))}(function(e){return null==e?void 0:e.replace(/(?:&#10;)/g,"\r").replace(/(?:&#13;)/g,"\n")}(e))))}function n(e){return e.replace(/\$\{startSup\}/g,"<sup>").replace(/\$\{endSup\}/g,"</sup>")}function s(e,t,i){return e.replace(/\$\{startLink\}/g,`<calcite-link label="${i}" href="${t}" target="_blank">`).replace(/\$\{endLink\}/g,"</calcite-link>")}function d(e){return e.replace(/\$\{startStrong\}/g,"<strong>").replace(/\$\{endStrong\}/g,"</strong>")}function o(e){return(0,a.s)((null==e?void 0:e.trim())||"").replace(/[!*+\-&|()[\]{}^~?:"\\]/g,"\\$&")}},79238:(e,t,i)=>{i.d(t,{a:()=>a,e:()=>l,f:()=>r});const a={point:"point",line:"line",polygon:"polygon",multipatch:"cube",table:"table",multipoint:"layer-points"},l={esriGeometryPoint:"point",esriGeometryPolyline:"line",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"cube",esriGeometryMultipoint:"point",none:"table"},r={esriFieldTypeOID:"key",esriFieldTypeBoolean:"boolean",esriFieldTypeString:"string",esriFieldTypeSingle:"number",esriFieldTypeDouble:"number",esriFieldTypeInteger:"integer",esriFieldTypeSmallInteger:"integer",esriFieldTypeGlobalID:"key",esriFieldTypeDate:"date-time",esriFieldTypeBigInteger:"integer",esriFieldTypeDateOnly:"calendar",esriFieldTypeTimeOnly:"clock",esriFieldTypeTimestampOffset:"time-zone",esriFieldTypeGUID:"key"}},35162:(e,t,i)=>{i.d(t,{M:()=>d,a:()=>s,b:()=>c,c:()=>o,d:()=>l,e:()=>n,f:()=>r,g:()=>a,h:()=>h,i:()=>u,j:()=>p,k:()=>m,s:()=>f});const a=128,l=31,r=2147483647,n=1,s=-2147483648,d=2147483647,o=-9e15,c=9e15,u=500,p=["text","numbers","dates","globalIdentifiers"],m=["esriFieldTypeString","esriFieldTypeDouble","esriFieldTypeInteger","esriFieldTypeBigInteger","esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset","esriFieldTypeGlobalID","esriFieldTypeGUID"],h={esriFieldTypeString:["binary","coordinate","dateAndTime","description","emailAddress","locationOrPlaceName","nameOrTitle","orderedOrRanked","phoneNumber","typeOrCategory","uniqueIdentifier"],esriFieldTypeInteger:["binary","coordinate","countOrAmount","currency","measurement","orderedOrRanked","percentageOrRatio","phoneNumber","typeOrCategory","uniqueIdentifier"],esriFieldTypeBigInteger:["countOrAmount","currency","measurement","orderedOrRanked","phoneNumber","typeOrCategory","uniqueIdentifier"],esriFieldTypeDouble:["binary","coordinate","countOrAmount","currency","measurement","orderedOrRanked","percentageOrRatio","typeOrCategory"],esriFieldTypeTime:["dateAndTime"],esriFieldTypeGUID:["uniqueIdentifier"]},f=["ABSOLUTE","ACCESS","ACTION","ADD","ALL","ALLOCATE","ALPHANUMERIC","ALTER","AND","ANY","ARE","AS","ASC","ASSERTION","AT","AUTHORIZATION","AUTOINCREMENT","AVG","BEGIN","BETWEEN","BINARY","BIT","BIT_LENGTH","BOOLEAN","BOTH","BY","BYTE","CASCADE","CASCADED","CASE","CAST","CATALOG","CHAR","CHAR_LENGTH","CHARACTER","CHARACTER_LENGTH","CHECK","CLOSE","COALESCE","COLLATE","COLLATION","COLUMN","COMMENT","COMMIT","CONNECT","CONNECTION","CONSTRAINT","CONSTRAINTS","CONTINUE","CONVERT","CORRESPONDING","COUNT","COUNTER","CREATE","CROSS","CURRENCY","CURRENT","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DATE","DATETIME","DAY","DEALLOCATE","DEC","DECIMAL","DECLARE","DEFAULT","DEFERRABLE","DEFERRED","DELETE","DESC","DESCRIBE","DESCRIPTOR","DIAGNOSTICS","DISCONNECT","DISALLOW","DISTINCT","DISTINCTROW","DOMAIN","DOUBLE","DROP","EQV","ELSE","END","END-EXEC","ESCAPE","EXCEPT","EXCEPTION","EXEC","EXECUTE","EXISTS","EXTERNAL","EXTRACT","FALSE","FETCH","FIRST","FLOAT","FLOAT4","FLOAT8","FOR","FOREIGN","FOUND","FROM","FULL","GENERAL","GET","GLOBAL","GO","GOTO","GRANT","GROUP","GUID","HAVING","HOUR","IDENTITY","IEEEDOUBLE","IEEESINGLE","IGNORE","IMMEDIATE","IMAGE","IN","IMP","INDEX","INDICATOR","INITIALLY","INNER","INPUT","INSENSITIVE","INSERT","INT","INTEGER","INTEGER4","INTEGER1","INTEGER2","INTERSECT","INTERVAL","INTO","IS","ISOLATION","JOIN","KEY","LANGUAGE","LAST","LEADING","LEFT","LEVEL","LIKE","LOCAL","LOCK","LOGICAL","LOGICAL1","LONG","LONGBINARY","LONGTEXT","LOWER","MATCH","MAX","MEMO","MIN","MINUTE","MODULE","MONTH","MOD","MONEY","NAMES","NATIONAL","NATURAL","NCHAR","NEXT","NO","NOT","NULL","NULLIF","NUMBER","NUMERIC","OCTET_LENGTH","OF","OFF","OLEOBJECT","ON","ONLY","OPEN","OPTION","OR","ORDER","OUTER","OUTPUT","OWNERACCESS","OVERLAPS","PAD","PARTIAL","PARAMETERS","PERCENT","PIVOT","POSITION","PRECISION","PREPARE","PRESERVE","PRIMARY","PRIOR","PRIVILEGES","PROCEDURE","PUBLIC","READ","REAL","REFERENCES","RELATIVE","RESTRICT","REVOKE","RIGHT","ROLLBACK","ROWID","ROWS","SCHEMA","SCROLL","SECOND","SECTION","SELECT","SESSION","SESSION_USER","SET","SHORT","SINGLE","SIZE","SMALLINT","SOME","SPACE","SQL","SQLCODE","SQLERROR","SQLSTATE","STDEV","STDEVP","STRING","SUBTYPE","SUBSTRING","SUM","SYSTEM_USER","TABLE","TABLEID","TEMPORARY","TEXT","THEN","TIME","TIMESTAMP","TIMEZONE_HOUR","TIMEZONE_MINUTE","TO","TOP","TRAILING","TRANSACTION","TRANSFORM","TRANSLATE","TRANSLATION","TRIM","TRUE","TYPE","UNION","UNIQUE","UNKNOWN","UPDATE","UPPER","USAGE","USER","USING","VALUE","VALUES","VAR","VARCHAR","VARBINARY","VARP","VARYING","VIEW","WHEN","WHENEVER","WHERE","WITH","WORK","WRITE","XOR","YEAR","YESNO","ZONE"]}}]);