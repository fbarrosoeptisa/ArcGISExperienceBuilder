/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-830ce0.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-830ce0"],{729:(e,t,a)=>{a.r(t),a.d(t,{arcgis_smart_mapping_class_breaks_color_slider:()=>f,arcgis_smart_mapping_flow_color_slider:()=>b,arcgis_smart_mapping_hillshade_type_button:()=>S,arcgis_smart_mapping_panels_raster_class_breaks:()=>v,arcgis_smart_mapping_panels_raster_colormap:()=>C,arcgis_smart_mapping_panels_raster_flow:()=>y,arcgis_smart_mapping_panels_raster_rgb:()=>N,arcgis_smart_mapping_panels_raster_shaded_relief:()=>I,arcgis_smart_mapping_panels_raster_stretch:()=>T,arcgis_smart_mapping_panels_raster_unique_value:()=>F,arcgis_smart_mapping_panels_raster_vector_field:()=>V,arcgis_smart_mapping_vector_symbol_button:()=>P});var s=a(28614),i=(a(68180),a(99592)),n=a(98518),l=a(33101),r=a(84521),o=a(97127),c=a(48122),d=a(54351),h=a(14289),p=a(76110),u=a(39304),m=a(58325),g=a(76133);a(71480),a(99818),a(80216);const f=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingClassBreaksColorSliderChange=(0,s.c)(this,"arcgisSmartMappingClassBreaksColorSliderChange",7),this.arcgisSmartMappingClassBreaksColorSliderError=(0,s.c)(this,"arcgisSmartMappingClassBreaksColorSliderError",7),this.manager=(0,o.u)(this),this.styleSheetStatus="not-loaded",this.smartMappingState=(0,l.u)()}render(){const{config:e}=this.smartMappingState;return(0,s.h)(s.H,{key:"17611382a426d585ab54cac6767d472ba7fa87f2"},(0,s.h)("link",{key:"8a43380774cf89358bcef258e52dbd7bba43bae6",rel:"stylesheet",href:`${e.jsapiUrl}/themes/light/main.css`,onLoad:()=>{this.styleSheetStatus="loaded",(0,s.f)(this.el)},onError:()=>{this.styleSheetStatus="failed",(0,s.f)(this.el)}}),"loaded"===this.styleSheetStatus?this.renderClassBreaksColorSlider():"not-loaded"===this.styleSheetStatus?this.renderClassBreaksColorSliderLoading():null)}renderClassBreaksColorSlider(){const{smartMappingState:e}=this,{strings:t}=e;if(1===(0,i.j)(e).classBreakInfos.length)return this.classBreaksColorSlider&&(this.classBreaksColorSlider.destroy(),this.classBreaksColorSlider=void 0),(0,s.h)(s.F,null);return(this.prepareClassBreaksColorSlider()||this.classBreaksColorSlider)&&this.classBreaksColorSlider.min!==this.classBreaksColorSlider.max?(0,s.h)("div",{class:"slider-box"},(0,s.h)("calcite-label",null,t.panels.classBreaks.dataRange),(0,s.h)("div",{class:"slider-box-buttons-front"},this.renderInvertButton()),(0,s.h)("div",{ref:e=>{e&&this.afterClassBreaksColorSliderCreate(e)}})):this.classBreaksColorSlider&&this.classBreaksColorSlider.min===this.classBreaksColorSlider.max?(0,s.h)(s.F,null):this.renderClassBreaksColorSliderLoading()}renderInvertButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("arcgis-smart-mapping-action",{text:e.panels.classBreaks.invertSlider,icon:"arrowUpDown",onClick:()=>this.handleInvertSlider()})}renderClassBreaksColorSliderLoading(){const{strings:e}=this.smartMappingState;return(0,s.h)("div",{class:"slider-box"},(0,s.h)("calcite-loader",{label:e.loading}))}prepareClassBreaksColorSlider(){const{smartMappingState:e}=this,{modules:t}=e,a=(0,i.j)(e);let s,l;s=a.classBreakInfos[0].minValue,l=a.classBreakInfos[a.classBreakInfos.length-1].maxValue,({min:s,max:l}=(0,i.ag)({min:s,max:l}));const o=(0,r.g)(e),c={min:s,max:l,breaks:o,precision:(0,n.g)(o)};return this.classBreaksColorSlider?this.classBreaksColorSlider.set(c):(this.classBreaksColorSlider=new t.ClassedColorSlider(c),this.classBreaksColorSlider&&this.classBreaksColorSlider.min===this.classBreaksColorSlider.max&&this.classBreaksColorSlider.set(c),this.createclassBreaksColorSliderChangeEvents()),(0,i.M)(this.classBreaksColorSlider)}afterClassBreaksColorSliderCreate(e){if(this.classBreaksColorSlider.container)e.append(this.classBreaksColorSlider.container);else{const t=document.createElement("div");e.append(t),this.classBreaksColorSlider.container=t}}createclassBreaksColorSliderChangeEvents(){const{smartMappingState:e}=this;this.classBreaksColorSlider&&(this.classBreaksColorSlider.on("min-change",(t=>{const a=(0,i.j)(e).classBreakInfos;t.value>a[0].maxValue?this.handleMinMaxChange(a[0].maxValue,a[a.length-1].maxValue):this.handleMinMaxChange(t.value,a[a.length-1].maxValue)})),this.classBreaksColorSlider.on("max-change",(t=>{const a=(0,i.j)(e).classBreakInfos;t.value<a[a.length-1].minValue?this.handleMinMaxChange(a[0].minValue,a[a.length-1].minValue):this.handleMinMaxChange(a[0].minValue,t.value)})),this.classBreaksColorSlider.on("thumb-change",(()=>this.updateRendererBreaks(this.classBreaksColorSlider.breaks))),this.classBreaksColorSlider.on("thumb-drag",(()=>this.updateRendererBreaks(this.classBreaksColorSlider.breaks))))}handleInvertSlider(){const{smartMappingState:e}=this,{modules:t}=e,a=(0,i.j)(e);(0,i.B)();let s=a.classBreakInfos.map((a=>(0,i.Z)(e,a.symbol)||new t.EsriColor({r:64,g:64,b:64,a:1})));s=s.reverse(),a.classBreakInfos.forEach(((t,a)=>{(0,i.Z)(e,t.symbol)&&(0,i.X)(e,t.symbol,s[a])})),(0,i.u)(e),this.arcgisSmartMappingClassBreaksColorSliderChange.emit({invertColors:!0})}handleMinMaxChange(e,t){const{smartMappingState:a}=this,s=(0,i.j)(a),n=s.classBreakInfos[0],l=s.classBreakInfos[s.classBreakInfos.length-1];n.minValue=e,n.label=(0,i.at)(n,this.classBreaksColorSlider.precision),l.maxValue=t,l.label=(0,i.at)(l,this.classBreaksColorSlider.precision),(0,i.u)(a),this.arcgisSmartMappingClassBreaksColorSliderChange.emit({updateValues:!0})}updateRendererBreaks(e){const{smartMappingState:t}=this;(0,i.j)(t).classBreakInfos.forEach(((t,a)=>{t.minValue===e[a].min&&t.maxValue===e[a].max||(t.minValue=e[a].min,t.maxValue=e[a].max,t.label=(0,i.at)(t,this.classBreaksColorSlider.precision))})),(0,i.u)(t),this.arcgisSmartMappingClassBreaksColorSliderChange.emit({updateValues:!0})}get el(){return(0,s.g)(this)}};f.style=".slider-box {\n  height: 320px;\n\n  .esri-classed-color-slider {\n    min-width: 200px;\n  }\n\n  .esri-classed-color-slider .esri-slider .esri-slider__content {\n    height: 175px;\n  }\n\n  .esri-classed-color-slider .esri-slider .esri-slider__label,\n  .esri-classed-color-slider .esri-slider .esri-slider__min,\n  .esri-classed-color-slider .esri-slider .esri-slider__max {\n    text-decoration: underline;\n  }\n\n  .esri-classed-color-slider .esri-slider .esri-slider__label:hover,\n  .esri-classed-color-slider .esri-slider .esri-slider__min:hover,\n  .esri-classed-color-slider .esri-slider .esri-slider__max:hover {\n    border: 1px solid #bbb;\n    background-color: #f3f3f3;\n    text-decoration: none;\n    z-index: 1;\n  }\n}\n\n.slider-box-buttons-front {\n  display: flex;\n}\n";const b=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingFlowColorSliderChange=(0,s.c)(this,"arcgisSmartMappingFlowColorSliderChange",7),this.arcgisSmartMappingFlowColorSliderError=(0,s.c)(this,"arcgisSmartMappingFlowColorSliderError",7),this.manager=(0,o.u)(this),this.currentStopValues=[],this.styleSheetStatus="not-loaded",this.smartMappingState=(0,l.u)()}componentDidLoad(){this.flowItemNode=(0,c.f)(this.el,"calcite-flow-item")}render(){const{config:e}=this.smartMappingState;return(0,s.h)(s.H,{key:"d57941ec672b36ce2943b18f566476f46a59936c"},(0,s.h)("link",{key:"3615b50085fffb363f1cb0265a27b70f2c08c99e",rel:"stylesheet",href:`${e.jsapiUrl}/themes/light/main.css`,onLoad:()=>{this.styleSheetStatus="loaded",(0,s.f)(this.el)},onError:()=>{this.styleSheetStatus="failed",(0,s.f)(this.el)}}),"loaded"===this.styleSheetStatus?this.renderFlowColorSlider():"not-loaded"===this.styleSheetStatus?this.renderFlowColorSliderLoading():null)}renderFlowColorSlider(){const{smartMappingState:e}=this,{layer:t,strings:a}=e,n=t,l=(0,i.R)(e),r=(0,i.b)(l,"color");if(!r)return(0,s.h)(s.F,null);const{sourceJSON:o}=n;if(!o)return(0,s.h)(s.F,null);const{minValues:c,maxValues:d}=o,h=(0,i.G)(l,"color"),p=h?.minSliderValue??c?.[0],u=h?.maxSliderValue??d?.[0];if((0,i.M)(p)&&(0,i.M)(u)&&p!==u&&1!==r?.stops.length){const e=this.prepareFlowColorSlider();return r.stops.forEach(((e,t)=>{this.currentStopValues[t]=e.value})),(e||this.flowColorSlider)&&this.flowColorSlider.min!==this.flowColorSlider.max?(0,s.h)("div",{class:"slider-box"},(0,s.h)("calcite-label",null,a.panels.flow.dataRange),(0,s.h)("div",{class:"slider-box-buttons-front"},this.renderInvertButton(),(0,s.h)("div",null,"\xa0"),this.renderResetButton()),(0,s.h)("div",{ref:e=>{e&&this.afterFlowColorSliderCreate(e)}})):this.flowColorSlider&&this.flowColorSlider.min===this.flowColorSlider.max?(0,s.h)(s.F,null):this.renderFlowColorSliderLoading()}return this.flowColorSlider&&(this.flowColorSlider.destroy(),this.flowColorSlider=void 0),(0,s.h)(s.F,null)}renderFlowColorSliderLoading(){const{strings:e}=this.smartMappingState;return(0,s.h)("div",{class:"slider-box"},(0,s.h)("calcite-loader",{label:e.loading}))}renderInvertButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("arcgis-smart-mapping-action",{text:e.panels.flow.invertSlider,icon:"arrowUpDown",onClick:()=>this.handleInvertSlider()})}renderResetButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("arcgis-smart-mapping-action",{text:e.panels.flow.resetSlider,icon:"undo",onClick:()=>this.handleResetSlider()})}prepareFlowColorSlider(){const{smartMappingState:e}=this,{layer:t,modules:a}=e,s=t,l=(0,i.R)(e),r=(0,i.b)(l,"color"),{sourceJSON:o}=s,{minValues:c,maxValues:d}=o,h=(0,i.G)(l,"color"),p=h?.minSliderValue??c?.[0],u=h?.maxSliderValue??d?.[0],m=h?(0,i.au)(h.theme,r.stops):void 0;if(!this.flowColorSlider||!r&&this.flowColorSlider.stops){this.flowColorSlider?.destroy();let e={min:p,max:u};e={...e,...m},e.stops=r.stops,e.precision=(0,n.g)(r.stops),e.labelFormatFunction=t=>t.toFixed(e.precision),this.flowColorSlider=new a.ColorSlider(e),this.flowColorSlider&&this.flowColorSlider.min===this.flowColorSlider.max&&this.flowColorSlider.set(e),this.createFlowColorSliderChangeEvents()}else{if("dragging"===this.flowColorSlider.slider?.state)return!0;let e={min:p,max:u};e={...e,...m},e.stops=r.stops,e.precision=(0,n.g)(r.stops),this.flowColorSlider.set(e)}return(0,i.M)(this.flowColorSlider)}handleInvertSlider(){const{smartMappingState:e}=this,t=(0,i.R)(e),a=(0,i.b)(t,"color");(0,i.B)();let n=a.stops.map((e=>e.color));n=n.reverse(),a.stops.forEach(((e,t)=>{e.color=n[t]})),(0,i.Q)(e),(0,s.f)(this.el),this.arcgisSmartMappingFlowColorSliderChange.emit()}handleResetSlider(){const{smartMappingState:e}=this,t=(0,i.R)(e);(0,d.r)((0,h.b)(e,{includeColorVariable:!0}),this.flowItemNode).then((a=>{const n=(0,i.b)(t,"color"),l=(0,i.G)(t,"color"),r=(0,i.b)(a.renderer,"color"),o=(0,i.G)(a.renderer,"color");l.minSliderValue=o.minSliderValue,l.maxSliderValue=o.maxSliderValue,n.stops.forEach(((e,t)=>e.value=r.stops[t].value)),(0,i.Q)(e),(0,s.f)(this.el)}),(e=>this.arcgisSmartMappingFlowColorSliderError.emit(e)))}afterFlowColorSliderCreate(e){if(this.flowColorSlider.container)e.append(this.flowColorSlider.container);else{const t=document.createElement("div");e.append(t),this.flowColorSlider.container=t}}createFlowColorSliderChangeEvents(){this.flowColorSlider&&(this.flowColorSlider.on("min-change",(e=>{e.value>this.currentStopValues[0]?(this.flowColorSlider.stops.forEach(((e,t)=>{e.value=this.currentStopValues[t]})),this.handleMinMaxChange(this.currentStopValues[0],this.flowColorSlider.max)):this.handleMinMaxChange(e.value,this.flowColorSlider.max)})),this.flowColorSlider.on("max-change",(e=>{e.value<this.currentStopValues[this.currentStopValues.length-1]?(this.flowColorSlider.stops.forEach(((e,t)=>{e.value=this.currentStopValues[t]})),this.handleMinMaxChange(this.flowColorSlider.min,this.currentStopValues[this.currentStopValues.length-1])):this.handleMinMaxChange(this.flowColorSlider.min,e.value)})),this.flowColorSlider.on("thumb-change",(()=>this.updateRendererStops(this.flowColorSlider.stops))),this.flowColorSlider.on("thumb-drag",(()=>this.updateRendererStops(this.flowColorSlider.stops))),this.flowColorSlider.on("segment-drag",(()=>this.updateRendererStops(this.flowColorSlider.stops))))}handleMinMaxChange(e,t){const{smartMappingState:a}=this,n=(0,i.R)(a),l=(0,i.G)(n,"color")||{};l.minSliderValue=e,l.maxSliderValue=t,n.authoringInfo.classificationMethod="manual",(0,i.Q)(a),(0,s.f)(this.el),this.arcgisSmartMappingFlowColorSliderChange.emit()}updateRendererStops(e){const{smartMappingState:t}=this,a=(0,i.R)(t),s=(0,i.b)(a,"color");5===e.length&&e.forEach((e=>e.label="")),s.stops=e,s.stops.forEach(((e,t)=>{this.currentStopValues[t]=e.value})),(0,i.Q)(t),this.arcgisSmartMappingFlowColorSliderChange.emit()}get el(){return(0,s.g)(this)}};b.style=".slider-box {\n  height: 275px;\n\n  .esri-color-slider {\n    min-width: 200px;\n  }\n\n  .esri-color-slider .esri-slider .esri-slider__content {\n    height: 130px;\n  }\n\n  .esri-color-slider .esri-slider .esri-slider__label,\n  .esri-color-slider .esri-slider .esri-slider__min,\n  .esri-color-slider .esri-slider .esri-slider__max {\n    text-decoration: underline;\n  }\n  .esri-color-slider .esri-slider .esri-slider__label:hover,\n  .esri-color-slider .esri-slider .esri-slider__min:hover,\n  .esri-color-slider .esri-slider .esri-slider__max:hover {\n    border: 1px solid #bbb;\n    background-color: #f3f3f3;\n    text-decoration: none;\n    z-index: 1;\n  }\n}\n\n.slider-box-buttons-front {\n  display: flex;\n}\n";const S=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingHillshadeTypeButtonChange=(0,s.c)(this,"arcgisSmartMappingHillshadeTypeButtonChange",7),this.arcgisSmartMappingHillshadeTypeButtonBeforeOpen=(0,s.c)(this,"arcgisSmartMappingHillshadeTypeButtonBeforeOpen",7),this.manager=(0,o.u)(this),this.hillshadeTypeInfos=[],this.open=!1,this.smartMappingState=(0,l.u)()}async setFocus(){this.buttonNode?.focus()}componentWillLoad(){this.populateHillshadeTypeInfo(),this.setSelection()}componentWillUpdate(){const{smartMappingState:e}=this,t=(0,i.R)(e),{hillshadeType:a}=t;this.selectedHillshadeTypeInfo.value!==a&&this.setSelection()}render(){const{strings:e}=this.smartMappingState;return(0,s.h)(s.H,{key:"b750235ee5517ceeecbee1a282c6a0745497aed2"},(0,s.h)("calcite-label",{key:"441e3857c0b961ab70b0c5ad77e42fbb20b68039"},e.panels.shadedRelief.hillshadeType,(0,s.h)("div",{key:"b3d733152511b6a5835a797eeed523c58ecece9a",class:"hillshade-type-button",role:"button",tabindex:"0","aria-haspopup":"true","aria-label":e.panels.shadedRelief.hillshadeType,ref:e=>this.buttonNode=e,onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.openHillshadeTypeDropdown())},onClick:()=>this.openHillshadeTypeDropdown()},(0,s.h)("div",{key:"e54690debfa3bf1438c7db201a656eeb2585b7b2",class:"hillshade-type-content"},(0,s.h)("div",{key:"6faa17205267b531771242cd62a7bf7d0c0bef49",class:"hillshade-type-button-text"},(0,s.h)("div",{key:"74a0bdceb0330d3e980869bee7623a52698be191",class:"hillshade-type-button-title"},this.selectedHillshadeTypeInfo.title),(0,s.h)("div",{key:"528a3039e7fb92d73bde02101949708ba91f0ed3",class:"hillshade-type-button-msg"},this.selectedHillshadeTypeInfo.msg)),(0,s.h)("div",{key:"fbdd251e4d8d55ca989000cfee81d16665332372"},(0,s.h)("calcite-icon",{key:"d53351a9134009a22d343d8e4ca5e8d8f71bf01b",scale:"s",icon:"chevron-down"}))))))}populateHillshadeTypeInfo(){const{strings:e}=this.smartMappingState,t=e.panels.shadedRelief.hillshadeTypeOptions,a=e.panels.shadedRelief.hillshadeTypeOptionDescriptions;this.hillshadeTypeInfos.push({value:"traditional",title:t.traditional,msg:a.traditional,iconPath:void 0,selected:!1}),this.hillshadeTypeInfos.push({value:"multi-directional",title:t.multidirectional,msg:a.multidirectional,iconPath:void 0,selected:!1})}setSelection(){const{smartMappingState:e}=this,t=(0,i.R)(e);this.selectedHillshadeTypeInfo=this.hillshadeTypeInfos.find((e=>e.value===t.hillshadeType)),this.hillshadeTypeInfos.forEach((e=>{e.selected=e.value===this.selectedHillshadeTypeInfo.value}))}closeDropdown(){this.open=!1,this.dropdownNode&&(this.dropdownNode.parentNode?.removeChild(this.dropdownNode),this.dropdownNode=void 0,this.buttonNode.classList.remove("active"))}openHillshadeTypeDropdown(){const{smartMappingState:e}=this;if(this.open)this.open=!1;else{this.arcgisSmartMappingHillshadeTypeButtonBeforeOpen.emit();const t=document.createElement("arcgis-smart-mapping-dropdown");t.smartMappingState=e,t.buttonNode=this.buttonNode,t.infos=this.hillshadeTypeInfos,this.dropdownNode=t,t.addEventListener("arcgisSmartMappingDropdownClose",(e=>{this.closeDropdown(),"Escape"===e.detail&&this.setFocus()})),t.addEventListener("arcgisSmartMappingDropdownChange",(e=>this.setHillshadeType(e.detail))),this.buttonNode.classList.add("active"),document.body.appendChild(t),this.open=!0}}setHillshadeType(e){const{smartMappingState:t}=this,a=(0,i.R)(t),{hillshadeType:s}=a,n=e.value;if(n===s)return this.closeDropdown(),void setTimeout((()=>{this.setFocus()}),300);this.hillshadeTypeInfos.forEach((e=>{e.selected=e.value===n})),this.selectedHillshadeTypeInfo=e,this.arcgisSmartMappingHillshadeTypeButtonChange.emit(this.selectedHillshadeTypeInfo.value),this.closeDropdown(),setTimeout((()=>{this.setFocus()}),300)}get el(){return(0,s.g)(this)}};S.style=".hillshade-type-button{display:flex;padding:6px;justify-content:space-between;align-items:center;border-radius:0;cursor:pointer;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-1);border-color:var(--calcite-color-foreground-3);border-width:1px;border-style:solid;box-shadow:transparent 0px 0px 0px 1px inset}.hillshade-type-button:hover{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3)}.hillshade-type-button:active{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3)}.hillshade-type-button:focus{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3);outline:2px solid var(--calcite-color-brand);outline-offset:2px}.hillshade-type-button.active{outline:1px solid var(--calcite-ui-focus-color, var(--calcite-color-brand))}.hillshade-type-content{display:flex;align-items:center;justify-content:space-between;width:100%}.hillshade-type-button-text{display:inline-block;padding:0 10px}.hillshade-type-button-title{font-weight:bold}.hillshade-type-button-msg{font-size:80%;line-height:16px}";const v=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterClassBreaksClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterClassBreaksClose",7),this.arcgisSmartMappingPanelsRasterClassBreaksBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterClassBreaksBackClick",7),this.arcgisSmartMappingPanelsRasterClassBreaksError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterClassBreaksError",7),this.manager=(0,o.u)(this),this.symbolNodes=[],this.labelNodes=[],this.inputNodes=[],this.disconnected=!1,this.smartMappingState=(0,l.u)(),this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterClassBreaksClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e,smartMappingState:t}=this;(0,i.Q)(t,e),this.arcgisSmartMappingPanelsRasterClassBreaksClose.emit("cancel")},this.menuOpen=!1,this.showBackButton=!1,this.selected=!1,this.beforeBack=void 0}async setFocus(){await(this.flowItemNode?.setFocus())}componentWillLoad(){const{modules:e}=this.smartMappingState,t=(0,i.R)(this.smartMappingState);this.originalRendererObj=e.esriLang.clone((0,i.R)(this.smartMappingState)),this.defaultColorRamp=t.classBreakInfos.map((e=>e.symbol.color))}componentDidLoad(){requestAnimationFrame((async()=>await(this.flowItemNode?.setFocus())))}disconnectedCallback(){this.disconnected=!0,clearTimeout(this.definedIntervalChangeHandle),clearTimeout(this.classesChangeHandle)}render(){const{hideLayerTitle:e,layer:t,strings:a}=this.smartMappingState,n=t.title;return(0,s.h)(s.H,{key:"9e99747322e50294faa4008d5b545895f6a2cc54",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"d22c554ab5e67952c2114677f4dfd738fe7f2bd9",heading:a.panels.classBreaks.styleOptions,description:e?void 0:n,class:"flow-item",closable:(0,i.C)(this.el),showBackButton:this.showBackButton,selected:this.selected,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterClassBreaksBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-block",{class:"class-breaks-block",heading:e.panels.classBreaks.classBreaks,open:!0},this.renderFieldSelector(),this.renderMethod(),this.renderClasses(),this.renderDefinedInterval(),this.renderColorScheme(),this.renderColorSlider(),this.renderValues())}renderFieldSelector(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e).field||t.panels.classBreaks.value,n=(0,h.g)(e),l=n.map((e=>({label:e.alias,layerField:e,simpleFieldType:i.q.STRING}))),r=n.find((e=>e.name===a));return(0,s.h)("arcgis-smart-mapping-attribute-input",{label:t.panels.classBreaks.field,fieldList:l,selectedField:{field:r?.name??t.panels.classBreaks.value,simpleFieldType:i.q.STRING},mode:"simple",popoverReferenceElement:this.flowItemNode,onArcgisSmartMappingAttributeInputChange:e=>{if(e.detail){const t=e.detail.field;this.handleFieldChange(t)}}})}renderMethod(){const{smartMappingState:e}=this,t=(0,i.R)(e);return(0,s.h)("arcgis-smart-mapping-method-button",{key:t.authoringInfo.classificationMethod,showDefinedInterval:!0,onArcgisSmartMappingMethodButtonBeforeOpen:()=>(0,i.B)(),onArcgisSmartMappingMethodButtonChange:t=>{const a=(0,i.R)(e);if("manual"===t.detail){a.authoringInfo.classificationMethod="manual",(0,i.Q)(e),(0,s.f)(this.el),setTimeout((()=>{this.methodButtonNode.setFocus()}),300)}else{let i,n=a?.authoringInfo?.numClasses||a.classBreakInfos?.length;if("defined-interval"===t.detail){const e=a.classBreakInfos;i=(e[e.length-1].maxValue-e[0].minValue)/5,n=Math.ceil((a.classBreakInfos[n-1].maxValue-a.classBreakInfos[0].minValue)/i)}(0,d.r)((0,h.d)(e,{classificationMethod:t.detail,numClasses:n,definedInterval:i}),this.flowItemNode).then((e=>{this.updateRasterClassBreaksRenderer(e.renderer),(0,s.f)(this.el),setTimeout((()=>{this.methodButtonNode.setFocus()}),300)}),(e=>{(0,s.f)(this.methodButtonNode),this.arcgisSmartMappingPanelsRasterClassBreaksError.emit(e)}))}},ref:e=>{e&&(this.methodButtonNode=e)}})}renderClasses(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),n=a.classBreakInfos.length,l=a.authoringInfo.classificationMethod;return(0,s.h)("calcite-label",null,t.panels.classBreaks.classifyClasses,(0,s.h)("calcite-input-number",{value:`${n}`,disabled:"defined-interval"===l,inputMode:"decimal",min:1,max:10,step:1,scale:"s",onCalciteInputNumberInput:(0,m.d)((()=>{if(this.disconnected)return;clearTimeout(this.classesChangeHandle);const e=Number.parseInt(this.classesNode.value);e!==n&&(!e||e<this.classesNode.min||e>this.classesNode.max?this.classesChangeHandle=setTimeout((()=>this.handleClassesChange()),3e3):this.handleClassesChange())}),300),ref:e=>{e&&(this.classesNode=e)}}))}renderDefinedInterval(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e);if("defined-interval"!==a.authoringInfo.classificationMethod)return(0,s.h)(s.F,null);const n=a.classBreakInfos[0].maxValue-a.classBreakInfos[0].minValue,l=Math.floor((a.classBreakInfos[a.classBreakInfos.length-1].maxValue-a.classBreakInfos[0].minValue)/9.1),r=a.classBreakInfos[a.classBreakInfos.length-1].maxValue-a.classBreakInfos[0].minValue;return(0,s.h)("calcite-label",null,t.panels.classBreaks.definedInterval,(0,s.h)("calcite-input-number",{value:""+Math.round(100*n)/100,inputMode:"decimal",min:l,max:r,step:.1,scale:"s",onCalciteInputNumberInput:e=>{clearTimeout(this.definedIntervalChangeHandle);const t=e.target,a=Number.parseFloat(t.value);!t.value||a<t.min||a>t.max?this.definedIntervalChangeHandle=setTimeout((()=>this.handleDefinedIntervalChange()),3e3):this.handleDefinedIntervalChange()},ref:e=>this.definedIntervalNode=e}))}renderColorScheme(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e).classBreakInfos.map((t=>(0,i.Z)(e,t.symbol)));return(0,s.h)("arcgis-smart-mapping-symbol-button",{label:t.panels.classBreaks.colorScheme,type:"raster-class-breaks",rampType:"discrete",colors:a,onArcgisSmartMappingSymbolButtonSymbolChange:t=>{const a=t.target,n=(0,i.R)(e);this.defaultColorRamp=n.classBreakInfos.map((e=>e.symbol.color)),(0,i.Q)(e),(0,s.f)(this.el),(0,s.f)(this.sliderNode),(0,s.f)(a)},ref:e=>this.symbolButtonNode=e})}renderColorSlider(){const{smartMappingState:e}=this;return(0,s.h)("arcgis-smart-mapping-class-breaks-color-slider",{onArcgisSmartMappingClassBreaksColorSliderChange:t=>{const a=(0,i.R)(e),n=t.detail;n?.updateValues&&(a.authoringInfo.classificationMethod="manual"),n?.invertColors&&(0,s.f)(this.symbolButtonNode),(0,s.f)(this.el),(0,s.f)(this.sliderNode),this.defaultColorRamp=a.classBreakInfos.map((e=>e.symbol.color))},ref:e=>this.sliderNode=e})}renderValues(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e);return this.labelNodes=[],this.inputNodes=[],(0,s.h)("calcite-list",{label:t.panels.classBreaks.classBreaks},a.classBreakInfos.map(((e,t)=>this.renderValue(e,t))).reverse())}renderValue(e,t){return(0,s.h)("calcite-list-item",null,(0,s.h)("div",{class:"symbol-container",slot:"actions-start"},this.renderSymbolNode(e,t)),this.renderTextNode(e,t))}renderSymbolNode(e,t){const{smartMappingState:a}=this,{strings:n}=a,l=(0,i.R)(a).classBreakInfos[t].symbol.clone(),r={"symbol-is-white":(0,i.av)(a,l),symbol:!0};return(0,s.h)("div",{class:r,tabindex:"0","aria-label":n.panels.classBreaks.accessibility.editColorFor.replace("${value}",e.label),"aria-haspopup":"true",ref:e=>{e&&this.symbolNodes.unshift(e)},onClick:()=>{this.popoverNode?(this.symbolNodes[this.selectedPopoverIdx].classList.remove("selected"),this.selectedPopoverIdx===t?((0,i.B)(),this.popoverNode=void 0,this.selectedPopoverIdx=void 0):(this.selectedPopoverIdx=t,this.handleValueSymbolClick(t))):(this.selectedPopoverIdx=t,this.handleValueSymbolClick(t))},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleValueSymbolClick(t))}},(0,s.h)("div",{ref:e=>{e&&this.afterCreateValueSymbol(e,t)}}))}renderTextNode(e,t){const{strings:a}=this.smartMappingState;return(0,s.h)(s.F,null,(0,s.h)("div",{class:"label",slot:"content",tabindex:"0",ref:e=>{e&&this.labelNodes.unshift(e)},"aria-label":a.panels.classBreaks.accessibility.editLabelFor.replace("${value}",e.label),onClick:e=>{const a=this.inputNodes[t];a.classList.remove("hidden"),a.setFocus(),e.target.classList.add("hidden")},onKeyDown:e=>{if(" "===e.key||"Enter"===e.key){const a=this.inputNodes[t];a.classList.remove("hidden"),a.setFocus(),e.target.classList.add("hidden")}}},e.label),(0,s.h)("calcite-input",{slot:"content",class:"hidden",scale:"s",ref:e=>{e&&this.inputNodes.unshift(e)},value:e.label??void 0,onCalciteInputChange:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onFocusout:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onKeyDown:a=>{if(a.stopPropagation(),"Escape"===a.key||"Enter"===a.key){this.inputNodes[t].classList.add("hidden");const s=a.currentTarget;s.value=e.label||"",s.disabled=!0,this.handleValueTextChange(t,a),this.labelNodes[t].classList.remove("hidden"),s.disabled=!1,setTimeout((()=>this.labelNodes[t].focus()),300)}}}))}renderDoneButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handleFieldChange(e){const{smartMappingState:t}=this,a=(0,i.R)(t);(0,d.r)((0,h.d)(t,{field:e}),this.flowItemNode).then((e=>this.updateRasterClassBreaksRenderer(e.renderer)),(e=>{this.fieldNode.value=a.field,this.arcgisSmartMappingPanelsRasterClassBreaksError.emit(e)}))}handleDefinedIntervalChange(){const{smartMappingState:e}=this,t=(0,i.R)(e),a=t.classBreakInfos[0].maxValue-t.classBreakInfos[0].minValue;let s=Number.parseFloat(this.definedIntervalNode.value);s!==a&&(Number.isNaN(s)||s<this.definedIntervalNode.min?s=this.definedIntervalNode.min:s>this.definedIntervalNode.max&&(s=this.definedIntervalNode.max),s=Number.parseFloat(s.toFixed(2)),this.definedIntervalNode.value=`${s}`,(0,d.r)((0,h.d)(e,{definedInterval:s}),this.flowItemNode).then((e=>this.updateRasterClassBreaksRenderer(e.renderer)),(e=>{this.definedIntervalNode.value=`${a}`,this.arcgisSmartMappingPanelsRasterClassBreaksError.emit(e)})))}handleClassesChange(){(0,i.B)();const{smartMappingState:e}=this,t=(0,i.R)(e),a=t.classBreakInfos.length,{authoringInfo:s}=t||{};s.numClasses=this.classesNode.value?Number.parseInt(this.classesNode.value,10):0;const n=s.classificationMethod;"manual"===n&&(s.classificationMethod="equal-interval");const l=Math.min(Math.max(Number.parseInt(this.classesNode.value),1),10)||5;`${l}`!==this.classesNode.value&&(this.classesNode.value=`${l}`),(0,d.r)((0,h.d)(e,{numClasses:l}),this.flowItemNode).then((e=>{"manual"===n&&(e.renderer.authoringInfo.classificationMethod="manual"),this.updateRasterClassBreaksRenderer(e.renderer)}),(e=>{this.classesNode.value=`${a}`,this.arcgisSmartMappingPanelsRasterClassBreaksError.emit(e)}))}afterCreateValueSymbol(e,t){const{smartMappingState:a}=this,{modules:s}=a,n=(0,i.R)(a).classBreakInfos[t].symbol.clone();for(-1===t&&n.outline&&(n.outline.width=0),(0,i.av)(a,n)&&(n.outline=new s.SimpleLineSymbol({color:"#bdc3c7",width:.75}));e?.childNodes?.length;)e.removeChild(e.childNodes[0]);const{symbolUtils:l}=s;n&&l.renderPreviewHTML(n,{size:(0,i.aw)(n),ignoreWhiteSymbols:!0,symbolConfig:{isSquareFill:!0}}).then((t=>e?.appendChild(t)))}handleValueSymbolClick(e){(0,i.B)();const{smartMappingState:t}=this,{strings:a}=t,n=(0,u.c)(t,{referenceElement:this.flowItemNode,heading:a.panels.classBreaks.colorScheme});n.addEventListener("arcgisSmartMappingStylerPopoverClose",(()=>{(0,u.r)(n),setTimeout((()=>{this.symbolNodes[e].focus(),this.popoverNode=void 0,this.symbolNodes[e].classList.remove("selected")}),300)})),n.addEventListener("arcgisSmartMappingStylerPopoverDisconnected",(()=>{(0,u.r)(n),setTimeout((()=>{this.popoverNode=void 0,this.symbolNodes[e].classList.remove("selected")}),300)})),this.smartMappingState.classedSymbolSelectedIdx=e,(0,p.b)(t,{popoverNode:n,onChange:()=>{(0,i.Q)(t),(0,s.f)(this.el),(0,s.f)(this.sliderNode)}}),this.popoverNode=n,this.symbolNodes[e].classList.add("selected")}handleValueTextChange(e,t){const{smartMappingState:a}=this,n=(0,i.R)(a),l=t.currentTarget;if(n.classBreakInfos[e].label=l.value,""===l.value){const t=n.classBreakInfos[e];t.label=`${t.minValue.toLocaleString()} - ${t.maxValue.toLocaleString()}`,this.inputNodes[e].value=this.labelNodes[e].textContent}(0,i.Q)(a),(0,s.f)(this.el)}handleInversionStatus(e){const{smartMappingState:t}=this,{modules:a}=t;if(JSON.stringify(this.defaultColorRamp[0])!==JSON.stringify(e.classBreakInfos[0].symbol.color)){let s=e.classBreakInfos.map((e=>(0,i.Z)(t,e.symbol)||new a.EsriColor({r:64,g:64,b:64,a:1})));s=s.reverse(),e.classBreakInfos.forEach(((e,a)=>{(0,i.Z)(t,e.symbol)&&(0,i.X)(t,e.symbol,s[a])}))}else this.defaultColorRamp=e.classBreakInfos.map((e=>e.symbol.color))}updateRasterClassBreaksRenderer(e){const{smartMappingState:t}=this;this.handleInversionStatus(e),(0,i.Q)(t,e),(0,s.f)(this.el),(0,s.f)(this.sliderNode)}get el(){return(0,s.g)(this)}};v.style=":host{width:100%;display:none}:host([selected]){display:flex}.flow-item{height:100%}.class-breaks-block{overflow-x:hidden;overflow-wrap:anywhere}.hidden{display:none}.symbol{margin-left:2px;margin-right:2px}.label:focus,.symbol:focus{outline:2px solid var(--calcite-color-brand)}.label,.symbol-container{padding-top:5px;padding-bottom:5px}.selected{outline:1px solid var(--calcite-color-brand)}";const C=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterColormapClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterColormapClose",7),this.arcgisSmartMappingPanelsRasterColormapBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterColormapBackClick",7),this.manager=(0,o.u)(this),this.inputNodes=[],this.labelNodes=[],this.smartMappingState=(0,l.u)(),this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterColormapClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e,smartMappingState:t}=this;(0,i.Q)(t,e),this.arcgisSmartMappingPanelsRasterColormapClose.emit("cancel")},this.menuOpen=!1,this.showBackButton=!1,this.selected=!1,this.beforeBack=void 0}async setFocus(){await(this.flowItemNode?.setFocus())}componentWillLoad(){const{modules:e}=this.smartMappingState,t=(0,i.R)(this.smartMappingState);this.originalRendererObj=e.esriLang.clone((0,i.R)(this.smartMappingState)),t.colormapInfos.forEach(((e,a)=>{e.label||(t.colormapInfos[a].label=" ")})),(0,i.Q)(this.smartMappingState)}componentDidLoad(){requestAnimationFrame((async()=>await(this.flowItemNode?.setFocus())))}render(){const{hideLayerTitle:e,layer:t,strings:a}=this.smartMappingState,n=t.title;return(0,s.h)(s.H,{key:"b24c0f52b8415a6697963e2479138f7423d64c0f",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"9af6d54b436284203ac96231d96807d7915460df",heading:a.panels.colormap.styleOptions,description:e?void 0:n,class:"flow-item",closable:(0,i.C)(this.el),showBackButton:this.showBackButton,selected:this.selected,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterColormapBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-block",{class:"colormap-block",heading:e.panels.colormap.colormap,open:!0},this.renderColormapTable())}renderColormapTable(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e);this.labelNodes=[],this.inputNodes=[];const n=a.colormapInfos.map(((e,t)=>this.renderColormapRow(e,t)));return(0,s.h)("calcite-table",{class:"table",caption:t.panels.colormap.colormapTable},(0,s.h)("calcite-table-row",{slot:"table-header"},(0,s.h)("calcite-table-header",{heading:t.panels.colormap.color,alignment:"center"}),(0,s.h)("calcite-table-header",{heading:t.panels.colormap.value,alignment:"center"}),(0,s.h)("calcite-table-header",{heading:t.panels.colormap.label,alignment:"center"})),n)}renderColormapRow(e,t){return(0,s.h)("calcite-table-row",null,(0,s.h)("calcite-table-cell",{alignment:"center"},this.renderColorNode(e)),(0,s.h)("calcite-table-cell",{alignment:"center"},e.value),(0,s.h)("calcite-table-cell",{alignment:"center",class:"label-cell"},this.renderLabelNode(e,t)))}renderColorNode(e){return(0,s.h)("div",{class:"color",ref:t=>{t&&this.afterCreateColor(t,e)}})}renderLabelNode(e,t){const{strings:a}=this.smartMappingState;return(0,s.h)(s.F,null,(0,s.h)("div",{class:"label",tabindex:"0",ref:e=>{e&&(this.labelNodes[t]=e)},"aria-label":a.panels.classBreaks.accessibility.editLabelFor.replace("${value}",e.label),onClick:e=>{const a=this.inputNodes[t];a.classList.remove("hidden"),a.setFocus(),e.target.classList.add("hidden")},onKeyDown:e=>{if(" "===e.key||"Enter"===e.key){const a=this.inputNodes[t];a.classList.remove("hidden"),a.setFocus(),e.target.classList.add("hidden")}}},e.label),(0,s.h)("calcite-input",{class:"hidden",ref:e=>{e&&(this.inputNodes[t]=e)},value:e.label??void 0,onCalciteInputChange:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onFocusout:e=>{this.inputNodes[t].classList.add("hidden"),this.labelNodes[t].classList.remove("hidden"),this.handleValueTextChange(t,e)},onKeyDown:a=>{if("Escape"===a.key||"Enter"===a.key){this.inputNodes[t].classList.add("hidden");const s=a.currentTarget;s.value=e.label||"",s.disabled=!0,this.handleValueTextChange(t,a),this.labelNodes[t].classList.remove("hidden"),s.disabled=!1,setTimeout((()=>this.labelNodes[t].focus()),300)}}}))}renderDoneButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}afterCreateColor(e,t){const{modules:a}=this.smartMappingState;for(;e?.childNodes?.length;)e.removeChild(e.childNodes[0]);const{symbolUtils:s}=a,i=s.renderColorRampPreviewHTML([t.color.clone()],{gradient:!1,width:20,height:20});i.classList.add("colorblock"),e.appendChild(i)}handleValueTextChange(e,t){const{smartMappingState:a}=this,n=(0,i.R)(a),l=t.currentTarget;""===l.value?this.inputNodes[e].value=this.labelNodes[e].textContent:n.colormapInfos[e].label=l.value,(0,i.Q)(a),(0,s.f)(this.el)}get el(){return(0,s.g)(this)}};C.style=":host{width:100%;display:none}:host([selected]){display:flex}.flow-item{height:100%}.colormap-block{overflow-x:hidden}.table{width:100%}.color{display:flex;justify-content:center}.colorblock{border:1px solid #000}.hidden{display:none}.label{padding-top:5px;padding-bottom:5px}.label:focus{outline:2px solid var(--calcite-color-brand)}.label-cell{overflow-wrap:anywhere}";const y=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterFlowClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterFlowClose",7),this.arcgisSmartMappingPanelsRasterFlowBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterFlowBackClick",7),this.arcgisSmartMappingPanelsRasterFlowError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterFlowError",7),this.manager=(0,o.u)(this),this.smartMappingState=(0,l.u)(),this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterFlowClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e,originalEffect:t,smartMappingState:a}=this,{layer:s}=a;s.effect=t,(0,i.Q)(a,e),this.arcgisSmartMappingPanelsRasterFlowClose.emit("cancel")},this.menuOpen=!1,this.showBackButton=!1,this.selected=!1,this.beforeBack=void 0}async setFocus(){await(this.flowItemNode?.setFocus())}componentWillLoad(){const{layer:e}=this.smartMappingState,t=e;this.originalRendererObj=(0,i.R)(this.smartMappingState),this.originalEffect=t.effect??void 0}componentDidLoad(){requestAnimationFrame((async()=>await(this.flowItemNode?.setFocus())))}render(){const{hideLayerTitle:e,layer:t,strings:a}=this.smartMappingState,n=t.title;return(0,s.h)(s.H,{key:"61e6d9694ee20253e8d07eb4fcf0e4708fcc4ab2",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"1a69a01b90194a3b8e7f47ad4b44d5f9e1c98955",heading:a.panels.flow.styleOptions,description:e?void 0:n,class:"flow-item",closable:(0,i.C)(this.el),showBackButton:this.showBackButton,selected:this.selected,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterFlowBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-block",{class:"flow-block",heading:e.panels.flow.flowStyle,open:!0},this.renderMode(),this.renderSpeed(),this.renderDensity(),this.renderLength(),this.renderWidth(),this.renderColor(),this.renderColorSlider(),this.renderDirection(),this.renderRoundCaps(),this.renderShowInLegend(),this.renderEffects())}renderMode(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),n=a.authoringInfo,l=n?.flowTheme?"wave-front"===n?.flowTheme:a.trailLength<1;return(0,s.h)("div",{class:"block-content-padding-large"},(0,s.h)("calcite-chip",{value:"flowline",label:t.panels.flow.flowline,appearance:l?"outline-fill":"solid",kind:l?"neutral":"brand",class:l?"mode-hover":"",scale:"s",onClick:()=>this.handleModeChange("flowline")},t.panels.flow.flowline),(0,s.h)("span",null,"\xa0"),(0,s.h)("calcite-chip",{value:"wavefront",label:t.panels.flow.wavefront,appearance:l?"solid":"outline-fill",kind:l?"brand":"neutral",class:l?"":"mode-hover",scale:"s",onClick:()=>this.handleModeChange("wavefront")},t.panels.flow.wavefront))}renderSpeed(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),n="wave-front"===a.authoringInfo.flowTheme,{flowSpeed:l}=a;return(0,s.h)("calcite-label",null,t.panels.flow.speed,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"flow",type:"speed",min:0,max:n?20:40,values:[l],precision:1,minLabel:t.panels.flow.slow,maxLabel:t.panels.flow.fast}))}renderDensity(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),{density:n}=a;return(0,s.h)("calcite-label",null,t.panels.flow.density,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"flow",type:"density",min:.1,max:1,values:[n],precision:1,minLabel:t.panels.flow.low,maxLabel:t.panels.flow.high}))}renderLength(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),n="wave-front"===a.authoringInfo.flowTheme,{trailLength:l}=a;return(0,s.h)("calcite-label",null,t.panels.flow.length,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"flow",type:"trail-length",min:n?.1:1,max:n?50:200,values:[l/.75],precision:n?1:0,minLabel:t.panels.flow.short,maxLabel:t.panels.flow.long}))}renderWidth(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),n="wave-front"===a.authoringInfo.flowTheme,{trailWidth:l}=a,r=Math.round(l/.75*10)/10;return(0,s.h)("div",{class:"block-content-padding-large"},(0,s.h)("calcite-label",null,t.panels.flow.width),(0,s.h)("arcgis-smart-mapping-slider-input",{min:n?Math.min(5,Math.floor(r)):.1,max:n?Math.max(12,Math.ceil(r)):Math.max(5,Math.ceil(r)),values:[r],precision:1,suffixText:t.panels.flow.px,onArcgisSmartMappingSliderInputChange:t=>{const a=(0,i.R)(e),s=t.detail,{trailWidth:n}=a;s!==Math.round(n/.75*10)/10&&(a.trailWidth=.75*s,(0,i.Q)(e))}}))}renderColor(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),n=(0,i.b)(a,"color");return(0,s.h)("calcite-radio-button-group",{class:"block-content-padding",name:"colorType",onCalciteRadioButtonGroupChange:e=>this.handleColorTypeChange(e.target.selectedItem.value)},(0,s.h)("div",{class:"color-wrapper"},(0,s.h)("div",null,(0,s.h)("calcite-label",{layout:"inline"},(0,s.h)("calcite-radio-button",{checked:!n,value:"singleColor",ref:e=>this.singleColorNode=e}),t.panels.flow.singleColor),!n&&this.renderSingleColor()),(0,s.h)("div",null,(0,s.h)("calcite-label",{layout:"inline"},(0,s.h)("calcite-radio-button",{checked:!!n,value:"colorRamp",ref:e=>this.colorRampNode=e}),t.panels.flow.colorRamp),n&&this.renderColorRamp())))}renderSingleColor(){const{smartMappingState:e}=this,t=(0,i.R)(e),{color:a}=t,n=(0,i.am)(e);return n.color=a,n.outline.color=a,(0,s.h)("div",{class:"symbol-button-padding"},(0,s.h)("arcgis-smart-mapping-symbol-button",{symbol:n,hideLabel:!0,type:"raster-flow",rampType:"continuous",onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,i.Q)(e),(0,s.f)(this.el)}}))}renderColorRamp(){const{smartMappingState:e}=this,t=(0,i.R)(e),a=(0,i.b)(t,"color");if(!a)return(0,s.h)(s.F,null);const n=a.stops.map((e=>{const t=e.color.clone();return t.a=1,t}));return(0,s.h)("div",{class:"symbol-button-padding"},(0,s.h)("arcgis-smart-mapping-symbol-button",{colors:n,hideLabel:!0,type:"raster-flow",rampType:"continuous",ref:e=>{e&&(this.symbolButtonNode=e)},onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,i.Q)(e),(0,s.f)(this.el),this.flowColorSliderNode&&(0,s.f)(this.flowColorSliderNode)}}))}renderColorSlider(){const{smartMappingState:e}=this,t=(0,i.R)(e);return(0,i.b)(t,"color")?(0,s.h)("arcgis-smart-mapping-flow-color-slider",{ref:e=>{e&&(this.flowColorSliderNode=e)},onArcgisSmartMappingFlowColorSliderChange:()=>{(0,s.f)(this.el),this.symbolButtonNode&&(0,s.f)(this.symbolButtonNode)},onArcgisSmartMappingFlowColorSliderError:e=>this.arcgisSmartMappingPanelsRasterFlowError.emit(e.detail)}):(0,s.h)(s.F,null)}renderDirection(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),{flowRepresentation:n}=a;return(0,s.h)("calcite-label",{layout:"inline-space-between",class:"block-content-padding"},t.panels.flow.flowDirection,(0,s.h)("calcite-segmented-control",{layout:"horizontal",appearance:"solid",onCalciteSegmentedControlChange:e=>this.handleDirectionChange(e.target.selectedItem.value)},(0,s.h)("calcite-segmented-control-item",{value:"to",checked:"flow-from"!==n},t.panels.flow.to),(0,s.h)("calcite-segmented-control-item",{value:"from",checked:"flow-from"===n},t.panels.flow.from)))}renderRoundCaps(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),{trailWidth:n,authoringInfo:l}=a,r="flow-line"===l.flowTheme,o="round"===a.trailCap,c=Math.round(1e3*n)/1e3>3;return(0,s.h)("div",{class:"toggles block-content-padding"},(0,s.h)("calcite-label",{class:"toggle-text",layout:"inline-space-between"},t.panels.flow.roundEndCaps,(0,s.h)("calcite-switch",{ref:e=>{e&&(this.roundCapToggleNode=e)},disabled:!c,scale:"s",checked:o,onCalciteSwitchChange:()=>this.handleRoundCapsToggle()})),r?(0,s.h)("div",{class:"hint-text "+(c?"":"disabled")},t.panels.flow.forWideLines):null)}renderShowInLegend(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),n=(0,i.b)(a,"color");if(!n)return(0,s.h)(s.F,null);const l=n.legendOptions,r=!l||!1!==l.showLegend;return(0,s.h)("calcite-label",{layout:"inline-space-between",class:"toggle-text toggles block-content-padding"},t.panels.flow.includeInLegend,(0,s.h)("calcite-switch",{scale:"s",checked:r,onCalciteSwitchChange:()=>this.handleIncludeInLegendToggle()}))}renderEffects(){const{layer:e,strings:t}=this.smartMappingState,a=e;return(0,s.h)("div",{class:"toggles block-content-padding"},(0,s.h)("calcite-label",{class:"toggle-text",layout:"inline-space-between"},t.panels.flow.layerEffects,(0,s.h)("calcite-switch",{scale:"s",checked:!!a.effect,onCalciteSwitchChange:()=>this.handleEffectToggle()})),(0,s.h)("div",{class:"hint-text"},t.panels.flow.adjustEffects))}renderDoneButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handleModeChange(e){const{smartMappingState:t}=this,a=(0,i.R)(t).authoringInfo,n="wave-front"===a.flowTheme,l="wave-front"===a.flowTheme?"flow-line":"wave-front";(!n&&"wavefront"===e||n&&"flowline"===e)&&((0,i.B)(),(0,d.r)((0,h.e)(t,{flowTheme:l}),this.flowItemNode).then((e=>{(0,i.Q)(t,e.renderer),this.roundCapToggleNode.checked=!1,(0,s.f)(this.el)}),(e=>this.arcgisSmartMappingPanelsRasterFlowError.emit(e))))}handleColorTypeChange(e){(0,i.B)();const{smartMappingState:t}=this,a={includeColorVariable:"colorRamp"===e};"colorRamp"!==e?this.lastFlowTheme=(0,h.f)(t):this.lastFlowTheme&&(a.flowScheme=this.lastFlowTheme),(0,d.r)((0,h.e)(t,a),this.flowItemNode).then((e=>{(0,i.Q)(t,e.renderer),(0,s.f)(this.el)}),(e=>{this.singleColorNode.checked?(this.singleColorNode.checked=!1,this.colorRampNode.checked=!0):(this.colorRampNode.checked=!1,this.singleColorNode.checked=!0),this.arcgisSmartMappingPanelsRasterFlowError.emit(e)}))}handleDirectionChange(e){const{smartMappingState:t}=this;(0,i.R)(t).flowRepresentation="from"===e?"flow-from":"flow-to",(0,i.Q)(t)}handleRoundCapsToggle(){const{smartMappingState:e}=this,t=(0,i.R)(e);t.trailCap="round"===t.trailCap?"butt":"round",(0,i.Q)(e)}handleIncludeInLegendToggle(){const{smartMappingState:e}=this,t=(0,i.R)(e),a=(0,i.b)(t,"color"),s=a.legendOptions;s&&!1===s.showLegend?s.title?s.showLegend=!0:a.legendOptions=void 0:(a.legendOptions=s||{},a.legendOptions.showLegend=!1),(0,i.Q)(e)}handleEffectToggle(){const{smartMappingState:e}=this,{layer:t}=e,a=t,s=(0,i.R)(e);if(a.effect)a.effect=void 0;else{const t=s.authoringInfo;(0,h.b)(e,{flowTheme:t.flowTheme}).then((t=>{a.effect=t.layerEffect,(0,i.Q)(e)}),(e=>this.arcgisSmartMappingPanelsRasterFlowError.emit(e)))}}get el(){return(0,s.g)(this)}};var w;y.style=":host{width:100%;display:none}:host([selected]){display:flex}.flow-item{height:100%}.flow-block{overflow-x:hidden}.block-content-padding{padding-bottom:10px}.block-content-padding-large{padding-bottom:20px}.color-wrapper{display:flex;flex-direction:column;width:100%}.symbol-button-padding{padding-bottom:12px}.mode-hover{cursor:pointer}.toggles{padding-top:10px}.toggle-text{width:100%}.hint-text{font-size:smaller;margin-top:-8px}.hint-text.disabled{opacity:0.5}",function(e){e[e.ALL=-1]="ALL",e[e.RED=0]="RED",e[e.GREEN=1]="GREEN",e[e.BLUE=2]="BLUE"}(w||(w={}));const N=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterRgbClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterRgbClose",7),this.arcgisSmartMappingPanelsRasterRgbBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterRgbBackClick",7),this.arcgisSmartMappingPanelsRasterRgbError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterRgbError",7),this.manager=(0,o.u)(this),this.disconnected=!1,this.smartMappingState=(0,l.u)(),this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterRgbClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e,originalEffect:t,originalBandCombination:a,smartMappingState:s}=this,{layer:n}=s,l=n;l.effect=t,l.bandIds=a,(0,i.Q)(s,e),this.arcgisSmartMappingPanelsRasterRgbClose.emit("cancel")},this.menuOpen=!1,this.showBackButton=!1,this.selected=!1,this.beforeBack=void 0}async setFocus(){await(this.flowItemNode?.setFocus())}async componentWillLoad(){const{layer:e,rasterInfo:t,modules:a}=this.smartMappingState,s=e,{statistics:n}=t;s.bandIds?.length||(s.bandIds=await(0,i.ax)(this.smartMappingState)),this.originalRendererObj=a.esriLang.clone((0,i.R)(this.smartMappingState)),this.originalEffect=s.effect??void 0,this.originalBandCombination=s.bandIds,this.originalStatistics=a.esriLang.clone(n),this.currentStatistics=[];for(let e=0;e<t.bandCount;e++)if(s.bandIds.includes(e)){const t=s.bandIds.indexOf(e);let i;this.originalRendererObj?.customStatistics?.[t]&&(i=a.esriLang.clone(this.originalRendererObj.customStatistics[t])),i?this.currentStatistics.push(i):this.originalStatistics?.[e]?this.currentStatistics.push(a.esriLang.clone(this.originalStatistics[e])):this.currentStatistics.push({min:0,max:255,avg:0,stddev:1})}else this.originalStatistics?.[e]?this.currentStatistics.push(a.esriLang.clone(this.originalStatistics[e])):this.currentStatistics.push({min:0,max:255,avg:0,stddev:1});this.rendererStatisticsSelection=s.bandIds[0],this.setGammaDisplay(),this.percentLabelFlip=(0,i.ay)(this.smartMappingState,this.el)}componentDidLoad(){const e=(0,i.R)(this.smartMappingState),{stretchType:t=i.aB.STRETCH_TYPE}=e||{},a=t===i.aA.PERCENT_CLIP,s=t===i.aA.NONE,{dynamicRangeAdjustment:n}=e;!n&&!(s||a)&&e.customStatistics?.[0]&&this.updateStatisticsDisplay(e.customStatistics[0]),requestAnimationFrame((async()=>await(this.flowItemNode?.setFocus())))}disconnectedCallback(){this.disconnected=!0,this.clearHandles()}render(){const{hideLayerTitle:e,layer:t,strings:a}=this.smartMappingState,n=t.title;return(0,s.h)(s.H,{key:"68cd1efec81df144388896dc881f64370bc6c0ff",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"de26e5470718668471ab84568997d754d4768a61",heading:a.panels.rgb.styleOptions,description:e?void 0:n,class:"flow-item",closable:(0,i.C)(this.el),showBackButton:this.showBackButton,selected:this.selected,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterRgbBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-block",{class:"rgb-block",heading:e.panels.rgb.rgb,open:!0},this.renderRgbBandSelectors(),this.renderStretchTypeSelector(),this.renderStandardDeviationSection(),this.renderPercentClipSection(),this.renderGammaBlock(),this.renderIndividualGammaToggle(),this.renderRangeAdjustmentToggle(),this.renderStatistics())}renderRgbBandSelectors(){const{smartMappingState:e}=this,{layer:t,rasterInfo:a,strings:n}=e,l=t,{bandInfos:r}=a,o=r.map((e=>e.name)),{red:c,green:d,blue:h}=n.panels.rgb,p=[c,d,h].map(((t,a)=>(0,s.h)("calcite-label",null,t,(0,s.h)("calcite-combobox",{overlayPositioning:"fixed",label:t,clearDisabled:!0,selectionMode:"single-persist",onCalciteComboboxChange:s=>{const n=s.target,r=(0,i.R)(e),c=[...l.bandIds];c[a]=o.indexOf(n.value),l.bandIds=c;const d=l.bandIds[a],h=this.currentStatistics?.[l.bandIds[a]];r.customStatistics?.length&&h&&(r.customStatistics[a]={...h}),this.statisticsControlNode&&t!==this.statisticsControlNode.value||(this.rendererStatisticsSelection=d,this.updateStatisticsDisplay({...h})),(0,i.Q)(e)}},o.map(((e,t)=>this.renderBandOptions(e,t,a)))))));return(0,s.h)(s.F,null,p)}renderBandOptions(e,t,a){const{layer:i}=this.smartMappingState,n=i.bandIds[a];return(0,s.h)("calcite-combobox-item",{textLabel:e,value:e,selected:n===t})}renderStretchTypeSelector(){const{smartMappingState:e}=this,{layer:t}=e,a=t;return(0,s.h)("arcgis-smart-mapping-stretch-type-button",{onArcgisSmartMappingStretchTypeButtonBeforeOpen:()=>(0,i.B)(),onArcgisSmartMappingStretchTypeButtonChange:t=>{const n=t.target;(0,d.r)((0,i.az)(e,{stretchType:t.detail}),this.flowItemNode).then((l=>{"none"===t.detail&&(l.renderer.dynamicRangeAdjustment=!1),this.rendererStatisticsSelection=a.bandIds[0],(0,i.Q)(e,l.renderer),(0,s.f)(this.el),(0,s.f)(n)}),(e=>this.arcgisSmartMappingPanelsRasterRgbError.emit(e)))}})}renderStandardDeviationSection(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),{stretchType:n=i.aB.STRETCH_TYPE}=a||{};if(!(n===i.aA.STANDARD_DEVIATION))return(0,s.h)(s.F,null);let{numberOfStandardDeviations:l}=a||{};return(0,i.M)(l)&&0!==l||(l=i.aB.STD_DEV),(0,s.h)("calcite-label",null,t.panels.rgb.stddev,(0,s.h)("calcite-input-number",{label:t.panels.rgb.stddev,scale:"s",inputMode:"decimal",min:1,max:100,step:.1,value:`${l}`,onCalciteInputNumberInput:e=>{clearTimeout(this.stddevHandle);const t=e.target,a=Number.parseFloat(t.value);t.value&&a>=t.min&&a<=t.max?this.handlePercentOrStddevChange(t,"stddev"):this.stddevHandle=setTimeout((()=>this.handlePercentOrStddevChange(t,"stddev")),3e3)}}))}renderPercentClipSection(){const{smartMappingState:e}=this,t=(0,i.R)(e),{stretchType:a=i.aB.STRETCH_TYPE}=t||{};if(!(a===i.aA.PERCENT_CLIP))return(0,s.h)(s.F,null);let{minPercent:n,maxPercent:l}=t||{};return(!(0,i.M)(n)||n<=0||n>=100)&&(n=i.aB.MIN_PERCENT),(!(0,i.M)(l)||l<=0||l>=100)&&(l=i.aB.MAX_PERCENT),n=Number.parseFloat(n.toFixed(1)),l=Number.parseFloat(l.toFixed(1)),t.minPercent=n,t.maxPercent=l,(0,i.Q)(e),(0,s.h)("div",{class:"percent-clip-section"},this.renderPercentClipSectionInput("min",n),this.renderPercentClipSectionInput("max",l))}renderPercentClipSectionInput(e,t){const{percentLabelFlip:a,smartMappingState:i}=this,{strings:n}=i;return(0,s.h)("div",{class:"percent-clip-section-input"},(0,s.h)("calcite-label",null,n.panels.rgb[e],(0,s.h)("calcite-input-number",{label:n.panels.rgb[e],scale:"s",inputMode:"decimal",min:.1,max:99.9,step:.1,prefixText:a?"%":void 0,suffixText:a?void 0:"%",value:`${t}`,onCalciteInputNumberInput:t=>{clearTimeout(this.percentClipHandle);const a=t.target,s=Number.parseFloat(a.value);a.value&&s>=a.min&&s<=a.max?this.handlePercentOrStddevChange(a,e):this.percentClipHandle=setTimeout((()=>this.handlePercentOrStddevChange(a,e)),3e3)}})))}renderIndividualGammaToggle(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-label",{layout:"inline-space-between",class:"individual-gamma-label"},e.panels.rgb.individualGamma,(0,s.h)("calcite-switch",{scale:"s",checked:this.changeIndividualGamma,onCalciteSwitchChange:e=>this.handleGammaToggle(e)}))}renderGammaBlock(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),{gamma:n=[i.aB.GAMMA]}=a||{},l=a.gamma[0],r=n[w.RED]??l,o=n[w.GREEN]??l,c=n[w.BLUE]??l;return(0,s.h)("calcite-label",null,t.panels.rgb.gamma,this.changeIndividualGamma?(0,s.h)("div",{class:"individual-gamma-selection"},this.renderIndividualGamma(r,"red"),this.renderIndividualGamma(o,"green"),this.renderIndividualGamma(c,"blue")):(0,s.h)("arcgis-smart-mapping-gamma-slider",{gamma:n[0],rendererType:"raster-rgb"}))}renderIndividualGamma(e,t){const{strings:a}=this.smartMappingState;return(0,s.h)("div",{class:"individual-gamma-selection-value"},(0,s.h)("calcite-label",null,a.panels.rgb[t],(0,s.h)("calcite-input-number",{label:a.panels.rgb[t],numberButtonType:"none",scale:"s",value:`${e}`,inputMode:"decimal",min:.1,max:10,step:.1,onCalciteInputNumberInput:e=>{clearTimeout(this.individualGammaHandle);const a=e.target,s=Number.parseFloat(a.value);a.value&&s>=a.min&&s<=a.max?this.handleIndividualGammaChange(a,t):this.individualGammaHandle=setTimeout((()=>this.handleIndividualGammaChange(a,t)),3e3)}})))}renderRangeAdjustmentToggle(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),{dynamicRangeAdjustment:n}=a,{stretchType:l=i.aB.STRETCH_TYPE}=a||{};return l===i.aA.NONE?(0,s.h)(s.F,null):(0,s.h)("calcite-label",{layout:"inline-space-between",class:"range-adjustment-label"},t.panels.rgb.dynamicRangeAdjustment,(0,s.h)("calcite-switch",{scale:"s",checked:n,onCalciteSwitchChange:e=>{const t=e.target.checked;this.handleDRAToggle(t),(0,s.f)(this.el)}}))}renderStatistics(){const{smartMappingState:e}=this,{layer:t,strings:a}=e,n=t,l=(0,i.R)(e),{stretchType:r=i.aB.STRETCH_TYPE}=l||{},o=r===i.aA.PERCENT_CLIP,c=r===i.aA.NONE,{dynamicRangeAdjustment:d}=l;return!d&&!(c||o)?(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,a.panels.rgb.statistics,(0,s.h)("calcite-segmented-control",{scale:"s",width:"full",onCalciteSegmentedControlChange:e=>{const t=e.target.value,s=t===a.panels.rgb.red?n.bandIds[0]:t===a.panels.rgb.green?n.bandIds[1]:n.bandIds[2],i=this.currentStatistics[s];this.rendererStatisticsSelection=s,this.updateStatisticsDisplay(i)},ref:e=>this.statisticsControlNode=e},(0,s.h)("calcite-segmented-control-item",{value:a.panels.rgb.red,checked:this.rendererStatisticsSelection===n.bandIds[0]},a.panels.rgb.red),(0,s.h)("calcite-segmented-control-item",{value:a.panels.rgb.green,checked:this.rendererStatisticsSelection===n.bandIds[1]&&this.rendererStatisticsSelection!==n.bandIds[0]},a.panels.rgb.green),(0,s.h)("calcite-segmented-control-item",{value:a.panels.rgb.blue,checked:this.rendererStatisticsSelection===n.bandIds[2]&&this.rendererStatisticsSelection!==n.bandIds[0]&&this.rendererStatisticsSelection!==n.bandIds[1]},a.panels.rgb.blue))),this.renderStatisticsDisplay()):(0,s.h)(s.F,null)}renderStatisticsDisplay(){const{smartMappingState:e}=this,{layer:t,rasterInfo:a,strings:n}=e,l=t,r=(0,i.R)(e),{stretchType:o=i.aB.STRETCH_TYPE}=r||{},c=o===i.aA.PERCENT_CLIP,d=o===i.aA.STANDARD_DEVIATION,h=null!==a.statistics,p=this.rendererStatisticsSelection??0,u=(!h||c)&&!d,{min:g=0,max:f=255,avg:b=0,stddev:S=1}=this.currentStatistics[p??0]??{};return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,n.panels.rgb.min,(0,s.h)("calcite-input-number",{label:n.panels.rgb.min,scale:"s",inputMode:"decimal",step:.1,numberButtonType:"none",value:`${(0,i.M)(g)?this.round(g):0}`,onCalciteInputNumberInput:(0,m.d)((()=>{if(this.disconnected)return;clearTimeout(this.minStatisticHandle);const e=Number.parseFloat(this.minNode.value),t=(l.bandIds??[])?.indexOf(this.rendererStatisticsSelection)??0;!Number.isNaN(e)&&e<=this.currentStatistics[t].max?(this.minNode.value=`${e}`,this.handleStatisticsChange(e,t,"min")):this.minStatisticHandle=setTimeout((()=>{const e=this.currentStatistics[t].min;this.minNode.value=`${this.round(e)}`}),3e3)}),300),ref:e=>{e&&(this.minNode=e)}})),(0,s.h)("calcite-label",null,n.panels.rgb.max,(0,s.h)("calcite-input-number",{label:n.panels.rgb.max,scale:"s",inputMode:"decimal",step:.1,numberButtonType:"none",value:`${(0,i.M)(f)?this.round(f):1}`,onCalciteInputNumberInput:(0,m.d)((()=>{if(this.disconnected)return;clearTimeout(this.maxStatisticHandle);const e=Number.parseFloat(this.maxNode.value),t=(l.bandIds??[])?.indexOf(this.rendererStatisticsSelection)??0;!Number.isNaN(e)&&e>=this.currentStatistics[t].min?(this.maxNode.value=`${e}`,this.handleStatisticsChange(e,t,"max")):this.maxStatisticHandle=setTimeout((()=>{const e=this.currentStatistics[t].max;this.maxNode.value=`${this.round(e)}`}),3e3)}),300),ref:e=>{e&&(this.maxNode=e)}})),(0,s.h)("calcite-label",null,n.panels.rgb.mean,(0,s.h)("calcite-input-number",{label:n.panels.rgb.mean,scale:"s",inputMode:"decimal",step:.1,disabled:u,numberButtonType:"none",value:`${(0,i.M)(b)?this.round(b):2}`,onCalciteInputNumberInput:(0,m.d)((()=>{if(this.disconnected)return;clearTimeout(this.avgStatisticHandle);const e=Number.parseFloat(this.avgNode.value),t=(l.bandIds??[])?.indexOf(this.rendererStatisticsSelection)??0;Number.isNaN(e)?this.avgStatisticHandle=setTimeout((()=>{const e=this.currentStatistics[t].avg;this.avgNode.value=`${this.round(e)}`}),3e3):(this.avgNode.value=`${e}`,this.handleStatisticsChange(e,t,"avg"))}),300),ref:e=>{e&&(this.avgNode=e)}})),(0,s.h)("calcite-label",null,n.panels.rgb.stddev,(0,s.h)("calcite-input-number",{label:n.panels.rgb.stddev,scale:"s",inputMode:"decimal",step:.1,disabled:u,numberButtonType:"none",value:`${(0,i.M)(S)?this.round(S):3}`,onCalciteInputNumberInput:(0,m.d)((()=>{if(this.disconnected)return;clearTimeout(this.stddevStatisticHandle);const e=Number.parseFloat(this.stddevNode.value),t=(l.bandIds??[])?.indexOf(this.rendererStatisticsSelection)??0;Number.isNaN(e)?this.stddevStatisticHandle=setTimeout((()=>{const e=this.currentStatistics[t].stddev;this.stddevNode.value=`${this.round(e)}`}),3e3):(this.stddevNode.value=`${e}`,this.handleStatisticsChange(e,t,"stddev"))}),300),ref:e=>{e&&(this.stddevNode=e)}})))}renderDoneButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}setGammaDisplay(){const{smartMappingState:e}=this,t=(0,i.R)(e),{gamma:a=[i.aB.GAMMA]}=t||{},s=t.gamma[0],n=a[w.RED]??s,l=a[w.GREEN]??s,r=a[w.BLUE]??s;this.changeIndividualGamma=n!==l||n!==r||l!==r}handlePercentOrStddevChange(e,t){const{smartMappingState:a}=this,s=(0,i.R)(a);let n=Number.parseFloat(e.value);Number.isNaN(n)||n<e.min?n=e.min:n>e.max&&(n=e.max),n=Number.parseFloat(n.toFixed(1)),e.value=`${n}`,"min"===t?s.minPercent=n:"max"===t?s.maxPercent=n:s.numberOfStandardDeviations=n,(0,i.Q)(a)}handleGammaToggle(e){const{smartMappingState:t}=this,a=(0,i.R)(t);this.changeIndividualGamma=!this.changeIndividualGamma;e.target.checked||(a.gamma=new Array(3).fill(a.gamma[0]),a.useGamma=!0),(0,i.Q)(t),(0,s.f)(this.el)}handleIndividualGammaChange(e,t){const{smartMappingState:a}=this,s=(0,i.R)(a);let n=Number.parseFloat(e.value);Number.isNaN(n)||n<e.min?n=e.min:n>e.max&&(n=e.max),n=Number.parseFloat(n.toFixed(1)),e.value=`${n}`,"red"===t?s.gamma[w.RED]=n:"green"===t?s.gamma[w.GREEN]=n:s.gamma[w.BLUE]=n,s.useGamma=!0,(0,i.Q)(a)}handleDRAToggle(e){const{smartMappingState:t}=this,{layer:a}=t,s=a,n=(0,i.R)(t);if(n.dynamicRangeAdjustment=e,e)n.customStatistics=[];else{const e=this.originalStatistics?.length?s.bandIds.map((e=>{const{min:t,max:a,avg:s,stddev:i}=this.originalStatistics[e];return[t,a,s,i]})):[],t=s.bandIds.map((e=>{const t=this.currentStatistics[e];return{min:t.min??0,max:t.max??255,avg:t.avg??0,stddev:t.stddev??1}}));n.customStatistics=JSON.stringify(t)===JSON.stringify(e)?[]:t}(0,i.Q)(t)}handleStatisticsChange(e,t,a){const{smartMappingState:s}=this,{layer:n}=s,l=n,r=(0,i.R)(s),o=l.bandIds[t];this.currentStatistics[o][a]=e,r.customStatistics=l.bandIds.map((e=>{const t=this.currentStatistics[e];return{min:t.min??0,max:t.max??255,avg:t.avg??0,stddev:t.stddev??1}})),(0,i.Q)(s)}updateStatisticsDisplay(e){const{min:t=0,max:a=255,avg:s=0,stddev:n=1}=e??{};this.minNode&&(this.minNode.value=`${(0,i.M)(t)?this.round(t):0}`,this.maxNode.value=`${(0,i.M)(a)?this.round(a):255}`,this.avgNode.value=`${(0,i.M)(s)?this.round(s):0}`,this.stddevNode.value=`${(0,i.M)(n)?this.round(n):1}`)}round(e){return Math.round(1e3*e)/1e3}clearHandles(){clearTimeout(this.stddevHandle),clearTimeout(this.percentClipHandle),clearTimeout(this.individualGammaHandle),clearTimeout(this.minStatisticHandle),clearTimeout(this.maxStatisticHandle),clearTimeout(this.avgStatisticHandle),clearTimeout(this.stddevStatisticHandle)}get el(){return(0,s.g)(this)}};N.style=":host{width:100%;display:none}:host([selected]){display:flex}.flow-item{height:100%}.rgb-block{overflow-x:hidden}.percent-clip-section{display:flex;justify-content:space-between}.percent-clip-section-input{width:48%;display:flex;flex-flow:column;justify-content:space-between}.individual-gamma-label,.range-adjustment-label{font-weight:var(--calcite-font-weight-medium)}.individual-gamma-selection{display:flex;justify-content:space-between}.individual-gamma-selection-value{display:flex;flex-flow:column;justify-content:space-between;width:30%}";const M="traditional",k="multi-directional",x="none",R={azimuth:315,altitude:45,pixelSizePower:.664,pixelSizeFactor:.024,zFactor:1},I=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterShadedReliefClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterShadedReliefClose",7),this.arcgisSmartMappingPanelsRasterShadedReliefBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterShadedReliefBackClick",7),this.arcgisSmartMappingPanelsRasterShadedReliefError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterShadedReliefError",7),this.manager=(0,o.u)(this),this.handles=[],this.smartMappingState=(0,l.u)(),this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterShadedReliefClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e,smartMappingState:t}=this;(0,i.Q)(t,e),this.arcgisSmartMappingPanelsRasterShadedReliefClose.emit("cancel")},this.menuOpen=!1,this.showBackButton=!1,this.selected=!1,this.beforeBack=void 0}async setFocus(){await(this.flowItemNode?.setFocus())}componentWillLoad(){const{modules:e}=this.smartMappingState;this.originalRendererObj=e.esriLang.clone((0,i.R)(this.smartMappingState))}componentDidLoad(){requestAnimationFrame((async()=>await(this.flowItemNode?.setFocus())))}disconnectedCallback(){this.handles.forEach((e=>clearTimeout(e)))}render(){const{hideLayerTitle:e,layer:t,strings:a}=this.smartMappingState,n=t.title;return(0,s.h)(s.H,{key:"ee7ed224e2f7fb2a973e6915fab00bab2c35b195",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"4f5340034524ac5b5ec2491631048b1ada1437e8",heading:a.panels.shadedRelief.styleOptions,description:e?void 0:n,class:"flow-item",closable:(0,i.C)(this.el),showBackButton:this.showBackButton,selected:this.selected,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterShadedReliefBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-block",{class:"shaded-relief-block",heading:e.panels.shadedRelief.shadedRelief,open:!0},this.renderHillshadeTypeSelector(),this.renderColorScheme(),this.renderAzimuthSlider(),this.renderAltitudeSlider(),this.renderScalingSelector(),this.renderZFactorAndPixelInputs())}renderHillshadeTypeSelector(){const{smartMappingState:e}=this;return(0,s.h)("arcgis-smart-mapping-hillshade-type-button",{onArcgisSmartMappingHillshadeTypeButtonBeforeOpen:()=>(0,i.B)(),onArcgisSmartMappingHillshadeTypeButtonChange:t=>{const a=t.target,n=t.detail;(0,i.R)(e).hillshadeType=n,(0,i.Q)(e),(0,s.f)(this.el),(0,s.f)(a)}})}renderColorScheme(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),{colorRamp:n}=a||{},l=(0,i.aC)(e,n);return(0,s.h)("arcgis-smart-mapping-symbol-button",{label:t.panels.shadedRelief.colorScheme,type:"raster-shaded-relief",rampType:"continuous",colors:l,onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,i.Q)(e),(0,s.f)(this.el)}})}renderAzimuthSlider(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),{hillshadeType:n=k,azimuth:l=R.azimuth}=a||{};return n===M?(0,s.h)("calcite-label",null,t.panels.shadedRelief.azimuth,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"shaded-relief",showThumbLabel:!0,editThumbLabel:!0,type:"azimuth",min:0,max:360,values:[l],precision:1,minLabel:"0",maxLabel:"360"})):(0,s.h)(s.F,null)}renderAltitudeSlider(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),{hillshadeType:n=k,altitude:l=R.altitude}=a||{};return n===M?(0,s.h)("calcite-label",null,t.panels.shadedRelief.altitude,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"shaded-relief",showThumbLabel:!0,editThumbLabel:!0,type:"altitude",min:0,max:90,values:[l],precision:1,minLabel:"0",maxLabel:"90"})):(0,s.h)(s.F,null)}renderScalingSelector(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),{scalingType:n=x}=a||{},l=t.panels.shadedRelief.scalingOptions;return(0,s.h)("calcite-label",null,t.panels.shadedRelief.scaling,(0,s.h)("calcite-segmented-control",{scale:"s",width:"full",onCalciteSegmentedControlChange:e=>{const t=e.target;this.handleScalingOptionChange(t.value)}},(0,s.h)("calcite-segmented-control-item",{value:"none",checked:"none"===n},l.none),(0,s.h)("calcite-segmented-control-item",{value:"adjusted",checked:"adjusted"===n},l.adjusted)))}renderZFactorAndPixelInputs(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),{scalingType:n=x}=a||{},l=["zFactor"];return"adjusted"===n&&(l.push("pixelSizePower"),l.push("pixelSizeFactor")),(0,s.h)(s.F,null,l.map(((e,i)=>(0,s.h)("calcite-label",null,t.panels.shadedRelief[e],(0,s.h)("calcite-input-number",{label:t.panels.shadedRelief[e],inputMode:"decimal",min:0,step:.1,scale:"s",value:`${a[e]??R[e]}`,onCalciteInputNumberInput:t=>{const a=t.target;""===a.value||Number.parseFloat(a.value)<0?this.handles[i]=setTimeout((()=>this.handleZFactorOrPixelChange(a,e)),3e3):(clearTimeout(this.handles[i]),setTimeout((()=>this.handleZFactorOrPixelChange(a,e)),300))}})))))}renderDoneButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handleScalingOptionChange(e){const{smartMappingState:t}=this;(0,i.R)(t).scalingType=e,(0,i.Q)(t),(0,s.f)(this.el)}handleZFactorOrPixelChange(e,t){const{smartMappingState:a}=this,s=(0,i.R)(a);let n=Number.parseFloat(e.value);(Number.isNaN(n)||n<e.min)&&(n=e.min),e.value=`${n}`,s[t]=n,(0,i.Q)(a)}get el(){return(0,s.g)(this)}};I.style=":host{width:100%;display:none}:host([selected]){display:flex}.flow-item{height:100%}.shaded-relief-block{overflow-x:hidden}";const B={min:0,max:255,avg:0,stddev:1},T=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterStretchClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterStretchClose",7),this.arcgisSmartMappingPanelsRasterStretchBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterStretchBackClick",7),this.arcgisSmartMappingPanelsRasterStretchError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterStretchError",7),this.manager=(0,o.u)(this),this.disconnected=!1,this.smartMappingState=(0,l.u)(),this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterStretchClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e,originalEffect:t,originalBandCombination:a,smartMappingState:s}=this,{layer:n}=s,l=n;l.effect=t,l.bandIds=a,(0,i.Q)(s,e),this.arcgisSmartMappingPanelsRasterStretchClose.emit("cancel")},this.menuOpen=!1,this.showBackButton=!1,this.selected=!1,this.beforeBack=void 0}async setFocus(){await(this.flowItemNode?.setFocus())}componentWillLoad(){const{layer:e,rasterInfo:t,modules:a}=this.smartMappingState,s=e,{statistics:n}=t;this.originalRendererObj=a.esriLang.clone((0,i.R)(this.smartMappingState)),this.originalEffect=s.effect??void 0,this.originalBandCombination=s.bandIds??void 0,this.originalStatistics=a.esriLang.clone(n),1!==s.bandIds?.length&&(s.bandIds=[0]),this.currentStatistics=[];for(let e=0;e<t.bandCount;e++)if(e===s.bandIds[0]){let t;this.originalRendererObj?.customStatistics?.[0]&&(t=a.esriLang.clone(this.originalRendererObj?.customStatistics?.[0])),t?this.currentStatistics.push(t):this.originalStatistics?.[e]?this.currentStatistics.push(a.esriLang.clone(this.originalStatistics[e])):this.currentStatistics.push({min:0,max:255,avg:0,stddev:1})}else this.originalStatistics?.[e]?this.currentStatistics.push(a.esriLang.clone(this.originalStatistics[e])):this.currentStatistics.push({min:0,max:255,avg:0,stddev:1})}componentDidLoad(){requestAnimationFrame((async()=>await(this.flowItemNode?.setFocus())))}disconnectedCallback(){this.disconnected=!0,this.clearHandles()}render(){const{hideLayerTitle:e,layer:t,strings:a}=this.smartMappingState,n=t.title;return(0,s.h)(s.H,{key:"77885ebb4f992c5f981ff70ab958a672ee90cd3e",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"e808c6fbc59470298f5a016cf8de59a213661858",heading:a.panels.stretch.styleOptions,description:e?void 0:n,class:"flow-item",closable:(0,i.C)(this.el),showBackButton:this.showBackButton,selected:this.selected,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterStretchBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-block",{class:"stretch-block",heading:e.panels.stretch.stretch,open:!0},this.renderStretchTypeSelector(),this.renderStandardDeviationSection(),this.renderPercentClipSection(),this.renderBandSelector(),this.renderGammaSlider(),this.renderColorScheme(),this.renderRangeAdjustmentToggle(),this.renderStatisticsTable())}renderStretchTypeSelector(){const{smartMappingState:e}=this,{layer:t}=e,a=t;return(0,s.h)("arcgis-smart-mapping-stretch-type-button",{onArcgisSmartMappingStretchTypeButtonBeforeOpen:()=>(0,i.B)(),onArcgisSmartMappingStretchTypeButtonChange:t=>{const n=t.target,l=t.detail;(0,d.r)((0,i.aD)(e,{stretchType:l}),this.flowItemNode).then((t=>{const r=a.bandIds[0]??i.aF.BAND_INDEX;(0,i.M)(this.currentStatistics)&&(t.renderer.customStatistics=[this.currentStatistics[r]]),"none"===l&&(t.renderer.dynamicRangeAdjustment=!1,t.renderer.colorRamp=void 0),(0,i.Q)(e,t.renderer),(0,s.f)(this.el),(0,s.f)(n)}),(e=>{(0,s.f)(n),this.arcgisSmartMappingPanelsRasterStretchError.emit(e)}))}})}renderStandardDeviationSection(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),{stretchType:n=i.aF.STRETCH_TYPE}=a||{};if(!(n===i.aE.STANDARD_DEVIATION))return(0,s.h)(s.F,null);let{numberOfStandardDeviations:l}=a||{};return(0,i.M)(l)&&0!==l||(l=i.aF.STD_DEV),(0,s.h)("calcite-label",null,t.panels.stretch.stddev,(0,s.h)("calcite-input-number",{label:t.panels.stretch.stddev,scale:"s",inputMode:"decimal",min:1,max:100,step:.1,value:`${l}`,onCalciteInputNumberInput:e=>{clearTimeout(this.stddevHandle);const t=e.target,a=Number.parseFloat(t.value);t.value&&a>=t.min&&a<=t.max?this.handlePercentOrStddevChange(t,"stddev"):this.stddevHandle=setTimeout((()=>this.handlePercentOrStddevChange(t,"stddev")),3e3)}}))}renderPercentClipSection(){const{smartMappingState:e}=this,t=(0,i.R)(e),{stretchType:a=i.aF.STRETCH_TYPE}=t||{};if(!(a===i.aE.PERCENT_CLIP))return(0,s.h)(s.F,null);let{minPercent:n,maxPercent:l}=t||{};return(!(0,i.M)(n)||n<=0||n>=100)&&(n=i.aF.MIN_PERCENT),(!(0,i.M)(l)||l<=0||l>=100)&&(l=i.aF.MAX_PERCENT),n=Number.parseFloat(n.toFixed(1)),l=Number.parseFloat(l.toFixed(1)),t.minPercent=n,t.maxPercent=l,(0,i.Q)(e),(0,s.h)("div",{class:"percent-clip-section"},this.renderPercentClipSectionInput("min",n),this.renderPercentClipSectionInput("max",l))}renderPercentClipSectionInput(e,t){const{strings:a}=this.smartMappingState;return(0,s.h)("div",{class:"percent-clip-section-input"},(0,s.h)("calcite-label",null,a.panels.stretch[e],(0,s.h)("calcite-input-number",{label:a.panels.stretch[e],scale:"s",inputMode:"decimal",min:.1,max:99.9,step:.1,suffixText:"%",value:`${t}`,onCalciteInputNumberInput:t=>{clearTimeout(this.percentClipHandle);const a=t.target,s=Number.parseFloat(a.value);a.value&&s>=a.min&&s<=a.max?this.handlePercentOrStddevChange(a,e):this.percentClipHandle=setTimeout((()=>this.handlePercentOrStddevChange(a,e)),3e3)}})))}renderBandSelector(){const{smartMappingState:e}=this,{layer:t,rasterInfo:a,strings:n}=e,l=t,{bandCount:r}=a;if(!(r>1))return(0,s.h)(s.F,null);const{bandInfos:o}=a,c=o.map((e=>e.name));return(0,s.h)("calcite-label",null,n.panels.stretch.band,(0,s.h)("calcite-combobox",{overlayPositioning:"fixed",label:n.panels.stretch.band,clearDisabled:!0,selectionMode:"single-persist",onCalciteComboboxChange:t=>{const a=t.target,n=(0,i.R)(e);l.bandIds=[c.indexOf(a.value)];const r=l.bandIds[0]??i.aF.BAND_INDEX;n.customStatistics=[this.currentStatistics[r]??B];const{min:o=0,max:d=255,avg:h=0,stddev:p=1}=n.customStatistics[0],{stretchType:u=i.aF.STRETCH_TYPE}=n||{},m=u===i.aE.PERCENT_CLIP,g=u===i.aE.NONE,{dynamicRangeAdjustment:f}=n;!f&&!(g||m)&&(this.minNode.value=`${(0,i.M)(o)?this.round(o):0}`,this.maxNode.value=`${(0,i.M)(d)?this.round(d):255}`,this.avgNode.value=`${(0,i.M)(h)?this.round(h):0}`,this.stddevNode.value=`${(0,i.M)(p)?this.round(p):1}`),(0,i.Q)(e),(0,s.f)(this.el)}},c.map(((e,t)=>this.renderBandOptions(e,t)))))}renderBandOptions(e,t){const{smartMappingState:a}=this,{layer:n}=a,l=n.bandIds[0]??i.aF.BAND_INDEX;return(0,s.h)("calcite-combobox-item",{textLabel:e,value:e,selected:l===t})}renderGammaSlider(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e);let{gamma:n=[i.aF.GAMMA]}=a||{};(0,i.M)(n)||(n=[i.aF.GAMMA]);const{stretchType:l=i.aF.STRETCH_TYPE}=a||{};return l===i.aE.NONE?(0,s.h)(s.F,null):(0,s.h)("calcite-label",null,t.panels.stretch.gamma,(0,s.h)("arcgis-smart-mapping-gamma-slider",{gamma:n[0],rendererType:"raster-stretch"}))}renderColorScheme(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),{stretchType:n=i.aF.STRETCH_TYPE}=a||{};if(n===i.aE.NONE)return(0,s.h)(s.F,null);const{colorRamp:l}=a||{},r=(0,i.aC)(e,l);return(0,s.h)("arcgis-smart-mapping-symbol-button",{label:t.panels.stretch.colorScheme,type:"raster-stretch",rampType:"continuous",colors:r,onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,i.Q)(e),(0,s.f)(this.el)}})}renderRangeAdjustmentToggle(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),{dynamicRangeAdjustment:n}=a,{stretchType:l=i.aF.STRETCH_TYPE}=a||{};return l===i.aE.NONE?(0,s.h)(s.F,null):(0,s.h)("calcite-label",{layout:"inline-space-between",class:"range-adjustment-label"},t.panels.stretch.dynamicRangeAdjustment,(0,s.h)("calcite-switch",{scale:"s",checked:n,onCalciteSwitchChange:e=>{const t=e.target.checked;this.handleDRAToggle(t),(0,s.f)(this.el)}}))}renderStatisticsTable(){const{originalStatistics:e,smartMappingState:t}=this,{layer:a,rasterInfo:n,modules:l,strings:r}=t,o=a,c=(0,i.R)(t),{stretchType:d=i.aF.STRETCH_TYPE}=c||{},h=d===i.aE.PERCENT_CLIP,p=d===i.aE.NONE,u=d===i.aE.STANDARD_DEVIATION,{dynamicRangeAdjustment:g}=c;if(!(!g&&!(p||h)))return(0,s.h)(s.F,null);const f=null!==n.statistics;let{customStatistics:b}=c||{};(!b||b.length<1)&&(b=l.esriLang.clone(e));const S=o.bandIds[0]??i.aF.BAND_INDEX,v=(!f||h)&&!u,{min:C=0,max:y=255,avg:w=0,stddev:N=1}=b[0]||{};return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,r.panels.stretch.statistics),(0,s.h)("calcite-label",null,r.panels.stretch.min,(0,s.h)("calcite-input-number",{label:r.panels.stretch.min,scale:"s",inputMode:"decimal",step:.1,numberButtonType:"none",value:`${(0,i.M)(C)?this.round(C):0}`,onCalciteInputNumberInput:(0,m.d)((()=>{if(this.disconnected)return;clearTimeout(this.minStatisticHandle);const e=Number.parseFloat(this.minNode.value);!Number.isNaN(e)&&e<=this.currentStatistics[S].max?(this.minNode.value=`${e}`,this.handleStatisticsChange(e,S,"min")):this.minStatisticHandle=setTimeout((()=>{const e=this.round(this.currentStatistics[S].min);this.minNode.value=`${e}`}),3e3)}),300),ref:e=>this.minNode=e})),(0,s.h)("calcite-label",null,r.panels.stretch.max,(0,s.h)("calcite-input-number",{label:r.panels.stretch.max,scale:"s",inputMode:"decimal",step:.1,numberButtonType:"none",value:`${(0,i.M)(y)?this.round(y):255}`,onCalciteInputNumberInput:(0,m.d)((()=>{if(this.disconnected)return;clearTimeout(this.maxStatisticHandle);const e=Number.parseFloat(this.maxNode.value);!Number.isNaN(e)&&e>=this.currentStatistics[S].min?(this.maxNode.value=`${e}`,this.handleStatisticsChange(e,S,"max")):this.maxStatisticHandle=setTimeout((()=>{const e=this.round(this.currentStatistics[S].max);this.maxNode.value=`${e}`}),3e3)}),300),ref:e=>this.maxNode=e})),(0,s.h)("calcite-label",null,r.panels.stretch.mean,(0,s.h)("calcite-input-number",{label:r.panels.stretch.mean,scale:"s",inputMode:"decimal",step:.1,disabled:v,numberButtonType:"none",value:`${(0,i.M)(w)?this.round(w):0}`,onCalciteInputNumberInput:(0,m.d)((()=>{if(this.disconnected)return;clearTimeout(this.avgStatisticHandle);const e=Number.parseFloat(this.avgNode.value);Number.isNaN(e)?this.avgStatisticHandle=setTimeout((()=>{const e=this.round(this.currentStatistics[S].avg);this.avgNode.value=`${e}`}),3e3):(this.avgNode.value=`${e}`,this.handleStatisticsChange(e,S,"avg"))}),300),ref:e=>this.avgNode=e})),(0,s.h)("calcite-label",null,r.panels.stretch.stddev,(0,s.h)("calcite-input-number",{label:r.panels.stretch.stddev,scale:"s",inputMode:"decimal",step:.1,disabled:v,numberButtonType:"none",value:`${(0,i.M)(N)?this.round(N):1}`,onCalciteInputNumberInput:(0,m.d)((()=>{if(this.disconnected)return;clearTimeout(this.stddevStatisticHandle);const e=Number.parseFloat(this.stddevNode.value);Number.isNaN(e)?this.stddevStatisticHandle=setTimeout((()=>{const e=this.round(this.currentStatistics[S].stddev);this.stddevNode.value=`${e}`}),3e3):(this.stddevNode.value=`${e}`,this.handleStatisticsChange(e,S,"stddev"))}),300),ref:e=>this.stddevNode=e})))}renderDoneButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handlePercentOrStddevChange(e,t){const{smartMappingState:a}=this,s=(0,i.R)(a);let n=Number.parseFloat(e.value);Number.isNaN(n)||n<e.min?n=e.min:n>e.max&&(n=e.max),n=Number.parseFloat(n.toFixed(1)),e.value=`${n}`,"min"===t?s.minPercent=n:"max"===t?s.maxPercent=n:s.numberOfStandardDeviations=n,(0,i.Q)(a)}handleDRAToggle(e){const{smartMappingState:t}=this,{layer:a}=t,s=a,n=(0,i.R)(t),l=s.bandIds[0]??i.aF.BAND_INDEX;n.dynamicRangeAdjustment=e,n.customStatistics=e?[]:[this.currentStatistics[l]],(0,i.Q)(t)}handleStatisticsChange(e,t,a){const{smartMappingState:s}=this,n=(0,i.R)(s);this.currentStatistics[t][a]=e,n.customStatistics=[this.currentStatistics[t]],(0,i.Q)(s)}round(e){return Math.round(1e3*e)/1e3}clearHandles(){clearTimeout(this.stddevHandle),clearTimeout(this.percentClipHandle),clearTimeout(this.minStatisticHandle),clearTimeout(this.maxStatisticHandle),clearTimeout(this.avgStatisticHandle),clearTimeout(this.stddevStatisticHandle)}get el(){return(0,s.g)(this)}};T.style=":host{width:100%;display:none}:host([selected]){display:flex}.flow-item{height:100%}.stretch-block{overflow-x:hidden}.percent-clip-section{display:flex;justify-content:space-between}.percent-clip-section-input{width:48%;display:flex;flex-flow:column;justify-content:space-between}.range-adjustment-label{font-weight:var(--calcite-font-weight-medium)}";const F=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterUniqueValueClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterUniqueValueClose",7),this.arcgisSmartMappingPanelsRasterUniqueValueBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterUniqueValueBackClick",7),this.arcgisSmartMappingPanelsRasterUniqueValueError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterUniqueValueError",7),this.manager=(0,o.u)(this),this.inputNodes=[],this.labelNodes=[],this.colorNodes=[],this.smartMappingState=(0,l.u)(),this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterUniqueValueClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e,smartMappingState:t}=this;(0,i.Q)(t,e),this.arcgisSmartMappingPanelsRasterUniqueValueClose.emit("cancel")},this.menuOpen=!1,this.showBackButton=!1,this.selected=!1,this.beforeBack=void 0}async setFocus(){await(this.flowItemNode?.setFocus())}componentWillLoad(){const{modules:e,strings:t}=this.smartMappingState,a=(0,i.R)(this.smartMappingState),s=(0,i.g)(this.smartMappingState);this.smartMappingState.lastDefault={defaultSymbol:a.defaultSymbol||(0,i.m)(this.smartMappingState,s),defaultLabel:a.defaultLabel||t.panels.uniqueValue.other},this.originalRendererObj=e.esriLang.clone((0,i.R)(this.smartMappingState))}componentDidLoad(){requestAnimationFrame((async()=>await(this.flowItemNode?.setFocus())))}disconnectedCallback(){(0,i.ah)()}render(){const{hideLayerTitle:e,layer:t,strings:a}=this.smartMappingState,n=t.title;return(0,s.h)(s.H,{key:"5db60a28e4bd0bec437dccf05b4dff10b8123954",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"42f40b2d6c7bdafeac3c71c5dc0efca9eb9fc050",heading:a.panels.uniqueValue.styleOptions,description:e?void 0:n,class:"flow-item",closable:(0,i.C)(this.el),showBackButton:this.showBackButton,selected:this.selected,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterUniqueValueBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-block",{class:"unique-value-block",heading:e.panels.uniqueValue.uniqueValue,open:!0},this.renderFieldSelector(),this.renderColorScheme(),this.renderValues())}renderFieldSelector(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e).field||t.panels.uniqueValue.value,n=(0,i.aG)(e),l=n.map((e=>({label:e.alias,layerField:e,simpleFieldType:i.q.STRING}))),r=n.find((e=>e.name===a));return(0,s.h)("arcgis-smart-mapping-attribute-input",{label:t.panels.uniqueValue.field,fieldList:l,selectedField:{field:r?.name??t.panels.uniqueValue.value,simpleFieldType:i.q.STRING},mode:"simple",popoverReferenceElement:this.flowItemNode,onArcgisSmartMappingAttributeInputChange:e=>{if(e.detail){const t=e.detail.field;this.handleFieldChange(t)}}})}renderColorScheme(){const{smartMappingState:e}=this,{mapView:t,modules:a,strings:n}=e,l=(0,i.R)(e),r=l.uniqueValueInfos;if(!r.length)return(0,s.h)(s.F,null);const o=a.typeSchemes.getSchemes({basemap:t.map.basemap,geometryType:"polygon"}),c=(0,i.ab)(o,Math.min(r.length,10))[0].colors,d=[];return l.authoringInfo?.colorRamp?d.push(...(0,i.aC)(e,l.authoringInfo.colorRamp)):d.push(...r?.length?r.map(((t,s)=>(0,i.Z)(e,t.symbol)||new a.EsriColor(c[s%c.length]))):[]),(0,s.h)("arcgis-smart-mapping-symbol-button",{label:n.panels.uniqueValue.colorScheme,type:"raster-unique-value",rampType:"continuous",colors:a.esriLang.clone(d).reverse(),onArcgisSmartMappingSymbolButtonSymbolChange:()=>{(0,i.Q)(e),(0,s.f)(this.el),(0,s.f)(this.symbolButtonNode)},ref:e=>this.symbolButtonNode=e})}renderValues(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e);return this.labelNodes=[],this.inputNodes=[],(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,a.field),(0,s.h)("calcite-list",{label:t.panels.uniqueValue.uniqueValue,group:"unique-value-items",class:"gray-border",dragEnabled:!0,onCalciteListOrderChange:e=>{if(e.detail.toEl){const t=e.detail.dragEl;if("other-values-list"===e.detail.toEl.id){const e=a.uniqueValueInfos.filter(((e,a)=>a!==Number.parseInt(t.label)));a.uniqueValueInfos=e}}const t=Array.from(e.target.children);this.handleSortValues(t)}},a.uniqueValueInfos.map(((e,t)=>this.renderValue(e,t)))),this.renderDefaultValue(),(0,s.h)("calcite-list",{label:t.panels.uniqueValue.uniqueValue,id:"other-values-list",dragEnabled:!0,group:"unique-value-items"}))}renderValue(e,t){return(0,s.h)("calcite-list-item",{key:`values-${e.value}`,value:`${e.value}`,label:`${t}`},(0,s.h)("div",{slot:"actions-start"},this.renderColorNode(e,t)),this.renderTextNode(e,t))}renderColorNode(e,t){const{smartMappingState:a}=this,{strings:n}=a,l=e.symbol.clone(),r={"symbol-is-white":(0,i.av)(a,l),symbol:!0};return-1!==t&&this.colorNodes.length&&(this.colorNodes=[]),(0,s.h)("div",{class:r,tabindex:"0","aria-label":n.panels.uniqueValue.accessibility.editColorFor.replace("${value}",e.label),"aria-haspopup":"true",ref:e=>{e&&(-1===t?this.defaultColorNode=e:this.colorNodes.push(e))},onClick:()=>{if(this.popoverNode){(-1===this.selectedPopoverIdx?this.defaultColorNode:this.colorNodes[this.selectedPopoverIdx]).classList.remove("selected"),this.selectedPopoverIdx===t?((0,i.B)(),this.popoverNode=void 0,this.selectedPopoverIdx=void 0):(this.selectedPopoverIdx=t,this.handleColorClick(t))}else this.selectedPopoverIdx=t,this.handleColorClick(t)},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleColorClick(t))}},(0,s.h)("div",{ref:e=>{e&&this.afterCreateColorNode(e,t)}}))}renderTextNode(e,t){const{strings:a}=this.smartMappingState;return(0,s.h)(s.F,null,(0,s.h)("div",{class:(-1===t?"default-label":"")+" label",slot:"content",tabindex:"0",ref:e=>{e&&(-1===t?this.defaultLabelNode=e:this.labelNodes[t]=e)},"aria-label":a.panels.uniqueValue.accessibility.editLabelFor.replace("${value}",e.label),onClick:e=>this.handleLabelEdit(t,e),onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||this.handleLabelEdit(t,e)}},e.label),(0,s.h)("calcite-input",{slot:"content",class:"hidden",scale:"s",ref:e=>{e&&(-1===t?this.defaultInputNode=e:this.inputNodes[t]=e,this.defaultInputNode?.classList.add("default-input-padding"))},value:e.label??void 0,onCalciteInputChange:e=>{const a=-1===t?this.defaultInputNode:this.inputNodes[t],s=-1===t?this.defaultLabelNode:this.labelNodes[t];a.classList.add("hidden"),s.classList.remove("hidden"),this.handleValueTextChange(t,e)},onFocusout:e=>{const a=-1===t?this.defaultInputNode:this.inputNodes[t],s=-1===t?this.defaultLabelNode:this.labelNodes[t];a.classList.add("hidden"),s.classList.remove("hidden"),this.handleValueTextChange(t,e)},onKeyDown:a=>{if("Escape"===a.key||"Enter"===a.key){(-1===t?this.defaultInputNode:this.inputNodes[t]).classList.add("hidden");const s=a.currentTarget;s.value=e.label||"",s.disabled=!0,this.handleValueTextChange(t,a);const i=-1===t?this.defaultLabelNode:this.labelNodes[t];i.classList.remove("hidden"),s.disabled=!1,setTimeout((()=>i.focus()),300)}}}))}renderDefaultValue(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),n=(0,i.g)(e),l=a.defaultSymbol||(0,i.m)(e,n),r=a.defaultLabel||t.panels.uniqueValue.other,o={symbol:l,label:r};return(0,s.h)("calcite-list",{class:"default-list-padding",label:r},(0,s.h)("calcite-list-item",null,(0,s.h)("calcite-checkbox",{class:"checkbox",slot:"actions-start",tabIndex:0,checked:!!a.defaultSymbol,onClick:e=>this.handleCheckboxClick(e),onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.handleCheckboxClick(e))},onMouseOver:()=>(0,i.ai)(this.checkboxNode,t.panels.uniqueValue.otherTooltip),onMouseOut:()=>(0,i.ah)(),onFocus:()=>(0,i.ai)(this.checkboxNode,t.panels.uniqueValue.otherTooltip),onFocusout:()=>(0,i.ah)(),ref:e=>{e&&(this.checkboxNode=e)}}),(0,s.h)("div",{slot:"content-start",class:"symbol-container"},this.renderColorNode(o,-1)),this.renderTextNode(o,-1)))}renderDoneButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}handleFieldChange(e){const{smartMappingState:t}=this,a=(0,i.R)(t);if(!a.uniqueValueInfos.length)return;const n={field:e};!(0,i.a5)(t)&&a.authoringInfo?.colorRamp&&(n.colorRamp=a.authoringInfo.colorRamp),(0,d.r)((0,i.aH)(t,n),this.flowItemNode).then((e=>{(0,i.Q)(t,e.renderer),(0,s.f)(this.el)}),(e=>{this.fieldNode.value=a.field,this.arcgisSmartMappingPanelsRasterUniqueValueError.emit(e)}))}handleSortValues(e){const{smartMappingState:t}=this,{modules:a,strings:n}=t,l=(0,i.g)(t),r=(0,i.R)(t);(0,i.B)();const o=e.map((e=>e.value)),c=r.uniqueValueInfos.map((e=>a.esriLang.clone(e)));c.sort(((e,t)=>o.indexOf(`${e.value}`)-o.indexOf(`${t.value}`))),c.length?r.uniqueValueInfos=c:(r.defaultSymbol=(0,i.m)(t,l),r.defaultLabel=n.panels.uniqueValue.other),(0,i.Q)(t),(0,s.f)(this.el)}afterCreateColorNode(e,t){const{smartMappingState:a}=this,{modules:s}=a,n=(0,i.R)(a),l=(0,i.g)(a),r=-1===t?n.defaultSymbol||(0,i.m)(a,l):n.uniqueValueInfos[t].symbol.clone();for(-1===t&&r.outline&&(r.outline.width=0),(0,i.av)(a,r)&&(r.outline=new s.SimpleLineSymbol({color:"#bdc3c7",width:.75}));e?.childNodes?.length;)e.removeChild(e.childNodes[0]);const{symbolUtils:o}=s;r&&o.renderPreviewHTML(r,{size:(0,i.aw)(r),ignoreWhiteSymbols:!0,symbolConfig:{isSquareFill:!0}}).then((t=>e?.appendChild(t)))}handleColorClick(e){(0,i.B)();const{smartMappingState:t}=this,{strings:a}=t,n=(0,u.c)(t,{referenceElement:this.flowItemNode,heading:a.panels.uniqueValue.colorScheme});n.addEventListener("arcgisSmartMappingStylerPopoverClose",(()=>this.handleRemoveColorFocus(n,e,!1))),n.addEventListener("arcgisSmartMappingStylerPopoverDisconnected",(()=>this.handleRemoveColorFocus(n,e,!0))),this.smartMappingState.selectedValue=e,(0,p.a)(t,{popoverNode:n,onChange:()=>{const n=(0,i.R)(t);-1!==e||n.defaultLabel||(n.defaultLabel=a.panels.uniqueValue.other),(0,i.Q)(t),(0,s.f)(this.el),this.symbolButtonNode&&(0,s.f)(this.symbolButtonNode)}}),this.popoverNode=n,-1===e?this.defaultColorNode.classList.add("selected"):this.colorNodes[e].classList.add("selected")}handleRemoveColorFocus(e,t,a){(0,u.r)(e),setTimeout((()=>{const e=-1===t?this.defaultColorNode:this.colorNodes[t];a||e.focus(),e.classList.remove("selected"),this.popoverNode=void 0}),300)}handleLabelEdit(e,t){const a=-1===e?this.defaultInputNode:this.inputNodes[e];a.classList.remove("hidden"),a.setFocus(),t.target.classList.add("hidden")}handleValueTextChange(e,t){const{smartMappingState:a}=this,{strings:n}=a,l=(0,i.R)(a);if(-1===e&&!l.defaultLabel)return this.defaultInputNode.value=n.panels.uniqueValue.other,this.defaultLabelNode.textContent=n.panels.uniqueValue.other,(0,i.Q)(a),void(0,s.f)(this.el);const r=t.target;-1===e?l.defaultLabel=r.value:l.uniqueValueInfos[e].label=r.value,""===r.value?-1===e?(l.defaultLabel=n.panels.uniqueValue.other,this.defaultInputNode.value=n.panels.uniqueValue.other,this.defaultLabelNode.textContent=n.panels.uniqueValue.other):(l.uniqueValueInfos[e].label=`${l.uniqueValueInfos[e].value}`,this.inputNodes[e].value=l.uniqueValueInfos[e].label):-1===e&&(this.defaultInputNode.value=l.defaultLabel,this.defaultLabelNode.textContent=l.defaultLabel),(0,i.Q)(a),(0,s.f)(this.el)}handleCheckboxClick(e){const{smartMappingState:t}=this,{lastDefault:a,strings:n}=t,l=(0,i.R)(t);(0,u.r)(this.popoverNode),this.popoverNode=void 0,(0,i.B)(),l.uniqueValueInfos.length?(l.defaultSymbol?(l.defaultSymbol=void 0,l.defaultLabel=void 0,this.defaultLabelNode.textContent=n.panels.uniqueValue.other,this.defaultInputNode.value=n.panels.uniqueValue.other):(l.defaultSymbol=a.defaultSymbol,l.defaultLabel=this.defaultLabelNode.textContent),(0,i.Q)(t),(0,s.f)(this.el)):e.target.checked=!0}get el(){return(0,s.g)(this)}};F.style=":host{width:100%;display:none}:host([selected]){display:flex}.flow-item{height:100%}.unique-value-block{overflow-x:hidden;overflow-wrap:anywhere}.label{padding:5px auto}.symbol{width:19px;height:19px}.symbol:focus,.label:focus{outline:2px solid var(--calcite-color-brand)}.symbol-container{cursor:pointer}.selected{outline:1px solid var(--calcite-color-brand)}.hidden{display:none}.gray-border{border-top:1px solid #e0e0e0;border-bottom:1px solid #e0e0e0}.checkbox{margin:0px 5.5px}.default-list-padding{padding-top:8px}";const V=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingPanelsRasterVectorFieldClose=(0,s.c)(this,"arcgisSmartMappingPanelsRasterVectorFieldClose",7),this.arcgisSmartMappingPanelsRasterVectorFieldBackClick=(0,s.c)(this,"arcgisSmartMappingPanelsRasterVectorFieldBackClick",7),this.arcgisSmartMappingPanelsRasterVectorFieldError=(0,s.c)(this,"arcgisSmartMappingPanelsRasterVectorFieldError",7),this.manager=(0,o.u)(this),this.documentClickHandler=void 0,this.smartMappingState=(0,l.u)(),this.handleDone=()=>{this.arcgisSmartMappingPanelsRasterVectorFieldClose.emit("save")},this.handleCancel=()=>{const{originalRendererObj:e,smartMappingState:t}=this;(0,i.Q)(t,e),this.arcgisSmartMappingPanelsRasterVectorFieldClose.emit("cancel")},this.menuOpen=!1,this.showBackButton=!1,this.selected=!1,this.beforeBack=void 0}async setFocus(){await(this.flowItemNode?.setFocus())}componentWillLoad(){this.originalRendererObj=(0,i.R)(this.smartMappingState),this.speedUnitOptions=this.getSpeedUnitOptions()}componentDidLoad(){requestAnimationFrame((async()=>await(this.flowItemNode?.setFocus()))),this.currentInput=this.inputUnitNode.value,this.currentOutput=this.outputUnitNode.value}render(){const{hideLayerTitle:e,layer:t,strings:a}=this.smartMappingState,n=t.title;return(0,s.h)(s.H,{key:"7fee941ff9efab438b4bb2885f2cf40e9dadc20a",class:"calcite-match-height"},(0,s.h)("calcite-flow-item",{key:"267033893f6de22a8997bf2f42771c6cda936fb7",heading:a.panels.vectorField.styleOptions,description:e?void 0:n,class:"flow-item",closable:(0,i.C)(this.el),showBackButton:this.showBackButton,selected:this.selected,onCalciteFlowItemClose:this.handleDone,onCalciteFlowItemBack:()=>this.arcgisSmartMappingPanelsRasterVectorFieldBackClick.emit(),ref:e=>this.flowItemNode=e},this.renderVisualization(),this.renderDoneButton(),this.renderCancelButton()))}renderVisualization(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-block",{class:"vector-field-block",heading:e.panels.vectorField.vectorField,open:!0},this.renderSymbolStyleSelector(),this.renderSymbolDensitySlider(),this.renderSymbolScalingSlider(),this.renderInvertSymbols(),this.renderMagnitudeRange(),this.renderUnitSelectors())}renderSymbolStyleSelector(){const{smartMappingState:e}=this;return(0,s.h)("arcgis-smart-mapping-vector-symbol-button",{ref:e=>this.selectNode=e,onArcgisSmartMappingSelectBeforeOpen:()=>{this.popoverNode?.parentElement?.removeChild(this.popoverNode),this.popoverNode=void 0,this.popoverOpen=!1},onArcgisSmartMappingSelectChange:t=>{const a=(0,i.R)(e);let n=t.detail;n.includes("beaufort")&&(n=this.getExactBeaufortUnit(a.outputUnit)),this.resetOutputUnit(n,a),(0,d.r)((0,h.h)(e,{style:n}),this.flowItemNode).then((t=>{(0,i.Q)(e,t.renderer),(0,s.f)(this.el),this.selectNode&&(0,s.f)(this.selectNode)}),(e=>{(0,s.f)(this.selectNode),this.arcgisSmartMappingPanelsRasterVectorFieldError.emit(e)}))}})}renderSymbolDensitySlider(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),{symbolTileSize:n}=a||{},l=100/n;return(0,s.h)("calcite-label",null,t.panels.vectorField.symbolDensity,(0,s.h)("arcgis-smart-mapping-raster-slider",{rendererType:"vector-field",type:"density",min:1,max:5,values:[Math.round(10*l)/10],precision:1,minLabel:t.panels.flow.low,maxLabel:t.panels.flow.high}))}renderSymbolScalingSlider(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),n=(0,i.b)(a,"size"),{minSize:l,maxSize:r}=n;return(0,s.h)("calcite-label",null,t.panels.vectorField.symbolScaling,(0,s.h)("calcite-slider",{min:0,minValue:null!==l?l:20,max:100,maxValue:null!==r?r:80,step:1,labelHandles:!0,labelTicks:!0,precise:!0,snap:!0,onCalciteSliderInput:(0,m.d)((()=>{const e=this.symbolScalingSliderNode.minValue,t=this.symbolScalingSliderNode.maxValue;this.handleSymbolScaleChange(e,t)}),300),ref:e=>this.symbolScalingSliderNode=e}))}renderInvertSymbols(){const{smartMappingState:e}=this,{strings:t}=e,a="flow-from"!==(0,i.R)(e).flowRepresentation;return(0,s.h)("div",{class:"invert-symbol-wrapper"},(0,s.h)("calcite-label",{layout:"inline-space-between"},(0,s.h)("section",null,t.panels.vectorField.invertSymbols,(0,s.h)("calcite-button",{class:"invert-symbol-margin","icon-start":"information",scale:"s",appearance:"transparent",kind:"neutral",onClick:()=>{this.popoverOpen?(this.removePopover(),this.buttonNode.setFocus()):this.togglePopover()},ref:e=>this.buttonNode=e}))),(0,s.h)("calcite-switch",{class:"invert-symbol-switch",scale:"s",label:t.panels.vectorField.invertSymbols,checked:a,onCalciteSwitchChange:e=>this.handleInvertSymbolsChange(e.currentTarget.checked?"flow-to":"flow-from")}))}renderMagnitudeRange(){const{smartMappingState:e}=this,{strings:t}=e,a=(0,i.R)(e),n=(0,i.b)(a,"size"),{minDataValue:l,maxDataValue:r}=n,o=(0,i.M)(l)?Math.round(10*l)/10:void 0,c=(0,i.M)(r)?Math.round(10*r)/10:void 0;return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,t.panels.vectorField.magnitudeRange),(0,s.h)("calcite-label",null,t.panels.vectorField.min,(0,s.h)("calcite-input-number",{label:t.panels.vectorField.min,scale:"s",inputMode:"decimal",min:o,max:c,value:`${o??""}`,numberButtonType:"none",onCalciteInputNumberInput:()=>{const e=Number.parseFloat(this.minRangeNode.value),t=Number.isNaN(Number.parseFloat(this.minRangeNode.value))?Number.NEGATIVE_INFINITY:Number.parseFloat(this.minRangeNode.value),a=Number.isNaN(Number.parseFloat(this.maxRangeNode.value))?Number.POSITIVE_INFINITY:Number.parseFloat(this.maxRangeNode.value);!Number.isNaN(e)&&e>=t&&e<=a?(this.minRangeNode.value=`${e}`,this.handleMagnitudeRangeValuesChange(e,Number.parseFloat(this.maxRangeNode.value))):(this.minRangeNode.value="",this.handleMagnitudeRangeValuesChange(void 0,Number.parseFloat(this.maxRangeNode.value)))},ref:e=>this.minRangeNode=e})),(0,s.h)("calcite-label",null,t.panels.vectorField.max,(0,s.h)("calcite-input-number",{label:t.panels.vectorField.max,scale:"s",inputMode:"decimal",min:o,max:c,value:`${c??""}`,numberButtonType:"none",onCalciteInputNumberInput:()=>{const e=Number.parseFloat(this.maxRangeNode.value),t=Number.isNaN(Number.parseFloat(this.minRangeNode.value))?Number.NEGATIVE_INFINITY:Number.parseFloat(this.minRangeNode.value),a=Number.isNaN(Number.parseFloat(this.maxRangeNode.value))?Number.POSITIVE_INFINITY:Number.parseFloat(this.maxRangeNode.value);!Number.isNaN(e)&&e>=t&&e<=a?(this.maxRangeNode.value=`${e}`,this.handleMagnitudeRangeValuesChange(Number.parseFloat(this.minRangeNode.value),e)):(this.maxRangeNode.value="",this.handleMagnitudeRangeValuesChange(Number.parseFloat(this.minRangeNode.value),void 0))},ref:e=>this.maxRangeNode=e})))}renderUnitSelectors(){const{strings:e}=this.smartMappingState;return(0,s.h)(s.F,null,(0,s.h)("calcite-label",null,e.panels.vectorField.convertMagnitude),(0,s.h)("calcite-label",null,e.panels.vectorField.inputUnits,this.renderUnitSelector("input")),(0,s.h)("calcite-label",null,e.panels.vectorField.outputUnits,this.renderUnitSelector("output")))}renderUnitSelector(e){const{smartMappingState:t}=this,{strings:a}=t,n=(0,i.R)(t),l="output"===e&&["wind-barb","ocean-current-kn","ocean-current-m"].includes(n.style);return(0,s.h)("calcite-combobox",{disabled:l,key:"input"===e?n.inputUnit:n.outputUnit,label:"input"===e?a.panels.vectorField.inputUnits:a.panels.vectorField.outputUnits,clearDisabled:!0,scale:"s",selectionMode:"single",ref:t=>{t&&("output"===e?this.outputUnitNode=t:this.inputUnitNode=t)},onCalciteComboboxChange:()=>{"input"===e?(""===this.inputUnitNode.value?this.inputUnitNode.value=this.currentInput:this.currentInput=this.inputUnitNode.value,this.handleUnitSelectClick("input")):(""===this.outputUnitNode.value?this.outputUnitNode.value=this.currentOutput:this.currentOutput=this.outputUnitNode.value,this.handleUnitSelectClick("output"))}},this.speedUnitOptions.map((t=>this.renderUnitOption(e,t))))}renderUnitOption(e,t){const{smartMappingState:a}=this,n=(0,i.R)(a),l=this.speedUnitOptions.find((t=>"input"===e?t.key===n.inputUnit:t.key===n.outputUnit));return(0,s.h)("calcite-combobox-item",{value:t.key,textLabel:t.title,selected:!!l&&t===l})}renderDoneButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-button",{slot:"footer",label:e.done,onClick:this.handleDone,appearance:"solid",width:"half"},e.done)}renderCancelButton(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-button",{slot:"footer",label:e.cancel,onClick:this.handleCancel,appearance:"outline-fill",width:"half"},e.cancel)}getExactBeaufortUnit(e){switch(e=e??"meter-per-second"){case"knots":return"beaufort-kn";case"meter-per-second":default:return"beaufort-m";case"mile-per-hour":return"beaufort-mi";case"kilometer-per-hour":return"beaufort-km";case"feet-per-second":return"beaufort-ft"}}resetOutputUnit(e,t){let a;switch(e){case"ocean-current-kn":case"wind-barb":a="knots";break;case"ocean-current-m":a="meter-per-second"}a&&(t.outputUnit=a)}handleSymbolScaleChange(e,t){const{smartMappingState:a}=this,s=(0,i.R)(a),n=(0,i.b)(s,"size");n.minSize=e,n.maxSize=t,(0,i.Q)(a)}handleInvertSymbolsChange(e){const{smartMappingState:t}=this;(0,i.R)(t).flowRepresentation=e,(0,i.Q)(t)}handleUnitSelectClick(e){const{smartMappingState:t}=this,a=(0,i.R)(t);"input"===e?a.inputUnit=this.inputUnitNode.value:(a.outputUnit=this.outputUnitNode.value,a.style.includes("beaufort")&&(a.style=this.getExactBeaufortUnit(a.outputUnit))),(0,i.Q)(t)}handleMagnitudeRangeValuesChange(e,t){const{smartMappingState:a}=this;if("number"==typeof e&&Number.isNaN(e)&&(e=""),"number"==typeof t&&Number.isNaN(t)&&(t=""),e===this.minRangeNode.max&&t===this.maxRangeNode.min)return;const s=(0,i.R)(a),n=(0,i.b)(s,"size");""!==e&&(0,i.M)(e)?(e=Math.round(1e3*e)/1e3,n.minDataValue=e,this.minRangeNode.value=`${e}`,this.maxRangeNode.min=e+this.maxRangeNode.step):(n.minDataValue=void 0,this.minRangeNode.value=""),""!==t&&(0,i.M)(t)?(t=Math.round(1e3*t)/1e3,n.maxDataValue=t,this.maxRangeNode.value=`${t}`,this.minRangeNode.max=t-this.minRangeNode.step):(n.maxDataValue=void 0,this.maxRangeNode.value=""),(0,i.Q)(a)}togglePopover(){const{flowItemNode:e,smartMappingState:t}=this,{strings:a}=t;this.popoverNode=document.createElement("arcgis-smart-mapping-info-popover"),this.popoverNode.smartMappingState=t,this.popoverNode.props={title:a.panels.vectorField.invertSymbols,flowItemNode:e,moreInfo:a.panels.vectorField.invertSymbolsTip},this.popoverNode.referenceElement=this.buttonNode,this.popoverNode.addEventListener("arcgisSmartMappingInfoPopoverClose",(e=>{e.stopPropagation(),this.removePopover(),this.buttonNode.setFocus()})),document.body.appendChild(this.popoverNode),this.popoverNode.setOpen(!0),this.popoverOpen=!0,setTimeout((()=>{this.documentClickHandler=e=>{(0,g.i)(e.target)||this.removePopover()},document.addEventListener("click",this.documentClickHandler)}))}removePopover(){document.body.querySelectorAll(".arcgis-smart-mapping-popover").forEach((e=>document.body.removeChild(e))),this.popoverNode=void 0,this.popoverOpen=!1,this.documentClickHandler&&(document.removeEventListener("click",this.documentClickHandler),this.documentClickHandler=void 0)}getSpeedUnitOptions(){const{strings:e}=this.smartMappingState,t=e.panels.vectorField.unitOptions;return[{key:"meter-per-second",title:t.esriMetersPerSecond,selected:!1},{key:"kilometer-per-hour",title:t.esriKilometersPerHour,selected:!1},{key:"knots",title:t.esriKnots,selected:!1},{key:"feet-per-second",title:t.esriFeetPerSecond,selected:!1},{key:"mile-per-hour",title:t.esriMilesPerHour,selected:!1}]}get el(){return(0,s.g)(this)}};var E;V.style=":host {\n  width: 100%;\n  display: none;\n}\n:host([selected]) {\n  display: flex;\n}\n\n.flow-item {\n  height: 100%;\n}\n\n.vector-field-block {\n  overflow-x: hidden;\n}\n\n.invert-symbol-wrapper {\n  display: flex;\n  justify-content: space-between;\n}\n\n.invert-symbol-margin {\n  margin-right: inherit;\n  margin-left: 0.35rem;\n}\n\n:dir(rtl) {\n  .invert-symbol-margin {\n    margin-left: inherit;\n    margin-right: 0.35rem;\n  }\n}\n\n.invert-symbol-switch {\n  padding-top: 6px;\n}\n",function(e){e.beaufort="beaufort.png",e.classifiedArrow="classifiedArrow.png",e.oceanCurrentKnots="oceanCurrentKnots.png",e.oceanCurrentMps="oceanCurrentMps.png",e.simpleScalar="simpleScalar.png",e.singleArrow="singleArrow.png",e.windBarbs="windBarbs.png"}(E||(E={}));const P=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingSelectChange=(0,s.c)(this,"arcgisSmartMappingSelectChange",7),this.arcgisSmartMappingSelectBeforeOpen=(0,s.c)(this,"arcgisSmartMappingSelectBeforeOpen",7),this.manager=(0,o.u)(this),this.open=!1,this.selectInfos=[],this.smartMappingState=(0,l.u)()}async setFocus(){this.buttonNode?.focus()}componentWillLoad(){this.populateSymbolStyleSelectorInfo(),this.setSymbolStyleSelection()}componentWillUpdate(){const e=(0,i.R)(this.smartMappingState),{style:t}=e;this.selectedStyleInfo?.value!==t&&this.setSymbolStyleSelection()}render(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-label",{key:"ae02c1b53faa093044bbe3ba5ba38e735abb1ded"},e.panels.vectorField.symbolType,(0,s.h)("div",{key:"4032892c34c503d475e303bdab5b51ea86d121c0",class:"vector-symbol-button",role:"button",tabindex:"0","aria-haspopup":"true","aria-label":e.panels.vectorField.symbolType,ref:e=>this.buttonNode=e,onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.openSelectDropdown())},onClick:()=>this.openSelectDropdown()},(0,s.h)("div",{key:"416ca0833648d32c17b3b72fdb56e5a3226dd00f",class:"vector-symbol-content"},(0,s.h)("div",{key:"40cd1371f076a1521d28ba0ddd9e017dff66bbf8",class:"vector-symbol-button-icon",style:{backgroundImage:`url(${(0,s.a)("./assets/smart-mapping-dropdown-images/")}${this.selectedStyleInfo?.iconPath})`}}),(0,s.h)("div",{key:"5d8f54fc655924cf0536d39d6f65ab51d9a58109",class:"vector-symbol-sub-content"},(0,s.h)("div",{key:"66648f94b92cf021d7fcb483897fd42e1e872c20",class:"vector-symbol-button-text"},(0,s.h)("div",{key:"ffd74c0d2e89b9dd89db49536161ed982551a2c3",class:"vector-symbol-button-title"},this.selectedStyleInfo?.title),(0,s.h)("div",{key:"8d00a1a46ae9f6887282e476c706eb60885aaab9",class:"vector-symbol-button-msg"},this.selectedStyleInfo?.msg)),(0,s.h)("div",{key:"418a6aa4dcb17aaed036a426ed75a479cce2fbf6"},(0,s.h)("calcite-icon",{key:"67350e35d17afe81fdc7ed92afda26ec957daa45",scale:"s",icon:"chevron-down"}))))))}setSymbolStyleSelection(){const e=(0,i.R)(this.smartMappingState);this.selectedStyleInfo=this.selectInfos.find((t=>t.value===e.style||e.style.includes("beaufort")&&t.value.includes("beaufort"))),this.selectInfos.forEach((e=>{e.selected=e.value===this.selectedStyleInfo?.value}))}closeDropdown(){this.open=!1,this.dropdownNode&&(this.dropdownNode.parentNode?.removeChild(this.dropdownNode),this.dropdownNode=void 0,this.buttonNode.classList.remove("active"))}openSelectDropdown(){const{smartMappingState:e}=this;if(this.open)this.open=!1;else{this.arcgisSmartMappingSelectBeforeOpen.emit();const t=document.createElement("arcgis-smart-mapping-dropdown");t.smartMappingState=e,t.buttonNode=this.buttonNode,t.infos=this.selectInfos,this.dropdownNode=t,t.addEventListener("arcgisSmartMappingDropdownClose",(e=>{this.closeDropdown(),"Escape"===e.detail&&this.setFocus()})),t.addEventListener("arcgisSmartMappingDropdownChange",(e=>this.setSymbolStyle(e.detail))),this.buttonNode.classList.add("active"),document.body.appendChild(t),this.open=!0}}setSymbolStyle(e){const t=(0,i.R)(this.smartMappingState),{style:a}=t,s=e.value,n=a.includes("beaufort"),l=s.includes("beaufort");if(s===a||n&&l)return this.closeDropdown(),void setTimeout((()=>{this.setFocus()}),300);this.selectInfos.forEach((e=>{e.selected=e.value===s})),this.selectedStyleInfo=e,this.arcgisSmartMappingSelectChange.emit(this.selectedStyleInfo.value),this.closeDropdown(),setTimeout((()=>{this.setFocus()}),300)}populateSymbolStyleSelectorInfo(){const{strings:e}=this.smartMappingState,t=e.panels.vectorField.symbolStyleOptions,a="vfr_";this.selectInfos.push({value:"beaufort",title:t.beaufort.title,msg:t.beaufort.description,iconPath:`${a}${E.beaufort}`,selected:!1}),this.selectInfos.push({value:"simple-scalar",title:t.simpleScalar.title,msg:t.simpleScalar.description,iconPath:`${a}${E.simpleScalar}`,selected:!1}),this.selectInfos.push({value:"single-arrow",title:t.singleArrow.title,msg:t.singleArrow.description,iconPath:`${a}${E.singleArrow}`,selected:!1}),this.selectInfos.push({value:"wind-barb",title:t.windBarbs.title,msg:t.windBarbs.description,iconPath:`${a}${E.windBarbs}`,selected:!1}),this.selectInfos.push({value:"ocean-current-kn",title:t.oceanCurrentKnots.title,msg:t.oceanCurrentKnots.description,iconPath:`${a}${E.oceanCurrentKnots}`,selected:!1}),this.selectInfos.push({value:"ocean-current-m",title:t.oceanCurrentMps.title,msg:t.oceanCurrentMps.description,iconPath:`${a}${E.oceanCurrentMps}`,selected:!1}),this.selectInfos.push({value:"classified-arrow",title:t.classifiedArrow.title,msg:t.classifiedArrow.description,iconPath:`${a}${E.classifiedArrow}`,selected:!1})}get el(){return(0,s.g)(this)}};P.style=".vector-symbol-button{display:flex;padding:6px;justify-content:space-between;align-items:center;border-radius:0;cursor:pointer;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-1);border-color:var(--calcite-color-foreground-3);border-width:1px;border-style:solid;box-shadow:transparent 0px 0px 0px 1px inset}.vector-symbol-button:hover{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3)}.vector-symbol-button:active{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3)}.vector-symbol-button:focus{box-shadow:inset 0 0 0 2px var(--calcite-color-foreground-3);outline:2px solid var(--calcite-color-brand);outline-offset:2px}.vector-symbol-button.active{outline:1px solid var(--calcite-ui-focus-color, var(--calcite-color-brand))}.vector-symbol-content{display:flex;align-items:center;width:100%}.vector-symbol-sub-content{display:flex;justify-content:space-between;align-items:center;width:100%}.vector-symbol-button-icon{min-width:16px;background-repeat:no-repeat;height:48px;padding:0;display:inline-block}.vector-symbol-button-text{display:inline-block;padding:0 10px}.vector-symbol-button-title{font-weight:bold}.vector-symbol-button-msg{font-size:80%;line-height:16px}"},58325:(e,t,a)=>{a.d(t,{a:()=>i,d:()=>s,t:()=>n});const s=(e,t)=>{let a,s="idle";const i=async(...i)=>await new Promise((n=>{switch(s){case"flushed":s="idle",a?(clearTimeout(a),n(e(...i))):n(null);break;case"invoked":clearTimeout(a),s="idle",n(e(...i));break;case"cancelled":clearTimeout(a),s="idle",n(null);break;default:a&&clearTimeout(a),s="pending",a=setTimeout((()=>{s="idle",n(e(...i))}),t)}}));return i.flush=async function(...e){return s="flushed",await i(...e)},i.invoke=async function(...e){return s="invoked",await i(...e)},i.cancel=async function(...e){return s="cancelled",await i(...e)},i.getStatus=function(){return s},i},i=(e,t)=>{let a;return async(...s)=>await new Promise((i=>{a||(a=setTimeout((()=>{clearTimeout(a),a=void 0,i(e(...s))}),t))}))};function n(e){return new Promise((t=>setTimeout(t,e)))}},76133:(e,t,a)=>{function s(e){if("ARCGIS-SMART-MAPPING-INFO-POPOVER"===e?.tagName)return!0;{let t=e?.parentElement;for(;t;){if("ARCGIS-SMART-MAPPING-INFO-POPOVER"===t.tagName)return!0;t=t.parentElement}}return!1}a.d(t,{i:()=>s})},98518:(e,t,a)=>{a.d(t,{a:()=>r,b:()=>l,g:()=>h,u:()=>n});var s=a(68180),i=a(99592);a(97127);function n(e,t){const{modules:a}=e,n=(0,i.j)(e),l=a.esriLang.clone(n.classBreakInfos);n.classBreakInfos=[],l.forEach(((a,i)=>{a=function(e,t,a,i,n){if((0,s.i)(a))if(0===a);else if(a<1){const s=Math.round(1/a);t.minValue="first"===n?Math.floor(t.minValue/a)/s:Math.round(t.minValue/a)/s,t.maxValue="last"===n?Math.ceil(t.maxValue/a)/s:Math.round(t.maxValue/a)/s,t.label=`${i>0?"> ":""}${t.minValue.toLocaleString(e.fullLocale,{maximumSignificantDigits:15})} - ${t.maxValue.toLocaleString(e.fullLocale,{maximumSignificantDigits:15})}`}else t.minValue="first"===n?Math.floor(t.minValue/a)*a:Math.round(t.minValue/a)*a,t.maxValue="last"===n?Math.ceil(t.maxValue/a)*a:Math.round(t.maxValue/a)*a,t.label=`${i>0?"> ":""}${t.minValue.toLocaleString()} - ${t.maxValue.toLocaleString()}`;return t}(e,a,t,i,0===i?"first":i===l.length-1?"last":void 0),n.addClassBreakInfo({minValue:a.minValue,maxValue:a.maxValue,symbol:a.symbol,label:a.label})}))}function l(e,t){const a=(0,i.j)(e).classBreakInfos;let s=t,n=Number.POSITIVE_INFINITY;a.forEach((e=>{s||(s=Math.max(o(e.minValue),o(e.maxValue))),n=Math.min(n,e.maxValue-e.minValue)}));const l=[];return n>1e7?(l.push(1e7),l.push(1e6),l.push(1e5),l.push(1e4),l.push(1e3),l.push(100),l.push(10),s>0&&l.push(1),s>1&&l.push(.1),s>2&&l.push(.01)):n>1e6?(l.push(1e6),l.push(1e5),l.push(1e4),l.push(1e3),l.push(100),l.push(10),s>0&&l.push(1),s>1&&l.push(.1),s>2&&l.push(.01)):n>1e5?(l.push(1e5),l.push(1e4),l.push(1e3),l.push(100),l.push(10),s>0&&l.push(1),s>1&&l.push(.1),s>2&&l.push(.01)):n>1e4?(l.push(1e4),l.push(1e3),l.push(100),l.push(10),s>0&&l.push(1),s>1&&l.push(.1),s>2&&l.push(.01)):n>1e3?(l.push(1e3),l.push(100),l.push(10),s>0&&l.push(1),s>1&&l.push(.1),s>2&&l.push(.01),s>3&&l.push(.001)):n>100?(l.push(100),l.push(10),s>0&&l.push(1),s>1&&l.push(.1),s>2&&l.push(.01),s>3&&l.push(.001),s>4&&l.push(1e-4),s>5&&l.push(1e-5)):n>10?(l.push(10),s>0&&l.push(1),s>1&&l.push(.1),s>2&&l.push(.01),s>3&&l.push(.001),s>4&&l.push(1e-4),s>5&&l.push(1e-5),s>6&&l.push(1e-6)):n>1?(s>0&&l.push(1),s>1&&l.push(.1),s>2&&l.push(.01),s>3&&l.push(.001),s>4&&l.push(1e-4),s>5&&l.push(1e-5),s>6&&l.push(1e-6)):n>.1?(s>1&&l.push(.1),s>2&&l.push(.01),s>3&&l.push(.001),s>4&&l.push(1e-4),s>5&&l.push(1e-5),s>6&&l.push(1e-6)):n>.01?(s>2&&l.push(.01),s>3&&l.push(.001),s>4&&l.push(1e-4),s>5&&l.push(1e-5),s>6&&l.push(1e-6)):n>.001?(s>3&&l.push(.001),s>4&&l.push(1e-4),s>5&&l.push(1e-5),s>6&&l.push(1e-6),s>7&&l.push(1e-7)):n>1e-4?(s>4&&l.push(1e-4),s>5&&l.push(1e-5),s>6&&l.push(1e-6),s>7&&l.push(1e-7),s>8&&l.push(1e-8)):n>1e-5&&(s>5&&l.push(1e-5),s>6&&l.push(1e-6),s>7&&l.push(1e-7),s>8&&l.push(1e-8),s>9&&l.push(1e-9)),l}function r(e){const t=(0,i.j)(e);let a=1e10;return t.classBreakInfos.forEach((e=>{a=Math.min(a,c(e.minValue)),a=Math.min(a,c(e.maxValue))})),a}function o(e){let t=1;for(;Math.round(e*t)/t!==e;)t*=10;return Math.log(t)/Math.LN10}function c(e){let t=1e-8;for(;d(Math.round(e/t)*t)===e;)t*=10;return t/10}function d(e){return Number.parseFloat(e.toPrecision(12))}function h(e){let t=0;e.forEach((e=>{(0,s.i)(e.value)?t=Math.max(o(d(e.value)),t):((0,s.i)(e.minValue)&&(t=Math.max(o(d(e.minValue)),t)),(0,s.i)(e.maxValue)&&(t=Math.max(o(d(e.maxValue)),t)),(0,s.i)(e.min)&&(t=Math.max(o(d(e.min)),t)),(0,s.i)(e.max)&&(t=Math.max(o(d(e.max)),t)))})),t=Math.min(t,3);const a=e[0],i=e[e.length-1],n=Math.min(a.minValue??a.min??a.value,i.minValue??i.min??i.value),l=Math.max(a.maxValue??a.max??a.value,i.maxValue??i.max??i.value)-n;return l/e.length<2e-7?t=8:l/e.length<2e-6?t=7:l/e.length<2e-5?t=6:l/e.length<2e-4?t=5:l/e.length<.002?t=4:l/e.length<.02?t=3:l/e.length<.2?t=Math.max(t,2):l/e.length<2&&(t=Math.max(t,1)),Math.round(t)}},14289:(e,t,a)=>{a.d(t,{a:()=>o,b:()=>n,c:()=>d,d:()=>h,e:()=>l,f:()=>r,g:()=>p,h:()=>c});a(68180);var s=a(99592),i=(a(97127),a(76110));async function n(e,t){const{layer:a,mapView:s,modules:i}=e,n=a;return t=t||{},await i.RasterFlowCreator.createRenderer({layer:n,view:s,theme:t.flowTheme||"flow-line",includeColorVariable:t.includeColorVariable,legendOptions:t.legendOptions,flowRepresentation:t.flowRepresentation,flowScheme:t.flowScheme||r(e)}).then((e=>(e.layerEffect&&!e.layerEffect.includes("drop-shadow")&&(n.effect=e.layerEffect),e.renderer.color=e.renderer.color&&(t.color||e.renderer.color),e)))}async function l(e,t){const{layer:a,mapView:i,modules:n}=e,l=a;t=t||{};const o=(0,s.R)(e),c=(0,s.b)(o,"color"),d=o.authoringInfo,h=t.flowTheme||d?.flowTheme||"flow-line";return await n.RasterFlowCreator.createRenderer({layer:l,view:i,theme:h,includeColorVariable:t.includeColorVariable??!!c,legendOptions:t.legendOptions||c?.legendOptions,flowRepresentation:t.flowRepresentation||o.flowRepresentation,flowScheme:t.flowScheme}).then((a=>{const i=(0,s.G)(o,"color"),l=(0,s.G)(a.renderer,"color");i?.minSliderValue&&i?.maxSliderValue&&l&&(l.minSliderValue=i.minSliderValue,l.maxSliderValue=i.maxSliderValue);const c=(0,s.b)((0,s.R)(e),"color"),p=(0,s.b)(a.renderer,"color");c&&p&&c.stops.forEach(((e,t)=>{p.stops[t].value=e.value})),a.renderer.color=a.renderer.color&&(t.color||o.color||a.renderer.color);return(t.flowScheme||r(e))&&c&&p&&c.stops.forEach(((e,t)=>{p.stops[t].color=new n.EsriColor(e.color.toJSON())})),h===d.flowTheme&&(a.renderer.flowSpeed=o.flowSpeed,a.renderer.density=o.density,a.renderer.trailLength=o.trailLength,a.renderer.trailWidth=o.trailWidth,a.renderer.trailCap=o.trailCap),a}))}function r(e){const{mapView:t,modules:a}=e,i=(0,s.R)(e),n=(0,s.b)(i,"color");if(!n)return null;const l=n.stops.map((e=>e.color)),r=a.flowSchemes.getSchemes({basemap:t.map.basemap||"topo"}),o=[r.primaryScheme].concat(r.secondarySchemes),c=[];return o.forEach((e=>{let t=l.some(((t,a)=>!(0,s.a8)(e.colors[a],t)));t?(e.colors=e.colors.reverse(),t=l.some(((t,a)=>!(0,s.a8)(e.colors[a],t))),t||c.push(e)):c.push(e)})),c.length?c[0]:null}async function o(e){const{layer:t,modules:a}=e,i=t,n="imagery"===i.type?i.rasterFunction??void 0:void 0;return await a.RasterVectorFieldCreator.createRenderer({layer:i,rasterFunction:n}).then((t=>(i.effect=void 0,(0,s.Q)(e,t.renderer),t)))}async function c(e,t){const{layer:a,modules:i}=e,n=a,l=(0,s.R)(e),r="imagery"===n.type?n.rasterFunction??void 0:void 0;return t=t||{},await i.RasterVectorFieldCreator.createRenderer({layer:n,rasterFunction:r,style:t.style||l.style}).then((e=>{e.renderer.symbolTileSize=l.symbolTileSize;const t=(0,s.b)(l,"size");return e.renderer.visualVariables=(0,s.V)(e.renderer,"size")||[],e.renderer.visualVariables.push(t),e.renderer.flowRepresentation=l.flowRepresentation,e.renderer.inputUnit=l.inputUnit,e.renderer.outputUnit=l.outputUnit,e}))}async function d(e){const{layer:t,modules:a}=e,s=t,n="imagery"===s.type?s.rasterFunction??void 0:void 0,l=(0,i.c)(e,[[245,245,0],[255,0,0]].map((e=>new a.EsriColor(e))));return await a.RasterClassBreaksCreator.createRenderer({layer:s,rasterFunction:n,colorRamp:l}).then((e=>(e.renderer.classBreakInfos.forEach((e=>e.symbol.outline.width=0)),e)))}async function h(e,t){const{layer:a,modules:i}=e,n=a,l=(0,s.R)(e),r="imagery"===n.type?n.rasterFunction:void 0;return await i.RasterClassBreaksCreator.createRenderer({layer:n,rasterFunction:r,field:t.field||l.field,classificationMethod:t.classificationMethod||l.authoringInfo.classificationMethod,numClasses:t.numClasses||l.classBreakInfos.length,colorRamp:l.authoringInfo.colorRamp,definedInterval:t.definedInterval}).then((e=>(e.renderer.classBreakInfos.forEach((e=>e.symbol.outline.width=0)),e)))}function p(e){const{rasterInfo:t,modules:a,strings:s}=e;let i;const n=t?.attributeTable?.fields;return i=n?n.filter((e=>"oid"!==e.type&&"string"!==e.type)):[new a.Field({name:"value",alias:s.panels.classBreaks.value})],i}}}]);