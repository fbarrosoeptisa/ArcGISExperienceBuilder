/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-4e3ecc.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-4e3ecc"],{99004:(e,r,t)=>{t.d(r,{c:()=>n,g:()=>a});var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t.g?t.g:"undefined"!=typeof self?self:{};function a(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}},23405:(e,r,t)=>{t.r(r),t.d(r,{arcgis_new_item_pages_feature_layer_from_url:()=>f});var n=t(19564),a=t(5011),o=t(4948),i=t(44508),s=t(86868),c=t(18409),l=t(61191),u=t(33861),d=t(98821),m=t(84775);t(57159),t(98034),t(99004),t(65174),t(67336),t(82297),t(5076),t(18991),t(32084),t(91102),t(73807),t(62913),t(17233),t(87382),t(76246),t(748),t(97018),t(56288),t(93863),t(80015),t(24211),t(90079),t(32198);const f=class{constructor(e){(0,n.r)(this,e),this.newItemUpdatePage=(0,n.c)(this,"newItemUpdatePage",7),this.getLayerDetailInfo=async()=>{const{url:e}=this,r=o.c.portal,{result:t}=await(0,a.g)([e],r),n=null==t?void 0:t[0];if(!(null==n?void 0:n.item))return null;const{result:i}=await(0,a.a)({itemId:n.item.id,owningSystemUrl:n.owningSystemUrl});return i},this.url=void 0,this.error=void 0,this.loading=void 0}async componentWillLoad(){this.i18n=u.u.i18n.featureLayerFromUrl,this.commonI18n=u.u.i18n.common,this.url=l.a.serviceInfoUrl}async handleNext(){var e,r,t,n,a;const{url:u,getLayerDetailInfo:f}=this;if(!u)return(0,m.f)("Empty URL"),this.inputRef.setFocus(),void(this.error="missingUrl");const{error:p}=(0,d.g)(u);if(p)return(0,m.f)("Invalid URL"),this.inputRef.setFocus(),void(this.error=p.code);this.loading=!0;const y=u.toLowerCase().indexOf("/featureserver"),v=u.substring(0,y)+"/FeatureServer";try{const{result:d}=await(0,c.F)({url:v});(null==d?void 0:d.isSecured)&&(l.a.checkAuth=!0);const{layers:m,serviceInfo:p,tables:y}=await(0,c.w)(u,(0,i.g)(o.c.portal),!1,null==d?void 0:d.isSecured),h=await f();l.a.layerData=h,l.a.serviceInfo=Object.assign(Object.assign({},p),{layers:m,tables:y});let g=null===(e=p.documentInfo)||void 0===e?void 0:e.title;const w=null!==(r=p.layers)&&void 0!==r?r:[],b=null!==(t=p.tables)&&void 0!==t?t:[];g||(1===w.length&&0===b.length?g=w[0].name:1===b.length&&0===w.length&&(g=b[0].name)),l.a.initialTitle=g,s.i.snippet=null!==(n=p.serviceDescription)&&void 0!==n?n:"",l.a.description=null!==(a=p.description)&&void 0!==a?a:"",l.a.serviceInfoUrl=u,this.loading=!1,this.newItemUpdatePage.emit("featureLayerSummary")}catch(e){(0,m.f)("Service doesn't exist"),this.error="serviceNotExist"}}handleInputChange(e){this.url=e.target.value}render(){const{loading:e,i18n:r,commonI18n:t,error:a,url:i}=this,{title:s,description:c}=r.error[a]||{},{portal:l}=o.c;return(0,n.h)(n.H,{key:"fbe9b7c648ae6c12bdaa7d43dba14ee267b4a956"},(0,n.h)("arcgis-new-item-loader",{key:"44e25c83cb12f80aea5d4f9175b400f260782e66",active:e,text:u.u.i18n.urlType.getServiceInfo}),(0,n.h)("calcite-label",{key:"041050f3c47629f67c53ea3612ee073fda78bca9",class:"label"},(0,n.h)("arcgis-new-item-description",{key:"9e7fca07e3ee5a3a2bd825792e4ab381ddae11a5",header:t.url,content:r.description}),(0,n.h)("calcite-input",{key:"31565ef0f9759531c93059bdeda711e6e40c7e0c",placeholder:l.isPortal?"https://webadaptorhost.domain.com/webadaptorname/rest/services/service/servicetype":"https://myserver.com/arcgis/rest/services/folder/service/FeatureServer",onCalciteInputInput:e=>this.handleInputChange(e),class:"input",scale:"l",ref:e=>this.inputRef=e,value:i})),(0,n.h)("arcgis-new-item-alert",{key:"031b37c1bf35550a0f802648ea250d55beda8be5",heading:s,description:c,active:!!a,onAlertDismiss:()=>this.error=null}))}get el(){return(0,n.d)(this)}};f.style=".input{margin-top:1rem}.label{margin-top:1rem;display:block}"},91102:(e,r,t)=>{t.d(r,{a:()=>c,c:()=>a,d:()=>l,g:()=>o,i:()=>i,s:()=>s});var n=t(73807);function a(e,r){return function e(t){return t?t.closest(r)||e(function(e){return e.getRootNode()}(t).host||null):null}(e)}function o(e){const r=a(e,".calcite-mode-dark, .calcite-mode-light");return(null==r?void 0:r.classList.contains("calcite-mode-dark"))?"dark":"light"}function i(e){let r=e;for(;null==r?void 0:r.parentNode;){if(r.parentNode===document)return!0;r=r.parentNode instanceof ShadowRoot?r.parentNode.host:r.parentNode}return!1}function s(e){return(new n.S).sanitize(e)}function c(e){const r=s(e),t=document.createElement("div");return t.innerHTML=r,t.textContent||t.innerText||""}function l(e){const r=document.createElement("textarea");return r.innerHTML=e,r.value}},84775:(e,r,t)=>{t.d(r,{a:()=>p,b:()=>m,c:()=>v,d:()=>f,e:()=>u,f:()=>y,i:()=>d});var n=t(4948),a=t(61191),o=t(57159),i=t(44508);const s="create feature layer",c="my content",l=e=>{switch(e){case"build":return"blank";case"existing":return"fs";case"template":return"template";case"link":return"url"}},u=e=>{const r=n.c.telemetry;null==r||r.stepWorkflow(s,"enable "+("captureGPS"===e?"gps":"enableZDefaults"===e?"z":"m"),{category:s,attribute:l(a.a.addFeatureLayerType),pageName:c})},d=e=>{const r=n.c.telemetry;null==r||r.stepWorkflow(s,`expand ${e} details`,{category:s,attribute:l(a.a.addFeatureLayerType),pageName:c})},m=()=>{const e=n.c.telemetry;null==e||e.stepWorkflow(s,"filter",{category:s,attribute:l(a.a.addFeatureLayerType),pageName:c})},f=e=>{const r=l(e),t=n.c.telemetry;null==t||t.stepWorkflow(s,"from option",{category:s,attribute:r,pageName:c})},p=()=>{const{addFeatureLayerType:e,serviceInfo:r}=a.a,t=r,o=n.c.telemetry;null==o||o.endWorkflow(s,{category:s,attribute:l(e),pageName:c,count:t.layers.length,number:t.tables.length})},y=e=>{var r;null===(r=n.c.telemetry)||void 0===r||r.logError({category:s,error:e})};async function v(){const e=(0,i.g)().replace("portal/sharing/rest/","server/admin/services/types/customdataproviders/checkcdf");try{return await(0,o.r)(e,"post")}catch(e){return e}}},5011:(e,r,t)=>{t.d(r,{a:()=>g,b:()=>d,c:()=>m,f:()=>u,g:()=>f,l:()=>w});var n=t(57159),a=t(77265),o=t(67336),i=t(98034),s=t(44508),c=t(82297),l=t(5076);const u=async(e,r)=>{const{owningSystemUrl:t}=await(0,n.f)((async()=>(0,c.g)(e)),"portalInfo",e.id);return(await Promise.all(r.map((async e=>{try{const{owningSystemUrl:r}=await(0,c.a)(e);return{owningSystemUrl:r,url:e}}catch(r){return console.error(r),{owningSystemUrl:null,url:e}}})))).filter((({owningSystemUrl:e})=>e===t)).map((({url:e})=>e))};async function d(e,r,t){var a;const{relationshipType:o,direction:i}=t,c=`${(0,s.g)(r)}content/items/${e}/relatedItems`,l=await(0,n.r)(c,{relationshipType:o,direction:i,includeRecycleBin:!0});return(null===(a=null==l?void 0:l.relatedItems)||void 0===a?void 0:a.length)&&(l.relatedItems=l.relatedItems.filter((r=>(null==r?void 0:r.id)!==e))),l}const m=async(e,r,t)=>{const a=!!t,o=(0,s.g)(r),i=a?`${o}/content/groups/${t.id}/search`:`${o}/search`;try{return{result:(await(0,n.r)(i,{filter:`id:(${e.join(" OR ")})`,num:100})).results}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},f=async(e,r)=>{try{const t=[],a=[],o=[];await Promise.all(e.map((async e=>{const{result:i,error:s}=await(0,n.f)((()=>(async(e,r)=>{var t;try{return{result:await(0,l.r)(e,r,{addTokenManually:!1})}}catch(e){const r="token required";return(null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.toLowerCase().includes(r))?{error:{code:"tokenRequired"}}:(console.error(e),{error:{code:"unhandledError"}})}})(e,r)),"itemMetadata",`${e}--no-token`);if("tokenRequired"!==(null==s?void 0:s.code))if(p(i))t.push(y(i,e));else try{const r=await(0,c.a)(e);o.push(Object.assign(Object.assign({},i),{owningSystemUrl:r.owningSystemUrl}))}catch(s){console.warn(s)}else a.push(e)})));const i=await u(r,a),s=(await Promise.all(i.map((async e=>({response:await(0,l.r)(e,r,{addTokenManually:!0}),owningSystemUrl:(await(0,c.a)(e)).owningSystemUrl,url:e}))))).reduce(((e,{response:r,url:n,owningSystemUrl:a})=>p(r)?(t.push(y(r,n)),e):[...e,Object.assign(Object.assign({},r),{owningSystemUrl:a})]),[]),d=await Promise.all([...o,...s].map((async({serviceItemId:e,owningSystemUrl:r})=>{if(!e)return null;const{result:t}=await h({itemId:e,owningSystemUrl:r});return{item:t,owningSystemUrl:r}}))),{result:m}=t.length<=0?{result:[]}:await f(t,r);return{result:[...d.filter((e=>!!e)),...m]}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},p=e=>!!(null==e?void 0:e.sources),y=(e,r)=>{var t;const n=null===(t=Object.values(e.sources)[0])||void 0===t?void 0:t.url;return n?n.includes("..")?(0,s.t)({url:r,path:n}):n:null},v=e=>`${e}/sharing/rest`,h=async({itemId:e,owningSystemUrl:r,requestOptions:t})=>{try{const a=(0,o.g)(e,v(r));return{result:await(0,n.r)(a,{},Object.assign(Object.assign({},t),{addTokenManually:!1}))}}catch(e){return console.error(e),(0,a.a)(e)&&e.message.toLocaleLowerCase().includes("invalid token")?{error:{code:"invalidToken"}}:{error:{code:"unhandledError"}}}},g=async({itemId:e,owningSystemUrl:r,requestOptions:t})=>{try{const a=`${(0,o.g)(e,v(r))}/data`;return{result:await(0,n.r)(a,{},Object.assign(Object.assign({},t),{addTokenManually:!1}))}}catch(e){return console.error(e),{error:{code:"unhandledError"}}}},w=async(e,r)=>{try{const[t]=await(0,i.l)(["esri/portal/PortalItem"]),n=new t({id:e,portal:r});return await n.load(),{result:n}}catch(e){return console.error("Fail to reload item",e),{error:{code:"unhandledError"}}}}},98034:(e,r,t)=>{t.d(r,{e:()=>o,l:()=>i});var n,a=t(99004),o={exports:{}};n=o.exports,a.c,function(e){var r={Promise:"undefined"!=typeof window?window.Promise:void 0},t="4.24",n="next";function a(e){if(e.toLowerCase()===n)return n;var r=e&&e.match(/^(\d)\.(\d+)/);return r&&{major:parseInt(r[1],10),minor:parseInt(r[2],10)}}function o(e){return void 0===e&&(e=t),"https://js.arcgis.com/".concat(e,"/")}function i(e){void 0===e&&(e=t);var r=o(e),i=a(e);if(i!==n&&3===i.major){var s=i.minor<=10?"js/":"";return"".concat(r).concat(s,"esri/css/esri.css")}return"".concat(r,"esri/themes/light/main.css")}function s(e){var r=document.createElement("link");return r.rel="stylesheet",r.href=e,r}function c(e,r){if(r){var t=document.querySelector(r);t.parentNode.insertBefore(e,t)}else document.head.appendChild(e)}function l(e){return document.querySelector('link[href*="'.concat(e,'"]'))}function u(e){return!e||a(e)?i(e):e}function d(e,r){var t=u(e),n=l(t);return n||c(n=s(t),r),n}var m={};function f(e){var r=document.createElement("script");return r.type="text/javascript",r.src=e,r.setAttribute("data-esri-loader","loading"),r}function p(e,r,t){var n;t&&(n=y(e,t));var a=function(){r(e),e.removeEventListener("load",a,!1),n&&e.removeEventListener("error",n,!1)};e.addEventListener("load",a,!1)}function y(e,r){var t=function(n){r(n.error||new Error("There was an error attempting to load ".concat(e.src))),e.removeEventListener("error",t,!1)};return e.addEventListener("error",t,!1),t}function v(e){void 0===e&&(e={}),m=e}function h(){return document.querySelector("script[data-esri-loader]")}function g(){var e=window.require;return e&&e.on}function w(e){void 0===e&&(e={});var t={};[m,e].forEach((function(e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}));var n=t.version,a=t.url||o(n);return new r.Promise((function(e,r){var o=h();if(o){var i=o.getAttribute("src");i!==a?r(new Error("The ArcGIS API for JavaScript is already loaded (".concat(i,")."))):g()?e(o):p(o,e,r)}else if(g())r(new Error("The ArcGIS API for JavaScript is already loaded."));else{var s=t.css;s&&d(!0===s?n:s,t.insertCssBefore),p(o=f(a),(function(){o.setAttribute("data-esri-loader","loaded"),e(o)}),r),document.body.appendChild(o)}}))}function b(e){return new r.Promise((function(r,t){var n=window.require.on("error",t);window.require(e,(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];n.remove(),r(e)}))}))}function S(e,r){if(void 0===r&&(r={}),g())return b(e);var t=h(),n=t&&t.getAttribute("src");return!r.url&&n&&(r.url=n),w(r).then((function(){return b(e)}))}e.utils=r,e.loadModules=S,e.getScript=h,e.isLoaded=g,e.loadScript=w,e.setDefaultOptions=v,e.loadCss=d,Object.defineProperty(e,"__esModule",{value:!0})}(n);const i=async(e,r)=>(await o.exports.loadModules(e,r)).map((e=>e.__esModule&&e.default?e.default:e))},5076:(e,r,t)=>{t.d(r,{r:()=>o});var n=t(57159),a=t(4948);const o=async(e,r,t={})=>{const{body:o,usePost:i,addTokenManually:s,api:c=(null===a.c||void 0===a.c?void 0:a.c.api),customToken:l}=t,u=new URLSearchParams;o&&Object.entries(o).forEach((([e,r])=>{void 0!==r&&u.append(e,r)}));const d=new URL(e);if(d.searchParams.append("f","json"),l)d.searchParams.append("token",l);else{const e=!1===s?null:await(0,n.g)(r,c);e&&d.searchParams.append("token",e)}const m=await fetch(d.toString(),{body:i?u:void 0,method:i?"POST":"GET"}),f=await m.json(),p=f.error;if(p)throw"string"==typeof p?new Error(p):p;return f}}}]);