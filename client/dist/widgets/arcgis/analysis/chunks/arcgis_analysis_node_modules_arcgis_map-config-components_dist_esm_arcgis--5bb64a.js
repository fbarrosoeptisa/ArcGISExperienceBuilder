/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm_arcgis--5bb64a.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm_arcgis--5bb64a"],{39085:(t,e,i)=>{i.r(e),i.d(e,{arcgis_un_ntc_pick_list:()=>n});var s,r=i(28614),a=i(71480),l=i(97127),o=i(50063);!function(t){t.DEFAULT="default",t.DESCRIPTION="description",t.TITLE="title",t.TYPE="type"}(s||(s={}));const n=class{constructor(t){(0,r.r)(this,t),this.arcgisChange=(0,r.c)(this,"arcgisChange",7),this.arcgisNtcPickListChange=(0,r.c)(this,"arcgisNtcPickListChange",7),this.arcgisClose=(0,r.c)(this,"arcgisClose",7),this.arcgisNtcPickListDismissed=(0,r.c)(this,"arcgisNtcPickListDismissed",7),this.manager=(0,l.u)(this),this.strings=(0,o.u)({blocking:!0}),this.errorMessage="",this.namedTraceConfigurations=[],this.namedTraceConfigurationInfos=[],this.utilityNetwork=void 0,this.selectedNTCs=[],this.popoverProps=void 0,this.multipleDisabled=!1,this.multiple=!0,this.showFilterLength=10,this.filterPlaceholderText=void 0,this.hideSort=!1,this.showSort=!0,this.sortBy=s.DEFAULT,this.lastSortBy=s.DEFAULT,this.filterNTCs=[]}async componentWillLoad(){this.multiple||this.multipleDisabled||(this.multipleDisabled=!0),this.showSort||this.hideSort||(this.hideSort=!0),this.NamedTraceConfiguration=await(0,a.b1)(),this.lastSortBy=this.sortBy||this.lastSortBy;try{if(this.namedTraceConfigurations=await this.utilityNetwork.queryNamedTraceConfigurations({}),!this.namedTraceConfigurations.length)return void(this.errorMessage=this.strings.ntcNoTracesFound);this.namedTraceConfigurations.forEach((t=>{this.namedTraceConfigurationInfos.push({id:t.globalId,creationDate:t.creationDate,creator:t.creator,description:t.description,minStartingPoints:t.minStartingPoints,resultTypes:t.resultTypes,tags:t.tags,title:t.title,type:t.traceType})})),this.utilityNetwork.sharedNamedTraceConfigurations.forEach((t=>{this.selectedNTCs.push(t.globalId)}))}catch(t){this.errorMessage=t.message}}async reposition(){this.popoverNode?.reposition()}render(){const{strings:t,popoverProps:e}=this;return(0,r.h)(r.H,{key:"28930fada7ecb6e0a3f9af8b96cb37ff6c5e6cc3",class:"js-app-flyout"},(0,r.h)("calcite-popover",{key:"8532b492f718a05cfec0f4904d2e075f3feeaaeb",class:"popover",placement:e.placement||"leading-start",open:!0,pointerDisabled:!0,referenceElement:e.refElement,offsetDistance:e.offsetDistance||-Math.round(e.refElement.getBoundingClientRect().width),offsetSkidding:e.offsetSkidding||25,label:t.headerSelect,ref:t=>this.popoverNode=t},(0,r.h)("calcite-flow",{key:"d14b1a68cbe2a657531f8123faebfdcfa35d8cea",class:"content",ref:t=>this.flowElement=t,style:{width:`${e.popoverWidth||e.refElement.getBoundingClientRect().width}px`}},(0,r.h)("calcite-flow-item",{key:"d06b8e8f3973c2a2d6b86bf275f73a14eeed8113",class:"panel",heading:t.headerSelect,closable:!0,onCalciteFlowItemClose:()=>{this.arcgisNtcPickListDismissed.emit(),this.arcgisClose.emit()}},""===this.errorMessage?this.renderNtcPickList():this.renderErrorLabel()))))}renderNtcPickList(){const{strings:t}=this;return(0,r.h)("calcite-list",{label:t.ntc,selectionMode:this.multipleDisabled?"single":"multiple",ref:t=>this.listNode=t,filterEnabled:this.namedTraceConfigurationInfos.length>=this.showFilterLength,filterPlaceholder:this.filterPlaceholderText??t.filter,onCalciteListFilter:t=>{t.stopPropagation(),this.filterNTCs=this.listNode.filteredItems?.map((t=>t.value))},onCalciteListChange:()=>{const t=this.listNode.selectedItems.map((t=>t.value)),e=this.selectedNTCs.filter((e=>t.includes(e))),i=t.filter((t=>!this.selectedNTCs.includes(t))),s=[...new Set([...e,...i])];this.selectedNTCs=s,this.emitChange()}},this.namedTraceConfigurationInfos.length>=this.showFilterLength&&!this.hideSort&&this.renderSort(),this.renderSelectionButton(),[...this.getSortedList()].map((t=>this.renderCalciteListItem(t))))}renderErrorLabel(){return(0,r.h)("calcite-label",{class:"label"},this.errorMessage)}renderSort(){const{strings:t}=this;return(0,r.h)("calcite-dropdown",{overlayPositioning:"fixed",slot:"filter-actions-end",placement:"bottom-end"},(0,r.h)("calcite-action",{slot:"trigger",text:t.sort,title:t.sort},(0,r.h)("calcite-icon",{scale:"s",icon:"sortDescending"})),(0,r.h)("calcite-dropdown-group",null,(0,r.h)("calcite-dropdown-item",{selected:this.lastSortBy===s.DEFAULT,onClick:()=>this.lastSortBy=s.DEFAULT},t.default),(0,r.h)("calcite-dropdown-item",{selected:this.lastSortBy===s.TITLE,onClick:()=>this.lastSortBy=s.TITLE},t.name),(0,r.h)("calcite-dropdown-item",{selected:this.lastSortBy===s.TYPE,onClick:()=>this.lastSortBy=s.TYPE},t.type),(0,r.h)("calcite-dropdown-item",{selected:this.lastSortBy===s.DESCRIPTION,onClick:()=>this.lastSortBy=s.DESCRIPTION},t.description)))}renderSelectionButton(){const{strings:t}=this;return(0,r.h)("div",{class:"selection-button-div"},(0,r.h)("calcite-button",{appearance:"transparent",scale:"s",width:"full",onClick:()=>{this.selectDeselect()?this.selectedNTCs=this.filterNTCs?.length?this.selectedNTCs.filter((t=>!this.filterNTCs.includes(t))):[]:this.selectedNTCs=this.filterNTCs?.length?[...new Set([...this.selectedNTCs,...this.filterNTCs])]:this.namedTraceConfigurationInfos.map((t=>t.id)),this.emitChange()}},this.selectDeselect()?t.deselectAll:t.selectAll))}renderCalciteListItem(t){const{strings:e}=this;return(0,r.h)("calcite-list-item",{key:t.id,label:t.title,description:t.description,value:t.id,selected:this.selectedNTCs.includes(t.id),metadata:{id:t.id,title:t.title}},(0,r.h)("calcite-action",{slot:"actions-end",text:e.info,title:e.info,scale:"s",icon:"information",onClick:e=>{e.stopPropagation();const i=document.createElement("calcite-flow-item");i.heading=t.title,i.description=t.description;const s=document.createElement("arcgis-un-ntc-pick-list-info");s.utilityNetwork=this.utilityNetwork,s.ntcId=t.id,s.strings=this.strings,s.classList.add("content"),i.appendChild(s),this.flowElement.appendChild(i),i.setFocus()}}))}getSortedList(){const t=[...this.namedTraceConfigurationInfos];return this.lastSortBy===s.TITLE?t.sort(((t,e)=>t.title.localeCompare(e.title))):this.lastSortBy===s.DESCRIPTION&&t.sort(((t,e)=>t.description.localeCompare(e.description))),this.lastSortBy===s.TYPE&&t.sort(((t,e)=>t.type.localeCompare(e.type))),t}selectDeselect(){return this.filterNTCs?.length?this.filterContainsAll():this.selectedNTCs.length===this.namedTraceConfigurationInfos.length}filterContainsAll(){return this.filterNTCs.every((t=>this.selectedNTCs.some((e=>e===t))))}emitChange(){const{NamedTraceConfiguration:t}=this;this.utilityNetwork.sharedNamedTraceConfigurations=[],this.selectedNTCs.forEach((e=>{const i=this.namedTraceConfigurations.find((t=>t.globalId===e));this.utilityNetwork.sharedNamedTraceConfigurations.push(new t({globalId:i.globalId,title:i.title}))})),this.arcgisNtcPickListChange.emit(this.utilityNetwork.sharedNamedTraceConfigurations),this.arcgisChange.emit(this.utilityNetwork.sharedNamedTraceConfigurations)}static get assetsDirs(){return["assets"]}get el(){return(0,r.g)(this)}};n.style=".popover{--calcite-popover-z-index:100}.panel{min-height:300px}.label{height:-webkit-fill-available;width:-webkit-fill-available;padding:10px}.selection-button-div{padding:4px 10px}.content{max-height:60vh}"},50063:(t,e,i)=>{i.d(e,{u:()=>a});var s=i(97127),r=i(28614);const a=(0,s.m)(r.a)}}]);