/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-file-up-87792c.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-file-up-87792c"],{81914:(e,i,s)=>{s.r(i),s.d(i,{arcgis_file_upload:()=>p});var a=s(19564),t=s(66507),l=s(17233),o=s(97018),r=s(68334),c=s(61191),n=s(4948),d=s(86868),h=s(69058);s(91102),s(73807),s(89261),s(98034),s(99004),s(57159),s(44508),s(65174),s(67336),s(87382),s(18409),s(98821),s(90079),s(32198),s(62913),s(33861),s(18991),s(82297),s(76246),s(748),s(56288),s(93863),s(80015),s(24211),s(78537),s(11163),s(11560),s(63330),s(66484),s(44069),s(32084);const p=class{constructor(e){(0,a.r)(this,e),this.arcgisFileUploadComplete=(0,a.c)(this,"arcgisFileUploadComplete",7),this.arcgisFileUploadCancel=(0,a.c)(this,"arcgisFileUploadCancel",7),this.allowedExtensions=null,this.workflowCompleted=!1,this.closeDialog=()=>{!this.workflowCompleted&&this.handleCancel(),this.workflowCompleted=!1,this.isActive=!1},this.handleCancel=async()=>{this.arcgisFileUploadCancel.emit()},this.portal=void 0,this.existingItem=void 0,this.user=void 0,this.config=void 0,this.api=3,this.isActive=!0,this.header=void 0,this.loading=!1,this.loaderMessage=void 0,this.loaderType="indeterminate",this.error=void 0}async componentWillLoad(){const{existingItem:e,config:i,api:s}=this,a=e.type,l=await(0,t.g)(this.el);this.i18n=l[0],c.a.existingItem=e,c.a.id=e.id,c.a.typeKeywords=e.typeKeywords,c.a.type=e.type,d.i.tags=(0,h.f)(e.tags),d.i.snippet=e.snippet,n.c.config=i,n.c.api=s,"Vector Tile Service"===a&&(this.allowedExtensions=["json"])}handleWorkflowComplete(){this.workflowCompleted=!0,this.isActive=!1}async fileSelectHandler(e){var i;const{existingItem:s}=this;this.sourceName=(null===(i=s.sourceData)||void 0===i?void 0:i.name)||s.name;const a=e.detail.file,t=s.type,l="Vector Tile Service"===t,{fileName:r,extension:n}=(0,o.s)(a);l&&"json"!==n?this.handleError({code:"invalidExtension"}):l||r===this.sourceName?(this.file=a,c.a.file=a,c.a.extension=n,c.a.fileName=r,"Vector Tile Service"===t?this.handleUpdateStyle():this.handleUpdate()):this.handleError({code:"useSameFileName"})}disconnectedCallback(){this.closeDialog()}determineHeader(e,i){const{i18n:s}=this;switch(e){case"Vector Tile Service":return s.editStyle;case"Vector Tile Package":case"Layer Package":case"Tile Package":return s.updatePackages.replace("${type}",e.toLowerCase()).replace("${hostedLayerName}",i);case"Microsoft Powerpoint":case"Microsoft Word":case"PDF":return s.uploadStaticFiles.replace("${fileName}",i);default:return s.sameFileNameDescription.replace("${fileName}",i)}}async handleUpdate(){const{existingItem:e,portal:i,file:s,i18n:a}=this;this.loading=!0,this.loaderMessage=a.updating;const t=await(0,r.u)(e,(0,l.g)({username:e.owner},i),{file:s,overwrite:!0,keepDescription:!0,fileName:e.name});t.success?this.arcgisFileUploadComplete.emit({success:t.success}):this.handleError({code:"unhandledError"})}async handleUpdateStyle(){const{existingItem:e,portal:i,file:s,i18n:a}=this;this.loading=!0,this.loaderMessage=a.updating;const t=!e.hasOwnProperty("hasResources")||e.hasResources,{result:o,error:c}=t?await(0,r.a)(this.existingItem,(0,l.g)({username:e.owner},i),{file:s}):await(0,r.b)(this.existingItem,(0,l.g)({username:e.owner},i),{file:s});o.success&&this.arcgisFileUploadComplete.emit({success:o.success}),c&&this.handleError({code:c.code})}async handleError(e){const{i18n:i}=this;this.loading=!1;let s=i.errors.errorWhileUpload;switch(e.code){case"invalidExtension":s=i.errors.invalidStyleFileExtension;case"useSameFileName":s=i.errors.sameFileName.replace("${fileName}",this.sourceName);break;case"unhandledError":s=i.errors.errorUpdate}this.error={title:i.error,description:s}}render(){const{loaderType:e,loading:i,loaderMessage:s,error:t,allowedExtensions:l,isActive:o,portal:r,config:c,user:n,existingItem:d,i18n:h}=this,p=this.header||this.determineHeader(d.type,d.name);return(0,a.h)(a.H,{key:"4274cfe425fa8b3f21ab2af79121664988dd8806"},(0,a.h)("calcite-dialog",{key:"80e226447d1415499507b0519998e5b52702103e",open:o,modal:!0,heading:h.updateData,onCalciteDialogClose:this.closeDialog},(0,a.h)("arcgis-new-item-loader",{key:"edf6413ab61247922dbe4c4e4caa14073372fbfd",type:e,active:i,text:s}),(0,a.h)("arcgis-new-item-description",{key:"9c8a631bc9d3c44ab942e07cc26385b6f30d602f",header:p}),(0,a.h)("arcgis-file-browser",{key:"7c5ce2fbf9eba57cf97a2a9f0abb0956c1dced04",class:"arcgis-file-browser",cloud:!1,insideModal:!0,fullHeight:!0,portal:r,config:c,user:n,allowedExtensions:l}),(0,a.h)("calcite-alert",{key:"09eba4908a317459522140af068dca05d585a739",icon:"exclamation-mark-triangle",open:!!t,label:null==t?void 0:t.title,kind:"danger",slot:"alerts"},(0,a.h)("div",{key:"128ad87e41106a2142a2b56d68b507dce832c2e4",slot:"title"},null==t?void 0:t.title),(null==t?void 0:t.description)&&(0,a.h)("div",{key:"391fc1c809a941828c62028c5926993f069b4478",slot:"message",class:"description"},t.description),(null==t?void 0:t.link)&&(0,a.h)("calcite-link",{key:"ff637f0f0233cfc3dc7afc54edb8dcd47d639377",slot:"link",class:"link",href:t.link.href,target:"_blank"},t.link.title)),(0,a.h)("calcite-button",{key:"fe7e1812f9c978e1b2876adda4d646d724b1a320",slot:"footer-end",appearance:"outline-fill",onClick:()=>{this.isActive=!1}},h.cancel)))}get el(){return(0,a.d)(this)}}}}]);