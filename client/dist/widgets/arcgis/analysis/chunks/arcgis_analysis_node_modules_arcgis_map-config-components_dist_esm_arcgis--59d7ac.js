/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm_arcgis--59d7ac.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm_arcgis--59d7ac"],{14532:(e,i,t)=>{t.r(i),t.d(i,{arcgis_symbol_order:()=>a});var s,n,o=t(28614),d=t(97127),r=t(50063),l=t(71480);!function(e){e.Ascending="sort-ascending-arrow",e.Descending="sort-descending-arrow"}(s||(s={})),function(e){e.AscendingDate="sortLeastRecent",e.AscendingNumber="smallToLarge",e.DescendingDate="sortMostRecent",e.DescendingNumber="largeToSmall"}(n||(n={}));const a=class{constructor(e){(0,o.r)(this,e),this.arcgisSymbolOrderChange=(0,o.c)(this,"arcgisSymbolOrderChange",7),this.arcgisChange=(0,o.c)(this,"arcgisChange",7),this.manager=(0,d.u)(this),this.infoString="",this.strings=(0,r.u)({blocking:!0}),this.fieldPickListChanges=e=>{e.stopPropagation();const i=e.detail?.selectedFields?.[0];i&&i!==this.selectedField.name&&(this.selectedField=i!==this.getRendererFieldName()?this.toPickListFieldInfo(this.findField(i)):this.getRendererFieldInfo()),this.onHideFieldPickList()},this.view=void 0,this.layer=void 0,this.open=!0,this.closedOnLoad=!1,this.disabled=!1,this.placement="auto",this.fieldTypes=["integer","small-integer","big-integer","single","double","long","date"],this.ascending=!1,this.selectedField=void 0}async componentWillLoad(){this.open||this.closedOnLoad||(this.closedOnLoad=!0);const{layer:e,pickListFields:i}=this,{type:t}=e;this.infoString="catalog"===t?this.strings.orderByTooltipCatalogLayer:this.strings.orderByTooltip;const s=i||this.createPickListFields();if("catalog"!==t&&this.isRendererOrder())this.selectedField=this.getRendererFieldInfo();else{const{orderBy:i}=e,t=Array.isArray(i)?i[0]:i;this.ascending="ascending"===t?.order,this.orderByField=t?.field||this.findOIDField(s)?.name||s[0].name;const n=this.orderByField;this.selectedField=this.toPickListFieldInfo(this.findField(n))}}async componentDidLoad(){this.intl=await(0,l.al)(),this.intl.setLocale(this.strings._t9nLocale),this.tooltipNode&&this.sortActionNode&&(this.tooltipNode.referenceElement=this.sortActionNode)}disconnectedCallback(){this.destroyFieldsPickList()}async done(){this.disableContainer(!1),this.destroyFieldsPickList()}render(){const{strings:e,closedOnLoad:i,disabled:t,layer:s}=this,{type:n}=s,d="catalog"===n?e.headingCatalogLayer:e.heading;return(0,o.h)(o.H,{key:"376e3fc6f75b578dae304fba5a974021d66534f2"},(0,o.h)("calcite-block",{key:"1fc4d9c2cfca8d9b2ea8a7766ec282e3f66a195e",heading:d,collapsible:!0,disabled:t,open:!i&&!t},(0,o.h)("p",{key:"22b55ce5473b6812c8d69585cf77972e2d91d670",class:"information"},this.infoString),this.renderFieldSelectionButton()),(0,o.h)("calcite-tooltip",{key:"fbf4f16940e7ec8493de775e6075326b2d1cb54c","reference-element":this.sortActionNode,placement:"bottom-start",ref:e=>{e&&(this.tooltipNode=e)}},this.getSortDirectionTooltip()))}renderFieldSelectionButton(){const{selectedField:e,strings:i}=this,t=this.createPickListFields();return(0,o.h)(o.F,null,(0,o.h)("calcite-label",{class:"button-label"},i.orderBy," "),(0,o.h)("div",{class:"field-selection"},(0,o.h)("calcite-button",{class:"field-selection-button",key:"selected-field-button",appearance:"outline-fill",kind:"neutral",width:"full",alignment:"icon-end-space-between",disabled:t.length<=1,iconEnd:"chevron-down",onClick:e=>this.onShowFieldPickList(e),ref:e=>{e&&(this.fieldSelectionNode=e)}},e?.alias||t[0].alias),(0,o.h)("calcite-action",{class:"sort-button",appearance:"transparent",icon:this.getSortDirectionIcon(),onClick:e=>this.onToggleSortDirection(e),onMouseOver:()=>this.onShowTooltip(!0),onMouseOut:()=>this.onShowTooltip(!1),text:this.infoString,disabled:"oid"===e.type||"renderer"===e.type,ref:e=>{e&&(this.sortActionNode=e)}})))}onChange(){const e=this.getValue(),i="renderer"===e;if(this.layer.orderBy=i?void 0:e,"feature"===this.layer.type){this.layer.renderer.orderByClassesEnabled=i||void 0}this.arcgisSymbolOrderChange.emit(),this.arcgisChange.emit()}async onShowFieldPickList(e){e.stopPropagation(),this.disableContainer(!0),this.createFieldPickList()}async onHideFieldPickList(){this.disableContainer(!1),this.destroyFieldsPickList(),await(this.fieldSelectionNode?.setFocus()),this.onChange()}onToggleSortDirection(e){e.stopPropagation(),this.ascending=!this.ascending,this.onChange()}onShowTooltip(e){this.tooltipNode&&(this.tooltipNode.open=e)}createFieldPickList(){const{layer:e,pickListFields:i,view:t,strings:s}=this,n=i||this.createPickListFields(),o=this.fieldSelectionNode,d=this.createPopoverProps(o),r=this.selectedField||(this.isRendererOrder()?this.getRendererFieldInfo():n[0]);this.fieldPickList=document.createElement("arcgis-field-pick-list");const l=this.fieldPickList;return l.heading=s.orderBy,l.multiple=!1,l.showFieldInfo=!1,l.showFieldName=!0,l.mapView=t,l.layer=e,l.fields=n,l.selectedFields=[r.name],l.popoverProps=d,l.addEventListener("arcgisFieldPickListDismissed",this.fieldPickListChanges),document.body.appendChild(l),l}destroyFieldsPickList(){this.fieldPickList&&(document.body.removeChild(this.fieldPickList),this.fieldPickList=void 0)}createPopoverProps(e){return{placement:this.placement||"auto",offsetDistance:5,offsetSkidding:0,pointerDisabled:!0,popoverWidth:this.getPopoverWidth(),refElement:e}}createPickListFields(){let{pickListFields:e}=this;if(!e){const{layer:i,fieldTypes:t}=this,s=i.fields;this.pickListFields=s.filter((e=>t.includes(e?.type))).map((e=>this.toPickListFieldInfo(e))),e=this.pickListFields;const n=this.getOIDField();if(n){const i=this.toPickListFieldInfo(n);e.unshift(i)}if(this.hasTypesOrPredominanceRenderer()){const i=this.getRendererFieldInfo();e.unshift(i)}}return e}toPickListFieldInfo(e){return{name:e.name,hideFieldName:"oid"===e.type,alias:this.getFieldAlias(e),type:e.type}}getPopoverWidth(){return this.el.getBoundingClientRect().width+30||280}getFieldAlias(e){const{strings:i}=this;if("oid"===e.type)return i.defaultDataOrder;{const i=this.findFieldInfoFromPopup(e);return i?.label||e.alias||e.name}}findFieldInfoFromPopup(e){const{popupTemplate:i}=this.layer,t=i?.fieldInfos;return(t||[]).find((i=>i.fieldName===e.name))}getOIDField(){const{layer:e}=this;return e.fields.find((i=>i.name===e.objectIdField||"oid"===i.type))}findOIDField(e){const{layer:i}=this;return e.find((e=>e.name===i.objectIdField||"oid"===e.type))}findField(e){const{layer:i}=this,t=i.fields;return t.find((i=>i.name===e))||t[0]}getSortDirectionIcon(){return this.ascending?s.Ascending:s.Descending}getSortDirectionTooltip(){const{ascending:e,selectedField:i,strings:t}=this,s=i?.type;let o="sortLeastRecent";return o="date"===s?e?n.AscendingDate:n.DescendingDate:e?n.AscendingNumber:n.DescendingNumber,t[o]}hasTypesOrPredominanceRenderer(){const{layer:e}=this,{renderer:i}=e;return!!i&&("unique-value"===i?.type&&(!i?.authoringInfo?.type||"predominance"===i?.authoringInfo?.type))}isRendererOrder(){const{layer:e}=this,{renderer:i}=e;return!!i&&(this.hasTypesOrPredominanceRenderer()&&!0===i?.orderByClassesEnabled)}getRendererFieldName(){const{layer:e}=this,{renderer:i}=e;return i&&this.hasTypesOrPredominanceRenderer()&&(i.field||i.valueExpressionTitle)||null}getRendererFieldInfo(){return{name:this.getRendererFieldName(),alias:this.strings.styleOrder,type:"renderer"}}disableContainer(e){const i=this.el.closest("calcite-flow-item");i&&(i.disabled=e)}getValue(){const{selectedField:e}=this;return"oid"===e.type?null:"renderer"===e.type?"renderer":[{order:this.ascending?"ascending":"descending",field:this.selectedField.name}]}static get assetsDirs(){return["assets"]}get el(){return(0,o.g)(this)}};a.style=".button-label{--calcite-label-margin-bottom:2px}.field-selection{display:flex;gap:0.5rem}.field-selection-button{min-width:0px;align-self:center}.infoPopover{width:340px;font-size:12px}.information{margin:0 0 1em 0}"},50063:(e,i,t)=>{t.d(i,{u:()=>o});var s=t(97127),n=t(28614);const o=(0,s.m)(n.a)}}]);