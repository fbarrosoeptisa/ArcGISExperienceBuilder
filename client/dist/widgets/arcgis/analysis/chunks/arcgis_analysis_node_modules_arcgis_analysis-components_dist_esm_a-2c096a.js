"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_a-2c096a"],{16432:(e,t,i)=>{i.r(t),i.d(t,{analysis_areal_unit_input:()=>x,analysis_boolean_input:()=>o.A,analysis_chip_group:()=>o.a,analysis_data_file_input:()=>o.b,analysis_dataset_input:()=>o.o,analysis_dataset_input_popover:()=>F,analysis_date_input:()=>o.c,analysis_field_input:()=>o.d,analysis_field_select:()=>o.e,analysis_folder_input:()=>O,analysis_geoenrichment_databrowser:()=>o.g,analysis_geoenrichment_input:()=>o.f,analysis_help_popover:()=>o.t,analysis_item_input:()=>o.h,analysis_layer_input:()=>o.l,analysis_layer_input_popover:()=>q,analysis_linear_unit_input:()=>o.i,analysis_number_input:()=>o.n,analysis_overwrite:()=>qc,analysis_query_builder:()=>o.x,analysis_query_input:()=>o.v,analysis_query_modal:()=>o.w,analysis_sketch:()=>Qc,analysis_spatial_reference_input:()=>o.r,analysis_spatial_reference_selector:()=>o.q,analysis_string_input:()=>o.j,analysis_summary_fields:()=>o.m,analysis_summary_fields_popover:()=>id,analysis_traffic_time_input:()=>o.k,analysis_tree:()=>o.p,analysis_unsupported_input:()=>o.u,analysis_workflow_select:()=>o.s,analysis_workflow_select_popover:()=>sd});var s,a,r=i(12064),n=i(22069),o=i(45218),l=i(46784),h=i(74449),c=i(64872),d=i(32513),u=i(588),p=i(44345),m=(i(55448),i(18423),i(91813),i(21255),i(54312),i(34031),i(9316),i(61320),i(64016),i(56451),i(6550)),y=(i(2924),i(5258),i(52373),i(33752)),v=(i(53976),i(49403),i(77462),i(23054),i(73645),i(12762)),g=(i(82567),i(28927)),f=i(35970),b=i(5933),w=(i(57295),i(5294),i(13661),i(35431),i(11840),i(440),i(66744),i(23795),i(17902),i(71802));i(36596),i(72349),i(89962),i(97703),i(43284),i(22741),i(86312),i(87192),i(46033);function C(e,t,i,s){for(var a=-1,r=null==e?0:e.length;++a<r;){var n=e[a];t(s,n,i(n),e)}return s}e=i.hmd(e);const k=(s=function(e,t){return e&&(0,h.b)(e,t,c.p)},function(e,t){if(null==e)return e;if(!(0,c.b)(e))return s(e,t);for(var i=e.length,r=a?i:-1,n=Object(e);(a?r--:++r<i)&&!1!==t(n[r],r,n););return e});function S(e,t,i,s){return k(e,(function(e,a,r){t(s,e,i(e),r)})),s}var L,_,I=(L=function(e,t,i){e[i?0:1].push(t)},_=function(){return[[],[]]},function(e,t){var i=(0,c.g)(e)?C:S,s=_?_():{};return i(e,L,(0,h.c)(t),s)});const M=I,x=class{constructor(e){(0,r.r)(this,e),this.analysisArealUnitInputChange=(0,r.c)(this,"analysisArealUnitInputChange",7),this.analysisHelpClick=(0,r.c)(this,"analysisHelpClick",7),this.areaChange=e=>{const t=e?.target,i=t?.value,s=this.value?.units;void 0===t||Array.isArray(i)||"multi"===(e?.target).selectionMode||(void 0!==i?(this.value={units:s,area:i},this.onUnitChoiceListChange()):this.value=void 0,this.analysisArealUnitInputChange.emit())},this.unitChanged=e=>{const t=e?.target;this.value={area:this.value?.area,units:t?.value},this.validate(),void 0!==this.value?.area&&this.analysisArealUnitInputChange.emit()},this.value=void 0,this.label=void 0,this.required=!1,this.minimum=void 0,this.excludeMinValue=void 0,this.maximum=void 0,this.excludeMaxValue=void 0,this.areaChoiceList=void 0,this.unitChoiceList=void 0,this.choiceListLabels=void 0,this.placeholderText=void 0,this.hideHelp=!1,this.isValid=!0}onUnitChoiceListChange(){const e=this.value?.units;void 0===this.unitChoiceList||void 0!==e&&this.unitChoiceList.includes(e)||(this.value={area:this.value?.area,units:this.unitChoiceList[0]})}async componentWillLoad(){({strings:this.strings,dir:this.dir}=await(0,n.d)(this.hostElement,(0,r.a)("."))),this.onUnitChoiceListChange()}async checkValidity(){return await this.validate(),Promise.resolve(this.isValid)}async validate(){const e=this.hostElement.shadowRoot?.querySelector("analysis-number-input"),t=await(e?.checkValidity())??!1,i=!this.required||void 0!==this.value?.units&&this.unitChoiceList?.includes(this.value?.units);return this.isValid=t&&i,Promise.resolve()}render(){return void 0!==this.value?.units&&(void 0===this.unitChoiceList||this.unitChoiceList.includes(this.value?.units)||(this.unitChoiceList=[...this.value?.units,...this.unitChoiceList])),(0,r.h)(r.H,{key:"4e3e2ec64f55b225ee863d18bc1ce21fe3326219"},(0,r.h)(o.y,{key:"354a468f3c7e65521c97a66023c5f08643aeeccd",label:this.label,required:this.required,value:this.value,minimum:this.minimum,maximum:this.maximum,excludeMinValue:this.excludeMinValue,excludeMaxValue:this.excludeMaxValue,placeholderText:this.placeholderText,strings:this.strings,dir:this.dir,unitChoiceList:this.unitChoiceList,hideHelp:this.hideHelp??!0,amountChoiceList:this.areaChoiceList,amountChange:this.areaChange,unitChanged:this.unitChanged,analysisHelpClick:this.analysisHelpClick,choiceListLabels:this.choiceListLabels,scale:n.U.Scale}))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,r.g)(this)}static get watchers(){return{unitChoiceList:["onUnitChoiceListChange"]}}};x.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex;flex-direction:column;--calcite-color-border-input:var(--analysis-ui-border-input)}.controls-container{display:flex;column-gap:5%}.control{flex:1 1 0}.text{cursor:pointer;padding-bottom:var(--analysis-quarter-spacing);margin-block-start:0;margin-block-end:0}.unit-select{margin-bottom:var(--analysis-half-spacing)}";const E="analysis-popover",T="popover-content",P="js-app-flyout",A="list-item",F=class{constructor(e){(0,r.r)(this,e),this.analysisDatasetInputPopoverClose=(0,r.c)(this,"analysisDatasetInputPopoverClose",7),this.analysisDatasetInputPopoverSelectionChange=(0,r.c)(this,"analysisDatasetInputPopoverSelectionChange",7),this.buildListItem=e=>(0,r.h)("calcite-list-item",{class:A,key:e.id,value:e.id,label:e.name,description:e.description,selected:void 0!==this.selectedDatasetIds&&this.selectedDatasetIds.includes(e.id)}),this.onListChange=()=>{const e=this.list?.selectedItems.map((e=>e.value));this.analysisDatasetInputPopoverSelectionChange.emit({selectedDatasetIds:e}),"multiple"!==this.selectionMode&&(this.open=!1)},this.analysisDatasets=void 0,this.selectionMode=void 0,this.referenceElement=void 0,this.placement="auto",this.open=void 0,this.selectedDatasetIds=void 0,this.popoverWidth=void 0}async componentWillLoad(){({strings:this.strings}=await(0,n.d)(this.hostElement,(0,r.a)(".")))}componentDidLoad(){setTimeout((()=>requestAnimationFrame((()=>this.popoverElement?.setFocus?.()))),1),setTimeout((()=>{this.popoverElement?.reposition?.()}),n.U.PopoverTimer)}async reposition(){await(this.popoverElement?.reposition?.())}render(){const e=this.popoverWidth??this.referenceElement?.getBoundingClientRect().width;return(0,r.h)(r.H,{key:"1b3f663f713620a00a75978d052c1fb2074c4be6",class:`${E} ${P}`},(0,r.h)("calcite-popover",{key:"b2dce680b2eb009a2652b8a9fe947dd6815d55e1",ref:e=>{this.popoverElement=e},autoClose:!0,referenceElement:this.referenceElement??"analysis-dataset-input",placement:this.placement,open:this.open,closable:!0,heading:this.strings.heading,label:this.strings.heading,focusTrapDisabled:!0,onCalcitePopoverClose:()=>this.analysisDatasetInputPopoverClose.emit()},(0,r.h)("calcite-panel",{key:"f8831de7634ffd3d0304612bae0ee0277b105f6c"},(0,r.h)("calcite-list",{key:"850638d814ac12059644aa4a069da8b4e85b3ea6",class:T,label:"",selectionMode:this.selectionMode,onCalciteListChange:this.onListChange,filterEnabled:!0,style:{width:void 0!==e?`${e}px`:void 0,maxWidth:n.U.MaxPopoverWidth},ref:e=>{this.list=e}},this.analysisDatasets?.map(this.buildListItem)))))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,r.g)(this)}};F.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex;--calcite-popover-z-index:var(--analysis-popover-z-index)}.popover-content{height:var(--analysis-popover-content-height)}.list-item{--calcite-font-size--1:var(--calcite-font-size--2)}";const O=class{constructor(e){(0,r.r)(this,e),this.analysisFolderInputChange=(0,r.c)(this,"analysisFolderInputChange",6),this.analysisHelpClick=(0,r.c)(this,"analysisHelpClick",7),this.validate=async()=>!0===await this.folderPicker.saveActiveFolder(),this.folderSelect=e=>{const t=e.detail.id;this.value=(t===this.user.username?"":t)??"",this.analysisFolderInputChange.emit(this.value)},this.setDefaultFolder=()=>{const e=this.folderPicker.folders.find((e=>e.id===this.value));this.folderPicker.folder=void 0!==e?e:{id:this.folderPicker.folders[0]?.id}},this.setRef=e=>{(0,n.F)(e)&&(this.folderPicker=e)},this.value=void 0,this.user=void 0,this.label=void 0,this.hideHelp=!1,this.disabled=!1}async checkValidity(){return await this.validate()}render(){return(0,r.h)(r.H,{key:"68c13d2e32d0995cfcff353bf63148c39af4c4fc"},void 0!==this.label&&""!==this.label?(0,r.h)("analysis-label",{label:this.label,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit(),hideHelp:this.hideHelp}):null,(0,r.h)("arcgis-folder-picker",{key:this.value,ref:this.setRef,api:4,user:this.user,disabled:this.disabled,portal:this.user.portal,scale:n.U.Scale,label:"",onArcgisFolderPickerLoad:this.setDefaultFolder,onArcgisFolderPickerChange:e=>this.folderSelect(e)}))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,r.g)(this)}};O.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{--calcite-color-border-input:var(--analysis-ui-border-input)}";const D="analysis-popover",$="js-app-flyout",B="popover-content",j="half-margin",V="list-message",R="layers-list",q=class{constructor(e){(0,r.r)(this,e),this.analysisLayerInputPopoverClose=(0,r.c)(this,"analysisLayerInputPopoverClose",7),this.analysisLayerInputPopoverSelectionChange=(0,r.c)(this,"analysisLayerInputPopoverSelectionChange",7),this.analysisLayerInputPopoverLayerBrowsed=(0,r.c)(this,"analysisLayerInputPopoverLayerBrowsed",7),this.analysisLayerInputPopoverConfirm=(0,r.c)(this,"analysisLayerInputPopoverConfirm",7),this.checkForMatchingLayer=()=>{this.calciteFilterSearchTerm=this.listElement?.filterText,this.noSearchedLayersMessageActive=0===this.listElement?.filteredItems?.length&&0!==this.listElement?.filterText.length},this.buildListItem=e=>{let t=e;return(0,n.n)(e)&&(t=(0,n.I)(e)),(0,r.h)("calcite-list-item",{class:R,key:e.id,value:e.id,label:(0,n.B)(e),description:(0,n.n)(e)&&!(0,l.c)(e.id)?(0,n.aq)(t)?this.strings.table:this.strings[e.geometryType]:"",selected:void 0!==this.selectedLayerIds&&this.selectedLayerIds.includes(e.id),onClick:this.onListChange,"data-layer-title":e.title})},this.openItemBrowser=()=>{this.itemBrowserElement?.remove(),this.itemBrowserElement=document.createElement("analysis-item-browser"),this.itemBrowserElement.header=this.strings.heading,this.itemBrowserElement.hideAddToMap=this.hideAddToMap,this.itemBrowserElement.filter=this.itemBrowserFilter,this.itemBrowserElement.q=this.itemBrowserQ,this.itemBrowserElement.allowedGeometries=this.itemBrowserAllowedGeometries,this.itemBrowserElement.layerFilterType=this.layerFilterType,this.itemBrowserElement.portal=this.portal,this.itemBrowserElement.bucketOptions=this.bucketOptions,this.itemBrowserElement.user=this.user,this.itemBrowserElement.viewIsSceneView=(0,l.v)(this.mapView),this.itemBrowserElement.selectionMode="multi"!==this.selectionMode?"single-sublayer":"multiple-sublayer",this.itemBrowserElement.addEventListener("analysisItemBrowserClose",this.closeModals),this.itemBrowserElement.addEventListener("analysisItemBrowserAddToMap",this.handleItemBrowserAddToMap),this.itemBrowserElement.addEventListener("analysisItemBrowserSelection",this.handleItemBrowserSelection),this.popoverElement.autoClose=!1,this.popoverElement.hidden=!0,document.body.appendChild(this.itemBrowserElement)},this.closeModals=()=>{this.popoverElement.autoClose=!0,this.popoverElement.hidden=!1,void 0!==this.itemBrowserElement&&(this.itemBrowserElement.removeEventListener("analysisItemBrowserClose",this.closeModals),this.itemBrowserElement.removeEventListener("analysisItemBrowserAddToMap",this.handleItemBrowserAddToMap),this.itemBrowserElement.removeEventListener("analysisItemBrowserSelection",this.handleItemBrowserSelection),this.itemBrowserElement.remove(),this.itemBrowserElement=void 0)},this.addLayersToMap=(e,t)=>{const i=M(t,(e=>(0,n.aq)(e))),s=i[1].map((e=>(0,n.n)(e)?(0,n.I)(e):e));e.addMany(s),e.tables.addMany(i[0])},this.handleItemBrowserAddToMap=e=>{this.addLayersToMap(this.mapView.map,e.detail),this.analysisLayerInputPopoverLayerBrowsed.emit(e.detail),this.open=!1},this.handleItemBrowserSelection=e=>{this.analysisLayerInputPopoverLayerBrowsed.emit(e.detail),this.open=!1},this.onListChange=()=>{const e=this.listElement?.selectedItems;this.analysisLayerInputPopoverSelectionChange.emit(e?.map((e=>e.value))),"multi"!==this.selectionMode&&(this.open=!1)},this.onConfirm=()=>{const e=this.listElement?.selectedItems??[];this.analysisLayerInputPopoverConfirm.emit(e?.map((e=>e.value))),this.open=!1},this.hideAddToMap=!1,this.mapLayers=void 0,this.modelVariableLayers=void 0,this.analysisSessionLayers=[],this.hideBrowseButton=!1,this.showNoticeMessage=!1,this.noticeMessage=void 0,this.selectionMode=void 0,this.referenceElement=void 0,this.placement="auto",this.open=void 0,this.selectedLayerIds=void 0,this.popoverWidth=void 0,this.user=void 0,this.portal=void 0,this.mapView=void 0,this.itemBrowserAllowedGeometries=void 0,this.itemBrowserFilter="",this.itemBrowserQ="",this.heading=void 0,this.pointerDisabled=!1,this.maxHeight=void 0,this.layerFilterType=void 0,this.noSearchedLayersMessageActive=!1,this.calciteFilterSearchTerm=void 0}get bucketOptions(){const e=["my","favorites","group","org","all"];if(!0!==this.portal.isPortal||this.portal.sourceJSON.portalDeploymentType!==n.av.Kubernetes){const t=this.isImageryLayerBrowser();e.splice(4,0,t?"living atlas":"living atlas analysis")}return e}isImageryLayerBrowser(){const e=Array.isArray(this.layerFilterType)?this.layerFilterType:[this.layerFilterType];return e?.map((e=>!!e&&e.indexOf("imagery")>-1)).includes(!0)}async componentWillLoad(){({strings:this.strings,dir:this.dir}=await(0,n.d)(this.hostElement,(0,r.a)(".")))}componentDidLoad(){this.focusTimeoutId=setTimeout((async()=>{await(this.listElement?.setFocus?.())}),n.U.PopoverTimer),setTimeout((()=>{this.popoverElement?.reposition?.()}),n.U.PopoverTimer)}disconnectedCallback(){void 0!==this.focusTimeoutId&&clearTimeout(this.focusTimeoutId),this.closeModals()}async reposition(){await(this.popoverElement?.reposition?.())}render(){const e=this.popoverWidth??this.referenceElement?.getBoundingClientRect().width,t=(0,n.a)(this.strings.noMatchesFound,{searchTerm:this.calciteFilterSearchTerm??""}),i=0===this.analysisSessionLayers?.length&&0===this.mapLayers?.length&&(void 0===this.modelVariableLayers||0===this.modelVariableLayers?.length),s=!0===this.hideBrowseButton;return(0,r.h)(r.H,{key:"7400660f099e9a9cdabb14f5f2c961a229e0b112",dir:this.dir,class:`${D} ${$}`},(0,r.h)("calcite-popover",{key:"0e2e51511a9e83b5238bf4cdd0e94a014b2f1c1c",ref:e=>{this.popoverElement=e},autoClose:!0,closable:!0,heading:this.heading??this.strings.heading,referenceElement:this.referenceElement??"analysis-layer-input",placement:this.placement,open:this.open,label:"",focusTrapDisabled:!0,pointerDisabled:this.pointerDisabled,onCalcitePopoverClose:()=>this.analysisLayerInputPopoverClose.emit()},(0,r.h)("calcite-panel",{key:"89ede9ec4ae6038df6c8821a93e38bc732a0488d",style:{maxHeight:void 0!==this.maxHeight?this.maxHeight-50+"px":void 0}},(0,r.h)("calcite-list",{key:"adfd7333b6ccad0300722e850b834c5e13f91ceb",class:B,label:"",selectionMode:"multi"===this.selectionMode?"multiple":"single",filterEnabled:!0,ref:e=>{this.listElement=e},style:{width:void 0!==e?`${e}px`:void 0,maxWidth:n.U.MaxPopoverWidth},onCalciteListFilter:this.checkForMatchingLayer},(0,r.h)("calcite-notice",{key:"b47cabbdfcb87bb377f6c45e8f8ebfb51a27930f",open:this.showNoticeMessage,class:this.showNoticeMessage?j:"",kind:"warning",scale:n.U.Scale},(0,r.h)("div",{key:"78e1b08c9b78a00dcad2a7c7178ba645a72f90ee",slot:"message"},Array.from(new Set(this.noticeMessage))?.map((e=>(0,r.h)("p",{innerHTML:e}))))),this.noSearchedLayersMessageActive&&(0,r.h)("p",{key:"cfe8d5aa5360db52d732ad3a24291d48bac57b70",class:V},t),i&&!1===this.noSearchedLayersMessageActive?(0,r.h)("p",{class:V},this.strings.noCompatibleLayers):(0,r.h)("div",null,(0,r.h)("calcite-list-item-group",{heading:this.strings.analysisSessionLayers,hidden:0===this.analysisSessionLayers?.length},(this.analysisSessionLayers??[]).map((e=>this.buildListItem(e)))),(0,r.h)("calcite-list-item-group",{heading:this.strings.mapLayers,hidden:0===this.mapLayers?.length},(this.mapLayers??[]).map((e=>this.buildListItem(e)))),(this.modelVariableLayers?.length??0)>0&&(0,r.h)("calcite-list-item-group",{heading:this.strings.modelVariableLayers},(this.modelVariableLayers??[]).map((e=>this.buildListItem(e)))))),!s&&(0,r.h)("calcite-button",{key:"2a29938b640a1f64d5d082b641508410419c5de3",slot:"footer-actions",appearance:"transparent",width:"full",onClick:this.openItemBrowser},this.strings.browseAnalysisLayers),s&&(0,r.h)(r.F,{key:"6b12d8f75ccc20cff8952d90f4c1f706bf27619a"},(0,r.h)("calcite-button",{key:"75cdff107caae32404b1b71bad23ae59c06f6f35",slot:"footer-actions",appearance:"outline",width:"half",onClick:()=>this.analysisLayerInputPopoverClose.emit()},this.strings.cancel),(0,r.h)("calcite-button",{key:"92c2992fdbd3d4ca09c50b2cfe84c213f2f0382e",slot:"footer-actions",appearance:"solid",width:"half",onClick:this.onConfirm},this.strings.add)))))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,r.g)(this)}};q.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex}.popover-content{height:var(--analysis-popover-content-height)}.fab{justify-content:center;padding:var(--analysis-half-spacing)}.half-margin{margin:var(--analysis-half-spacing)}.list-message{font-size:var(--calcite-font-size--2);background-color:var(--calcite-color-background);padding:var(--analysis-half-spacing);margin:0}.layers-list{--calcite-font-size--1:var(--calcite-font-size--2)}";var z={exports:{}};function H(e,t,i,s){var a=function(e){return null==e||"number"==typeof e||"boolean"==typeof e}(s)?s:i(s),r=t.get(a);return void 0===r&&(r=e.call(this,s),t.set(a,r)),r}function U(e,t,i){var s=Array.prototype.slice.call(arguments,3),a=i(s),r=t.get(a);return void 0===r&&(r=e.apply(this,s),t.set(a,r)),r}function N(e,t,i,s,a){return i.bind(t,e,s,a)}function W(e,t){return N(e,this,1===e.length?H:U,t.cache.create(),t.serializer)}function G(){return JSON.stringify(arguments)}function Q(){this.cache=Object.create(null)}Q.prototype.has=function(e){return e in this.cache},Q.prototype.get=function(e){return this.cache[e]},Q.prototype.set=function(e,t){this.cache[e]=t};var J={create:function(){return new Q}};z.exports=function(e,t){var i=t&&t.cache?t.cache:J,s=t&&t.serializer?t.serializer:G;return(t&&t.strategy?t.strategy:W)(e,{cache:i,serializer:s})},z.exports.strategies={variadic:function(e,t){return N(e,this,U,t.cache.create(),t.serializer)},monadic:function(e,t){return N(e,this,H,t.cache.create(),t.serializer)}};var K=z.exports,Y="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g,Z="object"==typeof self&&self&&self.Object===Object&&self,X=Y||Z||Function("return this")(),ee=X.Symbol,te=Object.prototype,ie=te.hasOwnProperty,se=te.toString,ae=ee?ee.toStringTag:void 0;var re=Object.prototype.toString;var ne=ee?ee.toStringTag:void 0;function oe(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":ne&&ne in Object(e)?function(e){var t=ie.call(e,ae),i=e[ae];try{e[ae]=void 0;var s=!0}catch(e){}var a=se.call(e);return s&&(t?e[ae]=i:delete e[ae]),a}(e):function(e){return re.call(e)}(e)}function le(e){return null!=e&&"object"==typeof e}function he(e){return"symbol"==typeof e||le(e)&&"[object Symbol]"==oe(e)}function ce(e,t){for(var i=-1,s=null==e?0:e.length,a=Array(s);++i<s;)a[i]=t(e[i],i,e);return a}var de=Array.isArray,ue=ee?ee.prototype:void 0,pe=ue?ue.toString:void 0;function me(e){if("string"==typeof e)return e;if(de(e))return ce(e,me)+"";if(he(e))return pe?pe.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function ye(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ve(e){return e}function ge(e){if(!ye(e))return!1;var t=oe(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}var fe,be=X["__core-js_shared__"],we=(fe=/[^.]+$/.exec(be&&be.keys&&be.keys.IE_PROTO||""))?"Symbol(src)_1."+fe:"";var Ce=Function.prototype.toString;function ke(e){if(null!=e){try{return Ce.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var Se=/^\[object .+?Constructor\]$/,Le=Function.prototype,_e=Object.prototype,Ie=Le.toString,Me=_e.hasOwnProperty,xe=RegExp("^"+Ie.call(Me).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ee(e){return!(!ye(e)||(t=e,we&&we in t))&&(ge(e)?xe:Se).test(ke(e));var t}function Te(e,t){var i=function(e,t){return null==e?void 0:e[t]}(e,t);return Ee(i)?i:void 0}var Pe=Te(X,"WeakMap"),Ae=Object.create,Fe=function(){function e(){}return function(t){if(!ye(t))return{};if(Ae)return Ae(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}();function Oe(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}var De=Date.now;function $e(e){return function(){return e}}var Be,je,Ve,Re=function(){try{var e=Te(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),qe=Re,ze=qe?function(e,t){return qe(e,"toString",{configurable:!0,enumerable:!1,value:$e(t),writable:!0})}:ve,He=(Be=ze,je=0,Ve=0,function(){var e=De(),t=16-(e-Ve);if(Ve=e,t>0){if(++je>=800)return arguments[0]}else je=0;return Be.apply(void 0,arguments)});function Ue(e){return e!=e}function Ne(e,t){return!!(null==e?0:e.length)&&function(e,t,i){return t==t?function(e,t,i){for(var s=i-1,a=e.length;++s<a;)if(e[s]===t)return s;return-1}(e,t,i):function(e,t,i,s){for(var a=e.length,r=i+(s?1:-1);s?r--:++r<a;)if(t(e[r],r,e))return r;return-1}(e,Ue,i)}(e,t,0)>-1}var We=/^(?:0|[1-9]\d*)$/;function Ge(e,t){var i=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==i||"symbol"!=i&&We.test(e))&&e>-1&&e%1==0&&e<t}function Qe(e,t,i){"__proto__"==t&&qe?qe(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function Je(e,t){return e===t||e!=e&&t!=t}var Ke=Object.prototype.hasOwnProperty;function Ye(e,t,i){var s=e[t];Ke.call(e,t)&&Je(s,i)&&(void 0!==i||t in e)||Qe(e,t,i)}function Ze(e,t,i,s){var a=!i;i||(i={});for(var r=-1,n=t.length;++r<n;){var o=t[r],l=s?s(i[o],e[o],o,i,e):void 0;void 0===l&&(l=e[o]),a?Qe(i,o,l):Ye(i,o,l)}return i}var Xe=Math.max;function et(e,t,i){return t=Xe(void 0===t?e.length-1:t,0),function(){for(var s=arguments,a=-1,r=Xe(s.length-t,0),n=Array(r);++a<r;)n[a]=s[t+a];a=-1;for(var o=Array(t+1);++a<t;)o[a]=s[a];return o[t]=i(n),Oe(e,this,o)}}function tt(e,t){return He(et(e,t,ve),e+"")}function it(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function st(e){return null!=e&&it(e.length)&&!ge(e)}function at(e){return tt((function(t,i){var s=-1,a=i.length,r=a>1?i[a-1]:void 0,n=a>2?i[2]:void 0;for(r=e.length>3&&"function"==typeof r?(a--,r):void 0,n&&function(e,t,i){if(!ye(i))return!1;var s=typeof t;return!!("number"==s?st(i)&&Ge(t,i.length):"string"==s&&t in i)&&Je(i[t],e)}(i[0],i[1],n)&&(r=a<3?void 0:r,a=1),t=Object(t);++s<a;){var o=i[s];o&&e(t,o,s,r)}return t}))}var rt=Object.prototype;function nt(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||rt)}function ot(e){return le(e)&&"[object Arguments]"==oe(e)}var lt=Object.prototype,ht=lt.hasOwnProperty,ct=lt.propertyIsEnumerable,dt=ot(function(){return arguments}())?ot:function(e){return le(e)&&ht.call(e,"callee")&&!ct.call(e,"callee")},ut=dt;var pt="object"==typeof exports&&exports&&!exports.nodeType&&exports,mt=pt&&e&&!e.nodeType&&e,yt=mt&&mt.exports===pt?X.Buffer:void 0,vt=(yt?yt.isBuffer:void 0)||function(){return!1},gt={};function ft(e){return function(t){return e(t)}}gt["[object Float32Array]"]=gt["[object Float64Array]"]=gt["[object Int8Array]"]=gt["[object Int16Array]"]=gt["[object Int32Array]"]=gt["[object Uint8Array]"]=gt["[object Uint8ClampedArray]"]=gt["[object Uint16Array]"]=gt["[object Uint32Array]"]=!0,gt["[object Arguments]"]=gt["[object Array]"]=gt["[object ArrayBuffer]"]=gt["[object Boolean]"]=gt["[object DataView]"]=gt["[object Date]"]=gt["[object Error]"]=gt["[object Function]"]=gt["[object Map]"]=gt["[object Number]"]=gt["[object Object]"]=gt["[object RegExp]"]=gt["[object Set]"]=gt["[object String]"]=gt["[object WeakMap]"]=!1;var bt="object"==typeof exports&&exports&&!exports.nodeType&&exports,wt=bt&&e&&!e.nodeType&&e,Ct=wt&&wt.exports===bt&&Y.process,kt=function(){try{var e=wt&&wt.require&&wt.require("util").types;return e||Ct&&Ct.binding&&Ct.binding("util")}catch(e){}}(),St=kt&&kt.isTypedArray,Lt=St?ft(St):function(e){return le(e)&&it(e.length)&&!!gt[oe(e)]},_t=Lt,It=Object.prototype.hasOwnProperty;function Mt(e,t){var i=de(e),s=!i&&ut(e),a=!i&&!s&&vt(e),r=!i&&!s&&!a&&_t(e),n=i||s||a||r,o=n?function(e,t){for(var i=-1,s=Array(e);++i<e;)s[i]=t(i);return s}(e.length,String):[],l=o.length;for(var h in e)!t&&!It.call(e,h)||n&&("length"==h||a&&("offset"==h||"parent"==h)||r&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||Ge(h,l))||o.push(h);return o}function xt(e,t){return function(i){return e(t(i))}}var Et=xt(Object.keys,Object),Tt=Object.prototype.hasOwnProperty;function Pt(e){if(!nt(e))return Et(e);var t=[];for(var i in Object(e))Tt.call(e,i)&&"constructor"!=i&&t.push(i);return t}function At(e){return st(e)?Mt(e):Pt(e)}var Ft=Object.prototype.hasOwnProperty;at((function(e,t){if(nt(t)||st(t))Ze(t,At(t),e);else for(var i in t)Ft.call(t,i)&&Ye(e,i,t[i])}));var Ot=Object.prototype.hasOwnProperty;function Dt(e){if(!ye(e))return function(e){var t=[];if(null!=e)for(var i in Object(e))t.push(i);return t}(e);var t=nt(e),i=[];for(var s in e)("constructor"!=s||!t&&Ot.call(e,s))&&i.push(s);return i}function $t(e){return st(e)?Mt(e,!0):Dt(e)}at((function(e,t,i,s){Ze(t,$t(t),e,s)}));var Bt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,jt=/^\w*$/;function Vt(e,t){if(de(e))return!1;var i=typeof e;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=e&&!he(e))||(jt.test(e)||!Bt.test(e)||null!=t&&e in Object(t))}var Rt=Te(Object,"create");var qt=Object.prototype.hasOwnProperty;var zt=Object.prototype.hasOwnProperty;function Ht(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}function Ut(e,t){for(var i=e.length;i--;)if(Je(e[i][0],t))return i;return-1}Ht.prototype.clear=function(){this.__data__=Rt?Rt(null):{},this.size=0},Ht.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Ht.prototype.get=function(e){var t=this.__data__;if(Rt){var i=t[e];return"__lodash_hash_undefined__"===i?void 0:i}return qt.call(t,e)?t[e]:void 0},Ht.prototype.has=function(e){var t=this.__data__;return Rt?void 0!==t[e]:zt.call(t,e)},Ht.prototype.set=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=Rt&&void 0===t?"__lodash_hash_undefined__":t,this};var Nt=Array.prototype.splice;function Wt(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}Wt.prototype.clear=function(){this.__data__=[],this.size=0},Wt.prototype.delete=function(e){var t=this.__data__,i=Ut(t,e);return!(i<0)&&(i==t.length-1?t.pop():Nt.call(t,i,1),--this.size,!0)},Wt.prototype.get=function(e){var t=this.__data__,i=Ut(t,e);return i<0?void 0:t[i][1]},Wt.prototype.has=function(e){return Ut(this.__data__,e)>-1},Wt.prototype.set=function(e,t){var i=this.__data__,s=Ut(i,e);return s<0?(++this.size,i.push([e,t])):i[s][1]=t,this};var Gt=Te(X,"Map");function Qt(e,t){var i=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?i["string"==typeof t?"string":"hash"]:i.map}function Jt(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}Jt.prototype.clear=function(){this.size=0,this.__data__={hash:new Ht,map:new(Gt||Wt),string:new Ht}},Jt.prototype.delete=function(e){var t=Qt(this,e).delete(e);return this.size-=t?1:0,t},Jt.prototype.get=function(e){return Qt(this,e).get(e)},Jt.prototype.has=function(e){return Qt(this,e).has(e)},Jt.prototype.set=function(e,t){var i=Qt(this,e),s=i.size;return i.set(e,t),this.size+=i.size==s?0:1,this};function Kt(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var i=function(){var s=arguments,a=t?t.apply(this,s):s[0],r=i.cache;if(r.has(a))return r.get(a);var n=e.apply(this,s);return i.cache=r.set(a,n)||r,n};return i.cache=new(Kt.Cache||Jt),i}Kt.Cache=Jt;var Yt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Zt=/\\(\\)?/g,Xt=function(e){var t=Kt(e,(function(e){return 500===i.size&&i.clear(),e})),i=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Yt,(function(e,i,s,a){t.push(s?a.replace(Zt,"$1"):i||e)})),t})),ei=Xt;function ti(e,t){return de(e)?e:Vt(e,t)?[e]:ei(function(e){return null==e?"":me(e)}(e))}function ii(e){if("string"==typeof e||he(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function si(e,t){for(var i=0,s=(t=ti(t,e)).length;null!=e&&i<s;)e=e[ii(t[i++])];return i&&i==s?e:void 0}function ai(e,t,i){var s=null==e?void 0:si(e,t);return void 0===s?i:s}function ri(e,t){for(var i=-1,s=t.length,a=e.length;++i<s;)e[a+i]=t[i];return e}var ni=ee?ee.isConcatSpreadable:void 0;function oi(e){return de(e)||ut(e)||!!(ni&&e&&e[ni])}function li(e,t,i,s,a){var r=-1,n=e.length;for(i||(i=oi),a||(a=[]);++r<n;){var o=e[r];t>0&&i(o)?t>1?li(o,t-1,i,s,a):ri(a,o):s||(a[a.length]=o)}return a}function hi(e){return(null==e?0:e.length)?li(e,1):[]}function ci(e){return He(et(e,void 0,hi),e+"")}var di=xt(Object.getPrototypeOf,Object),ui=Function.prototype,pi=Object.prototype,mi=ui.toString,yi=pi.hasOwnProperty,vi=mi.call(Object);function gi(e){if(!le(e)||"[object Object]"!=oe(e))return!1;var t=di(e);if(null===t)return!0;var i=yi.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&mi.call(i)==vi}tt((function(e,t){try{return Oe(e,void 0,t)}catch(e){return function(e){if(!le(e))return!1;var t=oe(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!gi(e)}(e)?e:new Error(e)}}));function fi(e){var t=this.__data__=new Wt(e);this.size=t.size}fi.prototype.clear=function(){this.__data__=new Wt,this.size=0},fi.prototype.delete=function(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i},fi.prototype.get=function(e){return this.__data__.get(e)},fi.prototype.has=function(e){return this.__data__.has(e)},fi.prototype.set=function(e,t){var i=this.__data__;if(i instanceof Wt){var s=i.__data__;if(!Gt||s.length<199)return s.push([e,t]),this.size=++i.size,this;i=this.__data__=new Jt(s)}return i.set(e,t),this.size=i.size,this};var bi="object"==typeof exports&&exports&&!exports.nodeType&&exports,wi=bi&&e&&!e.nodeType&&e,Ci=wi&&wi.exports===bi?X.Buffer:void 0,ki=Ci?Ci.allocUnsafe:void 0;function Si(){return[]}var Li=Object.prototype.propertyIsEnumerable,_i=Object.getOwnPropertySymbols,Ii=_i?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var i=-1,s=null==e?0:e.length,a=0,r=[];++i<s;){var n=e[i];t(n,i,e)&&(r[a++]=n)}return r}(_i(e),(function(t){return Li.call(e,t)})))}:Si,Mi=Ii;var xi=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)ri(t,Mi(e)),e=di(e);return t}:Si;function Ei(e,t,i){var s=t(e);return de(e)?s:ri(s,i(e))}function Ti(e){return Ei(e,At,Mi)}function Pi(e){return Ei(e,$t,xi)}var Ai=Te(X,"DataView"),Fi=Te(X,"Promise"),Oi=Te(X,"Set"),Di="[object Map]",$i="[object Promise]",Bi="[object Set]",ji="[object WeakMap]",Vi="[object DataView]",Ri=ke(Ai),qi=ke(Gt),zi=ke(Fi),Hi=ke(Oi),Ui=ke(Pe),Ni=oe;(Ai&&Ni(new Ai(new ArrayBuffer(1)))!=Vi||Gt&&Ni(new Gt)!=Di||Fi&&Ni(Fi.resolve())!=$i||Oi&&Ni(new Oi)!=Bi||Pe&&Ni(new Pe)!=ji)&&(Ni=function(e){var t=oe(e),i="[object Object]"==t?e.constructor:void 0,s=i?ke(i):"";if(s)switch(s){case Ri:return Vi;case qi:return Di;case zi:return $i;case Hi:return Bi;case Ui:return ji}return t});var Wi=Ni,Gi=Object.prototype.hasOwnProperty;var Qi=X.Uint8Array;function Ji(e){var t=new e.constructor(e.byteLength);return new Qi(t).set(new Qi(e)),t}var Ki=/\w*$/;var Yi=ee?ee.prototype:void 0,Zi=Yi?Yi.valueOf:void 0;function Xi(e,t,i){var s,a,r,n=e.constructor;switch(t){case"[object ArrayBuffer]":return Ji(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return function(e,t){var i=t?Ji(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}(e,i);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return function(e,t){var i=t?Ji(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}(e,i);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return(r=new(a=e).constructor(a.source,Ki.exec(a))).lastIndex=a.lastIndex,r;case"[object Symbol]":return s=e,Zi?Object(Zi.call(s)):{}}}var es=kt&&kt.isMap,ts=es?ft(es):function(e){return le(e)&&"[object Map]"==Wi(e)},is=ts;var ss=kt&&kt.isSet,as=ss?ft(ss):function(e){return le(e)&&"[object Set]"==Wi(e)},rs=as,ns="[object Arguments]",os="[object Function]",ls="[object Object]",hs={};function cs(e,t,i,s,a,r){var n,o=1&t,l=2&t,h=4&t;if(i&&(n=a?i(e,s,a,r):i(e)),void 0!==n)return n;if(!ye(e))return e;var c=de(e);if(c){if(n=function(e){var t=e.length,i=new e.constructor(t);return t&&"string"==typeof e[0]&&Gi.call(e,"index")&&(i.index=e.index,i.input=e.input),i}(e),!o)return function(e,t){var i=-1,s=e.length;for(t||(t=Array(s));++i<s;)t[i]=e[i];return t}(e,n)}else{var d=Wi(e),u=d==os||"[object GeneratorFunction]"==d;if(vt(e))return function(e,t){if(t)return e.slice();var i=e.length,s=ki?ki(i):new e.constructor(i);return e.copy(s),s}(e,o);if(d==ls||d==ns||u&&!a){if(n=l||u?{}:function(e){return"function"!=typeof e.constructor||nt(e)?{}:Fe(di(e))}(e),!o)return l?function(e,t){return Ze(e,xi(e),t)}(e,function(e,t){return e&&Ze(t,$t(t),e)}(n,e)):function(e,t){return Ze(e,Mi(e),t)}(e,function(e,t){return e&&Ze(t,At(t),e)}(n,e))}else{if(!hs[d])return a?e:{};n=Xi(e,d,o)}}r||(r=new fi);var p=r.get(e);if(p)return p;r.set(e,n),rs(e)?e.forEach((function(s){n.add(cs(s,t,i,s,e,r))})):is(e)&&e.forEach((function(s,a){n.set(a,cs(s,t,i,a,e,r))}));var m=c?void 0:(h?l?Pi:Ti:l?$t:At)(e);return function(e,t){for(var i=-1,s=null==e?0:e.length;++i<s&&!1!==t(e[i],i,e););}(m||e,(function(s,a){m&&(s=e[a=s]),Ye(n,a,cs(s,t,i,a,e,r))})),n}hs[ns]=hs["[object Array]"]=hs["[object ArrayBuffer]"]=hs["[object DataView]"]=hs["[object Boolean]"]=hs["[object Date]"]=hs["[object Float32Array]"]=hs["[object Float64Array]"]=hs["[object Int8Array]"]=hs["[object Int16Array]"]=hs["[object Int32Array]"]=hs["[object Map]"]=hs["[object Number]"]=hs[ls]=hs["[object RegExp]"]=hs["[object Set]"]=hs["[object String]"]=hs["[object Symbol]"]=hs["[object Uint8Array]"]=hs["[object Uint8ClampedArray]"]=hs["[object Uint16Array]"]=hs["[object Uint32Array]"]=!0,hs["[object Error]"]=hs[os]=hs["[object WeakMap]"]=!1;function ds(e){var t=-1,i=null==e?0:e.length;for(this.__data__=new Jt;++t<i;)this.add(e[t])}function us(e,t){for(var i=-1,s=null==e?0:e.length;++i<s;)if(t(e[i],i,e))return!0;return!1}function ps(e,t){return e.has(t)}ds.prototype.add=ds.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},ds.prototype.has=function(e){return this.__data__.has(e)};function ms(e,t,i,s,a,r){var n=1&i,o=e.length,l=t.length;if(o!=l&&!(n&&l>o))return!1;var h=r.get(e),c=r.get(t);if(h&&c)return h==t&&c==e;var d=-1,u=!0,p=2&i?new ds:void 0;for(r.set(e,t),r.set(t,e);++d<o;){var m=e[d],y=t[d];if(s)var v=n?s(y,m,d,t,e,r):s(m,y,d,e,t,r);if(void 0!==v){if(v)continue;u=!1;break}if(p){if(!us(t,(function(e,t){if(!ps(p,t)&&(m===e||a(m,e,i,s,r)))return p.push(t)}))){u=!1;break}}else if(m!==y&&!a(m,y,i,s,r)){u=!1;break}}return r.delete(e),r.delete(t),u}function ys(e){var t=-1,i=Array(e.size);return e.forEach((function(e,s){i[++t]=[s,e]})),i}function vs(e){var t=-1,i=Array(e.size);return e.forEach((function(e){i[++t]=e})),i}var gs=ee?ee.prototype:void 0,fs=gs?gs.valueOf:void 0;var bs=Object.prototype.hasOwnProperty;var ws="[object Arguments]",Cs="[object Array]",ks="[object Object]",Ss=Object.prototype.hasOwnProperty;function Ls(e,t,i,s,a,r){var n=de(e),o=de(t),l=n?Cs:Wi(e),h=o?Cs:Wi(t),c=(l=l==ws?ks:l)==ks,d=(h=h==ws?ks:h)==ks,u=l==h;if(u&&vt(e)){if(!vt(t))return!1;n=!0,c=!1}if(u&&!c)return r||(r=new fi),n||_t(e)?ms(e,t,i,s,a,r):function(e,t,i,s,a,r,n){switch(i){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!r(new Qi(e),new Qi(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Je(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var o=ys;case"[object Set]":var l=1&s;if(o||(o=vs),e.size!=t.size&&!l)return!1;var h=n.get(e);if(h)return h==t;s|=2,n.set(e,t);var c=ms(o(e),o(t),s,a,r,n);return n.delete(e),c;case"[object Symbol]":if(fs)return fs.call(e)==fs.call(t)}return!1}(e,t,l,i,s,a,r);if(!(1&i)){var p=c&&Ss.call(e,"__wrapped__"),m=d&&Ss.call(t,"__wrapped__");if(p||m){var y=p?e.value():e,v=m?t.value():t;return r||(r=new fi),a(y,v,i,s,r)}}return!!u&&(r||(r=new fi),function(e,t,i,s,a,r){var n=1&i,o=Ti(e),l=o.length;if(l!=Ti(t).length&&!n)return!1;for(var h=l;h--;){var c=o[h];if(!(n?c in t:bs.call(t,c)))return!1}var d=r.get(e),u=r.get(t);if(d&&u)return d==t&&u==e;var p=!0;r.set(e,t),r.set(t,e);for(var m=n;++h<l;){var y=e[c=o[h]],v=t[c];if(s)var g=n?s(v,y,c,t,e,r):s(y,v,c,e,t,r);if(!(void 0===g?y===v||a(y,v,i,s,r):g)){p=!1;break}m||(m="constructor"==c)}if(p&&!m){var f=e.constructor,b=t.constructor;f==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof f&&f instanceof f&&"function"==typeof b&&b instanceof b||(p=!1)}return r.delete(e),r.delete(t),p}(e,t,i,s,a,r))}function _s(e,t,i,s,a){return e===t||(null==e||null==t||!le(e)&&!le(t)?e!=e&&t!=t:Ls(e,t,i,s,_s,a))}function Is(e){return e==e&&!ye(e)}function Ms(e,t){return function(i){return null!=i&&(i[e]===t&&(void 0!==t||e in Object(i)))}}function xs(e){var t=function(e){for(var t=At(e),i=t.length;i--;){var s=t[i],a=e[s];t[i]=[s,a,Is(a)]}return t}(e);return 1==t.length&&t[0][2]?Ms(t[0][0],t[0][1]):function(i){return i===e||function(e,t,i,s){var a=i.length,r=a,n=!s;if(null==e)return!r;for(e=Object(e);a--;){var o=i[a];if(n&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++a<r;){var l=(o=i[a])[0],h=e[l],c=o[1];if(n&&o[2]){if(void 0===h&&!(l in e))return!1}else{var d=new fi;if(s)var u=s(h,c,l,e,t,d);if(!(void 0===u?_s(c,h,3,s,d):u))return!1}}return!0}(i,e,t)}}function Es(e,t){return null!=e&&t in Object(e)}function Ts(e,t){return null!=e&&function(e,t,i){for(var s=-1,a=(t=ti(t,e)).length,r=!1;++s<a;){var n=ii(t[s]);if(!(r=null!=e&&i(e,n)))break;e=e[n]}return r||++s!=a?r:!!(a=null==e?0:e.length)&&it(a)&&Ge(n,a)&&(de(e)||ut(e))}(e,t,Es)}function Ps(e){return Vt(e)?(t=ii(e),function(e){return null==e?void 0:e[t]}):function(e){return function(t){return si(t,e)}}(e);var t}function As(e){return"function"==typeof e?e:null==e?ve:"object"==typeof e?de(e)?(t=e[0],i=e[1],Vt(t)&&Is(i)?Ms(ii(t),i):function(e){var s=ai(e,t);return void 0===s&&s===i?Ts(e,t):_s(i,s,3)}):xs(e):Ps(e);var t,i}function Fs(e){return le(e)&&st(e)}function Os(e,t,i){for(var s=-1,a=null==e?0:e.length;++s<a;)if(i(t,e[s]))return!0;return!1}function Ds(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var $s=Math.min;function Bs(e){return Fs(e)?e:[]}function js(e,t){return t.length<2?e:si(e,function(e,t,i){var s=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(i=i>a?a:i)<0&&(i+=a),a=t>i?0:i-t>>>0,t>>>=0;for(var r=Array(a);++s<a;)r[s]=e[s+t];return r}(t,0,-1))}tt((function(e){var t=Ds(e),i=ce(e,Bs);return t===Ds(i)?t=void 0:i.pop(),i.length&&i[0]===e[0]?function(e,t,i){for(var s=i?Os:Ne,a=e[0].length,r=e.length,n=r,o=Array(r),l=1/0,h=[];n--;){var c=e[n];n&&t&&(c=ce(c,ft(t))),l=$s(c.length,l),o[n]=!i&&(t||a>=120&&c.length>=120)?new ds(n&&c):void 0}c=e[0];var d=-1,u=o[0];e:for(;++d<a&&h.length<l;){var p=c[d],m=t?t(p):p;if(p=i||0!==p?p:0,!(u?ps(u,m):s(h,m,i))){for(n=r;--n;){var y=o[n];if(!(y?ps(y,m):s(e[n],m,i)))continue e}u&&u.push(m),h.push(p)}}return h}(i,As(t)):[]}));var Vs=Object.prototype.hasOwnProperty;function Rs(e,t){return null==(e=js(e,t=ti(t,e)))||delete e[ii(Ds(t))]}function qs(e){return gi(e)?void 0:e}var zs=ci((function(e,t){var i={};if(null==e)return i;var s=!1;t=ce(t,(function(t){return t=ti(t,e),s||(s=t.length>1),t})),Ze(e,Pi(e),i),s&&(i=cs(i,7,qs));for(var a=t.length;a--;)Rs(i,t[a]);return i}));function Hs(e,t,i,s){if(!ye(e))return e;for(var a=-1,r=(t=ti(t,e)).length,n=r-1,o=e;null!=o&&++a<r;){var l=ii(t[a]),h=i;if("__proto__"===l||"constructor"===l||"prototype"===l)return e;if(a!=n){var c=o[l];void 0===(h=s?s(c,l,o):void 0)&&(h=ye(c)?c:Ge(t[a+1])?[]:{})}Ye(o,l,h),o=o[l]}return e}function Us(e,t){return function(e,t,i){for(var s=-1,a=t.length,r={};++s<a;){var n=t[s],o=si(e,n);i(o,n)&&Hs(r,ti(n,e),o)}return r}(e,t,(function(t,i){return Ts(e,i)}))}ci((function(e,t){return null==e?{}:Us(e,t)}));var Ns=Math.floor,Ws=Math.min;function Gs(e,t,i){return function(e,t,i,s){var a=0,r=null==e?0:e.length;if(0===r)return 0;for(var n=(t=i(t))!=t,o=null===t,l=he(t),h=void 0===t;a<r;){var c=Ns((a+r)/2),d=i(e[c]),u=void 0!==d,p=null===d,m=d==d,y=he(d);if(n)var v=s||m;else v=h?m&&(s||u):o?m&&u&&(s||!p):l?m&&u&&!p&&(s||!y):!p&&!y&&(s?d<=t:d<t);v?a=c+1:r=c}return Ws(r,4294967294)}(e,t,As(i))}var Qs=Oi&&1/vs(new Oi([,-0]))[1]==1/0?function(e){return new Oi(e)}:function(){};function Js(e){return null==e||"string"==typeof e&&""===e||gi(e)&&function(e){if(null==e)return!0;if(st(e)&&(de(e)||"string"==typeof e||"function"==typeof e.splice||vt(e)||_t(e)||ut(e)))return!e.length;var t=Wi(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(nt(e))return!Pt(e).length;for(var i in e)if(Vs.call(e,i))return!1;return!0}(e)||Array.isArray(e)&&e.length<1||"object"==typeof e&&!1===de(e)&&function(e){let t=!0;if("object"==typeof e&&!1===de(e))for(const i in e){const s=e?.[i];if(!0===e.hasOwnProperty(i)&&null!=s&&""!==s){t=!1;break}}return t}(e)}async function Ks(e,t){return(0,p.default)(e,t)}tt((function(e){var t=Ds(e);return Fs(t)&&(t=void 0),function(e,t,i){var s=-1,a=Ne,r=e.length,n=!0,o=[],l=o;if(i)n=!1,a=Os;else if(r>=200){var h=t?null:Qs(e);if(h)return vs(h);n=!1,a=ps,l=new ds}else l=t?[]:o;e:for(;++s<r;){var c=e[s],d=t?t(c):c;if(c=i||0!==c?c:0,n&&d==d){for(var u=l.length;u--;)if(l[u]===d)continue e;t&&l.push(d),o.push(c)}else a(l,d,i)||(l!==o&&l.push(d),o.push(c))}return o}(li(e,1,Fs,!0),As(t))}));const Ys={Arabic:"ar",Bosnian:"bs",Bulgarian:"bg",Catalan:"ca",Czech:"cs",Danish:"da",German:"de",Greek:"el",English:"en",EnglishUSA:"en-US",Spanish:"es",Estonian:"et",Finnish:"fi",French:"fr",Hebrew:"he",Croatian:"hr",Hungarian:"hu",Indonesian:"id",Italian:"it",Japanese:"ja",Korean:"ko",Lithuanian:"lt",Latvian:"lv",NorwegianBokml:"nb",Dutch:"nl",Polish:"pl",PortugueseBrazil:"pt-BR",PortuguesePortugal:"pt-PT",Romanian:"ro",Russian:"ru",Serbian:"sr",Slovenian:"sl",Slovak:"sk",Swedish:"sv",Thai:"th",Turkish:"tr",Ukrainian:"uk",Vietnamese:"vi",ChineseChina:"zh-CN",ChineseHongKong:"zh-HK",ChineseTaiwan:"zh-TW"},Zs=[...Object.values(Ys),"ar-u-nu-latn","en-AU","en-GB","es-ES","es-MX","de-AT","de-CH","de-DE","it-CH","it-IT"],Xs=[Ys.Arabic,Ys.Hebrew];function ea(e){let t=Ys.English;if(void 0!==e){const i=Object.values(Ys),s=i.filter((e=>-1!==e.indexOf("-")));if(-1!==e.indexOf("-")){const[t,i]=e.split("-");e=`${t}-${i.toUpperCase()}`}if(!0===s.includes(e))t=e;else{const s=function(e){const t=e?.match(/^([a-z]{2})-([A-Z]{1,2})$/);let i=Ys.English;return null!=t&&t?.length>1?i=t[1]:2===e?.length&&e.toLowerCase()===e&&(i=e),i}(e);!0===i.includes(s)&&(t=s)}}return t}function ta(e=document.documentElement){const t=(i="[lang]",function e(t){let s;return s=void 0===t||t===document||t===window?null:t.closest(i)||e(t.getRootNode().host),s}(e));var i;const s=t?.lang??window.navigator.language,a=ea(s),r=function(e){let t=Zs.find((t=>t===e));if(void 0===t&&(t=e),void 0!==t&&-1!==t.indexOf("-")){const[e,i]=t.split("-");t=`${e}-${i.toUpperCase()}`}return"ar"===t&&(t="ar-u-nu-latn"),t}(s);return{locale:a,rtl:Xs.includes(a),formatLocale:r}}class ia extends Error{constructor(e,t,i,s){super(t),this.name=e,this.details=i,this.cause=s}}const sa="networkError",aa="portalLoadError",ra="webToolFailedFetch",na="accessBlocked";var oa=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")},la=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return oa()}try{return __global__||oa()}finally{delete Object.prototype.__global__}}(),ha="object"!=typeof globalThis||!globalThis||globalThis.Array!==Array?la:globalThis,ca=ha,da={object:!0,symbol:!0},ua={exports:{}},pa=function(e){return null!=e},ma=pa,ya={object:!0,function:!0,undefined:!0},va=function(e){return!!ma(e)&&hasOwnProperty.call(ya,typeof e)},ga=function(e){if(!va(e))return!1;try{return!!e.constructor&&e.constructor.prototype===e}catch(e){return!1}},fa=function(e){if("function"!=typeof e)return!1;if(!hasOwnProperty.call(e,"length"))return!1;try{if("number"!=typeof e.length)return!1;if("function"!=typeof e.call)return!1;if("function"!=typeof e.apply)return!1}catch(e){return!1}return!ga(e)},ba=/^\s*class[\s{/}]/,wa=Function.prototype.toString,Ca=function(e){return null!=e},ka=Ca,Sa=Object.keys,La=function(){try{return!0}catch(e){return!1}}()?Object.keys:function(e){return Sa(ka(e)?Object(e):e)},_a=Ca,Ia=La,Ma=function(e){if(!_a(e))throw new TypeError("Cannot use null or undefined");return e},xa=Math.max,Ea=function(){var e,t=Object.assign;return"function"==typeof t&&(t(e={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}()?Object.assign:function(e,t){var i,s,a,r=xa(arguments.length,2);for(e=Object(Ma(e)),a=function(s){try{e[s]=t[s]}catch(e){i||(i=e)}},s=1;s<r;++s)Ia(t=arguments[s]).forEach(a);if(void 0!==i)throw i;return e},Ta=Ca,Pa=Array.prototype.forEach,Aa=Object.create,Fa="razdwatrzy",Oa=String.prototype.indexOf,Da="function"==typeof Fa.contains&&!0===Fa.contains("dwa")&&!1===Fa.contains("foo")?String.prototype.contains:function(e){return Oa.call(this,e,arguments[1])>-1},$a=pa,Ba=function(e){return!!fa(e)&&!ba.test(wa.call(e))},ja=Ea,Va=function(e){var t=Aa(null);return Pa.call(arguments,(function(e){Ta(e)&&function(e,t){var i;for(i in e)t[i]=e[i]}(Object(e),t)})),t},Ra=Da,qa=ua.exports=function(e,t){var i,s,a,r,n;return arguments.length<2||"string"!=typeof e?(r=t,t=e,e=null):r=arguments[2],$a(e)?(i=Ra.call(e,"c"),s=Ra.call(e,"e"),a=Ra.call(e,"w")):(i=a=!0,s=!1),n={value:t,configurable:i,enumerable:s,writable:a},r?ja(Va(r),n):n};qa.gs=function(e,t,i){var s,a,r,n;return"string"!=typeof e?(r=i,i=t,t=e,e=null):r=arguments[3],$a(t)?Ba(t)?$a(i)?Ba(i)||(r=i,i=void 0):i=void 0:(r=t,t=i=void 0):t=void 0,$a(e)?(s=Ra.call(e,"c"),a=Ra.call(e,"e")):(s=!0,a=!1),n={get:t,set:i,configurable:s,enumerable:a},r?ja(Va(r),n):n};var za,Ha,Ua,Na=function(e){return!!e&&("symbol"==typeof e||!!e.constructor&&("Symbol"===e.constructor.name&&"Symbol"===e[e.constructor.toStringTag]))},Wa=function(e){if(!Na(e))throw new TypeError(e+" is not a symbol");return e},Ga=ua.exports,Qa=Object.create,Ja=Object.defineProperty,Ka=Object.prototype,Ya=Qa(null),Za=ua.exports,Xa=ha.Symbol,er=ua.exports,tr=Wa,ir=Object.create(null),sr=ua.exports,ar=Wa,rr=ha.Symbol,nr=function(e){for(var t,i,s=0;Ya[e+(s||"")];)++s;return Ya[e+=s||""]=!0,Ja(Ka,t="@@"+e,Ga.gs(null,(function(e){i||(i=!0,Ja(this,t,Ga(e)),i=!1)}))),t},or=function(e){return Object.defineProperties(e,{hasInstance:Za("",Xa&&Xa.hasInstance||e("hasInstance")),isConcatSpreadable:Za("",Xa&&Xa.isConcatSpreadable||e("isConcatSpreadable")),iterator:Za("",Xa&&Xa.iterator||e("iterator")),match:Za("",Xa&&Xa.match||e("match")),replace:Za("",Xa&&Xa.replace||e("replace")),search:Za("",Xa&&Xa.search||e("search")),species:Za("",Xa&&Xa.species||e("species")),split:Za("",Xa&&Xa.split||e("split")),toPrimitive:Za("",Xa&&Xa.toPrimitive||e("toPrimitive")),toStringTag:Za("",Xa&&Xa.toStringTag||e("toStringTag")),unscopables:Za("",Xa&&Xa.unscopables||e("unscopables"))})},lr=function(e){return Object.defineProperties(e,{for:er((function(t){return ir[t]?ir[t]:ir[t]=e(String(t))})),keyFor:er((function(e){var t;for(t in tr(e),ir)if(ir[t]===e)return t}))})},hr=Object.create,cr=Object.defineProperties,dr=Object.defineProperty;if("function"==typeof rr)try{String(rr()),Ua=!0}catch(e){}else rr=null;Ha=function(e){if(this instanceof Ha)throw new TypeError("Symbol is not a constructor");return za(e)};var ur=za=function e(t){var i;if(this instanceof e)throw new TypeError("Symbol is not a constructor");return Ua?rr(t):(i=hr(Ha.prototype),t=void 0===t?"":String(t),cr(i,{__description__:sr("",t),__name__:sr("",nr(t))}))};or(za),lr(za),cr(Ha.prototype,{constructor:sr(za),toString:sr("",(function(){return this.__name__}))}),cr(za.prototype,{toString:sr((function(){return"Symbol ("+ar(this).__description__+")"})),valueOf:sr((function(){return ar(this)}))}),dr(za.prototype,za.toPrimitive,sr("",(function(){var e=ar(this);return"symbol"==typeof e?e:e.toString()}))),dr(za.prototype,za.toStringTag,sr("c","Symbol")),dr(Ha.prototype,za.toStringTag,sr("c",za.prototype[za.toStringTag])),dr(Ha.prototype,za.toPrimitive,sr("c",za.prototype[za.toPrimitive]));(function(){var e=ca.Symbol;return"function"==typeof e&&(e("test symbol"),!!da[typeof e.iterator]&&(!!da[typeof e.toPrimitive]&&!!da[typeof e.toStringTag]))}()?ha.Symbol:ur)("-");const pr="standard",mr="raster";var yr={exports:{}};function vr(e,t,i,s){var a=function(e){return null==e||"number"==typeof e||"boolean"==typeof e}(s)?s:i(s),r=t.get(a);return void 0===r&&(r=e.call(this,s),t.set(a,r)),r}function gr(e,t,i){var s=Array.prototype.slice.call(arguments,3),a=i(s),r=t.get(a);return void 0===r&&(r=e.apply(this,s),t.set(a,r)),r}function fr(e,t,i,s,a){return i.bind(t,e,s,a)}function br(e,t){return fr(e,this,1===e.length?vr:gr,t.cache.create(),t.serializer)}function wr(){return JSON.stringify(arguments)}function Cr(){this.cache=Object.create(null)}Cr.prototype.has=function(e){return e in this.cache},Cr.prototype.get=function(e){return this.cache[e]},Cr.prototype.set=function(e,t){this.cache[e]=t};var kr={create:function(){return new Cr}};yr.exports=function(e,t){var i=t&&t.cache?t.cache:kr,s=t&&t.serializer?t.serializer:wr;return(t&&t.strategy?t.strategy:br)(e,{cache:i,serializer:s})},yr.exports.strategies={variadic:function(e,t){return fr(e,this,gr,t.cache.create(),t.serializer)},monadic:function(e,t){return fr(e,this,vr,t.cache.create(),t.serializer)}};var Sr=yr.exports;const Lr=["SingleLine","Address","Address2","Address3","Neighborhood","City","Subregion","Region","Postal","PostalExt","CountryCode"];Sr((async({data:e,toolUIStrings:t})=>{const i=fc(e,"geocodeServiceURL");let s;try{({data:{detailedCountries:s}}=await Ks(`${i}?f=json`,{responseType:"json"}))}catch(e){return[]}const{locale:a}=ta(),r=s.map((e=>{const t=e.localizedNames,i=a.length>2&&a;let s;if("boolean"!=typeof i&&(s=t[i]),void 0===s){const e=2===a.length?a:a.slice(0,2);if(s=t[e],void 0===s){const i=Object.keys(t).find((t=>t.startsWith(e)));void 0!==i&&(s=t[i])}}return null!=s&&""!==s||(s=t[Ys.English]??t[Ys.EnglishUSA]),{name:e.name,label:s}}));if(!0===(null!==i.match(/(arcgis.com\/arcgis\/rest\/services\/world\/geocodeserver).*/gi)||function(e){return null!==e.match(/(\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/gi)}(i))){const e={name:"",label:t?.world??"World"};r.splice(Gs(r,e,"label"),0,e)}return r}),{serializer:e=>{const{data:{geocodeServiceURL:t}}=e;return t??"EMPTY_KEY"}}),Sr((async(e,t)=>{const i=function(e,t){const{locale:i}=ta(),s=fc(e,"geocodeServiceURL");let a={asyncGeocodeUrl:t.helperServices.asyncGeocode.url,geocodeServiceURL:s,locale:i};const r=wc(ai(e,"inputFileItem.itemId"),t),n=fc(e,"inputTable");if(Js(r?.id))Js(n?.url)||(a={...a,inputTable:{url:n.url,serviceToken:n.serviceToken}});else{const e="CSV"===r.type?"csv":"xlsx";a={...a,inputFileItem:{itemid:r.id},inputFileParameters:{fileType:e,headerRowExists:"true",columnDelimiter:"",textQualifier:""}}}return a}(e,t);let s,a,r;try{s=await bc(i)}catch(e){return{geocodeParameters:void 0,addressFields:[],labels:{},values:[]}}try{a=JSON.parse(s.field_info),r=JSON.parse(s.field_mapping).reduce(((e,t)=>({...e,[t[1]]:t[0]})),{})}catch(e){return{addressFields:[],labels:{},values:[]}}const n=a.map((e=>e[0])),o=n.reduce(((e,t)=>({...e,[t]:t})),{});return{geocodeParameters:s,addressFields:n,labels:o,values:Lr.map((e=>r[e]))}}),{serializer:e=>{const{geocodeServiceURL:t,inputFileItem:i,inputTable:s}=e[0],a=i?.itemId,r=s?.url;return Js(t)||Js(a)&&Js(r)?"EMPTY_KEY":`${t}${a}${r}`}});async function _r(e,t){const s=await async function(e=ta().locale){let t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-3e73a4").then(i.bind(i,89001));switch(e){case Ys.Arabic:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-78131c").then(i.bind(i,54423));break;case Ys.Bosnian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-a0a294").then(i.bind(i,87486));break;case Ys.Bulgarian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-0d0ecd").then(i.bind(i,88257));break;case Ys.Catalan:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-82d7e4").then(i.bind(i,2042));break;case Ys.Czech:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-21d138").then(i.bind(i,93672));break;case Ys.Danish:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-219e85").then(i.bind(i,50700));break;case Ys.German:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-73fd2f").then(i.bind(i,76254));break;case Ys.Greek:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-f91d86").then(i.bind(i,84029));break;case Ys.EnglishUSA:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-e65757").then(i.bind(i,45579));break;case Ys.Spanish:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-83f2d7").then(i.bind(i,12352));break;case Ys.Estonian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-6b55b7").then(i.bind(i,23142));break;case Ys.Finnish:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-40329c").then(i.bind(i,49966));break;case Ys.French:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-9d2269").then(i.bind(i,9472));break;case Ys.Hebrew:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-8aba1d").then(i.bind(i,27062));break;case Ys.Croatian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-176fb8").then(i.bind(i,73022));break;case Ys.Hungarian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-f7e24d").then(i.bind(i,97355));break;case Ys.Indonesian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-12f1da").then(i.bind(i,54944));break;case Ys.Italian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-eb7151").then(i.bind(i,98928));break;case Ys.Japanese:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-5a69d8").then(i.bind(i,51678));break;case Ys.Korean:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-ad9f6b").then(i.bind(i,1934));break;case Ys.Lithuanian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-bfd7c4").then(i.bind(i,41610));break;case Ys.Latvian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-1aee01").then(i.bind(i,48288));break;case Ys.NorwegianBokml:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-d1758e").then(i.bind(i,69025));break;case Ys.Dutch:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-6b95f1").then(i.bind(i,60922));break;case Ys.Polish:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-1e9a27").then(i.bind(i,65984));break;case Ys.PortugueseBrazil:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-e8ed63").then(i.bind(i,19953));break;case Ys.PortuguesePortugal:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-0042fc").then(i.bind(i,79717));break;case Ys.Romanian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-101055").then(i.bind(i,10402));break;case Ys.Russian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-aad84e").then(i.bind(i,1681));break;case Ys.Serbian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-7e5109").then(i.bind(i,16076));break;case Ys.Slovak:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-99129d").then(i.bind(i,65023));break;case Ys.Slovenian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-c19798").then(i.bind(i,3983));break;case Ys.Swedish:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-152fe7").then(i.bind(i,16778));break;case Ys.Thai:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-1004a2").then(i.bind(i,23889));break;case Ys.Turkish:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-313dc4").then(i.bind(i,40766));break;case Ys.Ukrainian:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-7d20da").then(i.bind(i,92481));break;case Ys.Vietnamese:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-36032f").then(i.bind(i,30221));break;case Ys.ChineseChina:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-5a68b4").then(i.bind(i,90894));break;case Ys.ChineseHongKong:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-63ee50").then(i.bind(i,98551));break;case Ys.ChineseTaiwan:t=await i.e("extensions_widgets_arcgis_analysis_node_modules_arcgis_analysis-components_dist_esm_errors_t9-154a59").then(i.bind(i,48405))}return t}(),a=s[e]??s.defaultError;throw new ia(e,a,{type:"analysis_ui"},t)}const Ir="hydrated",Mr=!1,xr=!1,Er=!0;var Tr=Object.defineProperty,Pr=new WeakMap,Ar=(e,t)=>t in e,Fr=(e,t)=>(0,console.error)(e,t),Or=new Map,Dr="undefined"!=typeof window?window:{},$r=Dr.document||{head:{}},Br={$flags$:0,$resourcesUrl$:"",jmp:e=>e(),raf:e=>requestAnimationFrame(e),ael:(e,t,i,s)=>e.addEventListener(t,i,s),rel:(e,t,i,s)=>e.removeEventListener(t,i,s),ce:(e,t)=>new CustomEvent(e,t)},jr=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch(e){}return!1})(),Vr=!1,Rr=[],qr=[],zr=(e,t)=>i=>{e.push(i),Vr||(Vr=!0,t&&4&Br.$flags$?Nr(Ur):Br.raf(Ur))},Hr=e=>{for(let t=0;t<e.length;t++)try{e[t](performance.now())}catch(e){Fr(e)}e.length=0},Ur=()=>{Hr(Rr),Hr(qr),(Vr=Rr.length>0)&&Br.raf(Ur)},Nr=e=>{return Promise.resolve(t).then(e);var t},Wr=zr(qr,!0),Gr={},Qr=e=>"object"===(e=typeof e)||"function"===e;((e,t)=>{for(var i in t)Tr(e,i,{get:t[i],enumerable:!0})})({},{err:()=>Kr,map:()=>Yr,ok:()=>Jr,unwrap:()=>en,unwrapErr:()=>tn});var Jr=e=>({isOk:!0,isErr:!1,value:e}),Kr=e=>({isOk:!1,isErr:!0,value:e});function Yr(e,t){if(e.isOk){const i=t(e.value);return i instanceof Promise?i.then((e=>Jr(e))):Jr(i)}if(e.isErr){const t=e.value;return Kr(t)}throw"should never get here"}var Zr,Xr,en=e=>{if(e.isOk)return e.value;throw e.value},tn=e=>{if(e.isErr)return e.value;throw e.value},sn=(e,t,...i)=>{let s=null,a=null,r=!1,n=!1;const o=[],l=t=>{for(let i=0;i<t.length;i++)s=t[i],Array.isArray(s)?l(s):null!=s&&"boolean"!=typeof s&&((r="function"!=typeof e&&!Qr(s))&&(s=String(s)),r&&n?o[o.length-1].$text$+=s:o.push(r?an(null,s):s),n=r)};if(l(i),t){t.key&&(a=t.key);{const e=t.className||t.class;e&&(t.class="object"!=typeof e?e:Object.keys(e).filter((t=>e[t])).join(" "))}}if("function"==typeof e)return e(null===t?{}:t,o,nn);const h=an(e,null);return h.$attrs$=t,o.length>0&&(h.$children$=o),h.$key$=a,h},an=(e,t)=>{const i={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null,$attrs$:null,$key$:null};return i},rn={},nn={forEach:(e,t)=>e.map(on).forEach(t),map:(e,t)=>e.map(on).map(t).map(ln)},on=e=>({vattrs:e.$attrs$,vchildren:e.$children$,vkey:e.$key$,vname:e.$name$,vtag:e.$tag$,vtext:e.$text$}),ln=e=>{if("function"==typeof e.vtag){const t={...e.vattrs};return e.vkey&&(t.key=e.vkey),e.vname&&(t.name=e.vname),sn(e.vtag,t,...e.vchildren||[])}const t=an(e.vtag,e.vtext);return t.$attrs$=e.vattrs,t.$children$=e.vchildren,t.$key$=e.vkey,t.$name$=e.vname,t},hn=(e,t,i,s,a,r)=>{if(i!==s){let n=Ar(e,t),o=t.toLowerCase();if("class"===t){const t=e.classList,a=dn(i),r=dn(s);e["s-si"]&&r.indexOf(e["s-si"])<0&&r.push(e["s-si"]),t.remove(...a.filter((e=>e&&!r.includes(e)))),t.add(...r.filter((e=>e&&!a.includes(e))))}else if("style"===t){for(const t in i)s&&null!=s[t]||(t.includes("-")?e.style.removeProperty(t):e.style[t]="");for(const t in s)i&&s[t]===i[t]||(t.includes("-")?e.style.setProperty(t,s[t]):e.style[t]=s[t])}else if("key"===t);else if("ref"===t)s&&s(e);else if(n||"o"!==t[0]||"n"!==t[1]){const o=Qr(s);if((n||o&&null!==s)&&!a)try{if(e.tagName.includes("-"))e[t]=s;else{const a=null==s?"":s;"list"===t?n=!1:null!=i&&e[t]==a||("function"==typeof e.__lookupSetter__(t)?e[t]=a:e.setAttribute(t,a))}}catch(e){}null==s||!1===s?!1===s&&""!==e.getAttribute(t)||e.removeAttribute(t):(!n||4&r||a)&&!o&&(s=!0===s?"":s,e.setAttribute(t,s))}else if(t="-"===t[2]?t.slice(3):Ar(Dr,o)?o.slice(2):o[2]+t.slice(3),i||s){const a=t.endsWith(un);t=t.replace(pn,""),i&&Br.rel(e,t,i,a),s&&Br.ael(e,t,s,a)}}},cn=/\s/,dn=e=>e?e.split(cn):[],un="Capture",pn=new RegExp(un+"$"),mn=(e,t,i)=>{const s=11===t.$elm$.nodeType&&t.$elm$.host?t.$elm$.host:t.$elm$,a=e&&e.$attrs$||Gr,r=t.$attrs$||Gr;for(const e of yn(Object.keys(a)))e in r||hn(s,e,a[e],void 0,i,t.$flags$);for(const e of yn(Object.keys(r)))hn(s,e,a[e],r[e],i,t.$flags$)};function yn(e){return e.includes("ref")?[...e.filter((e=>"ref"!==e)),"ref"]:e}var vn=!1,gn=!1,fn=(e,t,i,s)=>{const a=t.$children$[i];let r,n,o=0;if(null!==a.$text$)r=a.$elm$=$r.createTextNode(a.$text$);else{r=a.$elm$=$r.createElement(!vn&&xr&&2&a.$flags$?"slot-fb":a.$tag$),mn(null,a,gn);if(!!r.getRootNode().querySelector("body")&&Mr&&null!=Zr&&r["s-si"]!==Zr&&r.classList.add(r["s-si"]=Zr),a.$children$)for(o=0;o<a.$children$.length;++o)n=fn(e,a,o),n&&r.appendChild(n)}return r["s-hn"]=Xr,r},bn=(e,t,i,s,a,r)=>{let n,o=e;for(o.shadowRoot&&o.tagName===Xr&&(o=o.shadowRoot);a<=r;++a)s[a]&&(n=fn(null,i,a),n&&(s[a].$elm$=n,Ln(o,n,t)))},wn=(e,t,i)=>{for(let s=t;s<=i;++s){const t=e[s];if(t){const e=t.$elm$;Sn(t),e&&e.remove()}}},Cn=(e,t,i=!1)=>e.$tag$===t.$tag$&&(!!i||e.$key$===t.$key$),kn=(e,t,i=!1)=>{const s=t.$elm$=e.$elm$,a=e.$children$,r=t.$children$,n=t.$tag$,o=t.$text$;null===o?(("slot"!==n||vn)&&mn(e,t,gn),null!==a&&null!==r?((e,t,i,s,a=!1)=>{let r,n,o=0,l=0,h=0,c=0,d=t.length-1,u=t[0],p=t[d],m=s.length-1,y=s[0],v=s[m];for(;o<=d&&l<=m;)if(null==u)u=t[++o];else if(null==p)p=t[--d];else if(null==y)y=s[++l];else if(null==v)v=s[--m];else if(Cn(u,y,a))kn(u,y,a),u=t[++o],y=s[++l];else if(Cn(p,v,a))kn(p,v,a),p=t[--d],v=s[--m];else if(Cn(u,v,a))kn(u,v,a),Ln(e,u.$elm$,p.$elm$.nextSibling),u=t[++o],v=s[--m];else if(Cn(p,y,a))kn(p,y,a),Ln(e,p.$elm$,u.$elm$),p=t[--d],y=s[++l];else{for(h=-1,c=o;c<=d;++c)if(t[c]&&null!==t[c].$key$&&t[c].$key$===y.$key$){h=c;break}h>=0?(n=t[h],n.$tag$!==y.$tag$?r=fn(t&&t[l],i,h):(kn(n,y,a),t[h]=void 0,r=n.$elm$),y=s[++l]):(r=fn(t&&t[l],i,l),y=s[++l]),r&&Ln(u.$elm$.parentNode,r,u.$elm$)}o>d?bn(e,null==s[m+1]?null:s[m+1].$elm$,i,s,l,m):l>m&&wn(t,o,d)})(s,a,t,r,i):null!==r?(null!==e.$text$&&(s.textContent=""),bn(s,null,t,r,0,r.length-1)):!i&&Er&&null!==a&&wn(a,0,a.length-1)):e.$text$!==o&&(s.data=o)},Sn=e=>{e.$attrs$&&e.$attrs$.ref&&e.$attrs$.ref(null),e.$children$&&e.$children$.map(Sn)},Ln=(e,t,i)=>null==e?void 0:e.insertBefore(t,i),_n=(e,t,i=!1)=>{const s=e.$hostElement$,a=e.$cmpMeta$,r=e.$vnode$||an(null,null),n=(o=t)&&o.$tag$===rn?t:sn(null,null,t);var o;if(Xr=s.tagName,a.$attrsToReflect$&&(n.$attrs$=n.$attrs$||{},a.$attrsToReflect$.map((([e,t])=>n.$attrs$[t]=s[e]))),i&&n.$attrs$)for(const e of Object.keys(n.$attrs$))s.hasAttribute(e)&&!["key","ref","style","class"].includes(e)&&(n.$attrs$[e]=s[e]);n.$tag$=null,n.$flags$|=4,e.$vnode$=n,n.$elm$=r.$elm$=s.shadowRoot||s,Zr=s["s-sc"],vn=!!(1&a.$flags$),kn(r,n,i)},In=new WeakMap,Mn=e=>{const t=e.$cmpMeta$,i=e.$hostElement$,s=t.$flags$,a=(t.$tagName$,()=>{}),r=((e,t)=>{var i;const s=xn(t),a=Or.get(s);if(e=11===e.nodeType?e:$r,a)if("string"==typeof a){e=e.head||e;let r,n=In.get(e);if(n||In.set(e,n=new Set),!n.has(s)){{r=$r.createElement("style"),r.innerHTML=a;const s=null!=(i=Br.$nonce$)?i:function(e){var t,i,s;return null!=(s=null==(i=null==(t=e.head)?void 0:t.querySelector('meta[name="csp-nonce"]'))?void 0:i.getAttribute("content"))?s:void 0}($r);if(null!=s&&r.setAttribute("nonce",s),!(1&t.$flags$))if("HEAD"===e.nodeName){const t=e.querySelectorAll("link[rel=preconnect]"),i=t.length>0?t[t.length-1].nextSibling:e.querySelector("style");e.insertBefore(r,i)}else if("host"in e)if(jr){const t=new CSSStyleSheet;t.replaceSync(a),e.adoptedStyleSheets=[t,...e.adoptedStyleSheets]}else{const t=e.querySelector("style");t?t.innerHTML=a+t.innerHTML:e.prepend(r)}else e.append(r);1&t.$flags$&&"HEAD"!==e.nodeName&&e.insertBefore(r,null)}4&t.$flags$&&(r.innerHTML+="slot-fb{display:contents}slot-fb[hidden]{display:none}"),n&&n.add(s)}}else e.adoptedStyleSheets.includes(a)||(e.adoptedStyleSheets=[...e.adoptedStyleSheets,a]);return s})(i.shadowRoot?i.shadowRoot:i.getRootNode(),t);10&s&&2&s&&(i["s-sc"]=r,i.classList.add(r+"-h")),a()},xn=(e,t)=>"sc-"+e.$tagName$,En=(e,t)=>{if(e.$flags$|=16,4&e.$flags$)return void(e.$flags$|=512);((e,t)=>{t&&!e.$onRenderResolve$&&t["s-p"]&&t["s-p"].push(new Promise((t=>e.$onRenderResolve$=t)))})(e,e.$ancestorComponent$);return Wr((()=>Tn(e,t)))},Tn=(e,t)=>{const i=e.$hostElement$,s=(e.$cmpMeta$.$tagName$,()=>{}),a=e.$lazyInstance$;if(!a)throw new Error(`Can't render component <${i.tagName.toLowerCase()} /> with invalid Stencil runtime! Make sure this imported component is compiled with a \`externalRuntime: true\` flag. For more information, please refer to https://stenciljs.com/docs/custom-elements#externalruntime`);let r;return t&&(e.$flags$|=256,e.$queuedListeners$&&(e.$queuedListeners$.map((([e,t])=>Rn(a,e,t))),e.$queuedListeners$=void 0),r=Rn(a,"componentWillLoad")),r=Pn(r,(()=>Rn(a,"componentWillRender"))),s(),Pn(r,(()=>Fn(e,a,t)))},Pn=(e,t)=>An(e)?e.then(t).catch((e=>{console.error(e),t()})):t(),An=e=>e instanceof Promise||e&&e.then&&"function"==typeof e.then,Fn=async(e,t,i)=>{var s;const a=e.$hostElement$,r=(e.$cmpMeta$.$tagName$,()=>{}),n=a["s-rc"];i&&Mn(e);const o=(e.$cmpMeta$.$tagName$,()=>{});Dn(e,t,a,i),n&&(n.map((e=>e())),a["s-rc"]=void 0),o(),r();{const t=null!=(s=a["s-p"])?s:[],i=()=>Bn(e);0===t.length?i():(Promise.all(t).then(i),e.$flags$|=4,t.length=0)}},On=null,Dn=(e,t,i,s)=>{try{On=t,t=t.render(),e.$flags$&=-17,e.$flags$|=2,_n(e,t,s)}catch(t){Fr(t,e.$hostElement$)}return On=null,null},$n=()=>On,Bn=e=>{e.$cmpMeta$.$tagName$;const t=e.$hostElement$,i=()=>{},s=e.$lazyInstance$,a=e.$ancestorComponent$;Rn(s,"componentDidRender"),64&e.$flags$?(Rn(s,"componentDidUpdate"),i()):(e.$flags$|=64,qn(t),Rn(s,"componentDidLoad"),i(),e.$onReadyResolve$(t),a||Vn()),e.$onInstanceResolve$(t),e.$onRenderResolve$&&(e.$onRenderResolve$(),e.$onRenderResolve$=void 0),512&e.$flags$&&Nr((()=>En(e,!1))),e.$flags$&=-517},jn=e=>{{const t=(e=>Pr.get(e))(e),i=t.$hostElement$.isConnected;return i&&2==(18&t.$flags$)&&En(t,!1),i}},Vn=e=>{qn($r.documentElement),Nr((()=>((e,t,i)=>{const s=Br.ce(t,i);return e.dispatchEvent(s),s})(Dr,"appload",{detail:{namespace:"raster-function-editor"}})))},Rn=(e,t,i)=>{if(e&&e[t])try{return e[t](i)}catch(e){Fr(e)}},qn=e=>{var t;return e.classList.add(null!=(t=Ir)?t:"hydrated")};const zn=void 0!==i.g?i.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};const Hn="object"==typeof zn&&zn&&zn.Object===Object&&zn;var Un="object"==typeof self&&self&&self.Object===Object&&self;const Nn=Hn||Un||Function("return this")();const Wn=Nn.Symbol;var Gn=Object.prototype,Qn=Gn.hasOwnProperty,Jn=Gn.toString,Kn=Wn?Wn.toStringTag:void 0;var Yn=Object.prototype.toString;var Zn=Wn?Wn.toStringTag:void 0;function Xn(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Zn&&Zn in Object(e)?function(e){var t=Qn.call(e,Kn),i=e[Kn];try{e[Kn]=void 0;var s=!0}catch(e){}var a=Jn.call(e);return s&&(t?e[Kn]=i:delete e[Kn]),a}(e):function(e){return Yn.call(e)}(e)}function eo(e){return null!=e&&"object"==typeof e}const to=Array.isArray;function io(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function so(e){return e}function ao(e){if(!io(e))return!1;var t=Xn(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}const ro=Nn["__core-js_shared__"];var no=function(){var e=/[^.]+$/.exec(ro&&ro.keys&&ro.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var oo=Function.prototype.toString;function lo(e){if(null!=e){try{return oo.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var ho=/^\[object .+?Constructor\]$/,co=Function.prototype,uo=Object.prototype,po=co.toString,mo=uo.hasOwnProperty,yo=RegExp("^"+po.call(mo).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function vo(e){return!(!io(e)||function(e){return!!no&&no in e}(e))&&(ao(e)?yo:ho).test(lo(e))}function go(e,t){var i=function(e,t){return null==e?void 0:e[t]}(e,t);return vo(i)?i:void 0}const fo=go(Nn,"WeakMap");function bo(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}var wo=Date.now;function Co(e){return function(){return e}}var ko=function(){try{var e=go(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();const So=ko;var Lo=So?function(e,t){return So(e,"toString",{configurable:!0,enumerable:!1,value:Co(t),writable:!0})}:so;var _o=function(e){var t=0,i=0;return function(){var s=wo(),a=16-(s-i);if(i=s,a>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Lo);const Io=_o;var Mo=/^(?:0|[1-9]\d*)$/;function xo(e,t){var i=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==i||"symbol"!=i&&Mo.test(e))&&e>-1&&e%1==0&&e<t}function Eo(e,t,i){"__proto__"==t&&So?So(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}function To(e,t){return e===t||e!=e&&t!=t}var Po=Object.prototype.hasOwnProperty;function Ao(e,t,i){var s=e[t];Po.call(e,t)&&To(s,i)&&(void 0!==i||t in e)||Eo(e,t,i)}var Fo=Math.max;function Oo(e,t){return Io(function(e,t,i){return t=Fo(void 0===t?e.length-1:t,0),function(){for(var s=arguments,a=-1,r=Fo(s.length-t,0),n=Array(r);++a<r;)n[a]=s[t+a];a=-1;for(var o=Array(t+1);++a<t;)o[a]=s[a];return o[t]=i(n),bo(e,this,o)}}(e,t,so),e+"")}function Do(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function $o(e){return null!=e&&Do(e.length)&&!ao(e)}var Bo=Object.prototype;function jo(e){return eo(e)&&"[object Arguments]"==Xn(e)}var Vo=Object.prototype,Ro=Vo.hasOwnProperty,qo=Vo.propertyIsEnumerable,zo=jo(function(){return arguments}())?jo:function(e){return eo(e)&&Ro.call(e,"callee")&&!qo.call(e,"callee")};const Ho=zo;var Uo="object"==typeof exports&&exports&&!exports.nodeType&&exports,No=Uo&&e&&!e.nodeType&&e,Wo=No&&No.exports===Uo?Nn.Buffer:void 0;const Go=(Wo?Wo.isBuffer:void 0)||function(){return!1};var Qo={};Qo["[object Float32Array]"]=Qo["[object Float64Array]"]=Qo["[object Int8Array]"]=Qo["[object Int16Array]"]=Qo["[object Int32Array]"]=Qo["[object Uint8Array]"]=Qo["[object Uint8ClampedArray]"]=Qo["[object Uint16Array]"]=Qo["[object Uint32Array]"]=!0,Qo["[object Arguments]"]=Qo["[object Array]"]=Qo["[object ArrayBuffer]"]=Qo["[object Boolean]"]=Qo["[object DataView]"]=Qo["[object Date]"]=Qo["[object Error]"]=Qo["[object Function]"]=Qo["[object Map]"]=Qo["[object Number]"]=Qo["[object Object]"]=Qo["[object RegExp]"]=Qo["[object Set]"]=Qo["[object String]"]=Qo["[object WeakMap]"]=!1;var Jo="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ko=Jo&&e&&!e.nodeType&&e,Yo=Ko&&Ko.exports===Jo&&Hn.process,Zo=function(){try{var e=Ko&&Ko.require&&Ko.require("util").types;return e||Yo&&Yo.binding&&Yo.binding("util")}catch(e){}}();var Xo=Zo&&Zo.isTypedArray,el=Xo?function(e){return function(t){return e(t)}}(Xo):function(e){return eo(e)&&Do(e.length)&&!!Qo[Xn(e)]};const tl=el;var il=Object.prototype.hasOwnProperty;function sl(e,t){var i=to(e),s=!i&&Ho(e),a=!i&&!s&&Go(e),r=!i&&!s&&!a&&tl(e),n=i||s||a||r,o=n?function(e,t){for(var i=-1,s=Array(e);++i<e;)s[i]=t(i);return s}(e.length,String):[],l=o.length;for(var h in e)!t&&!il.call(e,h)||n&&("length"==h||a&&("offset"==h||"parent"==h)||r&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||xo(h,l))||o.push(h);return o}var al,rl=Object.prototype.hasOwnProperty;function nl(e){if(!io(e))return function(e){var t=[];if(null!=e)for(var i in Object(e))t.push(i);return t}(e);var t=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Bo)}(e),i=[];for(var s in e)("constructor"!=s||!t&&rl.call(e,s))&&i.push(s);return i}al=function(e,t,i,s){!function(e,t,i,s){var a=!i;i||(i={});for(var r=-1,n=t.length;++r<n;){var o=t[r],l=s?s(i[o],e[o],o,i,e):void 0;void 0===l&&(l=e[o]),a?Eo(i,o,l):Ao(i,o,l)}}(t,function(e){return $o(e)?sl(e,!0):nl(e)}(t),e,s)},Oo((function(e,t){var i=-1,s=t.length,a=s>1?t[s-1]:void 0,r=s>2?t[2]:void 0;for(a=al.length>3&&"function"==typeof a?(s--,a):void 0,r&&function(e,t,i){if(!io(i))return!1;var s=typeof t;return!!("number"==s?$o(i)&&xo(t,i.length):"string"==s&&t in i)&&To(i[t],e)}(t[0],t[1],r)&&(a=s<3?void 0:a,s=1),e=Object(e);++i<s;){var n=t[i];n&&al(e,n,i,a)}return e}));const ol=go(Object,"create");var ll=Object.prototype.hasOwnProperty;var hl=Object.prototype.hasOwnProperty;function cl(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}function dl(e,t){for(var i=e.length;i--;)if(To(e[i][0],t))return i;return-1}cl.prototype.clear=function(){this.__data__=ol?ol(null):{},this.size=0},cl.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},cl.prototype.get=function(e){var t=this.__data__;if(ol){var i=t[e];return"__lodash_hash_undefined__"===i?void 0:i}return ll.call(t,e)?t[e]:void 0},cl.prototype.has=function(e){var t=this.__data__;return ol?void 0!==t[e]:hl.call(t,e)},cl.prototype.set=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=ol&&void 0===t?"__lodash_hash_undefined__":t,this};var ul=Array.prototype.splice;function pl(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}pl.prototype.clear=function(){this.__data__=[],this.size=0},pl.prototype.delete=function(e){var t=this.__data__,i=dl(t,e);return!(i<0)&&(i==t.length-1?t.pop():ul.call(t,i,1),--this.size,!0)},pl.prototype.get=function(e){var t=this.__data__,i=dl(t,e);return i<0?void 0:t[i][1]},pl.prototype.has=function(e){return dl(this.__data__,e)>-1},pl.prototype.set=function(e,t){var i=this.__data__,s=dl(i,e);return s<0?(++this.size,i.push([e,t])):i[s][1]=t,this};const ml=go(Nn,"Map");function yl(e,t){var i=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?i["string"==typeof t?"string":"hash"]:i.map}function vl(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}vl.prototype.clear=function(){this.size=0,this.__data__={hash:new cl,map:new(ml||pl),string:new cl}},vl.prototype.delete=function(e){var t=yl(this,e).delete(e);return this.size-=t?1:0,t},vl.prototype.get=function(e){return yl(this,e).get(e)},vl.prototype.has=function(e){return yl(this,e).has(e)},vl.prototype.set=function(e,t){var i=yl(this,e),s=i.size;return i.set(e,t),this.size+=i.size==s?0:1,this};var gl=function(e,t){return function(i){return e(t(i))}}(Object.getPrototypeOf,Object);const fl=gl;var bl=Function.prototype,wl=Object.prototype,Cl=bl.toString,kl=wl.hasOwnProperty,Sl=Cl.call(Object);function Ll(e){if(!eo(e))return!1;var t=Xn(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!function(e){if(!eo(e)||"[object Object]"!=Xn(e))return!1;var t=fl(e);if(null===t)return!0;var i=kl.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&Cl.call(i)==Sl}(e)}Oo((function(e,t){try{return bo(e,void 0,t)}catch(e){return Ll(e)?e:new Error(e)}})),"object"==typeof exports&&exports&&!exports.nodeType&&exports&&e&&e.nodeType;const _l=go(Nn,"DataView");const Il=go(Nn,"Promise");const Ml=go(Nn,"Set");var xl="[object Map]",El="[object Promise]",Tl="[object Set]",Pl="[object WeakMap]",Al="[object DataView]",Fl=lo(_l),Ol=lo(ml),Dl=lo(Il),$l=lo(Ml),Bl=lo(fo),jl=Xn;(_l&&jl(new _l(new ArrayBuffer(1)))!=Al||ml&&jl(new ml)!=xl||Il&&jl(Il.resolve())!=El||Ml&&jl(new Ml)!=Tl||fo&&jl(new fo)!=Pl)&&(jl=function(e){var t=Xn(e),i="[object Object]"==t?e.constructor:void 0,s=i?lo(i):"";if(s)switch(s){case Fl:return Al;case Ol:return xl;case Dl:return El;case $l:return Tl;case Bl:return Pl}return t});const Vl=e=>!("isConnected"in e)||e.isConnected,Rl=((e,t)=>{let i;return(...s)=>{i&&clearTimeout(i),i=setTimeout((()=>{i=0,e(...s)}),t)}})((e=>{for(let t of e.keys())e.set(t,e.get(t).filter(Vl))}),2e3),ql=e=>"function"==typeof e?e():e,zl=(e,t)=>{const i=e.indexOf(t);i>=0&&(e[i]=e[e.length-1],e.length--)};var Hl={exports:{}};function Ul(e,t,i,s){var a=function(e){return null==e||"number"==typeof e||"boolean"==typeof e}(s)?s:i(s),r=t.get(a);return void 0===r&&(r=e.call(this,s),t.set(a,r)),r}function Nl(e,t,i){var s=Array.prototype.slice.call(arguments,3),a=i(s),r=t.get(a);return void 0===r&&(r=e.apply(this,s),t.set(a,r)),r}function Wl(e,t,i,s,a){return i.bind(t,e,s,a)}function Gl(e,t){return Wl(e,this,1===e.length?Ul:Nl,t.cache.create(),t.serializer)}function Ql(){return JSON.stringify(arguments)}function Jl(){this.cache=Object.create(null)}Jl.prototype.has=function(e){return e in this.cache},Jl.prototype.get=function(e){return this.cache[e]},Jl.prototype.set=function(e,t){this.cache[e]=t};var Kl={create:function(){return new Jl}};Hl.exports=function(e,t){var i=t&&t.cache?t.cache:Kl,s=t&&t.serializer?t.serializer:Ql;return(t&&t.strategy?t.strategy:Gl)(e,{cache:i,serializer:s})},Hl.exports.strategies={variadic:function(e,t){return Wl(e,this,Nl,t.cache.create(),t.serializer)},monadic:function(e,t){return Wl(e,this,Ul,t.cache.create(),t.serializer)}};const Yl=Hl.exports;Yl((async e=>{const t=new d.default({url:e});t.authMode="immediate";try{await t.load()}catch(e){console.error(e)}return t}));const Zl=Yl((async e=>{const{restUrl:t}=e,i=`${t}/portals/helpmap`;let s;try{const e=await async function(e,t){return(0,p.default)(e,t)}(i,{query:{f:"json"},responseType:"json",method:"auto"});s=await(e.data?.helpMap)??void 0}catch(e){s=void 0}return console.log(s),s}),{serializer:e=>`${e[0]}-${e[1]?.url}`});const Xl=((e,t)=>{const i=((e,t=(e,t)=>e!==t)=>{const i=ql(e);let s=new Map(Object.entries(null!=i?i:{}));const a={dispose:[],get:[],set:[],reset:[]},r=()=>{var t;s=new Map(Object.entries(null!==(t=ql(e))&&void 0!==t?t:{})),a.reset.forEach((e=>e()))},n=e=>(a.get.forEach((t=>t(e))),s.get(e)),o=(e,i)=>{const r=s.get(e);t(i,r,e)&&(s.set(e,i),a.set.forEach((t=>t(e,i,r))))},l="undefined"==typeof Proxy?{}:new Proxy(i,{get:(e,t)=>n(t),ownKeys:e=>Array.from(s.keys()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),has:(e,t)=>s.has(t),set:(e,t,i)=>(o(t,i),!0)}),h=(e,t)=>(a[e].push(t),()=>{zl(a[e],t)});return{state:l,get:n,set:o,on:h,onChange:(t,i)=>{const s=h("set",((e,s)=>{e===t&&i(s)})),a=h("reset",(()=>i(ql(e)[t])));return()=>{s(),a()}},use:(...e)=>{const t=e.reduce(((e,t)=>(t.set&&e.push(h("set",t.set)),t.get&&e.push(h("get",t.get)),t.reset&&e.push(h("reset",t.reset)),t.dispose&&e.push(h("dispose",t.dispose)),e)),[]);return()=>t.forEach((e=>e()))},dispose:()=>{a.dispose.forEach((e=>e())),r()},reset:r,forceUpdate:e=>{const t=s.get(e);a.set.forEach((i=>i(e,t,t)))}}})(e,t);return i.use((()=>{const e=new Map;return{dispose:()=>e.clear(),get:t=>{const i=$n();i&&((e,t,i)=>{const s=e.get(t);s?s.includes(i)||s.push(i):e.set(t,[i])})(e,t,i)},set:t=>{const i=e.get(t);i&&e.set(t,i.filter(jn)),Rl(e)},reset:()=>{e.forEach((e=>e.forEach(jn))),Rl(e)}}})()),i})({portal:undefined,assetPath:undefined,coreStrings:undefined,selectedFileName:undefined,entryPoint:undefined,isRightToLeft:!1,isLoadingRFT:!1,isViewerUserType:!1,rftId:undefined,canUpdateItem:!1,activeRFxTemplates:[],portalHelpMap:undefined,currentViewport:{x:0,y:0,width:0,height:0}}),eh=Xl.state;Xl.onChange("portal",(async e=>{void 0!==e&&e.isPortal&&(eh.portalHelpMap=await Zl(e))}));const th={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function ih(e,t,i){i<0&&++i,i>1&&--i;const s=6*i;return s<1?e+(t-e)*s:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e}function sh(){return[0,0,0]}function ah(e,t,i){return[e,t,i]}function rh(){return[0,0,0]}function nh(){return ah(1,1,1)}function oh(){return ah(1,0,0)}function lh(){return ah(0,1,0)}function hh(){return ah(0,0,1)}const ch=[0,0,0],dh=nh(),uh=oh(),ph=lh(),mh=hh();Object.freeze(Object.defineProperty({__proto__:null,ONES:dh,UNIT_X:uh,UNIT_Y:ph,UNIT_Z:mh,ZEROS:ch,clone:function(e){return[e[0],e[1],e[2]]},create:sh,createView:function(e,t){return new Float64Array(e,t,3)},fromArray:function(e){const t=[0,0,0],i=Math.min(3,e.length);for(let s=0;s<i;++s)t[s]=e[s];return t},fromValues:ah,ones:nh,unitX:oh,unitY:lh,unitZ:hh,zeros:rh},Symbol.toStringTag,{value:"Module"}));let yh=1e-6;function vh(){return yh}const gh=Math.random,fh=Math.PI/180,bh=180/Math.PI;function wh(e){const t=e[0],i=e[1],s=e[2];return Math.sqrt(t*t+i*i+s*s)}function Ch(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function kh(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e}function Sh(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e}function Lh(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e}function _h(e,t){const i=t[0]-e[0],s=t[1]-e[1],a=t[2]-e[2];return Math.sqrt(i*i+s*s+a*a)}function Ih(e,t){const i=t[0]-e[0],s=t[1]-e[1],a=t[2]-e[2];return i*i+s*s+a*a}function Mh(e){const t=e[0],i=e[1],s=e[2];return t*t+i*i+s*s}function xh(e,t){const i=t[0],s=t[1],a=t[2];let r=i*i+s*s+a*a;return r>0&&(r=1/Math.sqrt(r),e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r),e}function Eh(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:gh,equals:function(e,t){return Math.abs(e-t)<=yh*Math.max(1,Math.abs(e),Math.abs(t))},getEpsilon:vh,setEpsilon:function(e){yh=e},toDegree:function(e){return e*bh},toRadian:function(e){return e*fh}},Symbol.toStringTag,{value:"Module"}));const Th=[0,0,0],Ph=[0,0,0];const Ah=kh,Fh=Sh,Oh=Lh,Dh=_h,$h=Ih,Bh=wh,jh=Mh;function Vh(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e[2]=t[2]-i[2],e[3]=t[3]-i[3],e}function Rh(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e[2]=t[2]*i[2],e[3]=t[3]*i[3],e}function qh(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e[2]=t[2]/i[2],e[3]=t[3]/i[3],e}function zh(e,t){const i=t[0]-e[0],s=t[1]-e[1],a=t[2]-e[2],r=t[3]-e[3];return Math.sqrt(i*i+s*s+a*a+r*r)}function Hh(e,t){const i=t[0]-e[0],s=t[1]-e[1],a=t[2]-e[2],r=t[3]-e[3];return i*i+s*s+a*a+r*r}function Uh(e){const t=e[0],i=e[1],s=e[2],a=e[3];return Math.sqrt(t*t+i*i+s*s+a*a)}function Nh(e){const t=e[0],i=e[1],s=e[2],a=e[3];return t*t+i*i+s*s+a*a}Object.freeze(Object.defineProperty({__proto__:null,abs:function(e,t){return e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e[2]=Math.abs(t[2]),e},add:function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e},angle:function(e,t){Ch(Th,e),Ch(Ph,t),xh(Th,Th),xh(Ph,Ph);const i=Eh(Th,Ph);return i>1?0:i<-1?Math.PI:Math.acos(i)},bezier:function(e,t,i,s,a,r){const n=1-r,o=n*n,l=r*r,h=o*n,c=3*r*o,d=3*l*n,u=l*r;return e[0]=t[0]*h+i[0]*c+s[0]*d+a[0]*u,e[1]=t[1]*h+i[1]*c+s[1]*d+a[1]*u,e[2]=t[2]*h+i[2]*c+s[2]*d+a[2]*u,e},ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},copy:Ch,cross:function(e,t,i){const s=t[0],a=t[1],r=t[2],n=i[0],o=i[1],l=i[2];return e[0]=a*l-r*o,e[1]=r*n-s*l,e[2]=s*o-a*n,e},direction:function(e,t,i){const s=i[0]-t[0],a=i[1]-t[1],r=i[2]-t[2];let n=s*s+a*a+r*r;return n>0?(n=1/Math.sqrt(n),e[0]=s*n,e[1]=a*n,e[2]=r*n,e):(e[0]=0,e[1]=0,e[2]=0,e)},dist:Dh,distance:_h,div:Oh,divide:Lh,dot:Eh,equals:function(e,t){if(e===t)return!0;const i=e[0],s=e[1],a=e[2],r=t[0],n=t[1],o=t[2],l=vh();return Math.abs(i-r)<=l*Math.max(1,Math.abs(i),Math.abs(r))&&Math.abs(s-n)<=l*Math.max(1,Math.abs(s),Math.abs(n))&&Math.abs(a-o)<=l*Math.max(1,Math.abs(a),Math.abs(o))},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},hermite:function(e,t,i,s,a,r){const n=r*r,o=n*(2*r-3)+1,l=n*(r-2)+r,h=n*(r-1),c=n*(3-2*r);return e[0]=t[0]*o+i[0]*l+s[0]*h+a[0]*c,e[1]=t[1]*o+i[1]*l+s[1]*h+a[1]*c,e[2]=t[2]*o+i[2]*l+s[2]*h+a[2]*c,e},inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},len:Bh,length:wh,lerp:function(e,t,i,s){const a=t[0],r=t[1],n=t[2];return e[0]=a+s*(i[0]-a),e[1]=r+s*(i[1]-r),e[2]=n+s*(i[2]-n),e},max:function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e},min:function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e},mul:Fh,multiply:Sh,negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},normalize:xh,random:function(e,t){t=t||1;const i=gh,s=2*i()*Math.PI,a=2*i()-1,r=Math.sqrt(1-a*a)*t;return e[0]=Math.cos(s)*r,e[1]=Math.sin(s)*r,e[2]=a*t,e},rotateX:function(e,t,i,s){const a=[],r=[];return a[0]=t[0]-i[0],a[1]=t[1]-i[1],a[2]=t[2]-i[2],r[0]=a[0],r[1]=a[1]*Math.cos(s)-a[2]*Math.sin(s),r[2]=a[1]*Math.sin(s)+a[2]*Math.cos(s),e[0]=r[0]+i[0],e[1]=r[1]+i[1],e[2]=r[2]+i[2],e},rotateY:function(e,t,i,s){const a=[],r=[];return a[0]=t[0]-i[0],a[1]=t[1]-i[1],a[2]=t[2]-i[2],r[0]=a[2]*Math.sin(s)+a[0]*Math.cos(s),r[1]=a[1],r[2]=a[2]*Math.cos(s)-a[0]*Math.sin(s),e[0]=r[0]+i[0],e[1]=r[1]+i[1],e[2]=r[2]+i[2],e},rotateZ:function(e,t,i,s){const a=[],r=[];return a[0]=t[0]-i[0],a[1]=t[1]-i[1],a[2]=t[2]-i[2],r[0]=a[0]*Math.cos(s)-a[1]*Math.sin(s),r[1]=a[0]*Math.sin(s)+a[1]*Math.cos(s),r[2]=a[2],e[0]=r[0]+i[0],e[1]=r[1]+i[1],e[2]=r[2]+i[2],e},round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},scale:function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e},scaleAndAdd:function(e,t,i,s){return e[0]=t[0]+i[0]*s,e[1]=t[1]+i[1]*s,e[2]=t[2]+i[2]*s,e},set:function(e,t,i,s){return e[0]=t,e[1]=i,e[2]=s,e},sign:function(e,t){return e[0]=Math.sign(t[0]),e[1]=Math.sign(t[1]),e[2]=Math.sign(t[2]),e},sqrDist:$h,sqrLen:jh,squaredDistance:Ih,squaredLength:Mh,str:function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},sub:Ah,subtract:kh,transformMat3:function(e,t,i){const s=t[0],a=t[1],r=t[2];return e[0]=s*i[0]+a*i[3]+r*i[6],e[1]=s*i[1]+a*i[4]+r*i[7],e[2]=s*i[2]+a*i[5]+r*i[8],e},transformMat4:function(e,t,i){const s=t[0],a=t[1],r=t[2];return e[0]=i[0]*s+i[4]*a+i[8]*r+i[12],e[1]=i[1]*s+i[5]*a+i[9]*r+i[13],e[2]=i[2]*s+i[6]*a+i[10]*r+i[14],e},transformQuat:function(e,t,i){const s=i[0],a=i[1],r=i[2],n=i[3],o=t[0],l=t[1],h=t[2];let c=a*h-r*l,d=r*o-s*h,u=s*l-a*o,p=a*u-r*d,m=r*c-s*u,y=s*d-a*c;const v=2*n;return c*=v,d*=v,u*=v,p*=2,m*=2,y*=2,e[0]=o+c+p,e[1]=l+d+m,e[2]=h+u+y,e}},Symbol.toStringTag,{value:"Module"}));const Wh=Vh,Gh=Rh,Qh=qh,Jh=zh,Kh=Hh,Yh=Uh,Zh=Nh;Object.freeze(Object.defineProperty({__proto__:null,add:function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e[2]=t[2]+i[2],e[3]=t[3]+i[3],e},ceil:function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e},copy:function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},dist:Jh,distance:zh,div:Qh,divide:qh,dot:function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},equals:function(e,t){const i=e[0],s=e[1],a=e[2],r=e[3],n=t[0],o=t[1],l=t[2],h=t[3],c=vh();return Math.abs(i-n)<=c*Math.max(1,Math.abs(i),Math.abs(n))&&Math.abs(s-o)<=c*Math.max(1,Math.abs(s),Math.abs(o))&&Math.abs(a-l)<=c*Math.max(1,Math.abs(a),Math.abs(l))&&Math.abs(r-h)<=c*Math.max(1,Math.abs(r),Math.abs(h))},exactEquals:function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},floor:function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e},inverse:function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},len:Yh,length:Uh,lerp:function(e,t,i,s){const a=t[0],r=t[1],n=t[2],o=t[3];return e[0]=a+s*(i[0]-a),e[1]=r+s*(i[1]-r),e[2]=n+s*(i[2]-n),e[3]=o+s*(i[3]-o),e},max:function(e,t,i){return e[0]=Math.max(t[0],i[0]),e[1]=Math.max(t[1],i[1]),e[2]=Math.max(t[2],i[2]),e[3]=Math.max(t[3],i[3]),e},min:function(e,t,i){return e[0]=Math.min(t[0],i[0]),e[1]=Math.min(t[1],i[1]),e[2]=Math.min(t[2],i[2]),e[3]=Math.min(t[3],i[3]),e},mul:Gh,multiply:Rh,negate:function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},normalize:function(e,t){const i=t[0],s=t[1],a=t[2],r=t[3];let n=i*i+s*s+a*a+r*r;return n>0&&(n=1/Math.sqrt(n),e[0]=i*n,e[1]=s*n,e[2]=a*n,e[3]=r*n),e},random:function(e,t){const i=gh;let s,a,r,n,o,l;t=t||1;do{s=2*i()-1,a=2*i()-1,o=s*s+a*a}while(o>=1);do{r=2*i()-1,n=2*i()-1,l=r*r+n*n}while(l>=1);const h=Math.sqrt((1-o)/l);return e[0]=t*s,e[1]=t*a,e[2]=t*r*h,e[3]=t*n*h,e},round:function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e},scale:function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e},scaleAndAdd:function(e,t,i,s){return e[0]=t[0]+i[0]*s,e[1]=t[1]+i[1]*s,e[2]=t[2]+i[2]*s,e[3]=t[3]+i[3]*s,e},set:function(e,t,i,s,a){return e[0]=t,e[1]=i,e[2]=s,e[3]=a,e},sqrDist:Kh,sqrLen:Zh,squaredDistance:Hh,squaredLength:Nh,str:function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},sub:Wh,subtract:Vh,transformMat4:function(e,t,i){const s=t[0],a=t[1],r=t[2],n=t[3];return e[0]=i[0]*s+i[4]*a+i[8]*r+i[12]*n,e[1]=i[1]*s+i[5]*a+i[9]*r+i[13]*n,e[2]=i[2]*s+i[6]*a+i[10]*r+i[14]*n,e[3]=i[3]*s+i[7]*a+i[11]*r+i[15]*n,e},transformQuat:function(e,t,i){const s=t[0],a=t[1],r=t[2],n=i[0],o=i[1],l=i[2],h=i[3],c=h*s+o*r-l*a,d=h*a+l*s-n*r,u=h*r+n*a-o*s,p=-n*s-o*a-l*r;return e[0]=c*h+p*-n+d*-l-u*-o,e[1]=d*h+p*-o+u*-n-c*-l,e[2]=u*h+p*-l+c*-o-d*-n,e[3]=t[3],e}},Symbol.toStringTag,{value:"Module"}));const Xh=new Float32Array(1);const ec=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));const tc=BigInt("1000000");var ic;let sc;function ac(e){return"function"==typeof sc[e]?sc[e]=sc[e](globalThis):sc[e]}function rc(e){if(!e||"object"!=typeof e||"function"==typeof e)return e;const t=function(e){if(function(e){return"Int8Array"===e?.constructor?.name}(e)||function(e){return"Uint8Array"===e?.constructor?.name}(e)||function(e){return"Uint8ClampedArray"===e?.constructor?.name}(e)||function(e){return"Int16Array"===e?.constructor?.name}(e)||function(e){return"Uint16Array"===e?.constructor?.name}(e)||function(e){return"Int32Array"===e?.constructor?.name}(e)||function(e){return"Uint32Array"===e?.constructor?.name}(e)||function(e){return"Float32Array"===e?.constructor?.name}(e)||function(e){return"Float64Array"===e?.constructor?.name}(e))return e.slice();if(e instanceof Date)return new Date(e.getTime());if(e instanceof ArrayBuffer)return e.slice(0,e.byteLength);if(e instanceof Map){const t=new Map;for(const[i,s]of e)t.set(i,rc(s));return t}if(e instanceof Set){const t=new Set;for(const i of e)t.add(rc(i));return t}return null}(e);if(null!=t)return t;if(function(e){return"function"==typeof e.clone}(e))return e.clone();if(function(e){return"function"==typeof e.map&&"function"==typeof e.forEach}(e))return e.map(rc);if(function(e){return"function"==typeof e.notifyChange&&"function"==typeof e.watch}(e))return e.clone();const i={};for(const t of Object.getOwnPropertyNames(e))i[t]=rc(e[t]);return i}function nc(e,t,i){return t?Object.keys(t).reduce(((e,s)=>{let a=e[s],r=t[s];return a===r?e:void 0===a?(e[s]=rc(r),e):(Array.isArray(r)||Array.isArray(e)?(a=a?Array.isArray(a)?e[s]=a.concat():e[s]=[a]:e[s]=[],r&&(Array.isArray(r)||(r=[r]),i?r.forEach((e=>{a.includes(e)||a.push(e)})):e[s]=r.concat())):r&&"object"==typeof r?e[s]=nc(a,r,i):e.hasOwnProperty(s)&&!t.hasOwnProperty(s)||(e[s]=r),e)}),e||{}):e}!function(e){const t=function(e){return ec.setFloat64(0,e),ec.getBigInt64(0)}(e=Math.abs(e)),i=function(e){return ec.setBigInt64(0,e),ec.getFloat64(0)}(t<=tc?tc:t-tc);Math.abs(e-i)}(1),ic=34028234663852886e22,Xh[0]=ic,Xh[0],sc=globalThis.dojoConfig?.has||globalThis.esriConfig?.has?{...globalThis.dojoConfig?.has,...globalThis.esriConfig?.has}:{},ac.add=(e,t,i,s)=>((s||void 0===sc[e])&&(sc[e]=t),i&&ac(e)),ac.cache=sc,ac.add("esri-deprecation-warnings",!0),ac.add("esri-force-fullscreen-debug",!1),(()=>{ac.add("host-webworker",void 0!==globalThis.WorkerGlobalScope&&self instanceof globalThis.WorkerGlobalScope);const e="undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location===location&&window.document===document;if(ac.add("host-browser",e),ac.add("host-node","object"==typeof globalThis.process&&globalThis.process.versions?.node&&globalThis.process.versions.v8),ac.add("dom",e),ac("host-browser")){const e=navigator,t=e.userAgent,i=e.appVersion,s=parseFloat(i);if(ac.add("wp",parseFloat(t.split("Windows Phone")[1])||void 0),ac.add("msapp",parseFloat(t.split("MSAppHost/")[1])||void 0),ac.add("khtml",i.includes("Konqueror")?s:void 0),ac.add("edge",parseFloat(t.split("Edge/")[1])||void 0),ac.add("opr",parseFloat(t.split("OPR/")[1])||void 0),ac.add("webkit",!ac("wp")&&!ac("edge")&&parseFloat(t.split("WebKit/")[1])||void 0),ac.add("chrome",!ac("edge")&&!ac("opr")&&parseFloat(t.split("Chrome/")[1])||void 0),ac.add("android",!ac("wp")&&parseFloat(t.split("Android ")[1])||void 0),ac.add("safari",!i.includes("Safari")||ac("wp")||ac("chrome")||ac("android")||ac("edge")||ac("opr")?void 0:parseFloat(i.split("Version/")[1])),ac.add("mac",i.includes("Macintosh")),!ac("wp")&&/(iPhone|iPod|iPad)/.test(t)){const e=RegExp.$1.replace(/P/,"p"),i=/OS ([\d_]+)/.test(t)?RegExp.$1:"1",s=parseFloat(i.replace(/_/,".").replaceAll("_",""));ac.add(e,s),ac.add("ios",s)}ac("webkit")||(!t.includes("Gecko")||ac("wp")||ac("khtml")||ac("edge")||ac.add("mozilla",s),ac("mozilla")&&ac.add("ff",parseFloat(t.split("Firefox/")[1]||t.split("Minefield/")[1])||void 0))}})(),(()=>{if(globalThis.navigator){const e=navigator.userAgent,t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(e),i=/iPhone/i.test(e);t&&ac.add("esri-mobile",t),i&&ac.add("esri-iPhone",i),ac.add("esri-geolocation",!!navigator.geolocation)}ac.add("esri-wasm","WebAssembly"in globalThis),ac.add("esri-shared-array-buffer",(()=>{const e="SharedArrayBuffer"in globalThis,t=!1===globalThis.crossOriginIsolated;return e&&!t})),ac.add("wasm-simd",(()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])))),ac.add("esri-atomics","Atomics"in globalThis),ac.add("esri-workers","Worker"in globalThis),ac.add("web-feat:cache","caches"in globalThis),ac.add("esri-workers-arraybuffer-transfer",!ac("safari")||Number(ac("safari"))>=12),ac.add("workers-pool-size",8),ac.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),ac.add("featurelayer-simplify-payload-size-factors",[1,1,4]),ac.add("featurelayer-animation-enabled",!0),ac.add("featurelayer-snapshot-enabled",!0),ac.add("featurelayer-snapshot-point-min-threshold",8e4),ac.add("featurelayer-snapshot-point-max-threshold",4e5),ac.add("featurelayer-snapshot-point-coverage",.1),ac.add("featurelayer-advanced-symbols",!1),ac.add("featurelayer-pbf",!0),ac.add("featurelayer-pbf-statistics",!1),ac.add("feature-layers-workers",!0),ac.add("feature-polyline-generalization-factor",1),ac.add("mapview-transitions-duration",200),ac.add("mapview-srswitch-adjust-rotation-scale-threshold",24e6),ac.add("mapserver-pbf-version-support",10.81),ac.add("mapservice-popup-identify-max-tolerance",20),ac.add("heatmap-allow-raster-fallback",!1),ac.add("heatmap-force-raster",!1),ac("host-webworker")||ac("host-browser")&&(ac.add("esri-csp-restrictions",(()=>{try{new Function}catch{return!0}return!1})),ac.add("esri-image-decode",(()=>{if("decode"in new Image){const e=new Image;return e.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void e.decode().then((()=>{ac.add("esri-image-decode",!0,!0,!0)})).catch((()=>{ac.add("esri-image-decode",!1,!0,!0)}))}return!1})),ac.add("esri-url-encodes-apostrophe",(()=>{const e=window.document.createElement("a");return e.href="?'",e.href.includes("?%27")})))})();const oc={analysisTheme:{accentColor:[255,127,0],textColor:"white"},apiKey:void 0,applicationName:"",applicationUrl:globalThis.location?.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",userPrivilegesApplied:!1,portalUrl:"https://www.arcgis.com",routeServiceUrl:"https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{crossOriginNoCorsDomains:null,httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],maxUrlLength:2e3,priority:"high",proxyRules:[],proxyUrl:null,timeout:6e4,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};if(globalThis.esriConfig&&(function(e,t,i=!1){nc(e,t,i)}(oc,globalThis.esriConfig,!0),delete oc.has),!oc.assetsPath){{const e="4.27.0";oc.assetsPath=`https://cdn.jsdelivr.net/npm/@arcgis/core@${e}-next.20230526/assets`}oc.defaultAssetsPath=oc.assetsPath}const lc={info:0,warn:1,error:2,none:3};class hc{constructor(e){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},null!=e.level&&(this.level=e.level),null!=e.writer&&(this.writer=e.writer),this._module=e.module,hc._loggers.set(this.module,this);const t=this.module.lastIndexOf(".");-1!==t&&(this._parent=hc.getLogger(this.module.slice(0,t)))}get module(){return this._module}get parent(){return this._parent}error(...e){this._log("error","always",...e)}warn(...e){this._log("warn","always",...e)}info(...e){this._log("info","always",...e)}errorOnce(...e){this._log("error","once",...e)}warnOnce(...e){this._log("warn","once",...e)}infoOnce(...e){this._log("info","once",...e)}errorOncePerTick(...e){this._log("error","oncePerTick",...e)}warnOncePerTick(...e){this._log("warn","oncePerTick",...e)}infoOncePerTick(...e){this._log("info","oncePerTick",...e)}get test(){const e=this;return{loggedMessages:e._loggedMessages,clearLoggedWarnings:()=>e._loggedMessages.warn.clear()}}static get test(){return{resetLoggers(e=new Map){const t=hc._loggers;return hc._loggers=e,t},set throttlingDisabled(e){hc._throttlingDisabled=e}}}static getLogger(e){return e="string"!=typeof e?e.declaredClass:e,hc._loggers.get(e)||new hc({module:e})}_log(e,t,...i){if(this._matchLevel(e)){if("always"!==t&&!hc._throttlingDisabled){const s=this._argsToKey(i),a=this._loggedMessages[e].get(s);if("once"===t&&null!=a||"oncePerTick"===t&&a&&a>=hc._tickCounter)return;this._loggedMessages[e].set(s,hc._tickCounter),hc._scheduleTickCounterIncrement()}for(const t of oc.log.interceptors)if(t(e,this.module,...i))return;this._inheritedWriter()(e,this.module,...i)}}_parentWithMember(e,t){let i=this;for(;null!=i;){const t=i[e];if(null!=t)return t;i=i.parent}return t}_inheritedWriter(){return this._parentWithMember("writer",this._consoleWriter)}_consoleWriter(e,t,...i){console[e](`[${t}]`,...i)}_matchLevel(e){const t=oc.log.level||"warn";return lc[this._parentWithMember("level",t)]<=lc[e]}_argsToKey(...e){return function(e){let t=0;for(let i=0;i<e.length;i++)t=(t<<5)-t+e.charCodeAt(i),t|=0;return t}(JSON.stringify(e,((e,t)=>"object"!=typeof t||Array.isArray(t)?t:"[Object]")))}static _scheduleTickCounterIncrement(){hc._tickCounterScheduled||(hc._tickCounterScheduled=!0,Promise.resolve().then((()=>{hc._tickCounter++,hc._tickCounterScheduled=!1})))}}function cc(e){return function(e,t,i){return Math.min(Math.max(e,t),i)}(null==(t=e)?t:Math.round(parseFloat(t)),0,255);var t}function dc(e,t,i){return e=Number(e),isNaN(e)?i:e<t?t:e>i?i:e}hc._loggers=new Map,hc._tickCounter=0,hc._tickCounterScheduled=!1,hc._throttlingDisabled=!1,hc.getLogger("esri.core.accessorSupport.ensureTypes");class uc{static blendColors(e,t,i,s=new uc){return s.r=Math.round(e.r+(t.r-e.r)*i),s.g=Math.round(e.g+(t.g-e.g)*i),s.b=Math.round(e.b+(t.b-e.b)*i),s.a=e.a+(t.a-e.a)*i,s._sanitize()}static fromRgb(e,t){const i=e.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(i){const e=i[2].split(/\s*,\s*/),s=i[1];if("rgb"===s&&3===e.length||"rgba"===s&&4===e.length){const i=e[0];if("%"===i.charAt(i.length-1)){const i=e.map((e=>2.56*parseFloat(e)));return 4===e.length&&(i[3]=parseFloat(e[3])),uc.fromArray(i,t)}return uc.fromArray(e.map((e=>parseFloat(e))),t)}if("hsl"===s&&3===e.length||"hsla"===s&&4===e.length)return uc.fromArray(function(e,t,i,s=1){const a=(e%360+360)%360/360,r=i<=.5?i*(t+1):i+t-i*t,n=2*i-r;return[Math.round(255*ih(n,r,a+1/3)),Math.round(255*ih(n,r,a)),Math.round(255*ih(n,r,a-1/3)),s]}(parseFloat(e[0]),parseFloat(e[1])/100,parseFloat(e[2])/100,parseFloat(e[3])),t)}return null}static fromHex(e,t=new uc){if(4!==e.length&&7!==e.length||"#"!==e[0])return null;const i=4===e.length?4:8,s=(1<<i)-1;let a=Number("0x"+e.substr(1));return isNaN(a)?null:(["b","g","r"].forEach((e=>{const r=a&s;a>>=i,t[e]=4===i?17*r:r})),t.a=1,t)}static fromArray(e,t=new uc){return t._set(Number(e[0]),Number(e[1]),Number(e[2]),Number(e[3])),isNaN(t.a)&&(t.a=1),t._sanitize()}static fromString(e,t){const i=th[s=e]||th[s.toLowerCase()]?function(e){return th[e]??th[e.toLowerCase()]}(e):null;var s;return i&&uc.fromArray(i,t)||uc.fromRgb(e,t)||uc.fromHex(e,t)}static fromJSON(e){return e&&new uc([e[0],e[1],e[2],e[3]/255])}static toUnitRGB(e){return null!=e?[e.r/255,e.g/255,e.b/255]:null}static toUnitRGBA(e){return null!=e?[e.r/255,e.g/255,e.b/255,null!=e.a?e.a:1]:null}constructor(e){this.r=255,this.g=255,this.b=255,this.a=1,e&&this.setColor(e)}get isBright(){return.299*this.r+.587*this.g+.114*this.b>=127}setColor(e){return"string"==typeof e?uc.fromString(e,this):Array.isArray(e)?uc.fromArray(e,this):(this._set(e.r??0,e.g??0,e.b??0,e.a??1),e instanceof uc||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(){const e=this.r.toString(16),t=this.g.toString(16),i=this.b.toString(16);return`#${e.length<2?"0"+e:e}${t.length<2?"0"+t:t}${i.length<2?"0"+i:i}`}toCss(e=!1){const t=this.r+", "+this.g+", "+this.b;return e?`rgba(${t}, ${this.a})`:`rgb(${t})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(e=uc.AlphaMode.ALWAYS){const t=cc(this.r),i=cc(this.g),s=cc(this.b);return e===uc.AlphaMode.ALWAYS||1!==this.a?[t,i,s,cc(255*this.a)]:[t,i,s]}clone(){return new uc(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(e){return null!=e&&e.r===this.r&&e.g===this.g&&e.b===this.b&&e.a===this.a}_sanitize(){return this.r=Math.round(dc(this.r,0,255)),this.g=Math.round(dc(this.g,0,255)),this.b=Math.round(dc(this.b,0,255)),this.a=dc(this.a,0,1),this}_set(e,t,i,s){this.r=e,this.g=t,this.b=i,this.a=s}}uc.prototype.declaredClass="esri.Color",function(e){var t;(t=e.AlphaMode||(e.AlphaMode={}))[t.ALWAYS=0]="ALWAYS",t[t.UNLESS_OPAQUE=1]="UNLESS_OPAQUE"}(uc||(uc={}));new class{constructor(e,t={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=e,this._options=t,this.apiValues=[],this.jsonValues=[],this._apiToJSON=this._invertMap(e),this.apiValues=this._getKeysSorted(this._apiToJSON),this.jsonValues=this._getKeysSorted(this._jsonToAPI),this.read=e=>this.fromJSON(e),this.write=(e,t,i)=>{const s=this.toJSON(e);void 0!==s&&function(e,t,i){const s=e.split("."),a=s.pop(),r=function(e,t,i){let s=i;for(const i of e){if(null==s)return;if(!(i in s)){if(!t)return;s[i]={}}s=s[i]}return s}(s,!0,i);r&&a&&(r[a]=t)}(i,s,t)},this.write.isJSONMapWriter=!0}toJSON(e){if(null==e)return null;if(this._apiToJSON.hasOwnProperty(e)){const t=this._apiToJSON[e];return this._options.useNumericKeys?+t:t}return this._options.ignoreUnknown?void 0:e}fromJSON(e){return null!=e&&this._jsonToAPI.hasOwnProperty(e)?this._jsonToAPI[e]:this._options.ignoreUnknown?void 0:e}_invertMap(e){const t={};for(const i in e)t[e[i]]=i;return t}_getKeysSorted(e){const t=[];for(const i in e)t.push(i);return t.sort(),t}}({Aspect:"aspect","Black to White":"black-to-white","Blue Bright":"blue-bright","Blue Light to Dark":"blue-light-to-dark","Blue-Green Bright":"blue-green-bright","Blue-Green Light to Dark":"blue-green-light-to-dark","Brown Light to Dark":"brown-light-to-dark","Brown to Blue Green Diverging, Bright":"brown-to-blue-green-diverging-right","Brown to Blue Green Diverging, Dark":"brown-to-blue-green-diverging-dark","Coefficient Bias":"coefficient-bias","Cold to Hot Diverging":"cold-to-hot-diverging","Condition Number":"condition-number","Cyan to Purple":"cyan-to-purple","Cyan-Light to Blue-Dark":"cyan-light-to-blue-dark",Distance:"distance","Elevation #1":"elevation1","Elevation #2":"elevation2",Errors:"errors","Gray Light to Dark":"gray-light-to-dark","Green Bright":"green-bright","Green Light to Dark":"green-light-to-dark","Green to Blue":"green-to-blue","Orange Bright":"orange-bright","Orange Light to Dark":"orange-light-to-dark","Partial Spectrum":"partial-spectrum","Partial Spectrum 1 Diverging":"partial-spectrum-1-diverging","Partial Spectrum 2 Diverging":"partial-spectrum-2-diverging","Pink to YellowGreen Diverging, Bright":"pink-to-yellow-green-diverging-bright","Pink to YellowGreen Diverging, Dark":"pink-to-yellow-green-diverging-dark",Precipitation:"precipitation",Prediction:"prediction","Purple Bright":"purple-bright","Purple to Green Diverging, Bright":"purple-to-green-diverging-bright","Purple to Green Diverging, Dark":"purple-to-green-diverging-dark","Purple-Blue Bright":"purple-blue-bright","Purple-Blue Light to Dark":"purple-blue-light-to-dark","Purple-Red Bright":"purple-red-bright","Purple-Red Light to Dark":"purple-red-light-to-dark","Red Bright":"red-bright","Red Light to Dark":"red-light-to-dark","Red to Blue Diverging, Bright":"red-to-blue-diverging-bright","Red to Blue Diverging, Dark":"red-to-blue-diverging-dark","Red to Green":"red-to-green","Red to Green Diverging, Bright":"red-to-green-diverging-bright","Red to Green Diverging, Dark":"red-to-green-diverging-dark",Slope:"slope","Spectrum-Full Bright":"spectrum-full-bright","Spectrum-Full Dark":"spectrum-full-dark","Spectrum-Full Light":"spectrum-full-light",Surface:"surface",Temperature:"temperature","White to Black":"white-to-black","Yellow to Dark Red":"yellow-to-dark-red","Yellow to Green to Dark Blue":"yellow-to-green-to-dark-blue","Yellow to Red":"yellow-to-red","Yellow-Green Bright":"yellow-green-bright","Yellow-Green Light to Dark":"yellow-green-light-to-dark"});function pc(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var i=function(){var s=arguments,a=t?t.apply(this,s):s[0],r=i.cache;if(r.has(a))return r.get(a);var n=e.apply(this,s);return i.cache=r.set(a,n)||r,n};return i.cache=new(pc.Cache||vl),i}pc.Cache=vl;var mc=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,yc=/\\(\\)?/g;!function(e){var t=pc(e,(function(e){return 500===i.size&&i.clear(),e})),i=t.cache}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(mc,(function(e,i,s,a){t.push(s?a.replace(yc,"$1"):i||e)})),t}));const vc={Standalone:"standalone",Modelbuilder:"modelbuilder"};function gc(e){e??(e=pr);let t="";if(e===mr)t="_ra";else t="";return t}function fc(e,t){return ai(e,t)}Kt((async e=>{const{locale:t,name:i,assetPrefix:s,analysisEngine:a,uiMode:r=vc.Standalone,memoizedHelper:n}=e,o=`${i.toLowerCase()}${gc(a)}`;let l,h,c,d,u,p="",m="";if("modelbuilder"===r){const e=`${s}/tool-ui-json/mb/mb-overrides-manifest.json`,t=await n(e),i=t?.overrides;p=`${s}/tool-ui-json/${!0===(void 0!==t&&i?.includes(o))?"mb/":""}${o}.tool.ui.json`,m=`${s}/tool-ui-json/mb/allToolOverrides.json`}else p=`${s}/tool-ui-json/${o}.tool.ui.json`;l=await n(p);const y=`${s}/tool-json/${o}.tool.json`,v=`${s}/t9n/${o}/${o}.t9n.${t}.json`,g=`${s}/t9n/common.t9n.${t}.json`;let f=t;t===Ys.English||t===Ys.EnglishUSA?f="":f===Ys.NorwegianBokml&&(f="no");const b=`${s}/help/${""!==f?f+"/":""}${i}${gc(a)}.html`;try{d=await n(y),h=await n(v),c=await n(g),h={...c,...h},"modelbuilder"===r&&(u=await n(m))}catch{l=void 0}return{toolJson:d,toolUIJson:l,toolT9n:h,toolHelpFilePath:b,allToolOverrides:u}})),Kt((e=>{const t={};let i;if(void 0!==e.featureSet){if(t.source=b.default.fromJSON(e.featureSet).features,i=e.layerDefinition,void 0!==i.fields&&(t.fields=i.fields.map((e=>g.default.fromJSON(e)))),void 0!==i.objectIdField&&(t.objectIdField=i.objectIdField),void 0!==i.geometryType){let e="point";switch(i.geometryType){case"esriGeometryMultipoint":e="multipoint";break;case"esriGeometryPoint":e="point";break;case"esriGeometryPolygon":e="polygon";break;case"esriGeometryPolyline":e="polyline"}t.geometryType=e}void 0!==i.spatialReference&&(t.spatialReference=i.spatialReference),void 0!==i.drawingInfo?.renderer&&(t.renderer=f.default.fromJSON(i.drawingInfo.renderer))}return new m.default(t)})),Kt((async(e,t)=>{let i=!1;if(!0===window.location.href.includes("://localhost:")||void 0===t)i=!0;else{const s=`${e}${e.indexOf("?")>-1?"&":"?"}f=json`;v.default.request.proxyUrl=`${t}/sharing/proxy`;try{i=!1===Js((await Ks(s,{useProxy:!0})).data)}catch(e){i=!1}}return!0===i?e:void 0})),Sr((async e=>{const{url:t}=e,i=`${t}/sharing/rest/community/self`,s=u.default.findCredential(i);let a;void 0!==s&&(a=s.token);const r={query:{returnUserLicensedItems:!0,token:a,f:"json"}};try{const{data:{userLicensedItems:e}}=await Ks(i,r);return[...e.map((({entitlements:e})=>e))].flat()}catch(e){await _r(sa)}return[]}),{serializer:e=>`${e.user.username}`}),Sr((e=>{const t=new Set(e.map((e=>e.id)));return Array.from(t).map((t=>e.find((e=>e.id===t))))}),{serializer:e=>Array.isArray(e)?e.map((e=>e?.id)).join("-"):""}),Sr((async e=>{let t={isMultidimensional:!1};const i="imagery-tile"===e.type?e.serviceRasterInfo.multidimensionalInfo:e.multidimensionalInfo,s=e.multidimensionalSubset;if(null!=i){const a=null!=s?e.getMultidimensionalSubsetVariables():i.variables;if(void 0!==a&&a.length>0){const e=[],i=[],s={},r={},n={},o={},l={},h={},c={};a.forEach(((t,a)=>{let n="";const d=t.name;t.dimensions.forEach(((t,i)=>{const u=t.name;-1===e.indexOf(u)&&e.push(u);const p=i>0?`,${u}=${t.values?.length}`:`${u}=${t.values?.length}`;if(n=n.concat(p),0===i&&(r[d]={}),void 0===s[u]&&(s[u]=[]),r[d][u]=t.values,0===a){const e=t.values;if(void 0!==e)if("StdTime"!==u||void 0!==t.unit&&"ISO8601"!==t.unit)Array.isArray(e)&&"number"==typeof e[0]?o[u]=l[u]=e.map(String):Array.isArray(e[0])&&Array.isArray(e[1])&&(o[u]=e[0].map(String),l[u]=e[1].map(String));else{const t=[],i=[],s={},a={};e.forEach((e=>{if("number"==typeof e){const r=new Date(e),n=r.toLocaleString(),o=r.toISOString();t.push(o),i.push(o),s[o]=n,a[o]=n}else if(Array.isArray(e)){const r=new Date(e[0]),n=new Date(e[1]),o=r.toISOString(),l=n.toISOString();t.push(o),i.push(l),s[o]=r.toLocaleString(),a[l]=n.toLocaleString()}})),o[u]=t,l[u]=i,h[u]=s,c[u]=a}}s[u].push(d)})),i.push({name:d,alias:`${d}[${n}](${t.description})`,type:"string"})}));for(const e in s){const t=i.filter((t=>s[e].indexOf(t.name)>-1));n[e]={id:"1",name:e,description:"DimensionVariables",getFields:()=>Promise.resolve(t)}}t={isMultidimensional:!0,dimensions:e,dimensionVariableDatasets:n,dimensionValues:r,variablesDataset:{id:"1",name:"Variables",description:"Variables",getFields:()=>Promise.resolve(i)},dimensionMinValues:o,dimensionMaxValues:l,dimensionMinValuesWithLabels:h,dimensionMaxValuesWithLabels:c}}}let a;try{a=await e.generateRasterInfo(e.rasterFunction)}catch(t){a=e.serviceRasterInfo}return t.rasterInfo=a,t}));const bc=async e=>{const{asyncGeocodeUrl:t}=e,i=await w.submitJob(`${t}/AnalyzeGeocodeInput`,{...zs(e,"asyncGeocodeUrl"),f:"json"});await i.waitForJobCompletion();return(await i.fetchResultData("geocodeParameters")).value},wc=Sr(((e,t)=>new y.default({id:e,portal:t})),{serializer:e=>`${e[0]}-${e[1]?.url}`});Sr((async e=>{const{restUrl:t}=e,i=`${t}/portals/helpmap`;let s;try{const e=await(0,p.default)(i,{query:{f:"json"},responseType:"json",method:"auto"});s=await(e.data?.helpMap)??void 0}catch(e){s=void 0}return s}),{serializer:e=>`${e[0]}-${e[1]?.url}`}),K((async e=>{const t=new d.default({url:e});t.authMode="immediate";try{await t.load()}catch(e){await _r(aa)}return t}));const Cc="standard",kc="geoanalytics",Sc="raster";function Lc(e,t,i=!1){let s=t.helperServices.analysis.url;switch(e){case kc:s=t.helperServices.geoanalytics.url;break;case Sc:s=t.helperServices.rasterAnalytics.url;break;case Cc:s=i?t.helperServices.asyncGeocode.url:t.helperServices.analysis.url}return s}const _c=e=>{const t=Array.from(e).map((e=>{let t;return t="object"==typeof e&&void 0!==e.id?e.id:e,t}));return JSON.stringify(t)},Ic=K((async(e,t,i)=>{const s=`${Lc(t,i,"BatchGeocode"===e)}/${e}?f=json`,a=await(0,p.default)(s,{responseType:"json",authMode:"no-prompt"}),r=await a.data;return r.parameters?.forEach((e=>{null===e.defaultValue&&(e.defaultValue=void 0)})),r}),{serializer:_c}),Mc=K((async(e,t)=>{const i=Lc(e,t),s=await(0,p.default)(`${i}?f=json`,{responseType:"json"}),{data:{tasks:a}}=s,r=a.map((i=>Ic(i,e,t)));return await Promise.all(r)}),{serializer:_c});K((async(e,t)=>{let i=[];return i=void 0!==t?await Mc(t,e):[...await Mc(Cc,e),...await Mc(Sc,e),...await Mc(kc,e)],new Map(i.map((e=>[e.name.toLowerCase(),e])))}),{serializer:_c}),K((async e=>{const{helperServices:t}=e;let i;if(void 0!==t.routingUtilities){const e=await w.execute(`${t.routingUtilities.url}/GetTravelModes?f=json`),{results:[{value:{features:s}},{value:a}]}=e;i={travelModes:s.map((e=>JSON.parse(e.attributes.TravelMode))),defaultTravelModeId:a}}return i}),{serializer:_c});const xc=K((async e=>(await(0,p.default)(`${e}?f=json`,{responseType:"json"})).data)),Ec=K((async(e,t)=>{const i=`${e}/${t}?f=json`,s=await(0,p.default)(i,{responseType:"json",authMode:"no-prompt"}),a=await(s?.data);return void 0!==a?.parameters&&a.parameters?.forEach((e=>{null===e.defaultValue&&(e.defaultValue=void 0)})),a}));K((async e=>{const t=await(0,p.default)(`${e}?f=json`,{responseType:"json"}),{data:{tasks:i}}=t,s=i.map((t=>Ec(e,t)));return await Promise.all(s)})),K((async(e,t)=>{let i,s;try{i=await Ec(e,t),s=await xc(e)}catch(e){throw"OAUTH_0070"===e.details?.messageCode?new ia(na,e.message,e.details):new ia(ra,e.message,e.details)}return i.serviceInfo=s,{...i,serviceInfo:s}}));const Tc="error-message",Pc="string-item-browser-input-wrapper",Ac="layer-overwrite-checkbox",Fc="calcite-input",Oc="selected-layer",Dc="item-browser-layer-button",$c="top-spacing",Bc="list-item",jc="intermediateData",Vc="hostedLayer",Rc="overwriteExistingLayer",qc=class{constructor(e){(0,r.r)(this,e),this.analysisOverwriteValueChange=(0,r.c)(this,"analysisOverwriteValueChange",7),this.analysisHelpPopoverOpen=(0,r.c)(this,"analysisHelpPopoverOpen",7),this.filter='(type: "Feature Service")',this.itemBrowserBucketOptions=["my","favorites","group","org"],this.handleAnalysisHelpPopoverClose=()=>{(0,n.aw)(this.toolHelpPopover),this.toolHelpPopover?.removeEventListener("analysisHelpPopoverClose",this.handleAnalysisHelpPopoverClose),this.toolHelpPopover=void 0},this.updateValue=()=>{let e;if(this.overwriteMode===Vc||this.overwriteMode===Rc&&void 0!==this.selectedOverwriteItem){const t=this.folderId??this.folderInputRef?.value??"";e={serviceProperties:{name:this.outputName},itemProperties:this.overwriteExistingLayer?{overwrite:!0,folderId:t}:{folderId:t},overwriteMode:this.overwriteMode},e.itemProperties=this.selectedOverwriteItem?{...e.itemProperties,id:this.selectedOverwriteItem.id}:e.itemProperties,e=this.serializeOutputName(e,this.toolData)}else this.overwriteMode===Rc&&void 0===this.selectedOverwriteItem&&(e={serviceProperties:{name:""},itemProperties:{},overwriteMode:this.overwriteMode});this.value=e,this.analysisOverwriteValueChange.emit(this.value)},this.formatUnavailableItemErrorMessage=e=>{let t=this.strings.itemNameTaken;return!1===e?t=this.strings.noPermissionToOverwrite:this.overwriteMode===Rc?t=this.strings.cannotUndoOverwrite:this.overwriteMode===Vc&&!0===this.overwriteExistingLayer&&(t=this.strings.layerExistsOverwritten),{message:t,uiInputStatus:this.overwriteExistingLayer&&e?n.b.IDLE:n.b.INVALID}},this.validateOutputName=async()=>{if(this.isOutputNameTaken=!1,!(0,n.F)(this.outputName))return void(this.error={message:this.strings.requiredError,uiInputStatus:n.b.INVALID});if(!1===(0,n.ax)([this.outputName]))return void(this.error={message:this.strings.specialCharactersInServiceNameError,uiInputStatus:n.b.INVALID});const e=await async function(e){const{portal:{url:t,id:i},itemType:s,includeItemId:a=!1}=e,{serviceName:r}=e,n=`${t}/sharing/rest/portals/${i}/isServiceNameAvailable?f=json`,o={query:{f:"json",name:r,type:s,includeitemid:a}};let l={available:!0};try{const e=await(0,p.default)(n,o);l=void 0!==e.data.itemId?{available:e.data.available,itemId:e.data.itemId,inRecycleBin:e.data.inRecycleBin}:{available:e.data.available,inRecycleBin:e.data.inRecycleBin}}catch(e){await _r(sa)}return l}({portal:this.portal,itemType:"Feature Service",serviceName:this.outputName,includeItemId:!0}),{itemId:t,available:i,inRecycleBin:s}=e??{};if(!0===s)this.error={message:this.strings.recycleBinError,uiInputStatus:n.b.INVALID};else if(!1===i&&(0,n.F)(t)){this.isOutputNameTaken=!0;const e=await(0,n.ay)(t),i=(0,n.aA)(e,this.portal.user);!0===this.overwriteExistingLayer&&(this.folderId=e.ownerFolder),this.error=this.formatUnavailableItemErrorMessage(i)}else!1===i&&!1===(0,n.F)(t)?this.error={message:this.strings.noPermissionToOverwrite,uiInputStatus:n.b.INVALID}:this.error=void 0},this.debouncedValidateOutputName=(0,h.d)(this.validateOutputName,500),this.setOutputNameFromSelectedItem=e=>{this.overwriteExistingLayer=!0,this.outputName=e.name??(0,n.az)(e.url),this.isOutputNameTaken=!0,this.folderId=e.ownerFolder,(0,n.aA)(e,this.portal.user)?(this.selectedOverwriteItem=e,this.error={message:this.strings.cannotUndoOverwrite,uiInputStatus:n.b.IDLE}):this.error={message:this.strings.noPermissionToOverwrite,uiInputStatus:n.b.INVALID}},this.removeItemBrowser=()=>{this.itemBrowserElement?.removeEventListener("analysisItemBrowserClose",this.handleItemBrowserClose),this.itemBrowserElement?.removeEventListener("analysisItemBrowserSelection",this.handleItemBrowserSelection),this.itemBrowserElement?.remove(),this.itemBrowserElement=void 0},this.openItemBrowser=()=>{this.removeItemBrowser(),this.itemBrowserElement=document.createElement("analysis-item-browser"),this.itemBrowserElement.header=this.strings.selectLayerToOverwrite,this.itemBrowserElement.hideAddToMap=!0,this.itemBrowserElement.filter=this.filter,this.itemBrowserElement.portal=this.portal,this.itemBrowserElement.bucketOptions=this.itemBrowserBucketOptions,this.itemBrowserElement.user=this.portal?.user,this.itemBrowserElement.selectionMode="single",this.itemBrowserElement.addEventListener("analysisItemBrowserClose",this.handleItemBrowserClose),this.itemBrowserElement.addEventListener("analysisItemBrowserSelection",this.handleItemBrowserSelection),document.body.appendChild(this.itemBrowserElement)},this.renderItemBrowser=()=>(0,r.h)(r.F,null,(0,r.h)("analysis-label",{class:$c,label:this.strings.overwriteLayer,ref:e=>this.itemBrowserRef=e,required:!0,onAnalysisLabelHelpActionClick:()=>{this.createHelpPopover(this.strings.overwriteLayer,"existingLayerToOverwrite",this.itemBrowserRef)}}),this.selectedOverwriteItem?this.renderSelectedLayer():(0,r.h)("calcite-button",{class:Dc,scale:n.U.Scale,appearance:"outline",kind:"neutral",iconStart:"add-layer",onMouseOver:this.addTooltip,onMouseOut:this.removeTooltip,onClick:this.handleOpenItemBrowserClick},this.strings.layer),this.renderErrorMessage()),this.renderStringInput=()=>(0,r.h)(r.F,null,(0,r.h)("analysis-label",{class:$c,label:this.strings.outputName,ref:e=>this.outputNameLabelRef=e,required:!0,onAnalysisLabelHelpActionClick:()=>{this.createHelpPopover(this.strings.outputName,"outputName",this.outputNameLabelRef)}}),(0,r.h)("div",{class:Pc},(0,r.h)("calcite-input",{class:Fc,scale:n.U.Scale,type:"text",value:this.outputName,status:this.error?.uiInputStatus,placeholder:this.strings.enterUniqueName,onCalciteInputInput:this.handleStringInputChange})),this.renderErrorMessage()),this.renderLayerOverwriteCheckbox=()=>(0,r.h)("div",{class:Ac},(0,r.h)("analysis-boolean-input",{ref:e=>this.layerOverwriteCheckboxRef=e,label:this.strings.layerExistsAutomaticallyOverwrite,onAnalysisBooleanInputChange:this.handleLayerOverwriteBooleanInputChange,value:this.overwriteExistingLayer,onAnalysisHelpClick:()=>{this.createHelpPopover(this.strings.overwrite,"layerExistsAutomaticallyOverwrite",this.layerOverwriteCheckboxRef)}})),this.renderFolderInput=()=>(0,r.h)("analysis-folder-input",{ref:e=>this.folderInputRef=e,label:this.strings.saveInFolder,value:this.folderId,user:this.portal?.user,disabled:this.isOutputNameTaken,onAnalysisFolderInputChange:this.handleFolderInputChange,onAnalysisHelpClick:()=>{this.createHelpPopover(this.strings.saveInFolder,"saveResultIn",this.folderInputRef)}}),this.renderErrorMessage=()=>void 0!==this.error?.message&&void 0!==this.error?.uiInputStatus&&(0,r.h)("calcite-input-message",{class:Tc,status:this.error.uiInputStatus,hidden:!1,scale:n.U.Scale,icon:"exclamationMarkTriangle"},this.error.message),this.handleOverwriteModeChange=async()=>{this.overwriteMode=this.stringInputRef.value,this.overwriteMode===Vc?await this.validateOutputName():this.overwriteMode===Rc&&void 0===this.selectedOverwriteItem?this.error={message:this.strings.requiredError,uiInputStatus:n.b.INVALID}:this.overwriteMode===Rc&&void 0!==this.selectedOverwriteItem&&this.setOutputNameFromSelectedItem(this.selectedOverwriteItem),this.updateValue()},this.addTooltip=e=>{const t=e.target;void 0===this.tooltipElement&&(this.tooltipElement=document.createElement("calcite-tooltip"),this.tooltipElement.placement="bottom",this.tooltipElement.innerText=this.strings.chooseLayerToOverwrite,this.tooltipElement.offsetDistance=14,this.tooltipElement.referenceElement=t),(0,n.aB)(document,this.tooltipElement)},this.removeTooltip=()=>{(0,n.aw)(this.tooltipElement)},this.handleStringInputChange=async e=>{const t=e.target.value;this.outputName=t,await this.debouncedValidateOutputName(),this.updateValue()},this.handleLayerOverwriteBooleanInputChange=async e=>{const t=e.target.value;this.overwriteExistingLayer=t,await this.validateOutputName(),this.updateValue()},this.handleFolderInputChange=e=>{const t=e.target.value;t!==this.folderId&&(this.folderId=t,this.updateValue())},this.handleItemBrowserSelection=e=>{const t=e.detail;this.setOutputNameFromSelectedItem(t),this.updateValue()},this.handleRemoveSelectedItem=async()=>{this.selectedOverwriteItem=void 0,this.outputName="",this.overwriteExistingLayer=!1,this.folderId=void 0,await this.validateOutputName(),this.updateValue()},this.handleOpenItemBrowserClick=()=>{this.openItemBrowser()},this.handleItemBrowserClose=()=>{this.showItemBrowser=!1,this.removeItemBrowser()},this.replaceLayer=e=>{const t=e.target;"calcite-list-item"===t?.localName&&this.openItemBrowser()},this.handleMouseOver=e=>{const t=e.target;"calcite-list-item"===t?.localName&&(void 0===this.replaceTooltip&&(this.replaceTooltip=document.createElement("calcite-tooltip"),this.replaceTooltip.placement="bottom",this.replaceTooltip.innerText=this.strings.replaceLayer),this.replaceTooltip.referenceElement=t,(0,n.aB)(document,this.replaceTooltip))},this.handleMouseOut=()=>{(0,n.aw)(this.replaceTooltip)},this.value=void 0,this.toolData=void 0,this.required=!1,this.portal=void 0,this.toolHelpFilePath=void 0,this.isOutputNameTaken=!1,this.readOnly=!1,this.selectedOverwriteItem=void 0,this.overwriteExistingLayer=!0,this.outputName="",this.error=void 0,this.showItemBrowser=!1,this.folderId=void 0,this.overwriteMode=jc}async componentWillLoad(){let e="";({strings:this.strings,locale:e}=await(0,n.d)(this.hostElement,(0,r.a)("."))),!0===(0,n.F)(this.value)&&(this.outputName=this.value.serviceProperties?.name??"",this.overwriteExistingLayer=this.value.itemProperties?.overwrite??!1,this.folderId=this.value.itemProperties?.folderId,this.overwriteMode=this.value.overwriteMode??Vc,!0===(0,n.F)(this.value.itemProperties?.id)&&(this.selectedOverwriteItem=await(0,n.ay)(this.value.itemProperties.id)),!1===this.readOnly&&await this.validateOutputName()),this.portalChange(this.portal),this.updateValue(),this.setToolHelpFilePath(e)}disconnectedCallback(){this.toolHelpPopover?.removeEventListener("analysisHelpPopoverClose",this.handleAnalysisHelpPopoverClose),(0,n.aw)(this.toolHelpPopover)}portalChange(e){void 0!==e?.user&&(this.itemBrowserBucketOptions=(0,n.aC)(e.user)?["my","favorites","group","org"]:["my","favorites"])}get hasError(){return this.error?.uiInputStatus===n.b.INVALID}async checkValidity(){const e=void 0===this.error||!1===this.hasError;return Promise.resolve(e)}setToolHelpFilePath(e){if(void 0===this.toolHelpFilePath){let t=e;switch(e){case n.aE.English:case n.aE.EnglishUSA:t="";break;case n.aE.NorwegianBokml:t="no"}this.toolHelpFilePath=(0,r.a)(`assets/help/${""!==t?t+"/":""}AnalysisOverwrite.html`)}}serializeOutputName(e,t){const i=(0,n.aD)(e,t);return void 0!==t.itemProperties&&(i.itemProperties={...i.itemProperties,...t.itemProperties}),i}createHelpPopover(e,t,i){(0,n.am)(),void 0!==this.toolHelpPopover&&(this.toolHelpPopover.removeEventListener("analysisHelpPopoverClose",this.handleAnalysisHelpPopoverClose),this.toolHelpPopover=void 0),void 0!==this.toolHelpFilePath&&(this.toolHelpPopover=(0,h.s)(this.toolHelpPopover,{heading:e,helpFileName:"AnalysisOverwrite",helpId:t,helpUrl:this.toolHelpFilePath,isHelpFileExternalAsset:!0,learnMoreBaseUrl:this.portal?.sourceJSON.helpBase??void 0,portal:this.portal,referenceElement:i}),this.toolHelpPopover.addEventListener("analysisHelpPopoverClose",this.handleAnalysisHelpPopoverClose),this.analysisHelpPopoverOpen.emit())}renderSelectedLayer(){const e=this.selectedOverwriteItem.name??(0,n.az)(this.selectedOverwriteItem.url),t=(0,n.a)(this.strings.layerAction,{layerName:e});return(0,r.h)("calcite-list",{class:Oc,label:"",onClick:this.replaceLayer,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut},(0,r.h)("calcite-list-item",{key:this.selectedOverwriteItem.id,label:e,class:Bc,description:this.selectedOverwriteItem.type},(0,r.h)("calcite-action",{"data-layerId":this.selectedOverwriteItem.id,text:t,label:t,slot:"actions-end",appearance:"transparent",icon:"x",onClick:this.handleRemoveSelectedItem})))}render(){return(0,r.h)(r.H,{key:"215ed71fe5b0f730005c54a668dc664586b927ed"},(0,r.h)("analysis-string-input",{key:"6ab32a35a507d803c40089cb03397a00299ae4b2",label:this.strings.resultType,required:!0,value:this.overwriteMode,ref:e=>this.stringInputRef=e,onAnalysisHelpClick:()=>{this.createHelpPopover(this.strings.resultType,"resultType",this.stringInputRef)},choiceList:[jc,Vc,Rc],choiceListLabels:{[jc]:this.strings.createIntermediateData,[Vc]:this.strings.createHostedLayer,[Rc]:this.strings.overwriteExistingLayer},onAnalysisStringInputChange:this.handleOverwriteModeChange}),this.overwriteMode===jc&&(0,r.h)("calcite-input-message",{key:"897b53de99bfeb7fc89dbc718e1d9d45df6a0b94",class:$c,status:"idle",hidden:!1,scale:n.U.Scale,icon:"exclamationMarkTriangle"},this.strings.intermediateDataWarning),this.overwriteMode===Vc&&(0,r.h)("div",{key:"77fc342ee978186626748a7568c8d8207b40b6bf"},this.renderStringInput(),this.renderLayerOverwriteCheckbox(),this.renderFolderInput()),this.overwriteMode===Rc&&this.renderItemBrowser())}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,r.g)(this)}static get watchers(){return{portal:["portalChange"]}}};qc.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:block}.error-message{margin-top:var(--analysis-half-spacing)}.string-item-browser-input-wrapper{display:flex;gap:var(--analysis-half-spacing)}.layer-overwrite-checkbox{margin:var(--analysis-half-spacing) 0}.calcite-input{flex-grow:1}.selected-layer{border:1px solid var(--calcite-color-border-input);margin-bottom:var(--analysis-half-spacing)}.calcite-dropdown{width:100%}.item-browser-layer-button{width:100%}.top-spacing{margin-top:var(--analysis-half-spacing)}.negative-top-spacing{margin-top:calc(-1 * var(--analysis-half-spacing))}.list-item{--calcite-font-size--1:var(--calcite-font-size--2)}";const zc="circle",Hc="polygon",Uc="polyline",Nc="point",Wc="rectangle",Gc="text",Qc=class{constructor(e){(0,r.r)(this,e),this.analysisSketchLayerChange=(0,r.c)(this,"analysisSketchLayerChange",7),this.analysisSketchToolsRendered=(0,r.c)(this,"analysisSketchToolsRendered",7),this.analysisSketchRemove=(0,r.c)(this,"analysisSketchRemove",7),this.sketchUpdated=!1,this.sketchLayerTitleNumber=1,this.createSketch=()=>{void 0!==this.sketchElement&&this.removeSketch();const e=(0,n.aH)();this.reactiveUtilsHandler=e.on((()=>this.mapView?.map.allLayers),"change",(()=>this.handleMapLayerChange())),this.createSketchLayer(),this.mapView?.when((()=>{this.sketchElement=document.createElement("arcgis-sketch-layer-editor"),this.sketchElement.mapView=this.mapView,this.sketchElement.showSketchToolsOnly=!0,this.sketchElement.layer=this.sketchLayer,this.sketchElement.sketchToolsToHide=this.hiddenSketchTools,this.sketchElement.sketchToolsReferenceElement=this.referenceElement;const e=this.mapLayers.filter((e=>!0===e?.title?.includes(this.sketchLayerTitle)));this.sketchElement.hideSelectionTools=!(e.length>0),this.sketchElement.addEventListener("arcgisContentReRender",this.handleSketchContentReRender),this.sketchElement.addEventListener("sketchUpdated",(()=>{this.sketchUpdated=!0})),this.hostElement.appendChild(this.sketchElement),this.setupMutationObserver()})),setTimeout((()=>requestAnimationFrame((()=>this.sketchElement?.setFocus()))),1)},this.handleSketchContentReRender=e=>{const t=e.detail;t===Wc||t===zc?this.currentSketchTool=Hc:(0,n.i)(t)||(this.currentSketchTool=t),this.selectSketchFeatureLayer()},this.selectSketchFeatureLayer=()=>{const e=this.mapLayers.find((e=>e?.title?.includes(this.sketchLayerTitle)&&"geometryType"in e&&e?.geometryType===this.currentSketchTool));let t;void 0!==e&&(t=new CustomEvent("analysisLayerSketchChange",{detail:[e.id]}),this.previousSketchFeatureLayer=e),this.analysisSketchLayerChange.emit(t)},this.referenceElement=void 0,this.label=void 0,this.toolTitle=void 0,this.mapView=void 0,this.layerFilterType=void 0,this.mapLayers=[]}mapLayersChange(e,t){const i=e.find((e=>e.title===this.previousSketchFeatureLayer?.title)),s=this.previousSketchFeatureLayer?.source?.length!==i?.source?.length;e?.length===t?.length&&!0!==s||!0!==this.sketchUpdated||(this.selectSketchFeatureLayer(),this.updateSketchTools())}async componentWillLoad(){({strings:this.strings}=await(0,n.d)(this.hostElement,(0,r.a)("."))),this.createSketch()}async disconnectedCallback(){await this.removeSketch(),this.mutationObserver?.disconnect()}setupMutationObserver(){this.mutationObserver=new MutationObserver((e=>{e.forEach((e=>{if(e.addedNodes.length>0){void 0!==Array.from(e.addedNodes).find((e=>"ARCGIS-SKETCH-LAYER-EDITOR-TOOLS"===e.nodeName))&&this.analysisSketchToolsRendered.emit(!0)}}))})),this.mutationObserver.observe(document,{childList:!0,subtree:!0})}handleMapLayerChange(){const e=this.mapView?.map.allLayers.find((e=>e.title===this.sketchLayerTitle));void 0===e&&this.analysisSketchRemove.emit()}async removeSketch(){this.sketchUpdated=!1,this.reactiveUtilsHandler.remove(),await(this.sketchElement?.done()),this.sketchElement?.removeEventListener("arcgisContentReRender",this.handleSketchContentReRender),this.sketchElement?.remove(),this.sketchElement=void 0}updateSketchTools(){const e=this.mapLayers.filter((e=>!0===e?.title?.includes(this.sketchLayerTitle)));void 0!==this.sketchElement&&(this.sketchElement.hideSelectionTools=!(e.length>0),this.sketchElement.updateSketchTools())}createSketchLayer(){this.setSketchLayerName(),this.sketchLayer=(0,n.aF)(this.sketchLayerTitle),this.mapView?.map.add(this.sketchLayer)}setSketchLayerName(){let e=`${this.toolTitle?.trim()??""} ${this.label} ${this.strings.sketchLayerTitle}`.trim();e=(0,n.aG)(e);const t=this.mapView?.map.allLayers.filter((t=>t?.title?.includes(e)))??[];if(0===t?.length)this.sketchLayerTitle=e;else{let t=!1;for(;!1===t;){const i=`${e} ${this.sketchLayerTitleNumber}`;t=void 0===this.mapView?.map.allLayers.find((e=>e?.title===i)),!0===t?this.sketchLayerTitle=i:this.sketchLayerTitleNumber+=1}}}get hiddenSketchTools(){const e=Array.isArray(this.layerFilterType)?this.layerFilterType:[this.layerFilterType];let t=[Nc,Uc,Hc,Wc,zc,Gc];return!1===e.includes("feature")?e.forEach((e=>{"feature_point"===e||"feature_multiPoint"===e?t=t.filter((e=>e!==Nc)):"feature_line"===e?t=t.filter((e=>e!==Uc)):"feature_polygon"===e&&(t=t.filter((e=>e!==Hc&&e!==Wc&&e!==zc)))})):t=[Gc],t}render(){return(0,r.h)(r.H,{key:"9d1f075ee66f8c81b3037a137bd595cb4a85fd4d"})}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,r.g)(this)}static get watchers(){return{mapLayers:["mapLayersChange"]}}};Qc.style="";const Jc="analysis-popover",Kc="popover-content",Yc="js-app-flyout",Zc="toggle-select-all-button",Xc="analysis--rtl",ed="fields-message",td="list-item",id=class{constructor(e){(0,r.r)(this,e),this.analysisSummaryFieldSelectionDone=(0,r.c)(this,"analysisSummaryFieldSelectionDone",6),this.analysisSummaryFieldPopoverClose=(0,r.c)(this,"analysisSummaryFieldPopoverClose",7),this.hasEmptySearchResults=!1,this.onSelectionDone=()=>{this.analysisSummaryFieldSelectionDone.emit(this.selection),this.open=!1},this.onCalciteListItemChange=e=>{const t=e.target,i=t.value,s=new Set(this.selection);t.selected?s.add(i):s.delete(i),this.selection=s},this.handleSelectAllClick=()=>{this.showSelectAllString?this.selection=new Set(this.fields?.map((e=>e.name))):this.selection=new Set},this.handleCalciteListFilterChange=e=>{const t=e.target;this.hasEmptySearchResults=0===t.filteredData.length,this.searchString=t.filterText},this.renderMessages=()=>{const{noInputSelected:e,noFieldsAvailable:t,noSearchResults:i}=this.strings,s=!0===(0,n.i)(this.layer)&&(0,r.h)("calcite-label",{class:ed},this.noLayersText??(0,n.a)(void 0!==this.layerInputLocalizedLabel?e.withLayerInputLabel:e.withoutLayerInputLabel,{layerInputLabel:this.layerInputLocalizedLabel})),a=!1===(0,n.i)(this.layer)&&0===this.fields?.length&&(0,r.h)("calcite-label",{class:ed},this.noFieldsText??(0,n.a)(t,{layerName:this.layer?.title})),o=this.noSearchResults&&(0,r.h)("calcite-label",{class:ed},i);return(0,r.h)("div",null,s,a,o)},this.renderFields=()=>{const e=this.referenceElement?.offsetWidth;return(0,r.h)("calcite-list",{class:Kc,label:"",style:{width:void 0!==e?`${e}px`:void 0,maxWidth:n.U.MaxPopoverWidth},selectionMode:"multiple",filterEnabled:!0,onCalciteListFilter:this.handleCalciteListFilterChange},this.shouldDisplaySelectAllButton&&(0,r.h)("calcite-button",{class:Zc,appearance:"transparent",onClick:this.handleSelectAllClick,scale:n.U.Scale},this.showSelectAllString?this.strings.selectAll:this.strings.deselectAll),this.fields?.map((e=>{const{name:t,alias:i,type:s,description:a}=e;return(0,r.h)("calcite-list-item",{onCalciteListItemSelect:this.onCalciteListItemChange,selected:this.selection.has(t),key:t,value:t,label:i,description:this.showFieldDescription?a:`{${t}}`,"data-field-type":s,class:td})})),this.renderMessages())},this.layer=void 0,this.layerInputLocalizedLabel=void 0,this.noFieldsText=void 0,this.noLayersText=void 0,this.showFieldDescription=!1,this.usePopupTemplatesInfo=!0,this.allowDateType=!1,this.allowDateOnlyType=!1,this.allowTimeOnlyType=!1,this.allowStringType=!1,this.selection=new Set,this.referenceElement=void 0,this.open=void 0,this.showSelectAllString=!0,this.searchString=void 0}async layerChange(){void 0!==this.layer?(this.fields=await(0,n.h)(this.layer,this.usePopupTemplatesInfo),this.fields=(0,n.aI)({fields:this.fields,layer:this.layer,allowNumericType:!0,allowObjectId:!1,allowDateType:this.allowDateType,allowStringType:this.allowStringType,allowDateOnlyType:this.allowDateOnlyType,allowTimeOnlyType:this.allowTimeOnlyType,allowBigIntType:!0,allowGeometryFields:!1})):this.fields=[]}onSelectionChange(){this.showSelectAllString=this.selection.size!==this.fields?.length}get noSearchResults(){return""!==this.searchString&&this.hasEmptySearchResults}get shouldDisplaySelectAllButton(){return(this.fields?.length??0)>0&&!this.noSearchResults}async componentWillLoad(){({strings:this.strings,dir:this.dir}=await(0,n.d)(this.hostElement,(0,r.a)("."))),await this.layerChange(),this.onSelectionChange()}componentDidLoad(){setTimeout((()=>requestAnimationFrame((()=>this.summaryFieldsPopover?.setFocus()))),1),setTimeout((()=>{this.summaryFieldsPopover?.reposition?.()}),n.U.PopoverTimer)}async reposition(){await(this.summaryFieldsPopover?.reposition?.())}render(){return(0,r.h)(r.H,{key:"9fde0dcf7824a79c177c0107cad040802a6feca3",dir:this.dir,class:`${Jc} ${Yc} ${"rtl"===this.dir?Xc:""}`},(0,r.h)("calcite-popover",{key:"636798266160f9ae54dd62f77c2fcac64be80ca6",ref:e=>{this.summaryFieldsPopover=e},autoClose:!0,label:this.strings.summaryFieldsPopover,referenceElement:this.referenceElement,placement:"trailing",closable:!0,heading:this.strings.addField,open:this.open,focusTrapDisabled:!0,onCalcitePopoverClose:()=>this.analysisSummaryFieldPopoverClose.emit()},(0,r.h)("calcite-panel",{key:"60277800b53c20bd6117504f40a6d1a31fd2dea3"},this.renderFields(),(0,r.h)("calcite-button",{key:"cb6230efdd8885040a0e349c669050ea6ce538da",slot:"footer",width:"full",name:"done",scale:"m",onClick:this.onSelectionDone},this.strings.done))))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,r.g)(this)}static get watchers(){return{layer:["layerChange"],usePopupTemplatesInfo:["layerChange"],selection:["onSelectionChange"]}}};id.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex}.popover-content{height:var(--analysis-popover-content-height)}.toggle-select-all-button{margin:0;margin-left:var(--analysis-quarter-spacing);margin-bottom:var(--analysis-quarter-spacing)}.chip-group{margin:var(--analysis-quarter-spacing)}.fields-message{background-color:var(--calcite-color-background);padding:var(--analysis-three-quarter-spacing)}.list-item{--calcite-font-size--1:var(--calcite-font-size--2)}:host(.analysis--rtl) .toggle-select-all-button{margin:0;margin-right:var(--analysis-quarter-spacing);margin-top:var(--analysis-quarter-spacing)}";const sd=class{constructor(e){(0,r.r)(this,e),this.renderPopoverContent=void 0,this.popoverOptions=void 0,this.open=!0}render(){const e=this.popoverOptions?.referenceElement,t=e?.getBoundingClientRect().width,i={...this.popoverOptions,width:void 0!==t?`${t}px`:void 0,open:this.open};return(0,r.h)("calcite-popover",{key:"e3ee64a442697ed3ccf3dd4d90f524c89cadcbbf",...i},this.renderPopoverContent())}get hostElement(){return(0,r.g)(this)}}},45218:(e,t,i)=>{i.d(t,{A:()=>d,a:()=>u,b:()=>b,c:()=>k,d:()=>L,e:()=>E,f:()=>P,g:()=>D,h:()=>H,i:()=>N,j:()=>W,k:()=>Z,l:()=>ue,m:()=>ye,n:()=>ve,o:()=>be,p:()=>we,q:()=>ke,r:()=>Le,s:()=>xe,t:()=>Ve,u:()=>qe,v:()=>We,w:()=>Je,x:()=>Ye,y:()=>U});var s=i(12064),a=i(22069),r=i(46784),n=i(86312),o=i(74449),l=i(87192);const h="control-margin",c="label",d=class{constructor(e){(0,s.r)(this,e),this.analysisBooleanInputChange=(0,s.c)(this,"analysisBooleanInputChange",7),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.handleCheckChange=()=>{this.value=!this.value,this.analysisBooleanInputChange.emit()},this.value=void 0,this.label=void 0,this.labelLayout=void 0,this.displayStyle="checkbox",this.validationParams=void 0,this.hideHelp=!1}render(){const e=(0,a.f)(this.validationParams),t=!1===(0,a.i)(e),i=(0,a.g)(this.validationParams?.type);return(0,s.h)(s.H,{key:"6e4376139ae543f7e9ad792768d62923e45d08e3"},(0,s.h)("calcite-label",{key:"840aeb9566781c05e28edb0d827b518a24389383",class:c,layout:this.labelLayout??"inline"},"switch"===this.displayStyle?(0,s.h)("calcite-switch",{class:h,scale:a.U.Scale,checked:this.value??!1,onCalciteSwitchChange:this.handleCheckChange}):(0,s.h)("calcite-checkbox",{class:h,scale:a.U.Scale,checked:this.value??!1,onCalciteCheckboxChange:this.handleCheckChange}),!1===(0,a.i)(this.label)&&(0,s.h)("analysis-label",{key:"08bc68bc3b4d51e7c64a967ef567da024067aba8",label:this.label,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit(),hideHelp:this.hideHelp})),(0,s.h)("calcite-input-message",{key:"15481a49a3e3f90e04a71f749c0590a578e16e3c",status:i,hidden:!t,scale:a.U.Scale,icon:"exclamationMarkTriangle"},e))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}};d.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{--calcite-label-margin-bottom:0rem}.control-margin{margin-bottom:var(--analysis-quarter-spacing)}.label{width:100%}";const u=class{constructor(e){(0,s.r)(this,e),this.analysisChipGroupSelectionChange=(0,s.c)(this,"analysisChipGroupSelectionChange",7),this.chipRefs=[],this.isValid=!0,this.selectAllHandler=()=>{Array.isArray(this.value)?this.selectedChips.length<this.value.length?(this.selectedChips=this.value,this.canSelectAll=!1):(this.selectedChips=[],this.canSelectAll=!0):(this.selectedChips=1===this.selectedChips.length?[]:[this.value],this.canSelectAll=1!==this.selectedChips.length),this.analysisChipGroupSelectionChange.emit()},this.handleCalciteChipClick=e=>{const t=e.target.value;this.disabled||this.handleChipSelection(t)},this.validateSelection=()=>{this.isValid=this.selectedChips.length>0},this.renderChips=()=>{const e=(0,a.z)(this.value,this.chipLabel);return(0,s.h)(s.H,null,(0,s.h)("div",null,e.map((([e,t],i)=>(0,s.h)("calcite-chip",{label:t,key:e,scale:this.scale,ref:e=>{null==e||this.value.includes(e.value)||this.chipRefs.push(e)},appearance:"outline",kind:this.selectedChips.includes(e)?"brand":"neutral",icon:Array.isArray(this.iconLabel)?this.iconLabel[i]:this.iconLabel,value:e,onClick:this.handleCalciteChipClick,class:this.disabled?"analysis-chip-disabled":"analysis-chip-button",closed:!1,closable:this.dismissible,messageOverrides:{dismissLabel:this.strings.remove}},t))),this.selectAllEnabled?(0,s.h)("calcite-button",{round:!0,scale:this.scale,kind:"brand",appearance:"transparent",onClick:this.selectAllHandler},this.canSelectAll?this.strings.selectAll:this.strings.deselectAll):null,this.renderErrorMessage()))},this.renderErrorMessage=()=>!0===this.required&&!1===this.isValid?(0,s.h)("calcite-input-message",{status:a.b.INVALID,scale:a.U.Scale,icon:"exclamationMarkTriangle"},(0,a.a)(this.validationParams?.badInputMessage??this.strings.requiredError,{})):null,this.renderChip=()=>(0,s.h)(s.H,null,(0,s.h)("div",null,(0,s.h)("calcite-chip",{label:this.chipLabel,ref:e=>{0===this.chipRefs.length&&this.chipRefs.push(e)},kind:this.selectedChips.includes(this.value)?"brand":"neutral",appearance:"outline",icon:this.chipLabel,scale:this.scale,value:this.value,onClick:this.handleCalciteChipClick,class:this.disabled?"analysis-chip-disabled":"analysis-chip-button",closable:this.dismissible,messageOverrides:{dismissLabel:this.strings.remove}},this.chipLabel))),this.canSelectAll=!0,this.value=void 0,this.iconLabel=void 0,this.scale=a.U.Scale,this.selectAllEnabled=!1,this.label=void 0,this.selectionMode=void 0,this.disabled=!1,this.dismissible=!1,this.selectedChips=[],this.initialChipSelection=[],this.chipLabel=void 0,this.required=!1,this.validationParams=void 0}validateValues(e){if(!0===(0,a.c)(e))throw new a.A("DuplicateValueError","There are duplicate strings in the values array")}selectedChipsChange(){this.validateSelection(),this.analysisChipGroupSelectionChange.emit(),this.updateSelectAllButton()}async componentWillLoad(){Array.isArray(this.value)&&this.validateValues(this.value),({strings:this.strings}=await(0,a.d)(this.hostElement,(0,s.a)(".")))}componentDidLoad(){void 0!==this.initialChipSelection&&(this.selectedChips=this.initialChipSelection,this.isValid=!0)}handleDismiss(e){const t=e.target;this.value=Array.isArray(this.value)?this.value.filter((e=>e!==t.value)):"",this.chipLabel=Array.isArray(this.chipLabel)?this.chipLabel.filter((e=>e!==t.innerText)):"",this.chipRefs=this.chipRefs.filter((e=>e.value!==t.value))}handleChipSelection(e){if("single"===this.selectionMode)this.selectedChips=this.selectedChips.includes(e)?[]:[e];else{if("multi"!==this.selectionMode)throw new a.A("RequiredPropertyMissing","The selectionMode property is required and must be either 'single' or 'multi'");this.selectedChips=this.selectedChips.includes(e)?this.selectedChips=this.selectedChips.filter((t=>t!==e)):this.selectedChips=[...this.selectedChips,e]}}updateSelectAllButton(){!0===this.selectAllEnabled&&(Array.isArray(this.value)&&this.selectedChips.length===this.value.length||this.selectedChips[0]===this.value?this.canSelectAll=!1:this.canSelectAll=!0)}async checkValidity(){return this.validateSelection(),Promise.resolve(this.isValid)}render(){return!0===(Array.isArray(this.value)&&Array.isArray(this.chipLabel)&&this.value?.length===this.chipLabel?.length)?this.renderChips():this.renderChip()}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{value:["validateValues"],selectedChips:["selectedChipsChange"]}}};u.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{margin-bottom:var(--analysis-half-spacing)}.analysis-chip-button{margin:var(--analysis-quarter-spacing);border-width:2px}.analysis-chip-button:hover{cursor:pointer}.analysis-chip-disabled{margin:var(--analysis-quarter-spacing);background-color:var(--calcite-color-foreground-2);border:none}";const p="half-margin-bot",m="width-100",y="flex-container",v="primary-button",g="secondary-button",f="list-item--border",b=class{constructor(e){(0,s.r)(this,e),this.analysisDataFileInputChange=(0,s.c)(this,"analysisDataFileInputChange",7),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.renderInitial=()=>{const e=!(0,a.i)(this.value)&&"portalItemID"in this.value?{itemId:this.value.portalItemID}:void 0,t=this.accept?.map((e=>`.${e}`)).join(",");return(0,s.h)(s.F,null,(0,s.h)("div",{class:y},"item"===this.browseOption?(0,s.h)("analysis-item-input",{class:v,hidden:this.urlSelected||void 0!==this.selectedFile,q:'((typekeywords:"Document" OR type:"Image" OR type:"Layout" OR type:"Desktop Style" OR type:"Project Template" OR type:"Report Template" OR type:"Pro Report" OR type:"Statistical Data Collection" OR type:"360 VR Experience" OR type:"netCDF" OR type:"PDF" OR type:"CSV" OR type:"Administrative Report" OR type:"Raster function template") -type:("Image Service" OR "Explorer Document" OR "Explorer Map" OR "Globe Document" OR "Scene Document"))',label:"",replaceTooltipText:this.strings.replaceData,selectButtonLabel:this.strings.addData,selectedItemIcon:"file",value:e,onAnalysisItemInputChange:this.handleAnalysisItemInputChange,portal:this.portal,user:this.portal?.user}):(0,s.h)("analysis-layer-input",{class:v,hidden:this.urlSelected||void 0!==this.selectedFile,label:"",layerFilterType:"imagery",mapLayers:this.mapLayers,mapView:this.mapView,selectedLayers:this.selectedRasterDataLayer,selectedLayerIcon:"image-layer",user:this.portal?.user,value:this.value,popoverWidth:this.popoverWidth,onAnalysisLayerInputChange:this.handleAnalysisLayerInputChange}),!1===this.hideUpload&&(0,s.h)("calcite-button",{"data-tooltip-id":"upload",class:`${g} ${p}`,hidden:this.itemSelected||this.urlSelected||void 0!==this.selectedFile||void 0!==this.selectedRasterDataLayer,appearance:"outline","icon-start":"upload-to",kind:"neutral",scale:a.U.Scale,label:this.strings.file,onMouseOver:this.addTooltip,onMouseOut:this.removeTooltip,onClick:e=>{this.hiddenFileInput?.click(),e.preventDefault()}}),(0,s.h)("calcite-button",{"data-tooltip-id":"url",class:`${g} ${p}`,hidden:this.itemSelected||this.urlSelected||void 0!==this.selectedFile||void 0!==this.selectedRasterDataLayer,appearance:"outline","icon-start":"link",kind:"neutral",scale:a.U.Scale,label:this.strings.url,onMouseOver:this.addTooltip,onMouseOut:this.removeTooltip,onClick:this.handleUrlClick}),this.urlSelected&&this.renderUrlInput(),void 0!==this.selectedFile&&this.renderFileSelected(),(0,s.h)("input",{accept:t,hidden:!0,type:"file",onInput:this.handleFileInputChange,ref:e=>this.hiddenFileInput=e})),this.renderInputMessage())},this.renderUrlInput=()=>{const e=this.doCalciteInputChangeOnCommit?{onCalciteInputTextChange:this.handleUrlInputChange}:{onCalciteInputTextInput:this.handleUrlInputChange};return(0,s.h)("calcite-input-text",{class:m,value:this.value?.url,scale:a.U.Scale,...e},(0,s.h)("calcite-action",{slot:"action",icon:"x",scale:a.U.Scale,text:this.strings.clear,onClick:this.resetToInitial}))},this.renderFileSelected=()=>{const e=this.selectedFile?.itemName;return(0,s.h)("calcite-list",{class:m,label:"",loading:this.fileUploading},(0,s.h)("calcite-list-item",{"data-tooltip-id":"replace",class:f,label:e,onCalciteListItemSelect:e=>{this.hiddenFileInput?.click(),e.preventDefault()},onMouseOver:this.addTooltip,onMouseOut:this.removeTooltip},(0,s.h)("calcite-icon",{icon:"file",slot:"content-start"}),(0,s.h)("calcite-action",{text:this.strings.clear,slot:"actions-end",label:this.strings.clear,appearance:"transparent",icon:"x",onClick:this.resetToInitial,onMouseOver:this.removeTooltip})))},this.renderInputMessage=()=>void 0!==this.errorMessage&&(0,s.h)("calcite-input-message",{status:a.b.INVALID,scale:a.U.Scale,icon:"exclamationMarkTriangle"},this.errorMessage),this.handleAnalysisItemInputChange=e=>{const t=e.target.selectedItem;void 0!==t?(this.value={portalItemID:t.id},this.itemSelected=!0,this.validate(),this.analysisDataFileInputChange.emit()):this.resetToInitial()},this.handleAnalysisLayerInputChange=e=>{const{selectedLayers:t,value:i}=e.target;void 0!==t?(this.selectedRasterDataLayer=t,this.value={url:i.url,inputType:"layer"},this.validate(),this.analysisDataFileInputChange.emit()):this.resetToInitial()},this.handleFileInputChange=async()=>{if(0!==this.hiddenFileInput?.files?.length&&(this.selectedFile={itemName:this.hiddenFileInput?.files?.[0].name??""},void 0!==this.abortController&&this.abortController.abort(),void 0!==this.serviceUrl)){this.errorMessage=void 0,this.fileUploading=!0;try{this.abortController=new AbortController;const e=new FormData;e.append("file",this.hiddenFileInput?.files?.[0]),e.append("f","json");const t=this.apiUrls.upload,i=await(0,a.r)(t,{body:e,method:"post",responseType:"json",signal:this.abortController.signal});this.selectedFile=i.data.item,this.value={itemID:i.data.item.itemID,inputType:"file"},this.fileUploading=!1,this.validate(),this.analysisDataFileInputChange.emit()}catch(e){console.error(e),this.errorMessage=this.strings.uploadFailureMsg,this.selectedFile=void 0,this.fileUploading=!1}}},this.handleUrlClick=()=>{this.urlSelected=!0},this.handleUrlInputChange=e=>{const t=e.target.value;this.value={url:t,inputType:"text"},this.validate(),this.analysisDataFileInputChange.emit()},this.resetToInitial=()=>{this.value=void 0,this.selectedFile=void 0,this.selectedRasterDataLayer=void 0,this.urlSelected=!1,this.itemSelected=!1,this.validate(),this.analysisDataFileInputChange.emit()},this.addTooltip=e=>{const t=e.target,i=t?.getAttribute("data-tooltip-id");switch(void 0===this.tooltipElement&&(this.tooltipElement=document.createElement("calcite-tooltip"),this.tooltipElement.placement="bottom"),i){case"upload":this.tooltipElement.innerText=this.strings.uploadData,this.tooltipElement.offsetDistance=14;break;case"url":this.tooltipElement.innerText=this.strings.AddDataFromUrl,this.tooltipElement.offsetDistance=14;break;case"replace":this.tooltipElement.innerText=this.strings.replaceData;break;default:return void(this.tooltipElement=void 0)}this.tooltipElement.referenceElement=t,(0,r.a)(document,this.tooltipElement)},this.removeTooltip=()=>{(0,r.r)(this.tooltipElement)},this.validate=()=>{let e;void 0===this.value||"url"in this.value&&""===this.value.url?e=!0===this.required&&(0,a.i)(this.value)?this.strings.required:void 0:"url"in this.value&&void 0===this.selectedRasterDataLayer&&(e=(0,r.i)(this.value.url)&&(0,r.b)(this.value.url,this.accept)?void 0:e??this.strings.invalidUrl),this.errorMessage=e},this.value=void 0,this.label=void 0,this.required=void 0,this.selectionMode=void 0,this.accept=void 0,this.hideUpload=!1,this.serviceUrl=void 0,this.browseOption="item",this.portal=void 0,this.mapLayers=[],this.mapView=void 0,this.hideHelp=!1,this.doCalciteInputChangeOnCommit=!1,this.selectedFile=void 0,this.selectedRasterDataLayer=void 0,this.itemSelected=!1,this.urlSelected=!1,this.fileUploading=!1,this.errorMessage=void 0,this.popoverWidth=void 0}get apiUrls(){return{delete:`${this.serviceUrl}/uploads/deleteItems`,upload:`${this.serviceUrl}/uploads/upload`}}async onValueChange(e){if(!(0,a.i)(e))if("url"in e){const t=(0,a.s)(e.url);"layer"===e.inputType?this.selectedRasterDataLayer?.url!==t&&(this.selectedRasterDataLayer=await(0,a.e)({url:t},this.mapLayers),void 0===this.selectedRasterDataLayer&&(this.errorMessage=this.strings.layerNotFound)):this.urlSelected=!0}else if("itemID"in e&&e.itemID!==this.selectedFile?.itemID)try{void 0!==this.abortController&&this.abortController.abort(),this.abortController=new AbortController;const t=await(0,a.r)(`${this.serviceUrl}/uploads/${e.itemID}?f=json`,{signal:this.abortController.signal});this.selectedFile=t.data}catch(e){console.error(e),this.errorMessage=this.strings.fileNotFound}else"portalItemID"in e&&(this.itemSelected=!0)}async componentWillLoad(){({strings:this.strings}=await(0,a.d)(this.hostElement,(0,s.a)("."))),this.onValueChange(this.value)}componentDidRender(){this.popoverWidth=this.hostElement.offsetWidth}disconnectedCallback(){this.abortController?.abort()}async checkValidity(){return this.validate(),Promise.resolve(void 0===this.errorMessage)}render(){return(0,s.h)(s.H,{key:"ef6fb064d62f6b29a830b699053fc544c1db8a2b"},!1===(0,a.i)(this.label)&&(0,s.h)("analysis-label",{key:"8620f29fc32e02144132e44c7dab94f1eb710bad",label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit(),hideHelp:this.hideHelp}),this.renderInitial())}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{value:["onValueChange"]}}};b.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{width:100%}.half-margin-bot{margin-bottom:var(--analysis-half-spacing)}.width-100{width:100%}.primary-button{flex-grow:1;--layer-selected-margin-bottom:0}.secondary-button{flex-grow:0;height:1rem}.flex-container{display:flex;gap:0.33rem}.list-item--border{border:1px solid var(--calcite-color-border-input);box-shadow:none;--calcite-font-size--1:var(--calcite-font-size--2)}";const w="controls-container",C="control",k=class{constructor(e){(0,s.r)(this,e),this.analysisDateInputChange=(0,s.c)(this,"analysisDateInputChange",7),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.validateSelection=()=>{void 0!==this.value&&0!==this.dateInputElement.value?.length&&void 0!==this.timeInputElement?.value||!0!==this.required?this.isValid=!0:(this.errorMessage=this.validationParams?.requiredMessage??(0,a.a)(this.strings.requiredError,{label:this.label}),this.isValid=!1)},this.handleDateChange=()=>{if(void 0!==this.dateInputElement?.valueAsDate){const e=this.dateInputElement.valueAsDate,t=!1===(0,a.i)(this.timeInputElement?.value)?this.timeInputElement.value.split(":").map((e=>Number(e))):[0,0];this.value=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),t[0],t[1])}else this.value=void 0;this.analysisDateInputChange.emit()},this.handleTimeChange=()=>{const e=!1===(0,a.i)(this.timeInputElement?.value)?this.timeInputElement.value.split(":").map((e=>Number(e))):void 0;if(void 0!==this.value&&void 0!==e){const t=this.dateInputElement.valueAsDate;this.value=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),e[0],e[1])}this.analysisDateInputChange.emit()},this.value=void 0,this.defaultToNow=!1,this.label=void 0,this.minDate=void 0,this.maxDate=void 0,this.required=void 0,this.isValid=!0,this.validationParams=void 0,this.hideHelp=!1,this.errorMessage=""}async checkValidity(){return this.validateSelection(),Promise.resolve(this.isValid)}async componentWillLoad(){if(({strings:this.strings}=await(0,a.d)(this.hostElement,(0,s.a)("."))),!0===this.defaultToNow){const e=6e4*(new Date).getTimezoneOffset();this.value=new Date(Date.now()).setSeconds(0,0)-e,this.analysisDateInputChange.emit()}}render(){let e,t;if(void 0!==this.value&&null!==this.value)try{const i=new Date(this.value);e=i.toISOString(),t=`${i.getUTCHours()}:${i.getUTCMinutes()}`}catch{}return(0,s.h)(s.H,{key:"8c497f4d6c8c4dbda55ad9712a8afc9ceb94bc91"},void 0!==this.label&&""!==this.label?(0,s.h)("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit(),hideHelp:this.hideHelp}):null,(0,s.h)("div",{key:"08c38539af5cefa7017f72d699451ef390f7f885",class:w},(0,s.h)("calcite-input-date-picker",{key:"0453629d3d52cb857646a0421973ecae8c998a3c",scale:a.U.Scale,class:C,value:e,placement:"bottom",minAsDate:void 0!==this.minDate?new Date(this.minDate):void 0,maxAsDate:void 0!==this.maxDate?new Date(this.maxDate):void 0,onFocusout:this.validateSelection,onCalciteInputDatePickerChange:this.handleDateChange,ref:e=>{this.dateInputElement=e}}),(0,s.h)("calcite-input-time-picker",{key:"ff11e509e57ff685a4ef485e83657a70e900b1ab",placement:"bottom",scale:a.U.Scale,value:t,class:C,onCalciteInputTimePickerChange:this.handleTimeChange,ref:e=>{this.timeInputElement=e}})),(0,s.h)("calcite-input-message",{key:"14e033b4e40788f74406ff49c91121749a809ffa",status:a.b.INVALID,scale:a.U.Scale,icon:"exclamationMarkTriangle",hidden:!1!==this.isValid},this.errorMessage))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}};k.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex;flex-direction:column;margin-bottom:var(--analysis-half-spacing);--calcite-color-border-input:var(--analysis-ui-border-input)}.controls-container{display:flex;column-gap:5%}.control{flex:1 1 auto}.text{cursor:default;padding-bottom:var(--analysis-quarter-spacing);margin-block-start:0;margin-block-end:0}";const S="analysis-popover",L=class{constructor(e){(0,s.r)(this,e),this.analysisFieldInputChange=(0,s.c)(this,"analysisFieldInputChange",7),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.filterOutGeometryFields=e=>{let t=e;return void 0!==this.mapLayer&&(t=e.filter((e=>!1===[this.mapLayer?.geometryFieldsInfo?.shapeAreaField,this.mapLayer?.geometryFieldsInfo?.shapeLengthField].includes(e.name)))),t},this.getEmptyFieldsMessage=()=>{let e;return this.pickListFields.length>0&&0===this.filteredPickListFields.length?e=this.noFieldsText??this.strings.fieldTypesIncompatible:void 0===this.mapLayer&&void 0===this.analysisDataset?e=this.noLayersText??this.strings.layerNotSelected:this.errorMessage===this.strings.fieldLoadingErrorText&&(e=this.strings.fieldLoadingErrorText),e},this.arcgisFieldPickListDismissed=e=>{if(null!==e.detail){if(!0===this.storeAsGPValue)if(this.isMultiSelect){const t=e.detail.selectedFields;this.value=this.pickListFields.filter((e=>t.includes(e.name))).map((e=>this.convertFieldInstanceToFieldObject(e)))}else{const t=e.detail.selectedFields[0];this.value=this.convertFieldInstanceToFieldObject(this.pickListFields.find((e=>e.name===t)))}else this.value=this.isMultiSelect?e.detail.selectedFields:e.detail.selectedFields[0];this.analysisFieldInputChange.emit()}this.closeFieldPickList()},this.onAnalysisFieldRemoved=e=>{this.isStringArray(this.value)?this.value=this.value.filter((t=>t!==e.detail.value)):this.isGPFieldArray(this.value)?this.value=this.value.filter((t=>t.name!==e.detail.value)):this.value=void 0,this.validate(),this.analysisFieldInputChange.emit()},this.openFieldPickList=()=>{this.fieldPickListOpen=!0},this.closeFieldPickList=()=>{this.fieldPickListOpen=!1,this.validate()},this.validate=()=>{let e;this.required&&(e=!0===(0,a.i)(this.value)?(0,a.a)(this.strings.requiredErrorMessage,{label:this.label??this.strings.requiredErrorLabelDefault}):e),this.errorMessage=e},this.errorMessage=void 0,this.pickListFields=[],this.loading=!1,this.fieldPickListOpen=!1,this.label=void 0,this.noFieldsText=void 0,this.noLayersText=void 0,this.required=!1,this.readOnly=!1,this.mapLayer=void 0,this.analysisDataset=void 0,this.fieldTypes=void 0,this.mapView=void 0,this.showFieldInfo=!0,this.selectionMode=void 0,this.usePopupTemplatesInfo=!0,this.useValueLabel=!1,this.value=void 0,this.storeAsGPValue=!1,this.selectedFields=void 0,this.placeholderText=void 0,this.showSort=!0,this.heading=void 0,this.filterPlaceholderText=void 0,this.hideFieldNames=!1,this.useDefaultValue=!1,this.allowGeometryFields=!1,this.hideHelp=!1,this.notAllowedFields=void 0}onReadOnlyChange(){this.readOnly??(this.readOnly=!1)}syncSelectedFieldsWithPickListFields(){this.syncSelectedFieldsWithValue(),this.analysisFieldInputChange.emit()}isString(e){return"string"==typeof e}isGPField(e){return!Array.isArray(e)&&"object"==typeof e&&"name"in e}isStringArray(e){return Array.isArray(e)&&e.every((e=>"string"==typeof e))}isGPFieldArray(e){return Array.isArray(e)&&e.every(this.isGPField)}syncSelectedFieldsWithValue(){const e=this.value;if((0,a.i)(e))this.selectedFields=void 0;else if(!0===this.storeAsGPValue)if(!0===this.isMultiSelect){const t=new Set(e.map((e=>e.name)));this.selectedFields=this.pickListFields.filter((e=>t.has(e.name)))}else this.selectedFields=this.pickListFields.find((t=>t.name===e.name));else if(!0===this.isMultiSelect){const t=new Set(e);this.selectedFields=this.pickListFields.filter((e=>t.has(e.name)))}else this.selectedFields=this.pickListFields.find((t=>t.name===e))}disableFieldsFromPickList(){this.notAllowedFieldsSet=new Set(this.notAllowedFields),void 0!==this.value&&this.notAllowedFieldsSet.size&&(this.isStringArray(this.value)?this.value.forEach((e=>this.notAllowedFieldsSet.delete(e))):this.isGPFieldArray(this.value)?this.value.forEach((e=>this.notAllowedFieldsSet.delete(e.name))):this.isString(this.value)?this.notAllowedFieldsSet.delete(this.value):this.notAllowedFieldsSet.delete(this.value.name))}async updatePickListFieldsFromLayer(){await this.loadPickListFieldsFromLayer(),this.maybeResetValue()}async updatePickListFieldsFromDataset(){await this.loadPickListFieldsFromDataset(),this.maybeResetValue()}get filteredPickListFields(){const e=new Set(this.fieldTypes),t=!1===this.allowGeometryFields?this.filterOutGeometryFields(this.pickListFields):this.pickListFields;return 0===e.size?t:t.filter((t=>e.has(t.type)&&!this.notAllowedFieldsSet?.has(t.name)))}async componentWillLoad(){({strings:this.strings,dir:this.dir}=await(0,a.d)(this.hostElement,(0,s.a)("."))),void 0!==this.mapLayer?this.loadPickListFieldsFromLayer().then((()=>{this.disableFieldsFromPickList()})):void 0!==this.analysisDataset&&this.loadPickListFieldsFromDataset().then((()=>{void 0!==this.errorMessage&&""!==this.errorMessage||!0===this.abortController?.signal.aborted||this.maybeResetValue(),this.disableFieldsFromPickList()}))}disconnectedCallback(){this.abortController?.abort()}async checkValidity(){this.validate();const e=void 0===this.errorMessage||""===this.errorMessage;return Promise.resolve(e)}maybeResetValue(){const e=this.filteredPickListFields??[],t=new Set(e.map((e=>e.name)));this.errorMessage=void 0;let i=!0;if(this.isMultiSelect&&Array.isArray(this.value)){let e;e=this.isStringArray(this.value)?this.value.filter((e=>t.has(e))):this.value.filter((e=>t.has(e.name))),0!==e.length&&(this.value=e,this.validate(),this.analysisFieldInputChange.emit(),i=!1)}else i=this.isString(this.value)?!t.has(this.value):!t.has(this.value?.name);!0===i&&!1===this.readOnly&&(this.useDefaultValue&&e.length>0?(!1===this.storeAsGPValue?this.value=this.isMultiSelect?[e[0].name]:e[0].name:this.value=this.isMultiSelect?[e[0]]:e[0],this.validate(),this.analysisFieldInputChange.emit()):void 0!==this.value&&(this.value=void 0,this.validate(),this.analysisFieldInputChange.emit()))}get isMultiSelect(){return"multi"===this.selectionMode}convertFieldInstanceToFieldObject(e){return void 0!==e&&"toJSON"in e&&"function"==typeof e.toJSON?e.toJSON():e}async loadPickListFieldsFromDataset(){if(void 0!==this.abortController&&this.abortController.abort(),void 0!==this.analysisDataset){this.loading=!0;try{this.abortController=new AbortController,this.pickListFields=await this.analysisDataset.getFields({signal:this.abortController.signal})}catch(e){!1===(0,a.w)(e)&&(this.errorMessage=this.strings.fieldLoadingErrorText)}this.loading=!1}else this.pickListFields=[]}async loadPickListFieldsFromLayer(){if(void 0!==this.mapLayer)try{this.pickListFields=await(0,a.h)(this.mapLayer,this.usePopupTemplatesInfo)}catch(e){this.errorMessage=this.strings.fieldLoadingErrorText}else this.pickListFields=[]}render(){return(0,s.h)(s.H,{key:"68c98c0e9c89456e5aeb19a1e358a59679c5da84"},(0,s.h)("analysis-field-select",{key:"54384825520ea700f53351f05d844565702ce86e",errorMessage:this.errorMessage,value:!0===(0,a.i)(this.value)?void 0:this.value,label:this.label,hideHelp:this.hideHelp,ref:e=>{this.fieldSelectElement=e},fields:this.pickListFields,useValueLabel:this.useValueLabel,selectionMode:this.selectionMode,onAnalysisSelectFieldClick:this.openFieldPickList,onAnalysisFieldRemove:this.onAnalysisFieldRemoved,placeholderText:this.placeholderText,required:this.required,readOnly:this.readOnly}),this.fieldPickListOpen&&this.renderFieldPickList())}renderFieldPickList(){const e=this.filteredPickListFields;let t;const i=this.getEmptyFieldsMessage();let a,r,n;return this.loading?t=(0,s.h)("calcite-loader",{label:this.strings.loadingFields,type:"indeterminate",slot:"no-fields"}):void 0!==i&&(t=(0,s.h)("p",{slot:"no-fields",style:{margin:"var(--analysis-half-spacing)"}},i)),this.isMultiSelect||(a=this.strings.selectFieldPicklistHeading,r=this.strings.selectOkBtnText),a=this.heading??a,n=void 0!==this.value?this.isMultiSelect?!0===this.storeAsGPValue?this.value.map((e=>e.name)):this.value:[!0===this.storeAsGPValue?this.value.name:this.value]:[],(0,s.h)("arcgis-tunnel",{reference:this.hostElement},(0,s.h)("arcgis-field-pick-list",{dir:this.dir,class:S,layer:this.mapLayer,mapView:this.mapView,fields:this.loading?[]:e,selectedFields:n,multiple:this.isMultiSelect,showDescription:!0,showFieldName:!this.hideFieldNames,showSort:this.showSort,showSelectionAll:e.length>0,showFieldInfo:void 0===this.analysisDataset&&this.showFieldInfo,heading:a,okBtnText:r,filterPlaceholderText:this.filterPlaceholderText,filterNoResultsText:this.strings.noSearchResults,onArcgisFieldPickListDismissed:this.arcgisFieldPickListDismissed,popoverProps:{refElement:this.fieldSelectElement,autoClose:!0,popoverWidth:300,overlayPositioning:"fixed"}},t))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{readOnly:["onReadOnlyChange"],pickListFields:["syncSelectedFieldsWithPickListFields"],value:["syncSelectedFieldsWithValue"],notAllowedFields:["disableFieldsFromPickList"],mapLayer:["updatePickListFieldsFromLayer"],usePopupTemplatesInfo:["updatePickListFieldsFromLayer"],analysisDataset:["updatePickListFieldsFromDataset"]}}};L.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex;width:var(--analysis-component-default-width);margin-bottom:var(--analysis-half-spacing)}.list-item{--calcite-font-size--1:var(--calcite-font-size--2)}";const _="field-multi-select-btn-spaced",I="multi-select-container",M="error-message",x="bordered",E=class{constructor(e){(0,s.r)(this,e),this.analysisSelectFieldClick=(0,s.c)(this,"analysisSelectFieldClick",7),this.analysisFieldRemove=(0,s.c)(this,"analysisFieldRemove",7),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.renderErrorMessage=()=>{const e=!1===(0,a.i)(this.errorMessage);return(0,s.h)("calcite-input-message",{class:M,icon:"exclamationMarkTriangle",status:a.b.INVALID,scale:a.U.Scale,hidden:!e},this.errorMessage)},this.handleReplaceFieldClick=e=>{const t=e.target;"calcite-list-item"!==t?.localName||e.composedPath().find((e=>"calcite-action"===e.localName))||this.analysisSelectFieldClick.emit()},this.handleMouseOver=e=>{const t=e.target;"calcite-list-item"===t?.localName&&(void 0===this.replaceTooltip&&(this.replaceTooltip=document.createElement("calcite-tooltip"),this.replaceTooltip.placement="bottom",this.replaceTooltip.innerText=this.strings.replaceField),this.replaceTooltip.referenceElement=t,(0,r.a)(document,this.replaceTooltip))},this.handleMouseOut=()=>{(0,r.r)(this.replaceTooltip)},this.onSelectClick=()=>{this.analysisSelectFieldClick.emit()},this.onFieldRemoved=e=>{(0,r.r)(this.replaceTooltip),this.analysisFieldRemove.emit({value:e})},this.value=void 0,this.label=void 0,this.disabled=!1,this.selectionMode=void 0,this.useValueLabel=!1,this.fields=void 0,this.errorMessage=void 0,this.placeholderText=void 0,this.required=!1,this.readOnly=!1,this.hideHelp=!1}get fieldLabels(){let e=[];if(!0===this.useValueLabel&&void 0!==this.value){e=(Array.isArray(this.value)?this.value:[this.value]).map((e=>[e,e]))}else!1===this.useValueLabel&&void 0!==this.fields&&(e=this.fields.map((e=>[e.name,e.alias])));return new Map(e)}async componentWillLoad(){({strings:this.strings}=await(0,a.d)(this.hostElement,(0,s.a)(".")))}render(){return(0,s.h)(s.H,{key:"c6c2e7df1b9620a1861f480f6492f91c559529b2"},void 0!==this.label&&""!==this.label?(0,s.h)("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit(),hideHelp:this.hideHelp}):null,void 0===this.selectionMode||"single"===this.selectionMode?void 0===this.value?this.renderSingleSelectButton():this.renderSingleListItem():this.renderMultiple(),this.renderErrorMessage())}renderSingleListItem(){const e="string"==typeof this.value?this.value:this.value?.name,t=this.fieldLabels.get(e)??e;return(0,s.h)("calcite-list",{interactionMode:!0===this.readOnly?"static":void 0,label:""},(0,s.h)("calcite-list-item",{"data-layerId":e,class:x,key:e?.toString(),value:e,label:t,unavailable:!0===this.readOnly,onMouseOver:!1===this.readOnly?this.handleMouseOver:void 0,onMouseOut:!1===this.readOnly?this.handleMouseOut:void 0,onClick:!1===this.readOnly?this.handleReplaceFieldClick:void 0,messageOverrides:{close:this.strings.removeField}},!1===this.readOnly&&(0,s.h)("calcite-action",{text:this.strings.removeField,slot:"actions-end",label:this.strings.removeField,appearance:"transparent",icon:"x",onClick:()=>this.onFieldRemoved(e)})))}renderSingleSelectButton(){const e="string"==typeof this.value?this.value:this.value?.name,t=void 0!==e?this.fieldLabels.get(e):this.placeholderText??this.strings.inputPlaceholderText;return(0,s.h)("calcite-button",{scale:a.U.Scale,width:"full",alignment:"space-between",appearance:"outline",kind:"neutral","icon-end":"chevron-down",onClick:this.onSelectClick},t)}renderMultiple(){const e=void 0!==this.value&&Array.isArray(this.value)&&this.value.length>0?_:void 0,t=this.fieldLabels,i=e=>(0,s.h)("calcite-list-item",{key:e,label:t.get(e)??e,value:e,onClick:this.handleReplaceFieldClick},(0,s.h)("calcite-action",{text:this.strings.removeField,slot:"actions-end",label:this.strings.removeField,appearance:"transparent",icon:"x",onClick:()=>this.onFieldRemoved(e)}));let r;return r="string"==typeof this.value?.[0]?this.value.map(i):this.value?.map((e=>i(e.name))),(0,s.h)("div",{class:I},void 0!==r&&r.length>0&&(0,s.h)("calcite-list",{class:x,label:"",onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut},r),(0,s.h)("calcite-button",{iconStart:"plus",appearance:"outline",kind:"neutral",width:"full",onClick:this.onSelectClick,class:e,scale:a.U.Scale},this.placeholderText??this.strings.multiSelectFieldButtonText))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}};E.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{width:var(--analysis-component-default-width);font-size:var(--analysis-label-font-size)}.error-message{margin-top:var(--analysis-quarter-spacing)}.field-multi-select-btn-spaced{margin-top:var(--analysis-half-spacing)}.bordered{border:1px solid var(--analysis-ui-border-input);--calcite-font-size--1:var(--calcite-font-size--2)}.multi-select-container{display:flex;flex-direction:column;gap:var(--analysis-quarter-spacing);width:100%;margin-bottom:var(--analysis-half-spacing)}.text-s{margin-block-start:0;margin-block-end:0;color:var(--calcite-color-text-1);font-size:var(--calcite-font-size--2);line-height:1rem}.text-m{margin-block-start:0;margin-block-end:0;color:var(--calcite-color-text-1);font-size:var(--calcite-font-size--1);line-height:1rem}";const T={buttonContainer:"button-container",listItem:"list-item",firstListItem:"first-list-item"},P=class{constructor(e){(0,s.r)(this,e),this.analysisGeoenrichmentInputChange=(0,s.c)(this,"analysisGeoenrichmentInputChange",7),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.doValidate=!1,this.renderAddVariable=()=>(0,s.h)("calcite-button",{width:"full",appearance:"outline",kind:"neutral","icon-start":"plus",scale:a.U.Scale,onClick:this.openDataBrowser},this.strings.addVariableLabel),this.renderSelectedVariables=()=>{const e=this.value?.analysisVariables?.map(((e,t)=>(0,s.h)("calcite-list-item",{key:e,label:this.value?.labels?.[t]??e,value:e,class:0===t?T.firstListItem:T.listItem,closable:!0,onCalciteListItemClose:this.onListItemRemove})));return(0,s.h)("calcite-list",{label:""},e)},this.onListItemRemove=e=>{const t=e.target,i=t?.value;if(void 0!==this.value){let{analysisVariables:e,labels:s}=this.value;e=e?.filter((e=>e!==i)),s=s?.filter((e=>e!==t?.label)),this.doValidate=!0,this.value=0===e?.length?void 0:Object.assign({},this.value,{analysisVariables:e,labels:s})}this.analysisGeoenrichmentInputChange.emit()},this.openDataBrowser=()=>{this.dataBrowserElement=document.createElement("analysis-geoenrichment-databrowser"),this.dataBrowserElement.addEventListener("analysisDataBrowserSelectionChange",this.onSelectedVariables),this.dataBrowserElement.addEventListener("analysisDataBrowserClose",this.closeModal),document.body.appendChild(this.dataBrowserElement),this.dataBrowserElement.value=this.value?.analysisVariables,this.dataBrowserElement.portal=this.portal,this.dataBrowserElement.countryId=this.countryId,this.dataBrowserElement.hierarchyId=this.hierarchyId},this.closeModal=()=>{void 0!==this.dataBrowserElement&&(this.dataBrowserElement.removeEventListener("analysisDataBrowserSelectionChange",this.onSelectedVariables),this.dataBrowserElement.removeEventListener("analysisDataBrowserClose",this.closeModal),this.dataBrowserElement.remove(),this.dataBrowserElement=void 0)},this.onSelectedVariables=e=>{const{selectedValues:t,countryId:i,hierarchyId:s,countryAlias:a,hierarchyAlias:r}=e.detail;this.countryId=i,this.hierarchyId=s;const[n,o]=t.reduce(((e,t)=>{const[i,s]=e;return i.push(t.value),s.push(t.label),[i,s]}),[[],[]]);this.doValidate=!0,this.value={country:this.countryId,hierarchy:this.hierarchyId,countryAlias:a,hierarchyAlias:r,analysisVariables:n,labels:o},this.analysisGeoenrichmentInputChange.emit(),this.closeModal()},this.validate=()=>{let e;return this.required&&!0===(0,a.i)(this.value?.analysisVariables)?(e=!1,this.error=this.strings.requiredInputMessage):(e=!0,this.error=void 0),e},this.error=void 0,this.value=void 0,this.required=!1,this.label=void 0,this.portal=void 0}valueChange(e){this.countryId=e?.country??void 0,this.hierarchyId=e?.hierarchy??void 0,!0===this.doValidate&&this.validate()}get hasError(){return void 0!==this.error}async componentWillLoad(){({strings:this.strings}=await(0,a.d)(this.hostElement,(0,s.a)(".")));(this.value?.analysisVariables?.length??0)>0&&(this.doValidate=!0),void 0!==this.value&&this.valueChange(this.value)}disconnectedCallback(){this.closeModal()}async checkValidity(){const e=this.validate();return Promise.resolve(e)}render(){const e=(this.value?.analysisVariables?.length??0)>0?this.renderSelectedVariables():null;return(0,s.h)(s.H,{key:"b483244c61252465f9860146f9c608ee6b529beb"},!1===(0,a.i)(this.label)?(0,s.h)("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit()}):null,e,this.renderAddVariable(),(0,s.h)("calcite-input-message",{key:"f3d3d3978ec62e21c531eac8bdd6aef80e91e1b2",status:"invalid",scale:a.U.Scale,hidden:!this.hasError,icon:"exclamationMarkTriangle"},this.error))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{value:["valueChange"]}}};P.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}.first-list-item{border:1px solid var(--analysis-ui-border-input);border-bottom:none;box-shadow:none;--calcite-font-size--1:var(--calcite-font-size--2)}.list-item{border-right:1px solid var(--analysis-ui-border-input);border-left:1px solid var(--analysis-ui-border-input);border-bottom:none;box-shadow:none;--calcite-font-size--1:var(--calcite-font-size--2)}";const A="analysis--rtl",F="databrowser-modal-content",O="databrowser-modal-variables",D=class{constructor(e){(0,s.r)(this,e),this.analysisDataBrowserSelectionChange=(0,s.c)(this,"analysisDataBrowserSelectionChange",7),this.analysisDataBrowserClose=(0,s.c)(this,"analysisDataBrowserClose",7),this.onBackButtonClick=async()=>{void 0!==this.dataBrowserElement&&await this.dataBrowserElement.back()},this.close=()=>{void 0!==this.containerRef&&(this.containerRef.open=!1)},this.onSelectButtonClick=()=>{const e=this.dataBrowserElement.widget._shoppingCart._content,t=[];Object.values(e).map((e=>{!1===(0,a.i)(e?.group?.value)&&!0===this.dataBrowserElement.widget.selection.includes(e.group.value)&&t.push({value:e.group.value,label:e.label})}));const i=this.dataBrowserElement.widget.countryID,s=this.dataBrowserElement.widget.hierarchyID,r=this.dataBrowserElement.widget._pages?.categories?._countrySelect?._countries?.[i],n=r?.hierarchies?.find((e=>e.ID===s)),o=r?.name,l=n?.alias,h={selectedValues:t,countryId:i,hierarchyId:s,countryAlias:o,hierarchyAlias:l};this.analysisDataBrowserSelectionChange.emit(h),this.close()},this.onClose=()=>{this.analysisDataBrowserClose.emit()},this.onOpen=()=>{void 0!==this.dataBrowserElement&&void 0!==this.dataBrowserElement.widget&&!1===(0,a.i)(this.value)&&(this.dataBrowserElement.countryId=this.countryId,this.dataBrowserElement.widget.hierarchyID=this.hierarchyId,this.dataBrowserElement.widget.selection=this.value)},this.showBackButton=!1,this.value=void 0,this.countryId=void 0,this.hierarchyId=void 0,this.portal=void 0}portalChange(e){this.geoenrichmentUrl=e?.helperServices?.geoenrichment?.url??"https://geoenrichdev.arcgis.com/arcgis/rest/services/World/GeoenrichmentServer"}async componentWillLoad(){({strings:this.strings,locale:this.locale,dir:this.dir}=await(0,a.d)(this.hostElement,(0,s.a)("."))),this.portalChange(this.portal)}componentDidLoad(){try{setTimeout((()=>requestAnimationFrame((()=>this.containerRef?.setFocus()))),1)}catch{}}render(){return this.renderModal()}renderModal(){return(0,s.h)("calcite-modal",{class:O,open:!0,escapeDisabled:!0,outsideCloseDisabled:!0,focusTrapDisabled:!0,onCalciteModalOpen:this.onOpen,onCalciteModalClose:this.onClose,ref:e=>this.containerRef=e},(0,s.h)("div",{slot:"header"},this.strings.header),(0,s.h)("div",{slot:"content",class:F},this.renderDataBrowser()),!0===this.showBackButton&&(0,s.h)("calcite-button",{slot:"back",kind:"neutral",appearance:"outline",iconStart:"chevron-left",width:"full",onClick:this.onBackButtonClick},this.strings.back),(0,s.h)("calcite-button",{slot:"secondary",width:"full",appearance:"outline",onClick:this.close},this.strings.cancel),(0,s.h)("calcite-button",{slot:"primary",width:"full",onClick:this.onSelectButtonClick},this.strings.select))}renderDataBrowser(){return(0,s.h)("arcgis-geoenrichment-databrowser",{locale:this.locale,class:{[A]:"rtl"===this.dir},allowHierarchies:!0,countryId:this.countryId??"US",geoenrichmentUrl:this.geoenrichmentUrl,displayAllGlobalVariables:!0,hideApplyButton:!0,hideBackButton:!0,hideCancelButton:!0,hidePageBackButton:!0,ref:e=>{this.dataBrowserElement=e},onPageLoaded:()=>this.showBackButton=!1===(0,a.i)(this.dataBrowserElement?.widget?.currentPageId)&&"categories"!==this.dataBrowserElement?.widget?.currentPageId})}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{portal:["portalChange"]}}};D.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}.databrowser-modal-content{height:100%}.databrowser-modal-variables{--calcite-modal-height:min(700px, calc(60vh + 100px));--calcite-modal-content-padding:0px}.esri4GEDataBrowser_Title{display:none}.esri4GEWizard_Buttons{display:flex}.esri4GEPopup .esri4GEOnDemandSelectFlowListPopup .esri4GEOnDemandSelectVeryTallList500Popup{top:20px}";const $="Deep Learning Package",B="cloudStore_amazon",j="cloudStore_azure",V="bigquery",R="snowflake",q="analysis-item-input",z={label:`${q}__label`,buttonContainer:`${q}__buttons-container`,listItem:`${q}__list-item`,loaderContainer:`${q}__loader-container`,loader:`${q}__loader`},H=class{constructor(e){(0,s.r)(this,e),this.analysisItemInputChange=(0,s.c)(this,"analysisItemInputChange",7),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.renderInitialMode=()=>{let e;if(void 0!==this.newItemMode){const t=this.getNewItemButtonProps(this.newItemMode);e=(0,s.h)("calcite-button",{appearance:"outline",scale:a.U.Scale,kind:"neutral","icon-start":t.icon,onClick:this.openAddItem},t.label)}return(0,s.h)("div",{class:z.buttonContainer},e,(0,s.h)("calcite-button",{appearance:"outline",kind:"neutral",scale:a.U.Scale,"icon-start":"select",onClick:this.openItemBrowser},this.selectButtonLabel??this.strings.selectItem))},this.clearSelectedItem=()=>{this.value=void 0},this.openItemBrowser=()=>{this.itemBrowserElement=document.createElement("analysis-item-browser"),this.itemBrowserElement.header=this.strings.selectItem,this.itemBrowserElement.filter=this.filterExpression,this.itemBrowserElement.q=this.q,this.itemBrowserElement.portal=this.portal,this.itemBrowserElement.user=this.user,this.itemBrowserElement.bucketOptions=this.bucketOptions,this.itemBrowserElement.hidePreview=this.hidePreview,this.itemBrowserElement.hideFilters=!0,this.itemBrowserElement.hideAddToMap=!0,this.itemBrowserElement.selectionMode="single",this.itemBrowserElement.cardMessageOverrides={preview:this.strings.previewDetails},this.itemBrowserElement.addEventListener("analysisItemBrowserClose",this.closeModals),this.itemBrowserElement.addEventListener("analysisItemBrowserSelection",this.onSelectedBrowserItem),document.body.appendChild(this.itemBrowserElement)},this.onSelectedBrowserItem=e=>{null!==e.detail&&(this.value={itemId:e.detail.id})},this.openAddItem=()=>{if(void 0===this.newItemMode||void 0===this.newItemConfig)return;this.newItemElement=document.createElement("arcgis-new-item"),this.newItemElement.allowPublish=!1,this.newItemElement.allowedItemTypes=this.itemTypes,this.newItemElement.allowedModes=[this.newItemMode],this.newItemElement.api=4,this.newItemElement.config=this.newItemConfig,this.newItemElement.portal=this.portal,this.newItemElement.user=this.user;const e=[[B,"dataStoreSelectCloudCredentialsAmazonS3"],[j,"dataStoreSelectCloudCredentialsAzureBlob"],[R,"dataStoreDatabaseCredentialsSnowflake"],[V,"dataStoreDatabaseCredentialsBigQuery"]];for(const[t,i]of e)if(`typekeywords:${t}`===this.itemFilter){this.newItemElement.firstStep=i;break}this.newItemElement.addEventListener("workflowCancel",this.closeModals),this.newItemElement.addEventListener("workflowComplete",this.onAddItemComplete),document.body.appendChild(this.newItemElement)},this.onAddItemComplete=e=>{void 0!==e.detail.id?this.value={itemId:e.detail.id}:this.value=void 0,void 0!==this.newItemElement&&(this.newItemElement.isActive=!1)},this.closeModals=()=>{void 0!==this.itemBrowserElement&&(this.itemBrowserElement.removeEventListener("analysisItemBrowserClose",this.closeModals),this.itemBrowserElement.removeEventListener("analysisItemBrowserClose",this.closeModals),this.itemBrowserElement.remove(),this.itemBrowserElement=void 0),void 0!==this.newItemElement&&(this.newItemElement.removeEventListener("workflowCancel",this.closeModals),this.newItemElement.removeEventListener("workflowComplete",this.onAddItemComplete),this.newItemElement.remove(),this.newItemElement=void 0)},this.getNewItemButtonProps=e=>{if("file"===e)return{icon:"upload-to",label:this.strings.addFile};if("dataStore"===e)return{icon:"plus",label:this.strings.addDataStore};throw new Error("Unsupported new item mode.")},this.validate=()=>{let e;return this.required&&(0,a.i)(this.value)?(e=!1,this.errorMessage=this.strings.requiredInputMessage):(e=!0,this.errorMessage=void 0),e},this.renderLoader=()=>{const e=!0===this.isProcessingItem;return(0,s.h)("div",{class:z.loaderContainer},(0,s.h)("calcite-loader",{class:z.loader,hidden:!e,inline:!0,label:"loader",scale:a.U.Scale,type:"indeterminate"}),e?this.processingItemMessage??this.strings.queryModelArgsMsg:null)},this.onListItemMouseOver=e=>{const t=e.target;"calcite-list-item"===t?.localName&&(void 0===this.replaceTooltip&&(this.replaceTooltip=document.createElement("calcite-tooltip"),this.replaceTooltip.placement="bottom",this.replaceTooltip.innerText=this.replaceTooltipText??this.strings.replaceItem),this.replaceTooltip.referenceElement=t,(0,r.a)(document,this.replaceTooltip))},this.onListItemMouseOut=()=>{(0,r.r)(this.replaceTooltip)},this.onListItemClick=e=>{const t=e.target;"calcite-list-item"===t?.localName&&this.openItemBrowser()},this.isProcessingItem=!1,this.errorMessage=void 0,this.selectedItem=void 0,this.deepLearningParameters={},this.value=void 0,this.required=!1,this.label=void 0,this.itemTypes=[],this.itemFilter=void 0,this.q=void 0,this.sharingLevels=void 0,this.hidePreview=!1,this.newItemMode=void 0,this.selectButtonLabel=void 0,this.processingItemMessage=void 0,this.replaceTooltipText=void 0,this.newItemConfig=void 0,this.user=void 0,this.portal=void 0,this.selectedItemIcon=void 0}async hydrateSelectedItem(e){const t=e?.itemId;if(t!==this.selectedItem?.id){if(void 0===t)this.selectedItem=void 0,this.deepLearningParameters=void 0;else{const e=(0,a.j)(t,this.portal);try{await e.load(),this.selectedItem=e,await this.loadItemProperties()}catch(e){this.value=void 0,"object"==typeof e&&null!==e&&("identity-manager:not-authorized"===e.name?this.errorMessage=this.strings.itemPermissionDenied:"request:server"===e.name&&"object"==typeof e.details&&null!==e.details&&"CONT_0001"===e.details.messageCode&&(this.errorMessage=this.strings.itemNotFound))}}this.analysisItemInputChange.emit()}}validateOnValueChange(){this.validate()}get hasError(){return void 0!==this.errorMessage}get filterExpression(){return(0,r.m)(this.itemTypes,this.itemFilter)}get bucketOptions(){let e;if(void 0!==this.sharingLevels){e=[...this.sharingLevels];const t=e.indexOf("org-admin");t>=0&&(e.splice(t,1),"org_admin"!==this.user.role||e.includes("org")||e.push("org"))}return e}async componentWillLoad(){({strings:this.strings}=await(0,a.d)(this.hostElement,(0,s.a)("."))),this.hydrateSelectedItem(this.value)}disconnectedCallback(){this.closeModals(),(0,r.r)(this.replaceTooltip),void 0!==this.itemBrowserElement&&(this.itemBrowserElement.remove(),this.itemBrowserElement=void 0)}async checkValidity(){const e=this.validate();return Promise.resolve(e)}render(){const e=(0,a.i)(this.value)?this.renderInitialMode():this.renderSelection();return(0,s.h)(s.H,{key:"d222df663d9a96c19f83a516e41167ea795e5743"},void 0!==this.label&&""!==this.label?(0,s.h)("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit()}):null,e,(0,s.h)("calcite-input-message",{key:"3202c97ad412ec8e2c314c07d24fbfe4176277b4",status:"invalid",scale:a.U.Scale,hidden:!this.hasError,icon:"exclamationMarkTriangle"},this.errorMessage))}renderSelection(){return(0,s.h)("div",null,(0,s.h)("calcite-list",{label:"",selectionMode:"none"},(0,s.h)("calcite-list-item",{key:this.selectedItem?.id,value:this.selectedItem?.id,label:this.selectedItem?.title??"",class:z.listItem,onMouseOver:this.onListItemMouseOver,onMouseOut:this.onListItemMouseOut,onClick:this.onListItemClick},void 0!==this.selectedItemIcon&&(0,s.h)("calcite-icon",{icon:this.selectedItemIcon,slot:"content-start"}),(0,s.h)("calcite-action",{text:this.strings.removeItem,slot:"actions-end",label:this.strings.removeItem,appearance:"transparent",icon:"x",onClick:this.clearSelectedItem}))),this.renderLoader())}async loadItemProperties(){if(void 0!==this.abortController&&this.abortController.abort(),this.deepLearningParameters=void 0,this.selectedItem?.type===$)try{this.abortController=new AbortController,this.isProcessingItem=!0,this.deepLearningParameters=await(0,a.p)(this.selectedItem,this.portal,{signal:this.abortController.signal}),this.isProcessingItem=!1}catch(e){!1===(0,a.w)(e)&&(this.isProcessingItem=!1,this.errorMessage=this.strings.queryModelArgsErrMsg)}}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{value:["hydrateSelectedItem","validateOnValueChange"]}}};H.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}.analysis-item-input__list-item{border:1px solid var(--analysis-ui-border-input);box-shadow:none;--calcite-font-size--1:var(--calcite-font-size--2)}.analysis-item-input__buttons-container{display:flex;flex-direction:row;flex-wrap:wrap;gap:var(--analysis-half-spacing);margin-bottom:var(--analysis-half-spacing)}.analysis-item-input__buttons-container>calcite-button{flex:1;max-width:100%}.analysis-item-input__label{cursor:pointer;padding-bottom:var(--analysis-half-spacing);margin-block-start:0;margin-block-end:0}.analysis-item-input__loader-container{font-size:var(--calcite-font-size--2)}.analysis-item-input__loader{margin-top:0.5rem}";const U=e=>{let t;return(0,s.h)(s.F,null,void 0!==e.label&&""!==e.label?(0,s.h)("analysis-label",{label:e.label,required:e.required,onAnalysisLabelHelpActionClick:()=>e.analysisHelpClick.emit(),onClick:()=>{t?.focus()},hideHelp:e.hideHelp}):null,(0,s.h)("div",{class:"controls-container"},(0,s.h)("analysis-number-input",{ref:e=>t=e,class:"control",scale:e.scale,label:"",value:e.value?.distance??e.value?.area,required:e.required,placeholderText:e.placeholderText??e.strings.inputPlaceholderText,min:e.minimum,max:e.maximum,excludeMinValue:e.excludeMinValue,excludeMaxValue:e.excludeMaxValue,choiceList:e.amountChoiceList,onAnalysisNumberInputChange:e.amountChange,numberType:"float"}),(0,s.h)("calcite-select",{scale:a.U.Scale,class:"control unit-select",dir:e.dir,label:e.strings.unitSelect,onCalciteSelectChange:e.unitChanged},e.unitChoiceList?.map((t=>(0,s.h)("calcite-option",{value:t,label:void 0!==e.choiceListLabels?e.choiceListLabels[t]:t,selected:e.value?.units===t}))))))},N=class{constructor(e){(0,s.r)(this,e),this.analysisLinearUnitInputChange=(0,s.c)(this,"analysisLinearUnitInputChange",7),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.distanceChange=e=>{const t=e?.target,i=t?.value,s=this.value?.units;void 0===t||Array.isArray(i)||"multi"===t.selectionMode||(void 0!==i?(this.value={units:s,distance:i},this.onUnitChoiceListChange()):this.value=void 0,this.analysisLinearUnitInputChange.emit())},this.unitChanged=e=>{const t=e?.target;this.value={distance:this.value?.distance,units:t?.value},this.validate(),void 0!==this.value?.distance&&this.analysisLinearUnitInputChange.emit()},this.value=void 0,this.label=void 0,this.required=!1,this.minimum=void 0,this.excludeMinValue=void 0,this.maximum=void 0,this.excludeMaxValue=void 0,this.distanceChoiceList=void 0,this.unitChoiceList=void 0,this.choiceListLabels=void 0,this.placeholderText=void 0,this.hideHelp=!1,this.isValid=!0}onUnitChoiceListChange(){const e=this.value?.units;void 0===this.unitChoiceList||void 0!==e&&this.unitChoiceList.includes(e)||(this.value={distance:this.value?.distance,units:this.unitChoiceList[0]})}async componentWillLoad(){({strings:this.strings,dir:this.dir}=await(0,a.d)(this.hostElement,(0,s.a)("."))),this.onUnitChoiceListChange()}async checkValidity(){return await this.validate(),Promise.resolve(this.isValid)}async validate(){const e=this.hostElement.shadowRoot?.querySelector("analysis-number-input"),t=await(e?.checkValidity())??!1,i=!this.required||void 0!==this.value?.units&&this.unitChoiceList?.includes(this.value?.units);return this.isValid=t&&i,Promise.resolve()}render(){return void 0!==this.value?.units&&(void 0===this.unitChoiceList||this.unitChoiceList.includes(this.value?.units)||(this.unitChoiceList=[...this.value?.units,...this.unitChoiceList])),(0,s.h)(s.H,{key:"b61aac163a0d31c9e47ba5101eebc66ad6699e86"},(0,s.h)(U,{key:"a021f6a66a547a101b36c88e8ada75f912ca1809",label:this.label,required:this.required,value:this.value,minimum:this.minimum,maximum:this.maximum,excludeMinValue:this.excludeMinValue,excludeMaxValue:this.excludeMaxValue,placeholderText:this.placeholderText,strings:this.strings,dir:this.dir,unitChoiceList:this.unitChoiceList,hideHelp:this.hideHelp??!0,amountChoiceList:this.distanceChoiceList,amountChange:this.distanceChange,unitChanged:this.unitChanged,analysisHelpClick:this.analysisHelpClick,choiceListLabels:this.choiceListLabels,scale:a.U.Scale}))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{unitChoiceList:["onUnitChoiceListChange"]}}};N.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex;flex-direction:column;--calcite-color-border-input:var(--analysis-ui-border-input)}.controls-container{display:flex;column-gap:5%}.control{flex:1 1 0}.text{cursor:pointer;padding-bottom:var(--analysis-quarter-spacing);margin-block-start:0;margin-block-end:0}.unit-select{margin-bottom:var(--analysis-half-spacing)}";const W=class{constructor(e){(0,s.r)(this,e),this.analysisStringInputChange=(0,s.c)(this,"analysisStringInputChange",7),this.analysisStringInputComboboxBeforeOpen=(0,s.c)(this,"analysisStringInputComboboxBeforeOpen",7),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.segmentedItems=[],this.layoutUpdating=!1,this.setErrorMessage=e=>{this.isValid=void 0===e,this.errorMessage=e},this.validateSingleInput=e=>{let t;if(!0===this.required&&""===e&&(t=(0,a.a)(this.strings.requiredError,{label:this.label})),e.length<(this.minLength??-1)&&""!==e&&(t=(0,a.a)(this.strings.minLengthError,{label:this.label,minLength:(0,a.k)(this.minLength??-1)})),e.length>=(this.maxLength??Number.MAX_SAFE_INTEGER)&&(t=(0,a.a)(this.strings.maxLengthError,{label:this.label,maxLength:(0,a.k)(this.maxLength??Number.MAX_SAFE_INTEGER)})),void 0!==this.invalidCharactersRegex){const i=(0,a.l)(this.invalidCharactersRegex);void 0!==i&&!0===i.test(e)&&(t=(0,a.a)(this.strings.invalidCharacterError,{label:this.label}))}return this.setErrorMessage(t),void 0===t},this.validateInput=()=>{let e;if(this.required||void 0!==this.maxLength||void 0!==this.invalidCharactersRegex||void 0!==this.minLength)if("multi"!==this.selectionMode){const e=this.value??"";this.validateSingleInput(e)}else{const t=this.value??[];if(0===t.length)e=(0,a.a)(this.strings.requiredError,{label:this.label}),this.setErrorMessage(e);else{let i=!0;for(let e=0;e<t.length;e+=1){this.validateSingleInput(t[e]??"")||(i=!1)}this.isValid=i,!1===i&&(e=(0,a.a)(this.strings.choiceListBadInput,{label:this.label}),this.setErrorMessage(e))}}},this.adjustLayout=()=>{const e=this.segmentedControl?.firstChild?.clientWidth;this.layout=void 0!==e&&e*this.segmentedControl.childElementCount<this.hostElement.clientWidth?"horizontal":"vertical"},this.renderInput=()=>{const e=this.doCalciteInputChangeOnCommit?{onCalciteInputChange:this.inputChanged}:{onCalciteInputInput:this.inputChanged};return(0,s.h)("calcite-input",{scale:a.U.Scale,type:this.showAsTextArea?"textarea":"text",readOnly:this.readOnly,value:this.value,status:this.isValid?a.b.VALID:a.b.INVALID,placeholder:this.placeholderText??this.strings.inputPlaceholderText,...e})},this.renderCombobox=()=>{const e="multi"===this.selectionMode&&void 0===this.choiceList||!0===this.allowCustomValues,t=void 0!==this.errorMessage?a.b.INVALID:(0,a.g)(this.validationParams?.type),i=[];if(Array.isArray(this.choiceList)&&i.push(...this.choiceList),e&&void 0!==this.initialValues){const e=new Set(i),t="multi"===this.selectionMode?this.initialValues:[this.initialValues];for(const s of t)e.has(s)||i.push(s)}const r="multi"===this.selectionMode?this.strings.multiSelectComboboxPlaceholderText:this.strings.comboboxPlaceholderText;return(0,s.h)("calcite-combobox",{scale:a.U.Scale,status:t,label:this.strings.choiceList,disabled:this.readOnly,maxItems:this.maxItems,selectionMode:"multi"!==this.selectionMode?this.required?"single-persist":"single":"multiple",placeholder:this.placeholderText??r,placeholderIcon:this.placeholderIcon,allowCustomValues:e,onCalciteComboboxBeforeOpen:this.analysisStringInputComboboxBeforeOpen.emit,onCalciteComboboxChange:this.comboboxChanged,clearDisabled:!1===this.clearEnabled&&"multi"!==this.selectionMode},i.map((e=>this.buildComboBoxItem(e))))},this.buildComboBoxItem=e=>{let t,i=!1;return i="multi"!==this.selectionMode?this.value===e:void 0!==this.value&&this.value.includes(e),t=void 0===this.choiceListLabels?e:this.allowCustomValues?this.choiceListLabels[e]??e:this.choiceListLabels[e],(0,s.h)("calcite-combobox-item",{key:e,value:e,textLabel:t,icon:void 0!==this.choiceListIcons?this.choiceListIcons[e]:void 0,selected:i,scale:a.U.Scale})},this.renderRadioGroup=()=>{const e=this.choiceList;return(0,s.h)("calcite-segmented-control",{class:"segmented-control",scale:a.U.Scale,onCalciteSegmentedControlChange:this.segmentedControlChange,ref:e=>this.segmentedControl=e,layout:this.layout},e?.map((e=>this.buildRadioGroupItem(e))))},this.buildRadioGroupItem=e=>{const t=void 0!==this.choiceListLabels?this.choiceListLabels[e]:e;return(0,s.h)("calcite-segmented-control-item",{value:e,checked:e===this.value,ref:e=>{null!=e&&(e.focus=Function.prototype,this.segmentedItems.push(e))}},t)},this.renderRadioButtonGroup=()=>{const e=this.choiceList;return(0,s.h)("calcite-radio-button-group",{name:this.label,scale:a.U.Scale,layout:"vertical",onCalciteRadioButtonGroupChange:this.radioButtonGroupChange},e?.map((e=>this.buildRadioButton(e))))},this.buildRadioButton=e=>{const t=void 0!==this.choiceListLabels?this.choiceListLabels[e]:e;return(0,s.h)("calcite-label",{layout:"inline",scale:a.U.Scale},(0,s.h)("calcite-radio-button",{value:e,checked:e===this.value}),t)},this.renderCheckList=()=>(0,s.h)(s.F,null,this.showSelectAllForCheckList?this.renderCheckBox(!0,this.strings.selectAll):null,this.choiceList?.filter((e=>void 0!==e))?.map((e=>this.renderCheckBox(!1,e)))),this.toggleCheckListSelectAll=e=>{const t=e.target.checked?[...this.choiceList??[]]:[];this.checkListChange(t)},this.toggleCheckBoxSingleSelection=(e,t)=>{let i=e;i=e.includes(t)?i.filter((e=>e!==t)):[...i,t],this.checkListChange(i)},this.renderCheckBox=(e,t)=>{const i=e?this.strings.selectAll:this.choiceListLabels?.[t]??t,r=Array.isArray(this.value)?[...this.value]:[],n=e?r.length===this.choiceList?.length:r.includes(t),o=e&&!n&&r.length>0;return(0,s.h)("calcite-label",{layout:"inline",scale:a.U.Scale},(0,s.h)("calcite-checkbox",{scale:a.U.Scale,value:i,checked:n,indeterminate:o,onCalciteCheckboxChange:i=>{e?this.toggleCheckListSelectAll(i):this.toggleCheckBoxSingleSelection(r,t)}}),i)},this.inputChanged=e=>{null!==e.target&&(this.value=e.target.value,this.validateInput(),this.analysisStringInputChange.emit())},this.comboboxChanged=e=>{const t=e.target;if(null!==t){if("multi"===this.selectionMode)this.value=t.selectedItems.filter((e=>void 0!==e?.value)).map((e=>e.value));else{const[e]=t.selectedItems;this.value=e?.value}this.validateInput(),this.analysisStringInputChange.emit()}},this.segmentedControlChange=e=>{const t=e.target;null!==t&&(this.value=t.value??"",this.validateInput(),this.analysisStringInputChange.emit())},this.radioButtonGroupChange=e=>{null!==e?.target&&(this.value=e.target.selectedItem.value,this.validateInput(),this.analysisStringInputChange.emit())},this.checkListChange=e=>{this.value=e,this.validateInput(),this.analysisStringInputChange.emit()},this.value=void 0,this.label=void 0,this.validationParams=void 0,this.required=void 0,this.doCalciteInputChangeOnCommit=!1,this.maxLength=void 0,this.minLength=void 0,this.invalidCharactersRegex=void 0,this.selectionMode=void 0,this.readOnly=!1,this.clearEnabled=!1,this.choiceList=void 0,this.choiceListIcons=void 0,this.choiceListLabels=void 0,this.placeholderText=void 0,this.placeholderIcon=void 0,this.showAsRadioGroup=!1,this.showAsRadioButtonGroup=!1,this.showAsCheckList=!1,this.showSelectAllForCheckList=!1,this.showAsTextArea=!1,this.useDefaultOnReset=!1,this.allowCustomValues=!1,this.maxItems=10,this.hideHelp=!1,this.isValid=!0,this.errorMessage=void 0,this.layout=void 0}updatedSelectionMode(){this.initialValues=this.value}updatedChoiceList(e,t){if(!(0,n.i)(t,e)){let t=this.value;const i=(Array.isArray(t)?t:void 0!==t?[t]:[]).filter((t=>this.allowCustomValues||e?.includes(t)));t="multi"===this.selectionMode?i:i[0],this.useDefaultOnReset&&0===i.length&&(t=void 0!==e?"multi"===this.selectionMode?[e[0]]:e[0]:void 0),(0,n.i)(t,this.value)||(this.value=t,this.analysisStringInputChange.emit())}}async componentWillLoad(){({strings:this.strings}=await(0,a.d)(this.hostElement,(0,s.a)("."))),this.updatedChoiceList(this.choiceList,void 0),this.initialValues=this.value}async checkValidity(){return this.validateInput(),Promise.resolve(this.isValid)}componentDidLoad(){void 0!==this.segmentedControl&&(this.resizeObserver=new ResizeObserver((()=>{0!==this.hostElement.clientWidth?this.layoutUpdating?this.layoutUpdating=!1:(this.layoutUpdating=!0,this.adjustLayout()):this.layout="horizontal"})),this.resizeObserver.observe(this.hostElement)),setTimeout((()=>{this.segmentedItems.forEach((e=>delete e?.focus)),this.segmentedItems=[]}),250)}disconnectedCallback(){this.resizeObserver?.disconnect()}render(){let e;e=void 0===this.choiceList||0===this.choiceList.length?"multi"!==this.selectionMode?this.renderInput():this.renderCombobox():!0===this.showAsCheckList?this.renderCheckList():"multi"!==this.selectionMode&&!0===this.showAsRadioGroup?this.renderRadioGroup():"multi"!=this.selectionMode&&!0===this.showAsRadioButtonGroup?this.renderRadioButtonGroup():this.renderCombobox();const t=!1===this.isValid,i=(0,a.f)((0,a.m)(this.strings,this.validationParams)),r=!1===(0,a.i)(i)||!0===t,n=void 0!==this.errorMessage?a.b.INVALID:(0,a.g)(this.validationParams?.type);return(0,s.h)(s.H,{key:"b10f62a24127c7b8f30a1d28ea7f4aacfa753413"},(0,s.h)("calcite-label",{key:"d1b89cd56eb2d4a1ad946f8b0cb249e84859d4c8",class:"label",scale:a.U.Scale},""!==this.label?(0,s.h)("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit(),hideHelp:this.hideHelp}):null,e,(0,s.h)("calcite-input-message",{key:"380c3d9f2795987475a56958d91ec2fd01493e03",status:n,hidden:!r,scale:a.U.Scale,icon:"exclamationMarkTriangle"},this.errorMessage??i)))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{selectionMode:["updatedSelectionMode"],choiceList:["updatedChoiceList"]}}};W.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex;width:var(--analysis-component-default-width);--calcite-color-border-input:var(--analysis-ui-border-input)}.label{width:var(--analysis-component-default-width)}.segmented-control:not([layout]){visibility:hidden;position:absolute}";const G="now",Q="custom",J="unspecified",K="UTC",Y="GeoLocal",Z=class{constructor(e){(0,s.r)(this,e),this.analysisTrafficTimeInputChange=(0,s.c)(this,"analysisTrafficTimeInputChange",7),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.validateSelection=async()=>{let e=!0;this.selectedTimeMode===Q&&!0===this.required?(void 0!==this.dateInputElement&&(e=await this.dateInputElement.checkValidity()),this.isValid=e&&void 0!==this.value):this.isValid=e},this.setSelectedTimeMode=e=>{switch(e?.timeZoneForTimeOfDay){case void 0:const t={timeOfDay:void 0,timeZoneForTimeOfDay:void 0};this.value={...t},this.selectedTimeMode=J;break;case Y:const i=e.timeOfDay;if(void 0!==i&&"number"==typeof i){const e={timeOfDay:i,timeZoneForTimeOfDay:Y};this.value={...e}}this.selectedTimeMode=Q;break;default:const s=e??{timeOfDay:a.N,timeZoneForTimeOfData:K};s.timeOfDay=a.N,this.value={...s},this.selectedTimeMode=G}this.analysisTrafficTimeInputChange.emit()},this.renderDatePicker=()=>this.selectedTimeMode===Q?(0,s.h)("analysis-date-input",{label:"",required:this.required,onAnalysisDateInputChange:this.datePickerChange,ref:e=>{this.dateInputElement=e},value:this.value?.timeOfDay}):null,this.timeSelectChange=()=>{switch(this.selectedTimeMode=this.timeSelectElement.value,this.selectedTimeMode){case G:this.value={timeOfDay:a.N,timeZoneForTimeOfDay:K};break;case J:this.value={timeOfDay:void 0,timeZoneForTimeOfDay:void 0};break;case Q:const e=this.value?.timeOfDay;this.value={timeOfDay:e,timeZoneForTimeOfDay:Y}}this.analysisTrafficTimeInputChange.emit()},this.datePickerChange=()=>{if(this.selectedTimeMode===Q){const e=this.dateInputElement?.value;this.value={timeOfDay:e,timeZoneForTimeOfDay:Y},this.analysisTrafficTimeInputChange.emit()}},this.value={timeOfDay:a.N,timeZoneForTimeOfDay:K},this.label=void 0,this.required=void 0,this.isValid=!0,this.selectedTimeMode=void 0,this.resetTimeZoneValue=!1}resetTimeZoneValueChange(e){!0===e&&(this.value={timeOfDay:void 0,timeZoneForTimeOfDay:void 0},this.setSelectedTimeMode(this.value))}async componentWillLoad(){({strings:this.strings}=await(0,a.d)(this.hostElement,(0,s.a)("."))),this.setSelectedTimeMode(this.value)}async checkValidity(){return await this.validateSelection(),Promise.resolve(this.isValid)}render(){return(0,s.h)(s.H,{key:"e0c3b09f74a29739f7422351ee7d523656ba9aeb"},(0,s.h)("calcite-label",{key:"e147d04ff2bb54cdf80fe9e61ac4c6cfe514334b",class:"label",scale:a.U.Scale},void 0!==this.label&&""!==this.label?(0,s.h)("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit()}):null,(0,s.h)("calcite-select",{key:"e23ae7eb06b330e220e761a54906527946bdf4c0",value:this.selectedTimeMode,scale:a.U.Scale,label:this.label??this.strings.arriveTime,onCalciteSelectChange:this.timeSelectChange,ref:e=>this.timeSelectElement=e},(0,s.h)("calcite-option",{key:"2a3bbf8f04a11b5ac855a1eb1d63dd3b192bb4a7",selected:"UTC"===this.value?.timeZoneForTimeOfDay,value:G},this.strings.modes.now),(0,s.h)("calcite-option",{key:"f0da1f269991e682e4310765b31c0e062727412c",selected:"GeoLocal"===this.value?.timeZoneForTimeOfDay,value:Q},this.strings.modes.custom),(0,s.h)("calcite-option",{key:"970e5902e8d6d40bf114ebe77c75202eab2d4b7c",selected:void 0===this.value?.timeZoneForTimeOfDay,value:J},this.strings.modes.unspecified))),this.renderDatePicker())}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{resetTimeZoneValue:["resetTimeZoneValueChange"]}}};Z.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex;flex-direction:column;width:var(--analysis-component-default-width);--calcite-color-border-input:var(--analysis-ui-border-input)}.label{width:var(--analysis-component-default-width)}";const X=e=>!("isConnected"in e)||e.isConnected,ee=((e,t)=>{let i;return(...s)=>{i&&clearTimeout(i),i=setTimeout((()=>{i=0,e(...s)}),t)}})((e=>{for(let t of e.keys())e.set(t,e.get(t).filter(X))}),2e3),te=e=>"function"==typeof e?e():e,ie=(e,t)=>{const i=e.indexOf(t);i>=0&&(e[i]=e[e.length-1],e.length--)},se=((e,t)=>{const i=((e,t=(e,t)=>e!==t)=>{const i=te(e);let s=new Map(Object.entries(null!=i?i:{}));const a={dispose:[],get:[],set:[],reset:[]},r=()=>{var t;s=new Map(Object.entries(null!==(t=te(e))&&void 0!==t?t:{})),a.reset.forEach((e=>e()))},n=e=>(a.get.forEach((t=>t(e))),s.get(e)),o=(e,i)=>{const r=s.get(e);t(i,r,e)&&(s.set(e,i),a.set.forEach((t=>t(e,i,r))))},l="undefined"==typeof Proxy?{}:new Proxy(i,{get:(e,t)=>n(t),ownKeys:e=>Array.from(s.keys()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),has:(e,t)=>s.has(t),set:(e,t,i)=>(o(t,i),!0)}),h=(e,t)=>(a[e].push(t),()=>{ie(a[e],t)});return{state:l,get:n,set:o,on:h,onChange:(t,i)=>{const s=h("set",((e,s)=>{e===t&&i(s)})),a=h("reset",(()=>i(te(e)[t])));return()=>{s(),a()}},use:(...e)=>{const t=e.reduce(((e,t)=>(t.set&&e.push(h("set",t.set)),t.get&&e.push(h("get",t.get)),t.reset&&e.push(h("reset",t.reset)),t.dispose&&e.push(h("dispose",t.dispose)),e)),[]);return()=>t.forEach((e=>e()))},dispose:()=>{a.dispose.forEach((e=>e())),r()},reset:r,forceUpdate:e=>{const t=s.get(e);a.set.forEach((i=>i(e,t,t)))}}})(e,t);return i.use((()=>{if("function"!=typeof s.d)return{};const e=new Map;return{dispose:()=>e.clear(),get:t=>{const i=(0,s.d)();i&&((e,t,i)=>{const s=e.get(t);s?s.includes(i)||s.push(i):e.set(t,[i])})(e,t,i)},set:t=>{const i=e.get(t);i&&e.set(t,i.filter(s.f)),ee(e)},reset:()=>{e.forEach((e=>e.forEach(s.f))),ee(e)}}})()),i})({activeSketchToolName:""}),ae="flex-container",re="primary-button",ne="border",oe="warning-message",le="loading-message-wrapper",he="loading-sketch-message",ce="loader",de="list-item",ue=class{constructor(e){(0,s.r)(this,e),this.analysisLayerInputChange=(0,s.c)(this,"analysisLayerInputChange",7),this.analysisLayerInputClose=(0,s.c)(this,"analysisLayerInputClose",7),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.refreshHandlers=[],this.replaceId=null,this.filteredMapLayers=[],this.filteredModelVariableLayers=[],this.showNoticeMessage=!1,this.noticeMessage=[],this.warningMessageForPopover=[],this.filterFeatureLayers=e=>e.filter((e=>void 0!==e&&(0,a.n)(e)&&e.loaded)),this.updateWarningMessage=(e,t)=>{const i=t.length-e.length;if(this.warningMessage=void 0,i>0){const s=new Map(this.mapLayers.map((e=>[e.id,e]))),r=t.find((t=>!e.includes(t)))??"",n=s.get(r)?.title??"",o=1===i?this.strings.layerNotAvailable:this.strings.multipleLayersNotAvailable;this.warningMessage=(0,a.a)(o,{layerName:n})}},this.syncValueWithIds=async()=>{const e=[...this.browsedLayers??[],...this.mapLayers??[],...this.modelVariableLayers??[]],t=[],i=[],s="multi"!==this.selectionMode;for(const s of this.selectedLayerIds??[]){const r=e.find((e=>s===e.id)),n=this.modelVariableLayers?.some((e=>s===e.id));if(void 0!==r){let e;i.push(r),(0,a.n)(r)?e=await(0,a.o)(r,this.mapView):(0,a.q)(r)||(0,a.t)(r)?e=(0,a.u)(r):(0,a.v)(r)&&(e=(0,a.x)(r)),void 0!==e&&(!0===n&&(e={variable:s}),t.push(e))}}if(this.value=s?t[0]:t,this.selectedLayers=s?i[0]:i,this.processedLayerProperties={},s||Array.isArray(this.selectedLayers)&&1===this.selectedLayers.length){const e=i[0];if(void 0!==e&&((0,a.q)(e)||(0,a.t)(e)))this.processedLayerProperties=await(0,a.y)(e);else if(void 0!==e&&(0,a.n)(e)){const t=(0,a.I)(e).fields,i=t?.map((e=>e.name));this.processedLayerProperties.fieldNames=i}}this.analysisLayerInputChange.emit({creationMode:this.creationMode})},this.renderInitialMode=()=>(this.removeTooltip(),(0,s.h)("section",null,void 0!==this.label&&""!==this.label?(0,s.h)("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit(),hideHelp:this.hideHelp}):null,this.renderButton())),this.renderErrorMessage=()=>{const e=!1===(0,a.i)(this.validationParams?.message)||void 0!==this.errorMessage,t=(0,a.f)((0,a.m)(this.strings,this.validationParams)),i=void 0!==this.validationParams?(0,a.g)(this.validationParams.type):a.b.INVALID;return(0,s.h)("calcite-input-message",{status:i,hidden:!e,scale:a.U.Scale,icon:"exclamationMarkTriangle"},t??this.errorMessage)},this.renderWarningMessage=()=>void 0!==this.warningMessage?(0,s.h)("calcite-input-message",{icon:"exclamationMarkTriangle",scale:a.U.Scale},(0,s.h)("div",{class:oe},this.warningMessage)):null,this.renderSketchLoadingMessage=()=>!0===this.canCreateAnalysisSketch&&!0===this.isSketchLoading&&(0,s.h)("div",{class:le},(0,s.h)("calcite-loader",{class:ce,scale:a.U.Scale,label:this.strings.loadingSketch}),(0,s.h)("p",{class:he},this.strings.loadingSketch)),this.handleAnalysisSketchToolsRendered=()=>{this.isSketchLoading=!1,this.setupOutsideSketchClickListener()},this.handleAnalysisSketchLayerChange=e=>{const t=e.detail;!1===(0,a.i)(t)&&(this.currentSketchLayerId=t.detail[0],this.layerSelectionChange(t))},this.handleAnalysisSketchRemove=async()=>{await this.removeAnalysisSketch()},this.renderCreateSketchButton=()=>(0,s.h)(s.F,null,(0,s.h)("calcite-button",{ref:e=>{void 0!==e&&(this.createSketchButton=e)},scale:a.U.Scale,appearance:"outline",kind:"neutral",iconStart:"pencil-mark",onClick:this.onCreateSketchButtonClicked,label:this.strings.createSketch}),(0,s.h)("calcite-tooltip",{dir:this.dir,overlayPositioning:"fixed",referenceElement:this.createSketchButton,placement:"top"},this.strings.drawInputFeatures)),this.removeAnalysisSketch=async()=>{void 0!==this.analysisSketch&&(document.removeEventListener("click",this.handleClickedOutsideSketch),await(this.analysisSketch?.removeSketch()),this.analysisSketch?.remove(),this.analysisSketch=void 0,this.canCreateAnalysisSketch=!1,this.isSketchLoading=!0)},this.setupOutsideSketchClickListener=()=>{document.addEventListener("click",this.handleClickedOutsideSketch),se.onChange("activeSketchToolName",(async e=>{this.analysisSketchToolName!==e&&await this.removeAnalysisSketch()}))},this.handleClickedOutsideSketch=async e=>{e.target.tagName.includes("ANALYSIS-")&&await this.removeAnalysisSketch()},this.onCreateSketchButtonClicked=e=>{e.stopPropagation(),this.analysisSketchToolName=`${this.toolTitle?.trim()??""} ${this.label}`,se.state.activeSketchToolName=this.analysisSketchToolName,this.canCreateAnalysisSketch=!0},this.renderButton=()=>(0,s.h)("div",{class:ae},(0,s.h)("calcite-button",{class:re,appearance:"outline",kind:"neutral",scale:a.U.Scale,iconStart:"add-layer",onClick:this.primaryButtonClicked},this.strings.layer),!0===this.enableSketch&&!(0,r.v)(this.mapView)&&this.renderCreateSketchButton()),this.renderListMode=()=>{const e=Array.isArray(this.selectedLayers)?this.selectedLayers:[this.selectedLayers];return(0,s.h)("section",null,(0,s.h)("calcite-label",null,void 0!==this.label&&""!==this.label?(0,s.h)("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit()}):null,(0,s.h)("calcite-list",{class:ne,label:"",selectionMode:"none",onClick:this.replaceLayer,onMouseOver:this.mouseOver,onMouseOut:this.mouseOut},e.map((e=>this.renderListModeItem(e))))),"multi"===this.selectionMode?this.renderButton():null)},this.renderListModeItem=e=>{let t="";if((0,a.n)(e)&&!(0,r.c)(e.id)&&"featureCount"===this.descriptionDisplay)t=(0,a.a)(this.strings.numberFeatures,{featureCount:this.featureCounts.get(e.id)??this.strings.numberFeaturesLoading});else if("spatialReference"===this.descriptionDisplay){const i=(0,a.I)(e).fullExtent.spatialReference.latestWkid;t=this.wkidMap.get(i)??""}const i=(0,a.a)(this.strings.layerAction,{layerName:e.title});return(0,s.h)("calcite-list-item",{class:de,key:e.id,value:e.id,label:(0,a.B)(e),description:t},void 0!==this.selectedLayerIcon&&(0,s.h)("calcite-icon",{icon:this.selectedLayerIcon,slot:"content-start"}),(0,s.h)("calcite-action",{"data-layerId":e.id,text:i,slot:"actions-end",label:i,appearance:"transparent",icon:"x",onClick:this.actionClicked}))},this.layerSelectionChange=async e=>{this.creationMode="list","multi"!==this.selectionMode&&((0,r.r)(this.layerInputPopover),this.layerInputPopover=void 0);const t=e.detail;if(null===this.replaceId){const e=(this.selectedLayerIds??[]).filter((e=>this.browsedLayers.some((t=>t.id===e))));this.selectedLayerIds=[...t,...e]}else this.browsedLayers=this.browsedLayers.map((e=>this.replaceId===e.id?void 0:e)).filter((e=>void 0!==e)),this.selectedLayerIds=this.selectedLayerIds?.map((e=>e===this.replaceId?t?.[0]:e)),this.replaceId=null;const i=this.selectedLayerIds?.find((e=>e===this.currentSketchLayerId));void 0===i&&await this.removeAnalysisSketch(),await this.syncValueWithIds(),await this.validate()},this.handleLayerBrowsed=async e=>{this.creationMode="browse","multi"!==this.selectionMode?(this.browsedLayers=e.detail,this.selectedLayers=this.browsedLayers[0]):null===this.replaceId?(this.browsedLayers=[...this.browsedLayers,...e.detail],this.selectedLayers=[...this.selectedLayers??[],...this.browsedLayers]):(this.browsedLayers=this.browsedLayers.map((t=>this.replaceId===t.id?e.detail[0]:t)),this.selectedLayers=this.selectedLayers?.map((t=>this.replaceId===t.id?e.detail[0]:t)),this.replaceId=null),await this.validate()},this.primaryButtonClicked=e=>{this.createLayerPopover(e.currentTarget)},this.replaceLayer=e=>{const t=e.target;"calcite-list-item"===t?.localName&&(this.replaceId=t.value,this.createLayerPopover(t),void 0!==this.layerInputPopover&&null!==this.replaceId&&(this.layerInputPopover.selectedLayerIds=[this.replaceId]))},this.actionClicked=async e=>{const t=e.target?.getAttribute("data-layerId");this.selectedLayerIds=this.selectedLayerIds?.filter((e=>e!==t)),this.browsedLayers=this.browsedLayers.filter((e=>e.id!==t)),this.analysisLayerInputClose.emit(),await this.removeAnalysisSketch(),await this.syncValueWithIds(),await this.validate()},this.mouseOver=e=>{const t=e.target;"calcite-list-item"===t?.localName&&(void 0===this.replaceTooltip&&(this.replaceTooltip=document.createElement("calcite-tooltip"),this.replaceTooltip.placement="bottom",this.replaceTooltip.innerText=this.strings.replaceLayer),this.replaceTooltip.referenceElement=t,(0,r.a)(document,this.replaceTooltip))},this.mouseOut=()=>{this.removeTooltip()},this.layerPopoverClose=async()=>{this.replaceId=null,(0,r.r)(this.layerInputPopover),this.layerInputPopover=void 0,await this.validate()},this.validate=async()=>{this.warningMessage=void 0,this.errorMessage=void 0;const e=(0,a.f)((0,a.m)(this.strings,this.validationParams));if(!1===(!this.required||void 0!==this.selectedLayers&&(!Array.isArray(this.selectedLayers)||this.selectedLayers.length>0)))return void(this.errorMessage=void 0!==this.validationParams?.message?e:(0,a.a)(this.strings.isRequired,{label:this.label??this.strings.layer}));const t=(0,a.J)(this.value),i=Array.isArray(this.selectedLayers)?this.selectedLayers:[this.selectedLayers];if(t&&i.some((e=>(0,r.c)(e.id)))){const{filteredLayers:t}=await(0,a.C)({layers:i,layerFilterTypes:this.layerFilterType,user:this.user}),{filteredLayers:s}=(0,r.f)({layers:i,layerFilterTypes:this.layerFilterType}),n=t.length>0;if(s.length>0)return void(this.errorMessage=void 0!==this.validationParams?.message?e:this.strings.dataTypeMismatch);if(n)return void(this.errorMessage=void 0!==this.validationParams?.message?e:this.strings.geometryMismatch)}void 0!==this.selectedLayerFeatureCount&&(void 0!==this.minimumFeatureCount&&this.selectedLayerFeatureCount<this.minimumFeatureCount&&(this.errorMessage=void 0!==this.validationParams?.message?e:(0,a.a)(this.strings.featureCountBelowMinimum,{label:this.label,minimum:this.minimumFeatureCount.toString()})),void 0!==this.maximumFeatureCount&&this.selectedLayerFeatureCount>this.maximumFeatureCount&&(this.errorMessage=void 0!==this.validationParams?.message?e:(0,a.a)(this.strings.featureCountAboveMaximum,{label:this.label,maximum:this.maximumFeatureCount.toString()})))},this.removeTooltip=()=>{(0,r.r)(this.replaceTooltip)},this.updateFeatureCounts=e=>{const{mapView:t,ignoreTimeExtent:i}=this,s=this.filterFeatureLayers(e).map((async e=>{let s;try{s=(await(0,a.D)(e,t,i)).toString()}catch{}return[e.id,s]}));return Promise.all(s).then((e=>{const t=e.filter((([,e])=>void 0!==e)),i=[...this.featureCounts].filter((([e])=>this.selectedLayerIds?.includes(e)));this.featureCounts=new Map([...i,...t])})).catch((()=>{}))},this.hideAddToMap=!1,this.value=void 0,this.label=void 0,this.required=!1,this.validationParams=void 0,this.user=void 0,this.portalHelpMap=void 0,this.enableSketch=!1,this.ignoreTimeExtent=!1,this.mapLayers=[],this.modelVariableLayers=void 0,this.mapView=void 0,this.selectionMode=void 0,this.selectedLayers=void 0,this.selectedLayerIds=void 0,this.toolTitle=void 0,this.selectedLayerFeatureCount=void 0,this.minimumFeatureCount=void 0,this.maximumFeatureCount=void 0,this.processedLayerProperties={},this.layerFilterType=void 0,this.descriptionDisplay="featureCount",this.hideBrowseButton=!1,this.selectedLayerIcon=void 0,this.hideHelp=!1,this.popoverWidth=void 0,this.externalBrowsedLayers=void 0,this.creationMode="browse",this.canCreateAnalysisSketch=!1,this.isSketchLoading=!0,this.featureCounts=new Map,this.browsedLayers=[],this.errorMessage=void 0}async mapLayersChange(e,t){const i=void 0!==this.selectedLayerIds?.find((e=>e===this.currentSketchLayerId)),s=void 0===e.find((e=>e?.id===this.currentSketchLayerId));e.length!==t?.length&&!0===i&&!0===s&&(this.selectedLayerIds=this.selectedLayerIds?.filter((e=>e!==this.currentSketchLayerId)),await this.syncValueWithIds());const{proxyAllowedLayers:r,filteredLayersByType:n,filteredLayersAllowAnalysis:o}=await(0,a.E)(e,this.layerFilterType,this.user?.portal);if(o.length<e.length){this.noticeMessage=[];const t=r.length<e.length,i=o.length<n.length;t&&this.warningMessageForPopover.push("proxyReason"),i&&this.warningMessageForPopover.push("allowAnalysisReason")}this.showNoticeMessage=this.warningMessageForPopover.length>0,this.filteredMapLayers=o.filter((e=>e.loaded)),void 0!==this.layerInputPopover&&(this.layerInputPopover.mapLayers=this.filteredMapLayers)}async modelVariableLayersChange(e){if(void 0===e)return void(this.filteredModelVariableLayers=[]);const t=Object.groupBy(e,(({id:e})=>(0,r.c)(e)?"derived":"nonDerived")),{validLayers:i}=(0,r.f)({layers:t.derived??[],layerFilterTypes:this.layerFilterType}),{validLayers:s}=await(0,a.C)({layers:t.nonDerived??[],layerFilterTypes:this.layerFilterType,user:this.user});this.filteredModelVariableLayers=[...s,...i],void 0!==this.layerInputPopover&&(this.layerInputPopover.modelVariableLayers=this.filteredModelVariableLayers)}async selectedLayersChange(e,t){if((0,a.F)(e)&&!(0,n.i)(e,t)){let t=Array.isArray(e)?e:[e];"featureCount"===this.descriptionDisplay&&this.updateFeatureCounts(t),this.refreshHandlers.forEach((e=>e.remove())),this.refreshHandlers=this.filterFeatureLayers(t).map((e=>(0,a.I)(e).on("refresh",(t=>{t.dataChanged&&this.updateFeatureCounts([e])}))));const i=t.map((e=>e.id)),s=await Promise.allSettled(t.map((e=>e.loaded?Promise.resolve(e):e.load())));t=s.filter((e=>"fulfilled"===e.status)).map((e=>e.value));const r=t.filter((e=>e.loaded)).map((e=>e.id));this.updateWarningMessage(r,i),this.selectedLayerIds=Array.from(new Set(r));const n=this.featureCounts.get(this.selectedLayerIds?.[0]??"");void 0!==n&&"multi"!==this.selectionMode&&(this.selectedLayerFeatureCount=parseInt(n)),await this.syncValueWithIds(),void 0===this.warningMessage&&this.validate()}}async layerFilterTypeChange(e,t){(0,n.i)(e,t)||await this.mapLayersChange(this.mapLayers)}externalBrowsedLayersChange(e){this.browsedLayers=[...e??[],...this.browsedLayers]}onFeatureCountChange(){if(void 0!==this.selectedLayerIds&&this.selectedLayerIds.length>0&&"multi"!==this.selectionMode){const e=this.featureCounts.get(this.selectedLayerIds[0]);void 0!==e&&this.selectedLayerFeatureCount!==parseInt(e)&&(this.selectedLayerFeatureCount=parseInt(e),this.analysisLayerInputChange.emit({creationMode:this.creationMode}))}}async checkValidity(){await this.validate();const e=void 0===this.errorMessage&&(void 0===this.validationParams?.message||"informative"===this.validationParams.type);return Promise.resolve(e)}disconnectedCallback(){(0,r.r)(this.layerInputPopover),(0,r.r)(this.replaceTooltip),document.removeEventListener("click",this.handleClickedOutsideSketch),this.refreshHandlers.forEach((e=>e.remove()))}async componentWillLoad(){({strings:this.strings,dir:this.dir}=await(0,a.d)(this.hostElement,(0,s.a)("."))),this.wkidMap=(0,a.G)(),this.browsedLayers=[...this.externalBrowsedLayers??[],...this.browsedLayers],void 0!==this.mapLayers&&this.mapLayersChange(this.mapLayers),void 0!==this.modelVariableLayers&&this.modelVariableLayersChange(this.modelVariableLayers),await this.selectedLayersChange(this.selectedLayers,void 0)}get isInitialMode(){return void 0===this.selectedLayerIds||0===this.selectedLayerIds.length||void 0===this.selectedLayers}render(){return(0,s.h)(s.H,{key:"c7c49f04d2635f7894263c316b02edcdea2351c1"},(0,s.h)(s.F,{key:"48805255a17bccf4d9d359119d054d1f31b8f292"},!0===this.canCreateAnalysisSketch&&(0,s.h)("analysis-sketch",{key:"102539ff1285f361b13a0162be8b48659cbe18e7",ref:e=>{void 0!==e&&(this.analysisSketch=e)},referenceElement:this.hostElement,label:this.label,toolTitle:this.toolTitle,layerFilterType:this.layerFilterType,mapView:this.mapView,mapLayers:this.filteredMapLayers,onAnalysisSketchToolsRendered:this.handleAnalysisSketchToolsRendered,onAnalysisSketchLayerChange:this.handleAnalysisSketchLayerChange,onAnalysisSketchRemove:this.handleAnalysisSketchRemove}),this.isInitialMode?this.renderInitialMode():this.renderListMode(),this.renderErrorMessage(),this.renderWarningMessage(),this.renderSketchLoadingMessage()))}createLayerPopover(e){const t=(0,r.v)(this.mapView)&&null!=this.layerFilterType?(0,r.d)(this.layerFilterType):this.layerFilterType;void 0===this.layerInputPopover&&(this.layerInputPopover=document.createElement("analysis-layer-input-popover"),this.layerInputPopover.addEventListener("analysisLayerInputPopoverClose",this.layerPopoverClose),this.layerInputPopover.addEventListener("analysisLayerInputPopoverSelectionChange",this.layerSelectionChange),this.layerInputPopover.addEventListener("analysisLayerInputPopoverLayerBrowsed",this.handleLayerBrowsed)),!0===this.isInitialMode||"calcite-button"===e.localName?(this.layerInputPopover.selectionMode=this.selectionMode,void 0!==this.selectedLayerIds&&(this.layerInputPopover.selectedLayerIds=[...this.selectedLayerIds])):this.layerInputPopover.selectionMode="single",this.layerInputPopover.mapLayers=this.filteredMapLayers,this.layerInputPopover.modelVariableLayers=this.filteredModelVariableLayers,this.layerInputPopover.hideAddToMap=this.hideAddToMap,this.layerInputPopover.itemBrowserFilter=(0,r.e)(t),this.layerInputPopover.itemBrowserQ=(0,r.g)(this.mapView,t,this.user?.orgId),this.layerInputPopover.itemBrowserAllowedGeometries=(0,r.h)(t),this.layerInputPopover.layerFilterType=t,this.layerInputPopover.showNoticeMessage=this.showNoticeMessage;const i=this.warningMessageForPopover.map((e=>{const t="allowAnalysisReason"===e?"allowAnalysis":"supportedData",i=!0===this.user?.portal?.isPortal&&void 0!==this.portalHelpMap?this.portalHelpMap?.m[o.h.map.OtherHelpLinks[t]]:o.a.map.OtherHelpLinks[t],s=(0,a.H)({url:i,basePath:(0,a.K)(this.user?.portal),portalUrl:this.user?.portal?.restUrl});return(0,a.a)(this.strings[e],{docLink:s})}));this.layerInputPopover.noticeMessage=[...this.noticeMessage,...i],this.layerInputPopover.placement="leading",this.layerInputPopover.dir=this.dir,this.layerInputPopover.hideBrowseButton=this.hideBrowseButton,this.layerInputPopover.referenceElement=e.parentElement??e,this.layerInputPopover.popoverWidth=this.popoverWidth??e.parentElement?.offsetWidth,this.layerInputPopover.mapView=this.mapView,void 0!==this.user&&(this.layerInputPopover.user=this.user,this.layerInputPopover.portal=this.user?.portal),(0,r.a)(document,this.layerInputPopover)}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{mapLayers:["mapLayersChange"],modelVariableLayers:["modelVariableLayersChange"],selectedLayers:["selectedLayersChange"],layerFilterType:["layerFilterTypeChange"],externalBrowsedLayers:["externalBrowsedLayersChange"],featureCounts:["onFeatureCountChange"]}}};ue.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex;flex-direction:column;width:var(--analysis-component-default-width);margin-bottom:var(--analysis-half-spacing);--calcite-label-margin-bottom:0;--layer-selected-margin-bottom:var(--analysis-half-spacing)}:host([hidden]){display:none}.flex-container{display:flex;width:var(--analysis-component-default-width);column-gap:3%}.primary-button{flex:1 1 auto}.secondary-button{flex:auto 1 auto}.text{padding-bottom:var(--analysis-quarter-spacing);margin-block-start:0;margin-block-end:0}.border{border:1px solid var(--calcite-color-border-input);margin-bottom:var(--layer-selected-margin-bottom)}.warning-message{word-wrap:break-word;overflow-wrap:anywhere}.loading-message-wrapper{margin-top:var(--analysis-half-spacing);display:flex;justify-content:center;gap:1rem}.loading-message-wrapper .loading-sketch-message{margin:0}.loading-message-wrapper .loader{--calcite-loader-size:1rem;margin:0;padding:0}.list-item{--calcite-font-size--1:var(--calcite-font-size--2)}";const pe="calcite-chip",me="calcite-list-item",ye=class{constructor(e){(0,s.r)(this,e),this.analysisSummaryFieldsChange=(0,s.c)(this,"analysisSummaryFieldsChange",7),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.useInitialSelectedStatistics=!1,this.selection=new Set,this.updateValueMap=(e,t)=>{if(!1===this.valueMap.has(e))this.valueMap.set(e,[t]);else{const i=this.valueMap.get(e)??[];!1===i.includes(t)&&(i.push(t),this.valueMap.set(e,i))}},this.popoverAction=()=>{this.fieldPopoverOpen=!0,!0===this.fieldPopoverOpen?this.createSummaryFieldsPopover():void 0!==this.summaryFieldsPopover&&(this.summaryFieldsPopover.open=!1,this.validate())},this.createSummaryFieldsPopover=()=>{void 0===this.summaryFieldsPopover&&(this.summaryFieldsPopover=document.createElement("analysis-summary-fields-popover"),this.summaryFieldsPopover.addEventListener("analysisSummaryFieldSelectionDone",this.onAnalysisSummaryFieldSelectionDone),this.summaryFieldsPopover.addEventListener("analysisSummaryFieldPopoverClose",this.closePopover)),this.summaryFieldsPopover.referenceElement=this.fieldButton,this.summaryFieldsPopover.open=!0,this.summaryFieldsPopover.layer=this.layer,this.summaryFieldsPopover.usePopupTemplatesInfo=this.usePopupTemplatesInfo,this.summaryFieldsPopover.selection=new Set(this.selection.keys()),this.summaryFieldsPopover.allowDateType=this.allowDateType,this.summaryFieldsPopover.allowStringType=this.allowStringType,this.summaryFieldsPopover.allowDateOnlyType=this.allowDateOnlyType,this.summaryFieldsPopover.allowTimeOnlyType=this.allowTimeOnlyType,this.summaryFieldsPopover.layerInputLocalizedLabel=this.layerInputLocalizedLabel,this.summaryFieldsPopover.noFieldsText=this.noFieldsText,this.summaryFieldsPopover.noLayersText=this.noLayersText,this.summaryFieldsPopover.showFieldDescription=this.showFieldDescription,!1===document.body.contains(this.summaryFieldsPopover)&&(this.summaryFieldsPopover.open=!0,document.body.appendChild(this.summaryFieldsPopover))},this.closePopover=()=>{void 0!==this.summaryFieldsPopover&&!0===document.body.contains(this.summaryFieldsPopover)&&(document.body.removeChild(this.summaryFieldsPopover),this.summaryFieldsPopover?.remove(),this.summaryFieldsPopover=void 0,this.fieldPopoverOpen=!1)},this.onAnalysisSummaryFieldSelectionDone=e=>{this.selection=e.detail,this.fieldPopoverOpen=!1,0===this.selection.size?(this.valueMap=new Map,this.value=void 0):(Array.from(this.valueMap.keys()).map((e=>{!1===this.selection.has(e)&&this.removeFromValueMap(e)})),Array.from(this.selection).map((e=>{const t=this.layer.fieldsIndex.get(e),{statistics:i}=this.getSupportedStatisticTypes(t.type);this.useInitialSelectedStatistics=!0,!1===this.valueMap.has(e)&&this.updateValueMap(t.name,i[0])})),this.updateValue()),this.analysisSummaryFieldsChange.emit(),this.validate()},this.onAnalysisChipGroupSelectionChange=e=>{const t=e.target,i=t.selectedChips,s=t.parentElement,a=s.description??s.id;!0===this.useInitialSelectedStatistics&&(this.useInitialSelectedStatistics=!1),this.valueMap.set(a,i),this.updateValue(),this.analysisSummaryFieldsChange.emit()},this.closeField=e=>{const t=e.target.parentElement.id;if(this.selection.delete(t),this.removeFromValueMap(t),void 0!==this.value){let e;e=!0===this.storeAsGPValue?this.value.filter((e=>e.onStatisticField.name!==t)):"string"===this.valueFormat?this.value.filter((e=>e.split(" ")[0]!==t)):this.value.filter((e=>e.onStatisticField!==t)),this.value=[...e],this.analysisSummaryFieldsChange.emit()}this.validate()},this.validate=()=>{this.errorMessage=void 0;const e=!this.required||this.valueMap.size>0,t=Array.from(this.valueMap.values()).every((e=>e.length>0));!this.required||e&&t||(this.errorMessage=this.validationParams?.requiredMessage??this.strings.isRequired)},this.renderErrorMessage=()=>void 0!==this.errorMessage?(0,s.h)("calcite-input-message",{status:a.b.INVALID,scale:a.U.Scale,icon:"exclamationMarkTriangle"},this.errorMessage):null,this.renderFields=()=>{const e={badInputMessage:this.strings.statisticNotSelected,...this.validationParams};return(0,s.h)("calcite-list",{label:""},[...this.valueMap.keys()].map((t=>{const i=this.layer?.fieldsIndex?.get(t),a=i?.alias??t,r=this.valueMap.get(t),{statistics:n,labels:o}=this.getSupportedStatisticTypes(i?.type??"integer");return(0,s.h)("calcite-list-item",{class:me,label:a,key:t,id:t,description:i?.name??t},(0,s.h)("analysis-chip-group",{slot:"content-bottom",onAnalysisChipGroupSelectionChange:this.onAnalysisChipGroupSelectionChange,required:!0,scale:"s",class:pe,chipLabel:o,value:n,label:this.strings.statistic,selectionMode:"multi",selectAllEnabled:!0,initialChipSelection:this.useInitialSelectedStatistics?r:[],selectedChips:r,validationParams:e}),(0,s.h)("calcite-action",{text:"",slot:"actions-end",icon:"trash",onClick:this.closeField}))})))},this.valueMap=new Map,this.layer=void 0,this.label=void 0,this.valueFormat=void 0,this.storeAsGPValue=!1,this.value=void 0,this.required=!1,this.usePopupTemplatesInfo=!0,this.allowDateType=!1,this.allowDateOnlyType=!1,this.allowTimeOnlyType=!1,this.allowStringType=!1,this.showFirstLastStatistics=!1,this.alwaysShowAnyCountStatistics=!1,this.validationParams=void 0,this.layerInputLocalizedLabel=void 0,this.noFieldsText=void 0,this.noLayersText=void 0,this.showFieldDescription=!1,this.fieldPopoverOpen=!1,this.errorMessage=void 0}valueChange(){this.valueFormat=void 0!==this.value&&this.value.length>0&&"object"==typeof this.value[0]?"object":this.valueFormat??"string",void 0!==this.value&&0===this.valueMap.size&&void 0!==this.valueFormat&&(this.selection=new Set,this.value.forEach((e=>{let t,i;if("string"===this.valueFormat){const s=e.split(" ");t=s[0],i=s[1]}else{const s=e;t="string"==typeof s.onStatisticField?s.onStatisticField:s.onStatisticField.name,i=s.statisticType}this.updateValueMap(t,i),this.selection.add(t)})))}async layerChange(e,t){if(void 0!==e&&t?.id!==e.id){this.abortController?.abort();try{this.abortController=new AbortController;const e=(await(0,a.h)(this.layer,this.usePopupTemplatesInfo,this.abortController.signal)).filter((e=>this.selection.has(e.name))).map((e=>e.name));this.selection=new Set(e);const t=new Map;this.valueMap.forEach(((e,i)=>{if(this.selection.has(i)){const s=this.layer.fieldsIndex.get(i),{statistics:a}=this.getSupportedStatisticTypes(s.type),r=a.filter((t=>e.includes(t)));r.length>0?t.set(i,r):this.selection.delete(i)}})),this.useInitialSelectedStatistics=!0,(this.valueMap.size!==t.size||[...this.valueMap.entries()].some((([e,i])=>t.get(e).length!==i.length)))&&(this.valueMap=t,this.updateValue(),this.analysisSummaryFieldsChange.emit())}catch(e){!1===(0,a.w)(e)&&(this.errorMessage=this.strings.fieldLoadingErrorText)}}this.closePopover()}disconnectedCallback(){this.abortController?.abort(),this.closePopover()}async componentWillLoad(){({strings:this.strings}=await(0,a.d)(this.hostElement,(0,s.a)("."))),void 0!==this.value&&(this.valueChange(),this.useInitialSelectedStatistics=!0),await this.layerChange(this.layer)}componentShouldUpdate(){return this.layer?.loaded}async checkValidity(){return this.validate(),Promise.resolve(void 0===this.errorMessage)}updateValue(){const e=[];this.valueMap.forEach(((t,i)=>{t.forEach((t=>{let s;if(!0===this.storeAsGPValue){const s={onStatisticField:(0,a.L)(this.layer,i),statisticType:t};e.push(s)}else"string"===this.valueFormat?(s=`${i} ${t}`,e.push(s)):(s={onStatisticField:i,statisticType:t},e.push(s))}))})),this.value=[...e]}removeFromValueMap(e){const t=this.valueMap;t.delete(e),this.valueMap=new Map(t)}getSupportedStatisticTypes(e){let t=[],i=[];return!0===(0,a.M)(e)?(t=[r.S.Sum,r.S.Minimum,r.S.Maximum,r.S.Mean,r.S.StdDev],i=[this.strings.sum,this.strings.min,this.strings.max,this.strings.mean,this.strings.standardDeviation]):"date"===e&&!0===this.allowDateType?(t=[r.S.Minimum,r.S.Maximum],i=[this.strings.min,this.strings.max]):"string"===e&&!0===this.allowStringType?(t=[r.S.Any,r.S.Count],i=[this.strings.any,this.strings.count]):("date-only"===e&&!0===this.allowDateOnlyType||"time-only"===e&&!0===this.allowTimeOnlyType)&&(t=[r.S.Minimum,r.S.Maximum],i=[this.strings.min,this.strings.max]),!0===this.alwaysShowAnyCountStatistics&&"string"!==e?(t=[...t,r.S.Any,r.S.Count],i=[...i,this.strings.any,this.strings.count]):!0===this.showFirstLastStatistics&&(t=[...t,r.S.First,r.S.Last],i=[...i,this.strings.first,this.strings.last]),{statistics:t,labels:i}}render(){return(0,s.h)(s.H,{key:"be3e0e4cd92479ed050ed7bd7e36de27ea1a3d31"},void 0!==this.label&&""!==this.label?(0,s.h)("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit()}):null,void 0!==this.valueMap&&this.valueMap.size>0&&this.renderFields(),(0,s.h)("calcite-button",{key:"df96dea5942da27ce6ea8cee7b33b03f1c64c1bd",appearance:"outline",kind:"neutral","icon-start":"plus",width:"full",scale:a.U.Scale,ref:e=>{this.fieldButton=e},onClick:this.popoverAction},this.strings.field),this.renderErrorMessage())}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{value:["valueChange"],layer:["layerChange"],usePopupTemplatesInfo:["layerChange"]}}};ye.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex;flex-direction:column;margin-bottom:var(--analysis-half-spacing)}.label{margin-top:0}.calcite-chip{margin:var(--analysis-quarter-spacing)}.calcite-list-item{border:2px solid var(--calcite-color-border-1);margin-bottom:var(--analysis-quarter-spacing);margin-top:var(--analysis-quarter-spacing);border-radius:var(--analysis-quarter-spacing);overflow:hidden;--calcite-font-size--1:var(--calcite-font-size--2)}.calcite-switch{border:2px solid var(--calcite-color-border-1);margin-bottom:var(--analysis-quarter-spacing);margin-top:var(--analysis-quarter-spacing);padding:var(--analysis-quarter-spacing);padding-top:var(--analysis-three-quarter-spacing);border-radius:var(--analysis-quarter-spacing);overflow:hidden}";const ve=class{constructor(e){(0,s.r)(this,e),this.analysisNumberInputChange=(0,s.c)(this,"analysisNumberInputChange",7),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.renderSingleInput=()=>void 0===this.choiceList?this.renderInput():this.renderCombobox(),this.renderInput=()=>{const e=void 0!==this.errorMessage?a.b.INVALID:(0,a.g)(this.validationParams?.type),t=this.doCalciteInputChangeOnCommit?{onCalciteInputChange:this.inputChanged}:{onCalciteInputInput:this.inputChanged};return(0,s.h)("calcite-input",{type:"number",value:(0,a.O)(this.value),status:e,placeholder:this.placeholderText??this.strings.inputPlaceholderText,step:this.isFloatType?"any":1,readOnly:this.readOnly,required:this.required||void 0,min:this.min,max:this.max,scale:this.scale??a.U.Scale,groupSeparator:!0,...t})},this.renderCombobox=()=>{const e=this.choiceList?.map((e=>this.buildComboBoxItem((0,a.O)(e),e===this.value)));return(0,s.h)("calcite-combobox",{scale:this.scale??a.U.Scale,label:this.label??this.strings.comboboxLabel,selectionMode:"single",placeholder:this.placeholderText??this.strings.comboboxPlaceholderText,clearDisabled:!0},e)},this.buildComboBoxItem=(e,t)=>(0,s.h)("calcite-combobox-item",{key:e,value:e,textLabel:e,selected:t,onCalciteComboboxItemChange:this.comboboxItemChanged}),this.renderAnalysisMultiInput=()=>{const e=this.value?.map((e=>(0,a.O)(e))),t=this.choiceList?.map((e=>(0,a.O)(e))),{isFloatType:i,min:r,max:n,excludeMinValue:o,excludeMaxValue:l,minValues:h,maxValues:c}=this,d={isFloatType:i,min:r,max:n,excludeMinValue:o,excludeMaxValue:l,minValues:h,maxValues:c};return(0,s.h)("analysis-multiple-input",{dataType:"number",value:e,choiceList:t,placeholderText:this.placeholderText,required:this.required,validationOptions:d,validationParams:this.validationParams,ref:e=>{this.multiInputElement=e},onAnalysisMultipleInputChange:e=>{this.value=e.detail.map((e=>(0,a.P)(e))),this.analysisNumberInputChange.emit()}})},this.inputChanged=e=>{const t=e.currentTarget?.value;this.value=(0,a.P)(t),this.analysisNumberInputChange.emit(),this.validate()},this.comboboxItemChanged=e=>{if(this.isMultiSelect)return;const t=e.target,i=t?.value,s=(0,a.P)(i);this.value!==s&&t?.selected&&(this.value=s,this.analysisNumberInputChange.emit(),this.validate())},this.errorMessage=void 0,this.value=void 0,this.scale=void 0,this.label=void 0,this.doCalciteInputChangeOnCommit=!1,this.numberType=void 0,this.selectionMode=void 0,this.readOnly=!1,this.choiceList=void 0,this.required=void 0,this.validationParams=void 0,this.min=void 0,this.excludeMinValue=void 0,this.max=void 0,this.maxValues=void 0,this.minValues=void 0,this.excludeMaxValue=void 0,this.placeholderText=void 0,this.maxOfValues=void 0,this.hideHelp=!1}onValueChange(){this.maxOfValues=Array.isArray(this.value)?Math.max(...this.value):this.value}onRequiredChange(){this.validate()}async onValidationChange(){void 0!==this.multiInputElement&&(this.multiInputElement.validationOptions=this.formatValidationOptions()),this.errorMessage=void 0,!1===(0,a.i)(this.value)&&await this.validate()}async componentWillLoad(){({strings:this.strings}=await(0,a.d)(this.hostElement,(0,s.a)("."))),(0,a.i)(this.value)||this.onValueChange()}get isFloatType(){return void 0===this.numberType||"float"===this.numberType}get isMultiSelect(){return"multi"===this.selectionMode}get formatOptions(){return{min:`${this.min??Number.MIN_SAFE_INTEGER}`,max:`${this.max??Number.MAX_SAFE_INTEGER}`}}render(){const e=void 0!==this.errorMessage,t=(0,a.f)(this.validationParams),i=!1===(0,a.i)(t)||!0===e,r=e?a.b.INVALID:(0,a.g)(this.validationParams?.type);return(0,s.h)(s.H,{key:"65e98a2ab1ce67bf6608187aa7258b101213a99e"},(0,s.h)("calcite-label",{key:"22390cb7d8dfd4a4741501824755b4b3d37367a2",class:"label",scale:this.scale??a.U.Scale},""!==this.label?(0,s.h)("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit(),hideHelp:this.hideHelp}):null,this.isMultiSelect?this.renderAnalysisMultiInput():this.renderSingleInput(),(0,s.h)("calcite-input-message",{key:"2b8660d158eebf6ffc36bdfb29cbbbbae02c014e",status:r,scale:a.U.Scale,hidden:!i||this.isMultiSelect,icon:"exclamationMarkTriangle"},this.errorMessage??t)))}async checkValidity(){await this.validate();const e=void 0===this.errorMessage||""===this.errorMessage;return Promise.resolve(e)}async validate(){if(this.isMultiSelect)void 0!==this.multiInputElement&&(this.multiInputElement.errorMessage=void 0),await(this.multiInputElement?.checkValidity()),this.errorMessage=this.multiInputElement?.errorMessage;else{const e=this.value,t=(0,r.j)(e,this.formatValidationOptions()),i=void 0!==t?(0,a.a)(this.strings[t],this.formatOptions):void 0;this.errorMessage=i}}formatValidationOptions(){return{required:this.required,isFloatType:this.isFloatType,excludeMaxValue:this.excludeMaxValue,excludeMinValue:this.excludeMinValue,max:this.max??Number.MAX_SAFE_INTEGER,min:this.min??Number.MIN_SAFE_INTEGER}}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{value:["onValueChange"],required:["onRequiredChange"],min:["onValidationChange"],max:["onValidationChange"],excludeMaxValue:["onValidationChange"],excludeMinValue:["onValidationChange"],numberType:["onValidationChange"]}}};ve.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex;width:var(--analysis-component-default-width);--calcite-color-border-input:var(--analysis-ui-border-input)}:host([hidden]){display:none}.label{width:var(--analysis-component-default-width)}";const ge="dataset-input",fe={border:`${ge}__border`,container:`${ge}__container`,listItem:`${ge}__list-item`},be=class{constructor(e){(0,s.r)(this,e),this.analysisDatasetInputChange=(0,s.c)(this,"analysisDatasetInputChange",7),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.renderInitialMode=()=>(0,s.h)("section",null,(0,s.h)("calcite-label",{scale:a.U.Scale},void 0!==this.label&&""!==this.label?(0,s.h)("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit(),hideHelp:this.hideHelp}):null,this.renderAddButton(),this.renderErrorMessage())),this.renderListMode=()=>{const e=this.valueArray?.map((e=>(0,s.h)("calcite-list-item",{class:fe.listItem,key:e.id,value:e.id,label:e.name,description:e.description},(0,s.h)("calcite-action",{text:this.strings.remove,slot:"actions-end",label:this.strings.remove,appearance:"transparent",icon:"x",onClick:()=>this.onRemoveDataset(e.id)}))));return(0,s.h)("section",{class:fe.container},(0,s.h)("calcite-label",{scale:a.U.Scale},(0,s.h)("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit(),hideHelp:this.hideHelp}),(0,s.h)("calcite-list",{class:fe.border,label:"",onMouseOver:this.onListMouseOver,onMouseOut:this.onListMouseOut,onCalciteListChange:this.onListItemSelected},e),this.renderErrorMessage()),this.isMultiSelect&&this.renderAddButton())},this.renderErrorMessage=()=>{const e=void 0!==this.errorMessage;return(0,s.h)("calcite-input-message",{hidden:!e,icon:"exclamationMarkTriangle",status:a.b.INVALID,scale:a.U.Scale},this.errorMessage)},this.renderAddButton=()=>(0,s.h)("calcite-button",{appearance:"outline",kind:"neutral","icon-start":"plus",onClick:this.onAddButtonClicked,width:"full",scale:a.U.Scale},this.strings.dataset),this.onAddButtonClicked=e=>{this.createDatasetInputPopover(e.target)},this.onListMouseOver=e=>{const t=e.target;"calcite-list-item"===t?.localName&&(void 0===this.replaceTooltip&&(this.replaceTooltip=document.createElement("calcite-tooltip"),this.replaceTooltip.placement="bottom",this.replaceTooltip.innerText=this.strings.replaceDataset),this.replaceTooltip.referenceElement=t,(0,r.a)(document,this.replaceTooltip))},this.onListMouseOut=()=>{(0,r.r)(this.replaceTooltip)},this.onListItemSelected=e=>{this.createDatasetInputPopover(e.target)},this.onRemoveDataset=e=>{const t=this.valueArray?.filter((t=>t.id!==e));this.updateValueFromArray(t)},this.createDatasetInputPopover=e=>{void 0===this.datasetInputPopover&&(this.datasetInputPopover=document.createElement("analysis-dataset-input-popover"),this.datasetInputPopover.addEventListener("analysisDatasetInputPopoverClose",this.onDatasetPopoverClose),this.datasetInputPopover.addEventListener("analysisDatasetInputPopoverSelectionChange",this.onDatasetInputPopoverChange)),this.datasetInputPopover.selectedDatasetIds=this.valueArray?.map((e=>e.id)),this.datasetInputPopover.selectionMode=this.isMultiSelect?"multiple":"single",this.datasetInputPopover.analysisDatasets=this.analysisDatasets,this.datasetInputPopover.placement="leading",this.datasetInputPopover.referenceElement=e.parentElement??e,(0,r.a)(document,this.datasetInputPopover)},this.onDatasetPopoverClose=()=>{(0,r.r)(this.datasetInputPopover),this.datasetInputPopover=void 0,this.validate()},this.onDatasetInputPopoverChange=e=>{const t=e.detail.selectedDatasetIds,i=new Set(t),s=this.analysisDatasets?.filter((e=>i.has(e.id)));this.updateValueFromArray(s)},this.updateValueFromArray=e=>{if(this.isMultiSelect)this.value=e;else{const t=void 0===e||e.length<1;this.value=t?void 0:e[0]}this.analysisDatasetInputChange.emit()},this.validate=()=>{this.required&&!this.hasValue?this.errorMessage=(0,a.a)(this.strings.isRequired,{label:this.label}):this.errorMessage=void 0},this.label=void 0,this.required=!1,this.selectionMode=void 0,this.analysisDatasets=void 0,this.value=void 0,this.hideHelp=!1,this.errorMessage=void 0}onValueChange(){this.validate()}get isMultiSelect(){return"multi"===this.selectionMode}get hasValue(){return this.isMultiSelect?void 0!==this.value&&this.value.length>0:void 0!==this.value}get valueArray(){let e;return void 0!==this.value&&(e=this.isMultiSelect?this.value:[this.value]),e}async componentWillLoad(){({strings:this.strings}=await(0,a.d)(this.hostElement,(0,s.a)(".")))}disconnectedCallback(){(0,r.r)(this.datasetInputPopover),(0,r.r)(this.replaceTooltip)}render(){return(0,s.h)(s.H,{key:"1581750a0a706a2b173ca4d11d5b36b5a6398e55"},this.hasValue?this.renderListMode():this.renderInitialMode())}async checkValidity(){this.validate();const e=void 0===this.errorMessage||""===this.errorMessage;return Promise.resolve(e)}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{value:["onValueChange"]}}};be.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex;flex-direction:column;width:var(--analysis-component-default-width)}.dataset-input__border{border:1px solid var(--analysis-ui-border-input)}.dataset-input__container{margin-bottom:var(--analysis-half-spacing)}.dataset-input__list-item{--calcite-font-size--1:var(--calcite-font-size--2)}";const we=class{constructor(e){(0,s.r)(this,e),this.analysisTreeValueChange=(0,s.c)(this,"analysisTreeValueChange",7),this.treeItemsOpen=new Set,this.handleMutations=e=>{e.forEach((e=>{if("attributes"===e.type&&"expanded"===e.attributeName){const t=e.target;if("key"in t.dataset&&void 0!==t.dataset.key){this.treeItemsOpen.has(t.dataset.key)!==t.expanded&&this.toggleTreeItem(t.dataset.key)}}}))},this.toggleTreeItem=e=>{this.treeItemsOpen.has(e)?this.treeItemsOpen.delete(e):this.treeItemsOpen.add(e),this.buildJSXTree()},this.data={},this.value=void 0,this.renderedTree=[]}onDataChange(){this.setupComponent()}componentWillLoad(){this.setupComponent()}componentDidLoad(){this.setupObserver()}disconnectedCallback(){this.observer?.disconnect()}setupComponent(){this.treeItemsOpen.clear(),this.buildJSXTree()}setupObserver(){this.observer=new MutationObserver(this.handleMutations);const e=this.hostElement.shadowRoot??this.hostElement;this.observer.observe(e,{attributes:!0,subtree:!0,attributeFilter:["expanded"]})}buildJSXTree(){const e=t=>{const i=[];for(const s in t){const a=t[s];let r;"object"==typeof a&&(r=this.treeItemsOpen.has(s)?e(a):[]);const n="object"==typeof a?s:a;i.push(this.createTreeItem(s,n,r))}return i};this.renderedTree=e(this.data)}createTreeItem(e,t,i){return(0,s.h)("calcite-tree-item",{key:`${e}-item`,"data-key":e,selected:this.value===e,"aria-selected":this.value===e,expanded:this.treeItemsOpen.has(e),"aria-expanded":this.treeItemsOpen.has(e),onClick:void 0!==i?()=>this.toggleTreeItem(e):void 0},t,void 0!==i&&(0,s.h)("calcite-tree",{key:`${e}-child-tree`,slot:"children"},i))}handleTreeSelect(e){const t=e.target,i=t?.selectedItems[0]?.dataset.key;void 0!==i&&(this.value=i,this.analysisTreeValueChange.emit())}render(){return(0,s.h)(s.H,{key:"b607d098cea8ad9ece5b04115601d19b825ee954"},(0,s.h)("div",{key:"5330bf4742d9bc965ece3ab3073a86a28514734c"},(0,s.h)("calcite-tree",{key:"base-tree",scale:a.U.Scale,onCalciteTreeSelect:e=>this.handleTreeSelect(e)},this.renderedTree)))}get hostElement(){return(0,s.g)(this)}static get watchers(){return{data:["onDataChange"]}}};we.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{overflow-y:auto;overflow-x:hidden;scroll-behavior:smooth;height:100%;width:100%}";const Ce="no-matches-found-msg",ke=class{constructor(e){(0,s.r)(this,e),this.analysisSpatialReferenceValueChange=(0,s.c)(this,"analysisSpatialReferenceValueChange",7),this.analysisSpatialReferenceSelectorDismissed=(0,s.c)(this,"analysisSpatialReferenceSelectorDismissed",7),this.searchText="",this.performantFilterSpatialReferences=(0,o.d)((e=>{this.updateSearchResults(e)}),250,{leading:!1,trailing:!0}),this.autoFilterToDefault=!1,this.defaultWkid=4326,this.value=void 0,this.hideCategories=void 0,this.hideDone=!1,this.searchResults=void 0}onAutoFilterToDefaultChange(){this.autoFilterSpatialReferences()}onDefaultWkidChange(){this.autoFilterSpatialReferences()}async getSRDescription(){return void 0!==this.value?.latestWkid?Promise.resolve((0,a.Q)(this.value?.latestWkid)):Promise.resolve(void 0)}async componentWillLoad(){({strings:this.strings,dir:this.dir}=await(0,a.d)(this.hostElement,(0,s.a)("."))),this.value=this.value??{latestWkid:this.defaultWkid};const e=this.filterSrCategories(a.R);this.visibleSrCategories=this.translateSrCategories(e)}componentDidLoad(){this.autoFilterSpatialReferences()}translateSrCategories(e){const t={};return this.recursiveTranslate(e,t),t}recursiveTranslate(e,t){Object.keys(e).forEach((i=>{const s=this.getTranslatedKey(i);"object"==typeof e[i]?(t[s]={},this.recursiveTranslate(e[i],t[s])):t[s]=e[i]}))}getTranslatedKey(e){return e in this.strings?this.strings[e]:e}filterSrCategories(e){const t={};return Object.keys(e).forEach((i=>{void 0!==this.hideCategories&&!1!==this.hideCategories?.includes(i)||("object"==typeof e[i]?t[i]=this.filterSrCategories(e[i]):t[i]=e[i])})),t}setSpatialRef(e){this.value={latestWkid:Number(e)},this.analysisSpatialReferenceValueChange.emit(this.value)}inputKeyDown(e){"Enter"===e.key&&this.selectFirstChild(!0)}selectFirstChild(e){const t=this.treeElement,i=t?.shadowRoot?.querySelector("calcite-tree-item:not([has-children]):not([data-key='placeholder'])")||void 0;void 0!==t&&void 0!==i&&(i.selected=!0,this.setSpatialRef(i.dataset.key??""),e&&i.focus())}updateSearchResults(e){this.searchResults=(0,a.S)(e)}searchSpatialReferences(e){null!==e.target&&this.setSearchText(e.target.value??"")}setSearchText(e){this.searchText=e,this.searchText.length>1?this.performantFilterSpatialReferences(this.searchText):this.searchResults=void 0}autoFilterSpatialReferences(){this.autoFilterToDefault&&!1===(0,a.i)(this.defaultWkid)&&void 0!==this.searchInput&&(this.searchInput.value=this.defaultWkid.toString(),this.setSearchText(this.searchInput.value))}render(){const e=(0,a.a)(this.strings.noMatchesFound,{searchTerm:this.searchText??""});return(0,s.h)(s.H,{key:"8794dc4dfae024e307f97a7ada2b4427dd2afb36",dir:this.dir},(0,s.h)("calcite-panel",{key:"9fb462a30157390b1be515aaf27b445b9c6868ff",closable:!1,closed:!1,onCalcitePanelClose:()=>this.analysisSpatialReferenceSelectorDismissed.emit(this.value)},(0,s.h)("calcite-input",{key:"e3b2b06f48245abc479ba7ae42a935d9c82274bb",onCalciteInputInput:e=>this.searchSpatialReferences(e),onKeyDown:e=>this.inputKeyDown(e),placeholder:this.strings.searchPlaceholder,scale:a.U.Scale,type:"search",icon:!0,autofocus:!0,ref:e=>this.searchInput=e}),this.searchText.length>1&&(0,a.i)(this.searchResults)&&(0,s.h)("p",{key:"45fbeb11c265b397367509fce9ec306d6d8441bc",class:Ce},e),(0,s.h)("analysis-tree",{key:"tree",ref:e=>this.treeElement=e,data:void 0!==this.searchResults&&this.searchText.length>0?this.searchResults:this.visibleSrCategories,value:this.value&&`${this.value?.latestWkid}`,onAnalysisTreeValueChange:()=>{this.setSpatialRef(this.treeElement.value)}}),this.hideDone?void 0:(0,s.h)("calcite-button",{appearance:"solid",scale:a.U.Scale,width:"full",slot:"footer-actions",onClick:()=>this.analysisSpatialReferenceSelectorDismissed.emit(this.value)},this.strings.done)))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{autoFilterToDefault:["onAutoFilterToDefaultChange"],defaultWkid:["onDefaultWkidChange"]}}};ke.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{overflow-y:hidden;display:flex;flex-direction:column;--calcite-color-border-input:var(--analysis-ui-border-input);height:var(--analysis-popover-content-height);min-width:20rem;max-width:27rem}.no-matches-found-msg{margin:var(--analysis-half-spacing);font-size:var(--calcite-font-size--2)}analysis-tree{flex:1}";const Se="select-button",Le=class{constructor(e){(0,s.r)(this,e),this.analysisSpatialReferenceInputChange=(0,s.c)(this,"analysisSpatialReferenceInputChange",7),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.createPopover=e=>{this.spatialReferencePopover&&(this.spatialReferencePopover.remove(),this.spatialReferencePopover=void 0),this.spatialReferencePopover=document.createElement("calcite-popover");const t={autoClose:!0,dir:this.dir,focusTrapDisabled:!0,heading:this.strings.browseCoordinateSystems,closable:!0,open:!0,referenceElement:e.target};Object.assign(this.spatialReferencePopover,t),this.spatialReferencePopover.addEventListener("calcitePopoverClose",this.handleSpatialReferenceClose);const i=document.createElement("analysis-spatial-reference-selector");i.hideCategories=this.hideCategories,i.value=this.value,i.addEventListener("analysisSpatialReferenceValueChange",this.handleSpatialReferenceChange),i.addEventListener("analysisSpatialReferenceSelectorDismissed",this.handleSpatialReferenceClose),this.spatialReferencePopover.append(i),document.body.append(this.spatialReferencePopover),setTimeout((()=>requestAnimationFrame((()=>{this.spatialReferencePopover.open=!0,this.spatialReferencePopover?.setFocus()}))),1)},this.validate=()=>(this.required&&void 0===this.value?this.errorMessage=(0,a.a)(this.strings.isRequired,{label:this.label}):this.errorMessage=void 0,void 0===this.errorMessage),this.handleSpatialReferenceChange=e=>{this.value={latestWkid:e.detail.latestWkid,wkid:e.detail.latestWkid},this.analysisSpatialReferenceInputChange.emit(this.value)},this.handleSpatialReferenceClose=()=>{this.spatialReferencePopover?.remove(),this.spatialReferencePopover=void 0,this.validate()},this.label=void 0,this.required=!1,this.hideCategories=void 0,this.value=void 0,this.errorMessage=void 0}onValueChange(){var e,t;void 0!==this.value&&((e=this.value).wkid??(e.wkid=this.value.latestWkid),(t=this.value).latestWkid??(t.latestWkid=this.value.wkid)),this.validate()}async componentWillLoad(){var e,t;({strings:this.strings,dir:this.dir}=await(0,a.d)(this.hostElement,(0,s.a)("."))),void 0!==this.value&&((e=this.value).wkid??(e.wkid=this.value.latestWkid),(t=this.value).latestWkid??(t.latestWkid=this.value.wkid))}disconnectedCallback(){this.spatialReferencePopover?.remove()}async checkValidity(){this.validate();const e=void 0===this.errorMessage||""===this.errorMessage;return Promise.resolve(e)}render(){const e=(0,a.i)(this.value)?this.strings.browseCoordinateSystems:(0,a.Q)(this.value?.latestWkid)??this.strings.browseCoordinateSystems;return(0,s.h)(s.H,{key:"afaa2ce8053957d427bff1cd35fb58a8460179e7"},void 0!==this.label&&""!==this.label?(0,s.h)("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit()}):null,(0,s.h)("calcite-button",{key:"4c455d9c0005bec835ca7ca4755f87165b73ce55",width:"full",appearance:"outline",kind:"neutral","icon-end":"chevron-down",alignment:"icon-end-space-between",onClick:this.createPopover,class:Se,scale:a.U.Scale},e),(0,s.h)("calcite-input-message",{key:"aee752503cbb7f9c5b6a3995969b541ec8052528",status:"invalid",scale:a.U.Scale,hidden:void 0===this.errorMessage,icon:"exclamationMarkTriangle"},this.errorMessage))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{value:["onValueChange"]}}};Le.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex;flex-direction:column;width:var(--analysis-component-default-width)}.select-button{margin-bottom:var(--analysis-half-spacing)}";const _e="container",Ie="border",Me="list-item",xe=class{constructor(e){(0,s.r)(this,e),this.analysisWorkflowSelectChange=(0,s.c)(this,"analysisWorkflowSelectChange",7),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.workflowOptions={},this.hideElements=()=>{this.toolSettingsElement=this.parentAppContainer?.shadowRoot?.querySelector("analysis-tool-settings"),this.toolFooterElement=this.parentAppContainer?.shadowRoot?.querySelector("div[slot=footer]"),this.toolSettingsElement&&(this.toolSettingsElement.hidden=!0),this.toolFooterElement&&(this.toolFooterElement.hidden=!0)},this.showElements=()=>{!0===this.toolSettingsElement?.hidden&&(this.toolSettingsElement.hidden=!1),!0===this.toolFooterElement?.hidden&&(this.toolFooterElement.hidden=!1)},this.onSelectionChange=e=>{e!==this.value&&(this.value=e,this.updateSelectedUIParameters(),this.validate()),this.showElements()},this.replaceWorkflow=e=>{this.removeWorkflowReplacePopover(),this.workflowSelectPopover=this.createWorkflowSelectPopoverElement(e.target),(0,r.a)(document,this.workflowSelectPopover)},this.removeWorkflowReplacePopover=()=>{(0,r.r)(this.workflowSelectPopover)},this.createWorkflowSelectPopoverElement=e=>{const t=document.createElement("analysis-workflow-select-popover"),i={autoClose:!0,closable:!0,focusTrapDisabled:!0,heading:this.strings.popoverHeader,label:this.strings.popoverHeader,placement:"auto",referenceElement:e};return t.popoverOptions=i,t.renderPopoverContent=()=>this.renderWorkflowOptions(!0),t.addEventListener("calcitePopoverClose",(()=>{this.removeWorkflowReplacePopover()})),t},this.isValid=!0,this.label=void 0,this.value=void 0,this.choiceListLabels=void 0,this.required=void 0,this.validationParams=void 0,this.UIparameterInfos=void 0,this.selectUIparameterInfos=void 0}onUIparameterInfosChange(e){this.processUIparameterInfos(e)}async componentWillLoad(){({strings:this.strings,dir:this.dir}=await(0,a.d)(this.hostElement,(0,s.a)("."))),void 0===this.value&&(this.parentAppContainer=(0,a.T)("analysis-tool-app-container",this.hostElement)),void 0!==this.UIparameterInfos&&this.processUIparameterInfos(this.UIparameterInfos),this.updateSelectedUIParameters()}componentDidLoad(){void 0===this.value&&this.hideElements()}disconnectedCallback(){this.removeWorkflowReplacePopover(),this.showElements()}async checkValidity(){return this.validate()}validate(){let e=!0;return!0===this.required&&void 0===this.value&&(e=!1),this.isValid=e,Promise.resolve(this.isValid)}processUIparameterInfos(e){const t={},i={};for(const s of e??[]){const e=s?.name;if(void 0===e)throw new Error("UIparameterInfo goal must have a name property");t[e]=s,i[e]=s.label??e}this.workflowOptions=t,this.choiceListLabels=i,this.resetValueIfInvalid()}updateSelectedUIParameters(){const e=void 0===this.value?void 0:[this.workflowOptions[this.value]];!1===(0,n.i)(e,this.selectUIparameterInfos)&&(this.selectUIparameterInfos=e,this.analysisWorkflowSelectChange.emit())}resetValueIfInvalid(){void 0!==this.value&&void 0===this.workflowOptions[this.value]&&this.onSelectionChange(void 0)}renderReplaceTooltip(){const{replaceWorkflow:e}=this.strings;return(0,s.h)("calcite-tooltip",{closeOnClick:!0,dir:this.dir,overlayPositioning:"fixed",placement:"bottom",onClick:e=>e.stopPropagation(),ref:e=>this.selectedWorkflowTooltip=e},e)}renderWorkflowOptions(e=!1){const t=e||void 0===this.value,i=t?this.removeWorkflowReplacePopover:this.replaceWorkflow,a=t?Object.keys(this.workflowOptions).map((e=>this.renderListItem(this.workflowOptions[e],!1))):this.renderListItem(this.workflowOptions[this.value],!0);return(0,s.h)("calcite-list",{class:Ie,dir:this.dir,label:"",onClick:i,selectionMode:e?"single-persist":"none",selectionAppearance:"icon"},this.renderReplaceTooltip(),a)}renderWorkflowHelpAction(e){const{workflowHelp:t}=this.strings;return(0,s.h)("calcite-action",{label:t,text:t,onClick:t=>{t.stopPropagation();const i=t.target,s=i.parentElement,a=e.label??e.name;this.analysisHelpClick.emit({paramName:e.name,paramLabel:a,refElement:s??i})},icon:"information",slot:"actions-end"})}renderListItem(e,t){const{name:i,label:a}=e,r=t?()=>{}:()=>this.onSelectionChange(e.name);return(0,s.h)("calcite-list-item",{class:Me,key:i,id:i,value:i,label:a??i,selected:i===this.value,onClick:r,ref:e=>{!0===t&&void 0!==this.selectedWorkflowTooltip&&void 0!==this.value&&null!==e&&(this.selectedWorkflowTooltip.referenceElement=e)}},this.renderWorkflowHelpAction(e))}renderLabel(){return void 0!==this.label&&""!==this.label?(0,s.h)("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit()}):void 0}renderErrorMessage(){const e=this.validationParams?.requiredMessage??(0,a.a)(this.strings.isRequired,{label:this.label});return!1===this.isValid&&""!==e?(0,s.h)("calcite-input-message",{status:a.b.INVALID,scale:a.U.Scale,icon:"exclamationMarkTriangle",hidden:this.isValid},e):void 0}render(){return(0,s.h)(s.H,{key:"46289de57e4b7b7515c59c4be658a3551e532929"},(0,s.h)("calcite-section",{key:"44b4fac95006795cd6b3df3296703a2466fe1d4c",class:_e},(0,s.h)("calcite-label",{key:"0c0a960c440cf24ed5928864022819055e3b0d57",scale:a.U.Scale},this.renderLabel(),this.renderWorkflowOptions(),this.renderErrorMessage())))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{UIparameterInfos:["onUIparameterInfosChange"]}}};xe.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{width:var(--analysis-component-default-width)}.container{margin-bottom:var(--analysis-half-spacing)}.border{border:1px solid var(--calcite-color-border-input)}.list-item{--calcite-font-size--1:var(--calcite-font-size--2)}";const Ee="analysis-popover",Te="js-app-flyout",Pe="help-iframe-s",Ae="help-iframe-m",Fe="learn-more",Oe="OnlineOnly",De="PortalOnly",$e="modelBuilderOnly",Be="toolPaneOnly",je="help-custom-tool-param",Ve=class{constructor(e){(0,s.r)(this,e),this.analysisHelpPopoverClose=(0,s.c)(this,"analysisHelpPopoverClose",7),this.analysisHelpPopoverSelectionChange=(0,s.c)(this,"analysisHelpPopoverSelectionChange",7),this.referenceElement=void 0,this.mode=void 0,this.helpUrl=void 0,this.helpId=void 0,this.heading=void 0,this.isHelpFileExternalAsset=!1,this.portal=void 0,this.portalHelpMap=void 0,this.placement="auto",this.open=void 0,this.helpFileName=void 0,this.externalHelpMap=void 0,this.helpSrcdoc=void 0,this.learnMoreBaseUrl=void 0,this.learnMoreUrl=void 0,this.analysisEngine=o.A.Standard,this.offsetDistance=20,this.offsetSkidding=0,this.triggerDisabled=!1,this.helpMode="standalone"}async portalChange(e){void 0!==e&&e.isPortal&&void 0===this.portalHelpMap&&(this.portalHelpMap=await(0,a.V)(e))}async componentWillLoad(){({strings:this.strings,dir:this.dir,locale:this.locale}=await(0,a.d)(this.hostElement,(0,s.a)("."))),void 0!==this.portal&&await this.portalChange(this.portal)}componentDidLoad(){try{setTimeout((()=>requestAnimationFrame((()=>this.popoverElement?.setFocus()))),1),setTimeout((()=>{this.popoverElement?.reposition?.()}),a.U.PopoverTimer)}catch(e){}}async reposition(){await(this.popoverElement?.reposition?.())}get modifierClasses(){const e="model"===this.helpMode?$e:Be;return`${!0===this.portal?.isPortal?De:Oe}-${e}`}getContentStyleClass(e){let t=Pe;return(-1!==e.indexOf("Category")||-1!==e.indexOf("Tool")||-1!==e.indexOf("toolDescription"))&&(t=Ae),t}getLocalizedLearnMoreUrl(){let e;if(void 0!==this.learnMoreBaseUrl){e="/"!==this.learnMoreBaseUrl.charAt(this.learnMoreBaseUrl.length-1)?this.learnMoreBaseUrl+"/":this.learnMoreBaseUrl;const t=this.locale.toLocaleLowerCase();!0===a.W.includes(t)&&(e=e.replace(/(\/|^)(en)(\/|$)/,`$1${t}$3`))}return e}getLearnMoreUrlForWebAnalysis(){let e;if(void 0!==this.learnMoreBaseUrl){const t=!0===this.portal?.isPortal?o.h.map:o.a.map,i=(0,n.g)(t,`${this.helpFileName}${(0,a.X)(this.analysisEngine)}.${this.helpId}`);if(void 0!==i&&void 0!==this.learnMoreBaseUrl){const t=this.getLocalizedLearnMoreUrl();if(!0===this.portal?.isPortal&&void 0!==this.portalHelpMap?.m){e=`${t}${this.portalHelpMap.m[i]}`;const{restUrl:s}=this.portal;e=(0,a.Y)(e,s)}else void 0!==this.portal&&!1!==this.portal?.isPortal||(e=`${t}analyze/${i}`)}}return e}getLearnMoreForCustomHelpMap(){let e;if(void 0!==this.externalHelpMap&&void 0!==this.helpId&&void 0!==this.helpFileName&&(e=(0,n.g)(this.externalHelpMap.map,`${this.helpFileName}.${this.helpId}`),void 0!==e&&void 0!==this.learnMoreBaseUrl)){const t="/"!==this.learnMoreBaseUrl.charAt(this.learnMoreBaseUrl.length-1)?this.learnMoreBaseUrl+"/":this.learnMoreBaseUrl;e=`${!0===this.isHelpFileExternalAsset?t:this.getLocalizedLearnMoreUrl()}${e}`}return e}getLearnMoreUrl(){let e;return void 0!==this.learnMoreBaseUrl?e=void 0!==this.externalHelpMap?this.getLearnMoreForCustomHelpMap():this.getLearnMoreUrlForWebAnalysis():void 0!==this.learnMoreUrl&&(e=this.learnMoreUrl),e}renderIframeUsingSrcDoc(){return(0,s.h)("iframe",{class:this.getContentStyleClass(this.helpId),id:this.helpId,title:this.heading??this.helpId,srcdoc:this.helpSrcdoc})}renderIframeUsingHelpUrl(){const e=!1===this.isHelpFileExternalAsset?(0,s.a)(this.helpUrl):this.helpUrl,t=void 0!==e?`${e}#${this.helpId}-${this.modifierClasses}`:"";return(0,s.h)("iframe",{class:this.getContentStyleClass(this.helpId),id:this.helpId,title:this.heading??this.helpId,src:t})}render(){let e,t;if(!1===(0,a.i)(this.helpSrcdoc))e=this.renderIframeUsingSrcDoc(),t=this.getLearnMoreUrl();else if(!1===(0,a.i)(this.helpUrl))e=this.renderIframeUsingHelpUrl(),t=this.getLearnMoreUrl();else{const i="toolDescription"===this.helpId?(0,n.g)(this.referenceElement?.getRootNode(),"host.webToolJSON.description"):this.referenceElement?.getAttribute("description");e=(0,s.h)("div",{key:"dfe6bc9dcd002ed4c8e67ef958f0e8811f9600dc",class:je},(0,s.h)("p",{key:"8861e2ac39776fea3727a6493328cc355e10c829"},i??"")),t=(0,n.g)(this.referenceElement?.getRootNode(),"host.webToolJSON.helpUrl")}return(0,s.h)(s.H,{key:"c7c4818504c01ac3aa64260008e470103ed4c8a2",class:`${Ee} ${Te}`,dir:this.dir,mode:this.mode},(0,s.h)("calcite-popover",{key:"ab04fbe94b727fd0d5e4bff6ba3c3cb7405b4eb1",overlayPositioning:"fixed",autoClose:!0,ref:e=>this.popoverElement=e,referenceElement:this.referenceElement??"analysis-tool",placement:this.placement,open:this.open,closable:!0,heading:this.heading??this.helpId,headingLevel:4,triggerDisabled:this.triggerDisabled,focusTrapDisabled:!0,label:this.heading??this.helpId??"",offsetDistance:this.offsetDistance,offsetSkidding:this.offsetSkidding,onCalcitePopoverClose:()=>this.analysisHelpPopoverClose.emit()},e,void 0!==t&&(0,s.h)("calcite-link",{key:"ce29190914204700ff6d8dabc08444b46fc23d5a",rel:"help",target:"_blank",href:t,class:Fe},this.strings.learnMoreLabel)))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{portal:["portalChange"]}}};Ve.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{display:flex;background-color:var(--calcite-color-foreground-1)}.help-iframe-s{padding:var(--analysis-quarter-spacing);min-height:var(--analysis-popover-content-min-height-s);max-height:var(--analysis-popover-content-max-height);border:0px}.help-iframe-m{padding:var(--analysis-quarter-spacing);min-height:var(--analysis-popover-content-min-height-m);max-height:var(--analysis-popover-content-max-height);border:0px}.help-custom-tool-param{font-size:12px;font-family:Verdana, Helvetica, sans-serif;overflow-y:auto;padding:var(--analysis-quarter-spacing);min-height:var(--analysis-popover-content-min-height-s);max-height:var(--analysis-popover-content-max-height);width:300px}.help-custom-tool-param p{margin:var(--analysis-half-spacing)}.learn-more{margin:var(--analysis-full-spacing)}";const Re="description-text",qe=class{constructor(e){(0,s.r)(this,e),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.getMessageText=()=>{const e=!0===this.user?.portal?.isPortal&&void 0!==this.portalHelpMap?this.portalHelpMap?.m[o.h.map.OtherHelpLinks.unsupportedGPType]:o.a.map.OtherHelpLinks.unsupportedGPType,t=(0,a.H)({url:e,basePath:(0,a.K)(this.user?.portal),portalUrl:this.user?.portal?.restUrl});let i="";return i="GPValueTable"===this.dataType?(0,a.a)(!1===this.isDefaultValueProvided()?this.strings.unsupportedParameterConfig:this.strings.unsupportedParameterConfigDefaultValue,{docLink:t}):(0,a.a)(!1===this.isDefaultValueProvided()?this.strings.unsupportedGPType:this.strings.defaultValue,{docLink:t}),i},this.isDefaultValueProvided=()=>!((0,a.i)(this.value)||Array.isArray(this.value)&&!this.value.some((e=>!(0,a.i)(e)))||"object"==typeof this.value&&"dataType"in this.value&&(0,a.i)(this.value.value)),this.dataType=void 0,this.label=void 0,this.required=!1,this.user=void 0,this.portalHelpMap=void 0,this.hideLabel=!1,this.value=void 0,this.isValid=!0}async componentWillLoad(){({strings:this.strings}=await(0,a.d)(this.hostElement,(0,s.a)(".")))}async checkValidity(){return this.isValid=this.required&&this.isDefaultValueProvided()||!this.required,Promise.resolve(this.isValid)}render(){return(0,s.h)(s.H,{key:"4ae50674c829496f1f612930a1851406e3b685a6"},!1===this.hideLabel&&(0,s.h)("analysis-label",{key:"e60b014e9eaebd0ca486e5089084f9ba5122fe62",label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit()}),(0,s.h)("div",{key:"fb4d5df1f7258413bd1336835cdb72ad07d95e78",innerHTML:this.getMessageText(),class:Re}),(0,s.h)("calcite-input-message",{key:"59efaf6a14c8059a1e15ac9d6de5ddc7234c9e96",status:"invalid",hidden:this.isValid,scale:a.U.Scale,icon:"exclamationMarkTriangle"},this.strings.requiredMessage))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}};qe.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}:host{margin-bottom:var(--analysis-half-spacing)}.description-text{color:var(--calcite-color-text-3);font-size:var(--calcite-font-size--2)}";const ze="border",He="mb-half",Ue="list-item",Ne={error:"__aborted__"},We=class{constructor(e){(0,s.r)(this,e),this.analysisQueryInputChange=(0,s.c)(this,"analysisQueryInputChange",7),this.analysisHelpClick=(0,s.c)(this,"analysisHelpClick",7),this.openModal=()=>{this.queryModal=document.createElement("analysis-query-modal"),this.queryModal.target=this.layer??this.expressionGroup?.layer??this.combinedLayers[0],this.queryModal.expressionGroup=this.expressionGroup,this.queryModal.layers=this.combinedLayers,this.queryModal.recordsTerm=this.recordsTerm,this.queryModal.mode=this.mode,this.queryModal.open=!0,this.queryModal.options=this.options,this.hasValue&&void 0!==this.value&&(this.queryModal.value=this.value),this.queryModal.addEventListener("analysisQueryModalAdd",this.onQueryModalAddClick),this.queryModal.addEventListener("analysisQueryModalError",this.onQueryModalError),this.queryModal.addEventListener("analysisQueryModalDismissed",this.onQueryModalDismissed),document.body.appendChild(this.queryModal)},this.closeModal=()=>{this.queryModal?.removeEventListener("analysisQueryModalAdd",this.onQueryModalAddClick),this.queryModal?.removeEventListener("analysisQueryModalError",this.onQueryModalError),this.queryModal?.removeEventListener("analysisQueryModalDismissed",this.onQueryModalDismissed),this.queryModal?.remove()},this.onQueryModalError=e=>{this.errorMessage=e.detail},this.onQueryModalAddClick=async e=>{const t=e.detail;this.value=await this.serializeExpressionGroup(t),this.analysisQueryInputChange.emit(this.value),this.validate()},this.serializeExpressionGroup=async e=>{let t;if("sql"===this.mode)t=e?.toSQL(this.options);else{const i=await(e?.toJSON(this.combinedLayers,this.mapView));void 0!==i?.expressions&&void 0!==i?.inputLayers&&(t={expressions:i?.expressions,inputLayers:i?.inputLayers})}return t},this.onQueryModalDismissed=()=>{this.closeModal(),this.validate()},this.onDeleteQuery=()=>{this.value=void 0,this.analysisQueryInputChange.emit(void 0),this.validate()},this.combinedLayers=void 0,this.valueLabel=void 0,this.errorMessage=void 0,this.loading=!0,this.expressionGroup=void 0,this.label=void 0,this.required=!1,this.mode="analysis",this.value=void 0,this.mapLayers=[],this.recordsTerm="features",this.disabledTooltip=void 0,this.options=void 0,this.mapView=void 0,this.layer=void 0}async valueChange(){if("analysis"===this.mode){const e=await this.loadGPQueryLayers(this.value,this.combinedLayers);this.combinedLayers=this.combineLayers(e.result??[],this.combinedLayers)}const e=await this.parseCurrentValue();this.expressionGroup=e.result,this.maybeSetFirstError([e]),this.setValueLabel()}setValueLabel(){const e="features"===this.recordsTerm?this.strings.featureValueHeader:this.strings.recordsValueHeader,t=this.expressionGroup?.layer;this.valueLabel=void 0!==t?(0,a.a)(e,{layer:t.title}):(0,a.a)(e,{layer:""})}async mapLayersChange(e){const t=await this.loadSupportedMapLayers(e),i=this.expressionGroup?.getUsedLayers(this.combinedLayers);this.combinedLayers=this.combineLayers(i??[],t.result??[]),this.maybeSetFirstError([t])}async targetLayerChange(e){if(void 0===e)return;const t=await this.loadTargetLayer(e),i=await this.parseCurrentValue();if(void 0===t.error&&void 0!==i.result){const e=await this.serializeExpressionGroup(i.result);this.value!==e?(this.value=e,this.analysisQueryInputChange.emit(this.value)):(this.expressionGroup=i.result,this.setValueLabel())}this.maybeSetFirstError([t,i])}get hasError(){return!1===(0,a.i)(this.errorMessage)}get hasValue(){let e;if("string"==typeof this.value)e=""!==this.value;else if(void 0!==this.value){const{expressions:t,inputLayers:i}=this.value;e=void 0!==t&&t.length>0&&void 0!==i&&i.length>0}else e=!1;return e}get canCreateQuery(){const e=void 0===this.layer||void 0!==this.layer.loadError&&null!==this.layer.loadError,t=void 0===this.combinedLayers||0===this.combinedLayers.length;return!(e&&t)}async componentWillLoad(){({strings:this.strings}=await(0,a.d)(this.hostElement,(0,s.a)("."))),this.loading=!0,this.loadInitialState().finally((()=>this.loading=!1))}async loadInitialState(){const e=await this.loadTargetLayer(this.layer),t=await this.loadSupportedMapLayers(this.mapLayers),i=t.result??[],s=await this.loadGPQueryLayers(this.value,i),a=s.result??[];void 0!==s.error&&(this.value=void 0,this.analysisQueryInputChange.emit()),this.combinedLayers=this.combineLayers(a,i);const r=[e,t,s].some((e=>void 0!==e.error)),n=await this.parseCurrentValue();if(void 0!==n.result&&(this.expressionGroup=n.result,this.setValueLabel(),!r)){const e=await this.serializeExpressionGroup(this.expressionGroup);this.value!==e&&(this.value=e,this.analysisQueryInputChange.emit(this.value))}this.maybeSetFirstError([e,t,s,n])}componentDidRender(){void 0!==this.tooltipRef&&null!==this.tooltipRef&&void 0!==this.addButtonRef&&(this.tooltipRef.referenceElement=this.addButtonRef)}disconnectedCallback(){this.abortController?.abort(),this.closeModal()}async checkValidity(){return Promise.resolve(this.validate())}render(){return!0===this.loading?this.renderLoadingState():this.hasValue?this.renderValueState():this.renderInitialState()}renderLoadingState(){return(0,s.h)(s.H,null,(0,s.h)("calcite-label",{scale:a.U.Scale},void 0!==this.label&&""!==this.label?(0,s.h)("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit()}):null,(0,s.h)("calcite-button",{appearance:"outline",kind:"neutral","icon-start":"plus",width:"full",scale:a.U.Scale,onClick:()=>{},loading:!0,disabled:!0},this.strings.createQuery)))}renderInitialState(){return(0,s.h)(s.H,null,(0,s.h)("calcite-label",{scale:a.U.Scale},void 0!==this.label&&""!==this.label?(0,s.h)("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit()}):null,(0,s.h)("calcite-button",{appearance:"outline",kind:"neutral","icon-start":"plus",width:"full",scale:a.U.Scale,onClick:()=>{this.canCreateQuery&&this.openModal()},disabled:!1===this.canCreateQuery,ref:e=>this.addButtonRef=e},this.strings.createQuery),!1===this.canCreateQuery&&(0,s.h)("calcite-tooltip",{referenceElement:this.addButtonRef,ref:e=>this.tooltipRef=e,overlayPositioning:"fixed"},this.disabledTooltip??this.strings.disabledTooltip)),(0,s.h)("calcite-input-message",{class:He,hidden:!this.hasError,icon:"exclamationMarkTriangle",status:a.b.INVALID,scale:a.U.Scale},!1===this.hasError?this.strings.isRequired:this.errorMessage))}renderValueState(){return(0,s.h)(s.H,null,(0,s.h)("calcite-label",{scale:a.U.Scale},void 0!==this.label&&""!==this.label?(0,s.h)("analysis-label",{label:this.label,required:this.required,onAnalysisLabelHelpActionClick:()=>this.analysisHelpClick.emit()}):null,(0,s.h)("calcite-list",{label:"",onClick:()=>this.openModal(),class:`${ze} ${He}`},(0,s.h)("calcite-list-item",{class:Ue,value:"query",label:this.valueLabel,description:this.strings.editDescription,disabled:"sql"===this.mode&&!this.canCreateQuery},(0,s.h)("calcite-action",{slot:"actions-end",icon:"pencil",text:this.strings.editAction})))),(0,s.h)("calcite-button",{class:He,appearance:"outline",kind:"neutral","icon-start":"trash",width:"full",scale:a.U.Scale,onClick:this.onDeleteQuery},this.strings.deleteQuery),(0,s.h)("calcite-input-message",{class:He,status:"invalid",scale:a.U.Scale,hidden:!this.hasError,icon:"exclamationMarkTriangle"},this.errorMessage))}async loadTargetLayer(e){let t;this.abortController?.abort(),this.abortController=new AbortController;try{await(e?.load({signal:this.abortController.signal})),t={result:void 0===e?void 0:e}}catch(e){if((0,a.w)(e))return Ne;const t="records"===this.recordsTerm?"targetDatasetLoadError":"layersLoadError";return{error:this.strings[t]}}return t}async loadSupportedMapLayers(e){let t;if(void 0===e)t={result:[]};else{const i=e.filter(a.Z).filter((e=>!e.isTable));await Promise.allSettled(i.map((e=>e.load())));const s=i.filter((e=>e.loaded));t=s.length!==i.length?{result:s,error:this.strings.layersLoadError}:{result:s}}return t}async loadGPQueryLayers(e,t){let i;if("string"!=typeof e&&Array.isArray(e?.inputLayers)){const s=(t??[]).reduce(((e,t)=>(e.set((0,r.k)(t),t),e)),new Map),n=e.inputLayers.filter((e=>!s.has(e.url)));try{const e=await(0,a._)(n);n.forEach(((t,i)=>s.set(t.url,e[i])))}catch{return{error:this.strings.layersLoadError}}i={result:e.inputLayers.map((e=>s.get(e.url))).filter((e=>void 0!==e))}}else i={result:[]};return i}combineLayers(e,t){const i=new Set,s=[];for(const a of[...e,...t]){const e=(0,r.k)(a);i.has(e)||(i.add(e),s.push(a))}return s}async parseCurrentValue(){let e,t;return"analysis"===this.mode&&"object"==typeof this.value?({group:e,errorKey:t}=await l.E.fromJSON(this.value.expressions,this.combinedLayers)):"sql"===this.mode&&"string"==typeof this.value&&({group:e,errorKey:t}=await l.E.fromSQL(this.value,this.layer,this.options)),void 0!==t?{result:e,error:this.strings[t]}:{result:e}}validate(){let e;return!this.hasValue&&this.required?(e=!1,this.errorMessage=this.strings.isRequired):(e=!0,this.errorMessage=void 0),e}maybeSetFirstError(e){const t=e.find((e=>void 0!==e.error));void 0!==t&&t.error!==Ne.error&&(this.errorMessage=t.error)}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}static get watchers(){return{value:["valueChange"],mapLayers:["mapLayersChange"],layer:["targetLayerChange"]}}};We.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}.border{border:1px solid var(--calcite-color-border-input)}.mb-half{margin-bottom:var(--analysis-half-spacing)}.list-item{--calcite-font-size--1:var(--calcite-font-size--2)}";const Ge="expression-tile-select-w-third",Qe="expression-tile-select-group",Je=class{constructor(e){(0,s.r)(this,e),this.analysisQueryModalAdd=(0,s.c)(this,"analysisQueryModalAdd",7),this.analysisQueryModalDismissed=(0,s.c)(this,"analysisQueryModalDismissed",7),this.analysisQueryModalError=(0,s.c)(this,"analysisQueryModalError",7),this.close=()=>{void 0!==this.containerRef&&(this.containerRef.open=!1)},this.onQueryError=e=>{this.analysisQueryModalError.emit(e.detail)},this.onTargetChange=e=>{this.target=e.target.target},this.onSelectExpressionType=e=>{const t=e.target;this.selectedExpressionType=t.value},this.onOnboardingNextClick=()=>{this.expressionGroup=this.createDefaultGroup(),this.isOnboarding=!1},this.onAddClick=()=>{this.analysisQueryModalAdd.emit(this.newValue??this.expressionGroup),this.close()},this.onClose=()=>{this.analysisQueryModalDismissed.emit()},this.onQueryChange=e=>{this.newValue=e.detail},this.selectedExpressionType="attribute",this.isOnboarding=!0,this.value=void 0,this.mode=void 0,this.expressionGroup=void 0,this.target=void 0,this.layers=[],this.open=void 0,this.recordsTerm="features",this.options=void 0}async componentWillLoad(){({strings:this.strings}=await(0,a.d)(this.hostElement,(0,s.a)("."))),this.isOnboarding=void 0===this.value||"string"!=typeof this.value&&this.value.expressions.length<1,await Promise.allSettled(this.layers.map((e=>e.load())))}componentDidRender(){void 0!==this.tooltipRef&&null!==this.tooltipRef&&void 0!==this.spatialExpressionTile&&(this.tooltipRef.referenceElement=this.spatialExpressionTile)}get loadedLayers(){return(0===this.layers.length&&void 0!==this.target?[this.target]:this.layers).filter((e=>e.loaded))}createDefaultGroup(){const e=this.target??this.loadedLayers[0];let t=new l.E(e,"and");return t="group"===this.selectedExpressionType?t.addNewGroup("and"):"spatial"===this.selectedExpressionType?t.addDefaultSpatialExpression(e,this.loadedLayers):t.addDefaultExpression(this.options),t}render(){return(0,s.h)("calcite-dialog",{key:"84162167c551d2682ceb68a74825ad3e18487d0c",modal:!0,escapeDisabled:!0,outsideCloseDisabled:!0,open:this.open,class:"query-modal",heading:this.strings.header,ref:e=>this.containerRef=e,onCalciteDialogClose:this.onClose},this.isOnboarding?this.renderOnboardingContent():this.renderQueryBuilder(),(0,s.h)("calcite-button",{key:"5b29c012cc93b0535c9ad13d0cf754e740fc512c",slot:"footer-end",appearance:"outline",onClick:this.close},this.strings.cancel),(0,s.h)("calcite-button",{key:"fa71e3cc2a87cef7b4f044965335c6cc8967fb80",slot:"footer-end",onClick:this.isOnboarding?this.onOnboardingNextClick:this.onAddClick},this.isOnboarding?this.strings.next:this.strings.add))}renderOnboardingContent(){const e=new Set(this.layers.map(r.k)),t="sql"!==this.mode?Ge:"";return(0,s.h)(s.F,null,(0,s.h)("analysis-query-target-select",{target:this.target,layers:this.loadedLayers,onAnalysisQueryTargetSelectChange:this.onTargetChange,recordsTerm:this.recordsTerm,disabled:"sql"===this.mode}),(0,s.h)("calcite-tile-select-group",{class:Qe},(0,s.h)("calcite-tile-select",{class:t,heading:this.getString(this.strings.attributeExpressionTitle,this.strings.expressionTitle),description:this.getString(this.strings.attributeExpressionDescription,this.strings.expressionDescription),checked:"attribute"===this.selectedExpressionType||void 0,icon:"list-check",value:"attribute",inputEnabled:!0,inputAlignment:"end",onCalciteTileSelectChange:this.onSelectExpressionType}),"sql"!==this.mode&&(0,s.h)(s.F,null,(0,s.h)("calcite-tile-select",{class:t,ref:e=>{e&&(this.spatialExpressionTile=e)},heading:this.strings.spatialExpressionTitle,description:this.strings.spatialExpressionDescription,checked:"spatial"===this.selectedExpressionType||void 0,icon:"geographic-link-chart-layout",value:"spatial",disabled:e.size>1==!1,inputEnabled:!0,inputAlignment:"end",onCalciteTileSelectChange:this.onSelectExpressionType}),e.size>1==!1&&(0,s.h)("calcite-tooltip",{referenceElement:this.spatialExpressionTile,ref:e=>this.tooltipRef=e,overlayPositioning:"fixed",placement:"top"},this.strings.spatialExpressionTwoLayers)),(0,s.h)("calcite-tile-select",{class:t,heading:this.strings.expressionGroupTitle,description:this.strings.expressionGroupDescription,checked:"group"===this.selectedExpressionType||void 0,icon:"group-form-plus",value:"group",inputEnabled:!0,inputAlignment:"end",onCalciteTileSelectChange:this.onSelectExpressionType})))}renderQueryBuilder(){return(0,s.h)("analysis-query-builder",{expressionGroup:this.expressionGroup,layers:this.loadedLayers,mode:this.mode,recordsTerm:this.recordsTerm,onAnalysisQueryChange:this.onQueryChange,onAnalysisQueryError:this.onQueryError,options:this.options})}getString(e,t){return"features"===this.recordsTerm?e:t}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}};Je.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}.query-modal{--calcite-dialog-background-color:var(--calcite-color-foreground-1)}.expression-tile-select-group{justify-content:center}.expression-tile-select-w-third{width:33%}";class Ke{constructor(){this.requestCache={}}getOrPut(e,t){const i=this.requestCache[t];return null==i&&(this.requestCache[t]=e()),this.requestCache[t]}}const Ye=class{constructor(e){(0,s.r)(this,e),this.analysisQueryChange=(0,s.c)(this,"analysisQueryChange",7),this.analysisQueryError=(0,s.c)(this,"analysisQueryError",7),this.cache=new Ke,this.onGroupChange=e=>{this.workingExpressionGroup=e.target.expressionGroup,this.analysisQueryChange.emit(this.workingExpressionGroup)},this.onTargetChange=e=>{const t=e.target.target;this.workingExpressionGroup=this.workingExpressionGroup.changeTarget(t),this.analysisQueryChange.emit(this.workingExpressionGroup)},this.resetError=()=>{this.errorMessage=void 0,this.analysisQueryError.emit(this.errorMessage)},this.errorMessage=void 0,this.mode=void 0,this.options=void 0,this.expressionGroup=void 0,this.workingExpressionGroup=void 0,this.recordsTerm="features",this.layers=[]}get hasError(){return void 0!==this.errorMessage}async componentWillLoad(){let e;({strings:this.strings,locale:e}=await(0,a.d)(this.hostElement,(0,s.a)("."))),(0,l.s)(this.strings,e),this.workingExpressionGroup=this.expressionGroup.clone()}render(){return(0,s.h)(s.H,{key:"86f02bd0b581c0d69c20d40a766966701829a378"},(0,s.h)("analysis-query-target-select",{key:"c3edc581a542d377471e8d5a8ae43166cf653ba3",target:this.workingExpressionGroup.layer,layers:this.layers,onAnalysisQueryTargetSelectChange:this.onTargetChange,disabled:"sql"===this.mode,recordsTerm:this.recordsTerm}),(0,s.h)("analysis-expression-group",{key:"56bc074543823c8e1c17f84b08d00efc18b0c151",expressionGroup:this.workingExpressionGroup,layers:this.layers,cache:this.cache,onAnalysisExpressionGroupChange:this.onGroupChange,recordsTerm:this.recordsTerm,mode:this.mode,allowedExpressions:"sql"===this.mode?["attribute","group"]:["attribute","group","spatial"],options:this.options}),this.hasError&&(0,s.h)("calcite-notice",{key:"03763074ffc4581d814b5aa7d814cf0a71ad6861",class:l.H.errorNotice,open:!0,kind:"danger",closable:!0,scale:a.U.Scale,width:"auto",onCalciteNoticeClose:this.resetError},(0,s.h)("div",{key:"ce4b8357c83689d46ad77a8735ba9d79c36fa6eb",slot:"title"},this.strings.error),(0,s.h)("div",{key:"a1f8c6c8607d097f51bf200c022631db5efebbe0",slot:"message"},this.errorMessage)))}static get assetsDirs(){return["t9n"]}get hostElement(){return(0,s.g)(this)}};Ye.style=":root{--analysis-quarter-spacing:0.25rem;--analysis-half-spacing:0.5rem;--analysis-three-quarter-spacing:0.75rem;--analysis-full-spacing:1rem;--analysis-component-default-width:100%;--analysis-ui-border-input:var(--calcite-color-border-2);--analysis-label-font-size:var(--calcite-font-size--2);--analysis-popover-content-min-height-s:7.5rem;--analysis-popover-content-min-height-m:8.75rem;--analysis-popover-content-max-height:60vh;--analysis-popover-content-height:45vh;--analysis-popover-z-index:calc(var(--calcite-z-index-overlay) - 1)}.error-notice{margin-top:var(--analysis-half-spacing)}"}}]);