/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-1e85d6.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm-1e85d6"],{32382:(e,t,i)=>{i.r(t),i.d(t,{arcgis_smart_mapping_relationship_color_slider:()=>p,arcgis_smart_mapping_relationship_focus_button:()=>f,arcgis_smart_mapping_relationship_legend:()=>g});var s=i(28614),o=i(48122),a=(i(68180),i(99592)),n=i(54351),l=i(98518),r=i(66215),c=i(33101),u=i(372),d=i(97127),h=i(42444);i(71480);const p=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingRelationshipColorSliderChange=(0,s.c)(this,"arcgisSmartMappingRelationshipColorSliderChange",7),this.arcgisSmartMappingRelationshipColorSliderError=(0,s.c)(this,"arcgisSmartMappingRelationshipColorSliderError",7),this.manager=(0,d.u)(this),this.currentBreakValues=[],this.smartMappingState=(0,c.u)(),this.fieldPos=void 0,this.histogramStatus=a.s.MISSING,this.statisticsStatus=a.s.MISSING}async updateStatistics(){this.statisticsStatus=a.s.MISSING,this.statistics=void 0,this.histogramStatus=a.s.MISSING,this.histogram=void 0,this.colorSlider?.destroy(),this.colorSlider=void 0,this.getStatistics()}componentWillLoad(){this.flowItemNode=(0,o.f)(this.el,"calcite-flow-item"),this.getStatistics()}componentDidLoad(){(0,h.i)(this.el.shadowRoot,this.smartMappingState.modules.esriConfig)}render(){const{statisticsStatus:e,smartMappingState:t}=this,{strings:i}=t,o=(0,a.j)(t).authoringInfo;if(e===a.s.FAILED||e===a.s.MISSING)return this.colorSlider?.destroy(),this.colorSlider=void 0,(0,s.h)(s.F,null);if(this.statisticsStatus===a.s.IN_PROGRESS||this.histogramStatus===a.s.IN_PROGRESS&&!this.colorSlider)return this.renderColorSliderLoading();{const e=this.prepareColorSlider(),t=0===this.fieldPos?o.field1.classBreakInfos:o.field2.classBreakInfos;return this.currentBreakValues=t.map((e=>({min:e.minValue,max:e.maxValue}))),(e||this.colorSlider)&&this.colorSlider.min!==this.colorSlider.max?(0,s.h)("div",{class:"slider-box"},(0,s.h)("calcite-label",null,i.panels.relationship.dataRange),(0,s.h)("div",{ref:e=>{e&&this.afterColorSliderCreate(e)}})):this.colorSlider&&this.colorSlider.min===this.colorSlider.max?(0,s.h)(s.F,null):this.renderColorSliderLoading()}}renderColorSliderLoading(){const{strings:e}=this.smartMappingState;return(0,s.h)("div",{class:"slider-box"},(0,s.h)("calcite-loader",{label:e.loading}))}afterColorSliderCreate(e){if(this.colorSlider.container)e.append(this.colorSlider.container);else{const t=document.createElement("div");t.classList.add("slider-container"),e.append(t),this.colorSlider.container=t}}createColorSliderChangeEvents(){this.colorSlider&&(this.colorSlider.on("min-change",(e=>{e.value>this.currentBreakValues[0].max?this.onMinMaxChange(this.currentBreakValues[0].max,this.colorSlider.slider.max):this.onMinMaxChange(e.value,this.colorSlider.slider.max)})),this.colorSlider.on("max-change",(e=>{e.value<this.currentBreakValues[this.currentBreakValues.length-1].min?this.onMinMaxChange(this.colorSlider.slider.min,this.currentBreakValues[this.currentBreakValues.length-1].min):this.onMinMaxChange(this.colorSlider.slider.min,e.value)})),this.colorSlider.on("thumb-change",(()=>{this.updateRendererBreaks(this.colorSlider.breaks)})),this.colorSlider.on("thumb-drag",(()=>{this.updateRendererBreaks(this.colorSlider.breaks)})))}getClassBreaksColors(){const{smartMappingState:e}=this,{modules:t}=e,i=(0,a.j)(e),s=i.authoringInfo,o=(0===this.fieldPos?s.field1.classBreakInfos:s.field2.classBreakInfos).map((e=>({min:e.minValue,max:e.maxValue,color:new t.EsriColor([0,0,0])})));let n=new t.EsriColor([0,0,0,1]),l=new t.EsriColor([0,0,0,1]);i.uniqueValueGroups[0].classes.forEach((t=>{"HH"===t.values[0].value?n=(0,a.Z)(e,t.symbol):"LL"===t.values[0].value&&(l=(0,a.Z)(e,t.symbol))}));let r=(n.r+n.g+n.b)/3;const c=(l.r+l.g+l.b)/3;if(2===o.length)o[1].color=new t.EsriColor([r,r,r,1]),o[0].color=new t.EsriColor([c,c,c,1]);else if(3===o.length)o[2].color=new t.EsriColor([r,r,r,1]),r=(r+c)/2,o[1].color=new t.EsriColor([r,r,r,1]),o[0].color=new t.EsriColor([c,c,c,1]);else{o[3].color=new t.EsriColor([r,r,r,1]);let e=r+(c-r)/3;o[2].color=new t.EsriColor([e,e,e,1]),e=r+2*(c-r)/3,o[1].color=new t.EsriColor([e,e,e,1]),o[0].color=new t.EsriColor([c,c,c,1])}return o}getHistogram(e,t,i,s,o){const{layer:n,useFeatureReduction:l,mapView:r,modules:c}=this.smartMappingState,u=n;(i=i||this.statistics)&&0!==i.count&&(this.histogramStatus=a.s.IN_PROGRESS,c.histogram({layer:u,view:r,field:e.field??void 0,numBins:50,minValue:s??i.min,maxValue:o??i.max,normalizationField:t,forBinning:"featureReduction"in u&&"binning"===u.featureReduction?.type&&l}).then((e=>{this.histogram=e,this.histogramStatus=a.s.SUCCESS}),(e=>{console.log("error-histogram",e),this.histogramStatus=a.s.FAILED})))}getStatistics(){const{smartMappingState:e}=this,{layer:t,useFeatureReduction:i,mapView:s,modules:o}=e,n=t,l=(0,a.j)(e).authoringInfo,r=0===this.fieldPos?l.field1:l.field2,c=r.classBreakInfos;if(!c||this.statistics)return;const u={field:r.field,simpleFieldType:a.q.NUMBER},d=r.normalizationField;let h=c[0].minValue,p=c[c.length-1].maxValue;this.statisticsStatus=a.s.IN_PROGRESS,o.summaryStatistics({layer:n,view:s,field:r.field,normalizationField:d,forBinning:"featureReduction"in n&&"binning"===n.featureReduction?.type&&i,outStatisticTypes:{exclude:["median"]}}).then((e=>{if(0===e.count)e.min=0,e.max=100,e.avg=(p+h)/2;else if(!(0,a.M)(e.avg)||!(0,a.M)(e.min)||!(0,a.M)(e.max))return void(this.statisticsStatus=a.s.FAILED);e=(0,a.ag)(e),h=h??e.min??void 0,p=p??e.max??void 0,this.statistics=e,this.statisticsStatus=a.s.SUCCESS,this.getHistogram(u,d,e,h,p)}),(e=>{console.log("error-summaryStatistics",e),this.statisticsStatus=a.s.FAILED}))}onMinMaxChange(e,t){const{statistics:i,smartMappingState:s}=this,o=(0,a.j)(s),l=o.authoringInfo,c=0===this.fieldPos?l.field1:l.field2,d=c.normalizationField,h={field:c.field,simpleFieldType:a.q.NUMBER},p=0===this.fieldPos?l.field1.classBreakInfos:l.field2.classBreakInfos;p[0].minValue=e,p[p.length-1].maxValue=t,(0,n.r)((0,u.u)(s),this.flowItemNode).then((o=>{(0,a.u)(s,o),this.getHistogram(h,d,i,e,t),(0,r.u)(s,this.colorSlider,this.colorSliderBars,this.getClassBreaksColors(),this.histogram)})),o.authoringInfo.classificationMethod="manual",this.arcgisSmartMappingRelationshipColorSliderChange.emit()}prepareColorSlider(){const{statistics:e,histogram:t,histogramStatus:i,smartMappingState:s}=this,{modules:o}=s,n=(0,a.j)(s).authoringInfo,c=0===this.fieldPos?n.field1.classBreakInfos:n.field2.classBreakInfos;if(!c||i===a.s.IN_PROGRESS)return!1;let u=c[0].minValue,d=c[c.length-1].maxValue;if(({min:u,max:d}=(0,a.ag)({min:u,max:d})),this.colorSlider){const i=this.colorSlider;if("dragging"===i.slider?.state)return!0;const o=this.getClassBreaksColors(),a=(0,l.g)(o),n={histogramConfig:{bins:t?.bins,average:Math.round(10*e.avg)/10,standardDeviation:e.stddev,standardDeviationCount:1,barCreatedFunction:t&&this.colorSliderBars&&r.b.bind(this,s,o,t,this.colorSliderBars)},min:u??e.min,max:d??e.max,breaks:o,precision:a};(0,r.u)(s,i,this.colorSliderBars,o,t),this.colorSlider.set(n)}else{const e=this.getClassBreaksColors(),t=(0,l.g)(e),i={histogramConfig:{bins:this.histogram?.bins,average:Math.round(10*this.statistics.avg)/10,standardDeviation:this.statistics.stddev,standardDeviationCount:1,barCreatedFunction:this.histogram&&r.b.bind(this,s,e,this.histogram,this.colorSliderBars)},min:u??this.statistics.min,max:d??this.statistics.max,breaks:e,precision:t};this.colorSliderBars=[],(0,r.u)(s,this.colorSlider,this.colorSliderBars,e,this.histogram),this.colorSlider=new o.ClassedColorSlider(i),this.colorSlider&&this.colorSlider.min===this.colorSlider.max&&this.colorSlider.set(i),this.createColorSliderChangeEvents()}return(0,a.M)(this.colorSlider)}updateRendererBreaks(e){const{smartMappingState:t}=this,i=(0,a.j)(t).authoringInfo,s=0===this.fieldPos?i.field1:i.field2;i.classificationMethod="manual",s.classBreakInfos&&(s.classBreakInfos.forEach(((t,i)=>{t.minValue===e[i].min&&t.maxValue===e[i].max||(t.minValue=e[i].min,t.maxValue=e[i].max,this.currentBreakValues[i].min=e[i].min,this.currentBreakValues[i].max=e[i].max)})),(0,n.r)((0,u.u)(t),this.flowItemNode).then((e=>{(0,a.u)(t,e),(0,r.u)(t,this.colorSlider,this.colorSliderBars,this.getClassBreaksColors(),this.histogram)})),this.arcgisSmartMappingRelationshipColorSliderChange.emit())}get el(){return(0,s.g)(this)}};p.style=".slider-box{height:310px;margin-top:6px}.esri-classed-color-slider{min-width:200px}.esri-classed-color-slider__histogram-container{width:70px}.esri-classed-color-slider .esri-slider .esri-slider__content{height:200px}.esri-classed-color-slider .esri-slider .esri-slider__label,.esri-classed-color-slider .esri-slider .esri-slider__min,.esri-classed-color-slider .esri-slider .esri-slider__max{text-decoration:underline}.esri-classed-color-slider .esri-slider .esri-slider__label:hover,.esri-classed-color-slider .esri-slider .esri-slider__min:hover,.esri-classed-color-slider .esri-slider .esri-slider__max:hover{border:1px solid #bbb;background-color:#f3f3f3;text-decoration:none;z-index:1}.slider-container{overflow:hidden}";const f=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingRelationshipFocusButtonChange=(0,s.c)(this,"arcgisSmartMappingRelationshipFocusButtonChange",7),this.arcgisSmartMappingRelationshipFocusButtonBeforeOpen=(0,s.c)(this,"arcgisSmartMappingRelationshipFocusButtonBeforeOpen",7),this.arcgisSmartMappingRelationshipFocusButtonError=(0,s.c)(this,"arcgisSmartMappingRelationshipFocusButtonError",7),this.manager=(0,d.u)(this),this.open=!1,this.smartMappingState=(0,c.u)(),this.flowItemNode=void 0,this.selectedFocusInfo=void 0}async setFocus(){this.buttonNode?.focus()}componentWillLoad(){const{strings:e}=this.smartMappingState,t=(0,a.j)(this.smartMappingState);this.focusInfos=[{focus:"HH",title:e.relationshipFocusButton.focusHighHigh,msg:e.relationshipFocusButton.focusHighHighMsg,selected:!1,iconPath:null},{focus:"HL",title:e.relationshipFocusButton.focusHighLow,msg:e.relationshipFocusButton.focusHighLowMsg,selected:!1,iconPath:null},{focus:"LH",title:e.relationshipFocusButton.focusLowHigh,msg:e.relationshipFocusButton.focusLowHighMsg,selected:!1,iconPath:null},{focus:"LL",title:e.relationshipFocusButton.focusLowLow,msg:e.relationshipFocusButton.focusLowLowMsg,selected:!1,iconPath:null},{focus:"none",title:e.relationshipFocusButton.none,msg:e.relationshipFocusButton.focusNoneMsg,selected:!this.selectedFocusInfo,iconPath:null}],this.setSelectedFocus(t.authoringInfo.focus||"none")}render(){const{strings:e}=this.smartMappingState;return(0,s.h)(s.H,{key:"af217c8d9bb5313334d87c94c759f058874e8096"},(0,s.h)("calcite-label",{key:"7bd369e31d187ccd6821a9e636abd18cc4caa0c2",class:"focus-margin"},e.relationshipFocusButton.focus,(0,s.h)("div",{key:"d6498911851760f13eb25c1b43e585adce9a4cb1",class:"focus-button",role:"button",tabindex:"0","aria-haspopup":"true","aria-label":e.relationshipFocusButton.focus,ref:e=>{e&&(this.buttonNode=e)},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.openFocusDropdown())},onClick:()=>this.openFocusDropdown()},(0,s.h)("div",{key:"80e9e069de8e95f7c4071de50a3be40906c7e7dd",class:"focus-content"},(0,s.h)("div",{key:"6bec30a2992875f66461a4e2a81d015b7430da7f",class:"focus-button-text"},(0,s.h)("div",{key:"bb4d458990fef74ea787ee8b6a450be8b0e13161",class:"focus-button-title"},this.selectedFocusInfo.title),(0,s.h)("div",{key:"4bf0ae0c7debedb82ae723d5ff50faf307cdd1b3",class:"focus-button-msg"},this.selectedFocusInfo.msg)),(0,s.h)("div",{key:"4816a8eb392c71112ecfd4afa236ce9ceb50ca54"},(0,s.h)("calcite-icon",{key:"20fa7c0f66486f7ca08d0f6830e9416789e1dda9",scale:"s",icon:"chevron-down"}))))))}closeDropdown(){this.open=!1,this.dropdownNode&&(this.dropdownNode.parentNode?.removeChild(this.dropdownNode),this.dropdownNode=void 0,this.buttonNode.classList.remove("active"))}openFocusDropdown(){const{smartMappingState:e}=this;if(this.open)this.open=!1;else{this.arcgisSmartMappingRelationshipFocusButtonBeforeOpen.emit();const t=document.createElement("arcgis-smart-mapping-dropdown");t.smartMappingState=e,t.buttonNode=this.buttonNode,t.infos=this.focusInfos,this.dropdownNode=t,t.addEventListener("arcgisSmartMappingDropdownClose",(e=>{this.closeDropdown(),"Escape"===e.detail&&this.setFocus()})),t.addEventListener("arcgisSmartMappingDropdownChange",(e=>this.setNewFocus(e.detail))),t.addEventListener("arcgisSmartMappingDropdownDisconnected",(()=>this.closeDropdown())),this.buttonNode.classList.add("active"),document.body.appendChild(t),this.open=!0}}setNewFocus(e){const{smartMappingState:t}=this,i=(0,a.j)(t).authoringInfo.focus,s=e.focus;if(s===i)return this.closeDropdown(),void setTimeout((()=>{this.setFocus()}),300);(0,n.r)((0,u.u)(t,{focus:s}),this.flowItemNode).then((i=>{this.setSelectedFocus(e.focus);(0,a.j)(t).uniqueValueInfos.forEach((e=>{i.uniqueValueInfos.find((t=>e.value===t.value)).label=e.label})),(0,a.u)(t,i),setTimeout((()=>{this.setFocus()}),300),this.arcgisSmartMappingRelationshipFocusButtonChange.emit()}),(e=>{setTimeout((()=>{this.setFocus()})),this.arcgisSmartMappingRelationshipFocusButtonError.emit(e)})),this.closeDropdown()}setSelectedFocus(e){this.focusInfos.forEach((t=>{t.focus===e?(this.selectedFocusInfo=t,t.selected=!0):t.selected=!1}))}get el(){return(0,s.g)(this)}};var m;f.style=".focus-button{display:flex;padding:6px;justify-content:space-between;align-items:center;border-radius:0;cursor:pointer;background-color:var(--calcite-color-foreground-1);color:var(--calcite-color-text-1);border-color:var(--calcite-color-foreground-3);border-width:2px;border-style:solid;box-shadow:transparent 0px 0px 0px 1px inset}.focus-button:active{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3)}.focus-button:focus{box-shadow:inset 0 0 0 1px var(--calcite-color-foreground-3);outline:2px solid var(--calcite-color-brand);outline-offset:2px}.focus-button.active{outline:1px solid var(--calcite-ui-focus-color, var(--calcite-color-brand))}.focus-content{justify-content:space-between;display:flex;align-items:center;width:100%}.focus-button-text{display:inline-block;padding:0 10px}.focus-button-title{font-weight:bold}.focus-button-msg{font-size:80%;line-height:16px}.focus-margin{margin:12px 0}",function(e){e.focusUp16="M8,0.29 L0.29,8 L8,15.71 L15.71,8 L8,0.29 Z M1.71,8 L5.93,3.78 L8,5.85 L10.07,3.78 L14.29,8 L8,14.29 L1.71,8 Z",e.focusRight16="M8,0.29 L0.29,8 L8,15.71 L15.71,8 L8,0.29 Z M1.71,8 L8,1.71 L12.22,5.93 L10.15,8 L12.22,10.07 L8,14.29 L1.71,8 Z",e.focusLeft16="M8,0.29 L0.29,8 L8,15.71 L15.71,8 L8,0.29 Z M3.78,10.07 L5.85,8 L3.78,5.93 L8,1.71 L14.29,8 L8,14.29 L3.78,10.07 Z",e.focusDown16="M8,0.29 L0.29,8 L8,15.71 L15.71,8 L8,0.29 Z M8,1.71 L14.29,8 L10.07,12.22 L8,10.15 L5.93,12.22 L1.71,8 L8,1.71 Z",e.code16="M6.865 13.965l-.957-.29 3.213-10.62.957.29zM15.19 8.45l-3.837-3.805-.704.71 3.131 3.104-3.135 3.19.712.702zm-9.833 3.2L2.221 8.458l3.13-3.104-.703-.71L.811 8.45l3.833 3.9z",e.fields16="M10.578 1A2.425 2.425 0 0 1 13 3.422V6c0 .552.448 1 1 1v1c-.552 0-1 .448-1 1v2.578A2.425 2.425 0 0 1 10.578 14H10v-1h.578c.785 0 1.421-.637 1.422-1.422V9c0-.574.247-1.121.679-1.5A1.995 1.995 0 0 1 12 6V3.422c0-.785-.637-1.421-1.422-1.422H10V1h.578zM6 1v1h-.578C4.637 2 4.001 2.637 4 3.422V6c0 .574-.247 1.121-.679 1.5.432.379.68.926.679 1.5v2.578c0 .785.637 1.421 1.422 1.422H6v1h-.578A2.425 2.425 0 0 1 3 11.578V9c0-.552-.448-1-1-1V7c.552 0 1-.448 1-1V3.422A2.425 2.425 0 0 1 5.422 1H6z"}(m||(m={}));const g=class{constructor(e){(0,s.r)(this,e),this.arcgisSmartMappingRelationshipLegendFocusChange=(0,s.c)(this,"arcgisSmartMappingRelationshipLegendFocusChange",7),this.arcgisSmartMappingRelationshipLegendError=(0,s.c)(this,"arcgisSmartMappingRelationshipLegendError",7),this.manager=(0,d.u)(this),this.valueTextNodes=[],this.smartMappingState=(0,c.u)()}componentWillLoad(){this.flowItemNode=(0,o.f)(this.el,"calcite-flow-item")}disconnectedCallback(){this.smartMappingState.selectedValue=void 0}render(){const{strings:e}=this.smartMappingState;return(0,s.h)("calcite-block",{key:"3b3b61272d7c96a23bc7dd0ad1537f6ca922b573",open:!0,heading:e.relationshipLegend.legend,collapsible:!0},this.renderContent())}renderContent(){return(0,s.h)("div",null,(0,s.h)("div",{class:"attributes"},this.renderAttribute(0),this.renderAttribute(1)),this.renderFocus(),this.renderLabels())}renderAttribute(e){const{smartMappingState:t}=this,i=(0,a.j)(t).authoringInfo,o=0===e?i.field1:i.field2,n=(0,a.o)(t,o.field),l=this.getColorOrder(e);return(0,s.h)("div",{class:"attribute"},(0,s.h)("div",{class:"attribute-color-icon","aria-hidden":"true"},l.map(((e,t)=>this.getSwatch(l[t])))),(0,s.h)("div",{class:"attribute-name"},n.label))}renderFocus(){const e=this.flowItemNode;return(0,s.h)("arcgis-smart-mapping-relationship-focus-button",{flowItemNode:e,onArcgisSmartMappingRelationshipFocusButtonBeforeOpen:()=>(0,a.B)(),onArcgisSmartMappingRelationshipFocusButtonChange:()=>{this.arcgisSmartMappingRelationshipLegendFocusChange.emit(),(0,s.f)(this.el)},onArcgisSmartMappingRelationshipFocusButtonError:({detail:e})=>this.arcgisSmartMappingRelationshipLegendError.emit(e)})}renderLabels(){const{smartMappingState:e}=this,{strings:t}=e,i=(0,a.j)(e).authoringInfo.numClasses;return(0,s.h)("calcite-label",null,t.relationshipLegend.labels,(0,s.h)("calcite-list",{label:t.relationshipLegend.labels},this.renderLabel(0),this.renderLabel(i-1),this.renderLabel(i*i-i),this.renderLabel(i*i-1)))}renderLabel(e){const{smartMappingState:t}=this,i=(0,a.j)(t).authoringInfo,o=i.numClasses,n=i.focus,l=0===e?m.focusUp16:e===("LH"===n||"HL"===n?o*o-o:o-1)?m.focusLeft16:e===("LH"===n||"HL"===n?o-1:o*o-o)?m.focusRight16:m.focusDown16;return(0,s.h)("calcite-list-item",null,this.renderIconNode(l),this.renderTextNode(e))}renderIconNode(e){const{smartMappingState:t}=this,i=!(0,a.j)(t).authoringInfo.focus;return(0,s.h)("div",{slot:"actions-start",class:"label-icon"},(0,s.h)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",width:"16",height:"16",class:i?"rotate-45":""},(0,s.h)("path",{d:e})))}renderTextNode(e){const{smartMappingState:t}=this,{strings:i}=t,o=(0,a.j)(t),n=o.authoringInfo,l=n.numClasses,r=n.focus,c=o.uniqueValueInfos[e],u=0===e?i.relationshipLegend.accessibility.editLabelForTop:e===("LH"===r||"HL"===r?l*l-l:l-1)?i.relationshipLegend.accessibility.editLabelForLeft:e===("LH"===r||"HL"===r?l-1:l*l-l)?i.relationshipLegend.accessibility.editLabelForRight:i.relationshipLegend.accessibility.editLabelForBottom;return this.selectedLabelText===e?(0,s.h)("calcite-input",{slot:"content",scale:"s",value:c.label??void 0,onFocusout:t=>{const i=t.target;this.handleLabelTextChange(e,i.value)},onKeyDown:t=>{if(t.stopPropagation(),"Escape"===t.key||"Enter"===t.key){const i=t.target;this.handleLabelTextChange(e,i.value)}},ref:e=>{e?.setFocus()}}):(0,s.h)("div",{class:"label",slot:"content",tabIndex:0,"aria-label":u,onClick:()=>this.handleLabelTextClick(e),onKeyUp:t=>{" "!==t.key&&"Enter"!==t.key||this.handleLabelTextClick(e)},ref:t=>{t&&(this.valueTextNodes[e]=t)}},c.label)}getColorOrder(e){const{smartMappingState:t}=this,i=(0,a.j)(t).authoringInfo||{};let s=[];if(2===i.numClasses)switch(i.focus){case"HH":default:s=0===e?[3,1]:[3,2];break;case"HL":s=0===e?[2,0]:[2,3];break;case"LH":s=0===e?[1,3]:[1,0];break;case"LL":s=0===e?[0,2]:[0,1]}else if(3===i.numClasses)switch(i.focus){case"HH":default:s=0===e?[8,5,2]:[8,7,6];break;case"HL":s=0===e?[6,3,0]:[6,7,8];break;case"LH":s=0===e?[2,5,8]:[2,1,0];break;case"LL":s=0===e?[0,3,6]:[0,1,2]}else switch(i.focus){case"HH":default:s=0===e?[15,11,7,3]:[15,14,13,12];break;case"HL":s=0===e?[12,8,4,0]:[12,13,14,15];break;case"LH":s=0===e?[3,7,11,15]:[3,2,1,0];break;case"LL":s=0===e?[0,4,8,12]:[0,1,2,3]}return s}getSwatch(e){const{smartMappingState:t}=this,i=(0,a.j)(t);return(0,s.h)("div",{class:"attribute-color-icon-selection",ref:s=>{if(s){const o=(0,a.Z)(t,i.uniqueValueInfos[e].symbol);s.style.width=100/i.authoringInfo.numClasses+"px",s.style.backgroundColor=o?.toHex()||"#ffffff"}}})}handleLabelTextClick(e){this.smartMappingState.selectedValue=e,this.selectedLabelText=e,(0,s.f)(this.el)}handleLabelTextChange(e,t){const{smartMappingState:i}=this;(0,a.j)(i).uniqueValueInfos[e].label=t,this.selectedLabelText=void 0,(0,a.u)(i),(0,s.f)(this.el),setTimeout((()=>{this.smartMappingState.selectedValue===e&&(this.valueTextNodes[e]?.focus(),this.smartMappingState.selectedValue=void 0)}),300)}get el(){return(0,s.g)(this)}};g.style=".attribute {\n  display: flex;\n  padding-bottom: 6px;\n}\n\n.attributes {\n  margin: 12px 0;\n}\n\n.attribute-name {\n  padding: 0 10px;\n  width: calc(100% - 45px);\n  word-break: break-all;\n}\n.attribute-color-icon {\n  width: 45px;\n  height: 16px;\n  overflow: hidden;\n  border-radius: 3px;\n  display: flex;\n  align-self: center;\n}\n\n.attribute-color-icon-selection {\n  height: 16px;\n  display: inline-block;\n}\n\n.label {\n  display: flex;\n  padding: 6px 0;\n  align-items: center;\n  div {\n    display: flex;\n    //flex-direction: row;\n  }\n}\n.label-icon {\n  color: rgba(50, 50, 50, 0.4);\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  cursor: default;\n\n  .rotate-45 {\n    -webkit-transform: rotate(45deg);\n    -moz-transform: rotate(45deg);\n    -ms-transform: rotate(45deg);\n    -o-transform: rotate(45deg);\n    transform: rotate(45deg);\n  }\n}\n"},54351:(e,t,i)=>{let s,o;function a(e){e.loading=!1}async function n(e,t){return function(e){e.loading=!0,o=!1,s&&clearTimeout(s),s=setTimeout((()=>{a(e),o=!0}),6e4)}(t),await e.then((e=>{if(a(t),o)throw new Error("timeout");return e})).catch((e=>{throw a(t),e}))}i.d(t,{r:()=>n})},98518:(e,t,i)=>{i.d(t,{a:()=>l,b:()=>n,g:()=>d,u:()=>a});var s=i(68180),o=i(99592);i(97127);function a(e,t){const{modules:i}=e,a=(0,o.j)(e),n=i.esriLang.clone(a.classBreakInfos);a.classBreakInfos=[],n.forEach(((i,o)=>{i=function(e,t,i,o,a){if((0,s.i)(i))if(0===i);else if(i<1){const s=Math.round(1/i);t.minValue="first"===a?Math.floor(t.minValue/i)/s:Math.round(t.minValue/i)/s,t.maxValue="last"===a?Math.ceil(t.maxValue/i)/s:Math.round(t.maxValue/i)/s,t.label=`${o>0?"> ":""}${t.minValue.toLocaleString(e.fullLocale,{maximumSignificantDigits:15})} - ${t.maxValue.toLocaleString(e.fullLocale,{maximumSignificantDigits:15})}`}else t.minValue="first"===a?Math.floor(t.minValue/i)*i:Math.round(t.minValue/i)*i,t.maxValue="last"===a?Math.ceil(t.maxValue/i)*i:Math.round(t.maxValue/i)*i,t.label=`${o>0?"> ":""}${t.minValue.toLocaleString()} - ${t.maxValue.toLocaleString()}`;return t}(e,i,t,o,0===o?"first":o===n.length-1?"last":void 0),a.addClassBreakInfo({minValue:i.minValue,maxValue:i.maxValue,symbol:i.symbol,label:i.label})}))}function n(e,t){const i=(0,o.j)(e).classBreakInfos;let s=t,a=Number.POSITIVE_INFINITY;i.forEach((e=>{s||(s=Math.max(r(e.minValue),r(e.maxValue))),a=Math.min(a,e.maxValue-e.minValue)}));const n=[];return a>1e7?(n.push(1e7),n.push(1e6),n.push(1e5),n.push(1e4),n.push(1e3),n.push(100),n.push(10),s>0&&n.push(1),s>1&&n.push(.1),s>2&&n.push(.01)):a>1e6?(n.push(1e6),n.push(1e5),n.push(1e4),n.push(1e3),n.push(100),n.push(10),s>0&&n.push(1),s>1&&n.push(.1),s>2&&n.push(.01)):a>1e5?(n.push(1e5),n.push(1e4),n.push(1e3),n.push(100),n.push(10),s>0&&n.push(1),s>1&&n.push(.1),s>2&&n.push(.01)):a>1e4?(n.push(1e4),n.push(1e3),n.push(100),n.push(10),s>0&&n.push(1),s>1&&n.push(.1),s>2&&n.push(.01)):a>1e3?(n.push(1e3),n.push(100),n.push(10),s>0&&n.push(1),s>1&&n.push(.1),s>2&&n.push(.01),s>3&&n.push(.001)):a>100?(n.push(100),n.push(10),s>0&&n.push(1),s>1&&n.push(.1),s>2&&n.push(.01),s>3&&n.push(.001),s>4&&n.push(1e-4),s>5&&n.push(1e-5)):a>10?(n.push(10),s>0&&n.push(1),s>1&&n.push(.1),s>2&&n.push(.01),s>3&&n.push(.001),s>4&&n.push(1e-4),s>5&&n.push(1e-5),s>6&&n.push(1e-6)):a>1?(s>0&&n.push(1),s>1&&n.push(.1),s>2&&n.push(.01),s>3&&n.push(.001),s>4&&n.push(1e-4),s>5&&n.push(1e-5),s>6&&n.push(1e-6)):a>.1?(s>1&&n.push(.1),s>2&&n.push(.01),s>3&&n.push(.001),s>4&&n.push(1e-4),s>5&&n.push(1e-5),s>6&&n.push(1e-6)):a>.01?(s>2&&n.push(.01),s>3&&n.push(.001),s>4&&n.push(1e-4),s>5&&n.push(1e-5),s>6&&n.push(1e-6)):a>.001?(s>3&&n.push(.001),s>4&&n.push(1e-4),s>5&&n.push(1e-5),s>6&&n.push(1e-6),s>7&&n.push(1e-7)):a>1e-4?(s>4&&n.push(1e-4),s>5&&n.push(1e-5),s>6&&n.push(1e-6),s>7&&n.push(1e-7),s>8&&n.push(1e-8)):a>1e-5&&(s>5&&n.push(1e-5),s>6&&n.push(1e-6),s>7&&n.push(1e-7),s>8&&n.push(1e-8),s>9&&n.push(1e-9)),n}function l(e){const t=(0,o.j)(e);let i=1e10;return t.classBreakInfos.forEach((e=>{i=Math.min(i,c(e.minValue)),i=Math.min(i,c(e.maxValue))})),i}function r(e){let t=1;for(;Math.round(e*t)/t!==e;)t*=10;return Math.log(t)/Math.LN10}function c(e){let t=1e-8;for(;u(Math.round(e/t)*t)===e;)t*=10;return t/10}function u(e){return Number.parseFloat(e.toPrecision(12))}function d(e){let t=0;e.forEach((e=>{(0,s.i)(e.value)?t=Math.max(r(u(e.value)),t):((0,s.i)(e.minValue)&&(t=Math.max(r(u(e.minValue)),t)),(0,s.i)(e.maxValue)&&(t=Math.max(r(u(e.maxValue)),t)),(0,s.i)(e.min)&&(t=Math.max(r(u(e.min)),t)),(0,s.i)(e.max)&&(t=Math.max(r(u(e.max)),t)))})),t=Math.min(t,3);const i=e[0],o=e[e.length-1],a=Math.min(i.minValue??i.min??i.value,o.minValue??o.min??o.value),n=Math.max(i.maxValue??i.max??i.value,o.maxValue??o.max??o.value)-a;return n/e.length<2e-7?t=8:n/e.length<2e-6?t=7:n/e.length<2e-5?t=6:n/e.length<2e-4?t=5:n/e.length<.002?t=4:n/e.length<.02?t=3:n/e.length<.2?t=Math.max(t,2):n/e.length<2&&(t=Math.max(t,1)),Math.round(t)}},372:(e,t,i)=>{i.d(t,{a:()=>n,c:()=>a,u:()=>l});var s=i(68180),o=i(99592);i(97127);async function a(e,t){const{layer:i,useFeatureReduction:a,mapImageSublayer:n,mapView:l,modules:r}=e,c=i,u=(0,o.a)(e);let d=t.relationshipScheme;if(!d&&["relationship","relationship-size"].includes(u)&&(d=(0,o.a7)(e)),t=t||{},"relationship-size"===u){const i=(0,o.j)(e).clone(),s=i.authoringInfo;if(s&&t.fieldInfos?.length>1&&t.fieldInfos[0].field===s.field1.field&&t.fieldInfos[1].field===s.field2.field){if(i.visualVariables=(0,o.V)(i,"size"),i.authoringInfo.visualVariables=(0,o.W)(i,"size"),(0,o.z)(e)){const t=(0,o.m)(e),s=i.uniqueValueInfos.slice();s.forEach((i=>{const s=(0,o.Z)(e,i.symbol);i.symbol=t.clone(),(0,o.X)(e,i.symbol,s)})),i.uniqueValueInfos=s}return{renderer:i}}}const h=(0,o.k)((0,o.j)(e)),p={layer:c,view:l,field1:{field:t.fieldInfos[0].field},field2:{field:t.fieldInfos[1].field},classificationMethod:"quantile",numClasses:3,focus:"HH",relationshipScheme:d,outlineOptimizationEnabled:!n&&(!(0,s.i)(t.outlineOptimizationEnabled)||t.outlineOptimizationEnabled),sizeOptimizationEnabled:!n&&(!(0,s.i)(t.sizeOptimizationEnabled)||t.sizeOptimizationEnabled),legendOptions:t.legendOptions,defaultSymbolEnabled:!1,forBinning:"binning"===c.featureReduction?.type&&a};return await r.RelationshipCreator.createRenderer(p).then((e=>((0,o.l)(h,e.renderer),e)))}async function n(e,t){const{layer:i,useFeatureReduction:a,mapImageSublayer:n,mapView:l,modules:r}=e,c=i;t=t||{};const u=(0,o.j)(e),d=(0,o.a)(e),h=u.authoringInfo,p=(0,o.b)(u,"size");if(t.fieldInfos&&t.fieldInfos.length>1&&t.fieldInfos[0].field===h.field1.field&&t.normalizationField1===h.field1.normalizationField&&t.fieldInfos[1].field===h.field2.field&&t.normalizationField2===h.field2.normalizationField&&(delete t.fieldInfos,delete t.normalizationField1,delete t.normalizationField2,(0,o.T)(t)&&!p))return{renderer:u.clone()};let f=t.relationshipScheme;!f&&["relationship","relationship-size"].includes(d)&&(f=(0,o.a7)(e));const m=(0,o.k)(u),g=t.fieldInfos?t.fieldInfos[0]:{field:h.field1.field,simpleFieldType:o.q.NUMBER},b=t.fieldInfos?t.fieldInfos[1]:{field:h.field2.field,simpleFieldType:o.q.NUMBER},S=void 0!==t.normalizationField1?t.normalizationField1:h.field1.normalizationField,x=void 0!==t.normalizationField2?t.normalizationField2:h.field2.normalizationField,v=u.uniqueValueInfos?.length?u.uniqueValueInfos[0].symbol:null,L=u.defaultSymbol,M=u.defaultLabel,C=t.numClasses?t.numClasses:h.numClasses,I={layer:c,view:l,field1:{field:g?g.field:u.field,normalizationField:S},field2:{field:b?b.field:u.field,normalizationField:x},classificationMethod:t.classificationMethod?t.classificationMethod:"manual"!==h.classificationMethod?h.classificationMethod:"quantile",numClasses:C,focus:t.focus?t.focus:h.focus,relationshipScheme:f,outlineOptimizationEnabled:!n&&((0,s.i)(t.outlineOptimizationEnabled)?t.outlineOptimizationEnabled:!!m.sizeOutlineVisVar),sizeOptimizationEnabled:!n&&((0,s.i)(t.sizeOptimizationEnabled)?t.sizeOptimizationEnabled:!!m.sizeAutoVisVar),legendOptions:t.legendOptions?t.legendOptions:u.legendOptions,defaultSymbolEnabled:(0,s.i)(t.defaultSymbolEnabled)?t.defaultSymbolEnabled:!!u.defaultSymbol,forBinning:"binning"===c.featureReduction?.type&&a};return await r.RelationshipCreator.createRenderer(I).then((t=>{if((0,o.l)(m,t.renderer),v){t.renderer.uniqueValueInfos.forEach((t=>{const i=v.clone();(0,o.X)(e,i,(0,o.Z)(e,t.symbol)),t.symbol=i}))}return(0,o.j)(e).uniqueValueInfos.forEach((e=>{const i=t.renderer.uniqueValueInfos.find((t=>e.value===t.value));i&&(i.label=e.label)})),L&&(t.renderer.defaultSymbol=L,t.renderer.defaultLabel=M),t}))}async function l(e,t){const{modules:i}=e;t=t||{};const s=(0,o.j)(e),a=s.authoringInfo;return await i.RelationshipCreator.updateRenderer({field1:a.field1,field2:a.field2,numClasses:t.numClasses?t.numClasses:a.numClasses,focus:t.focus?"none"===t.focus?null:t.focus:a.focus,colors:t.colors,renderer:s})}},66215:(e,t,i)=>{function s(e,t,i,s,o,l){const r=t?.length?n(t,i.bins[o]):a(e,t.stops,i.bins[o]);r&&(l.setAttribute("fill",r.toHex()),l.setAttribute("opacity",`${Math.max(r.a,.2)}`)),s?.push(l)}function o(e,t,i,s,o){t&&i?.forEach(((i,l)=>{const r=(o||t.histogramConfig)?.bins?.[l],c="breaks"in t?n(s||t.breaks,r):a(e,(s||t).stops,r);c&&(i.setAttribute("fill",c.toHex()),i.setAttribute("opacity",`${Math.max(c.a,.2)}`))}))}function a(e,t,i){const{modules:s}=e;if(!i)return;const o=(i.maxValue-i.minValue)/2+i.minValue;let a=t[0],n=t[t.length-1];const l=a.value,r=n.value;if(o<l)return a.color;if(o>r)return n.color;const c=t.filter((e=>e.value===o));if(c.length>0)return c[0].color;a=null,n=null,t.forEach(((e,i)=>{!a&&!n&&e.value>=o&&(a=t[i-1],n=e)}));const u=(o-a.value)/(n.value-a.value);return s.EsriColor.blendColors(a.color,n.color,u)}function n(e,t){if(!t)return;const i=(t.maxValue-t.minValue)/2+t.minValue;let s=e[0],o=e[e.length-1];if(i<s.min||i>o.max)return;const a=e.filter((e=>e.min===i));return a.length>0?a[0].color:(s=e[e.length-1],o=null,e.forEach(((t,a)=>{!o&&t.min>=i&&(s=e[a-1],o=t)})),s.color)}i.d(t,{b:()=>s,u:()=>o})},33101:(e,t,i)=>{i.d(t,{c:()=>a,u:()=>n});var s=i(97127),o=(i(68180),i(99592));function a(e){e.selectedFields=[],e.layerFields=void 0,e.fields=void 0,e.hideLayerTitle=!1,e.supportsArcade=!1,e.stringFieldsCount=-1,e.dateFieldsCount=-1,e.numberFieldsCount=-1,e.containsFlow=!0,e.oneFeatureResponseStatus=o.s.MISSING,e.selectedAttribute=void 0,e.selectedAttributeText=void 0,e.selectedTypeValue=void 0,e.selectedValue=void 0,e.lastDefault=void 0,e.lastDefaults=void 0,e.dotColorSelected=void 0,e.backgroundStyleSelected=void 0,e.lastSettings=void 0,e.classedSymbolSelectedIdx=void 0,e.allUniqueValues=void 0,e.useFeatureReduction=void 0,e.hideSvgUploadSymbols=!1,e.hideAddStyles=!1,e.rasterInfo=void 0}function n(){const e=(0,s.r)(),t=e;e.manager.onLoad((()=>{t.smartMappingState=function(e,t){const i=l.get(e);if(i)return i;const o=(0,s.c)(e,t);if(o&&"store"in o)return l.set(e,o.store),o.store;return null}(e.el,"arcgis-smart-mapping").state}))}const l=new WeakMap},42444:(e,t,i)=>{function s(e,t){if(!e||!t)return;let i=t.assetsPath;i.endsWith("/")||(i+="/"),e?.firstElementChild?.insertAdjacentHTML("beforebegin",`<link rel="stylesheet" href="${i}esri/themes/light/main.css" />`)}i.d(t,{i:()=>s})}}]);