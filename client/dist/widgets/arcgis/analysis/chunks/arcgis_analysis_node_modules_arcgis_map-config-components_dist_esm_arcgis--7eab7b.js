/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm_arcgis--7eab7b.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm_arcgis--7eab7b"],{11590:(t,e,i)=>{i.r(e),i.d(e,{arcgis_modal_arcade:()=>n});var s=i(28614),a=i(97127),r=i(50063),c=i(71480);const n=class{constructor(t){(0,s.r)(this,t),this.arcgisClose=(0,s.c)(this,"arcgisClose",7),this.arcgisModalArcadeClose=(0,s.c)(this,"arcgisModalArcadeClose",7),this.manager=(0,a.u)(this),this.strings=(0,r.u)({blocking:!0}),this.hideDocumentationActions=!1,this.arcadeScript="",this.arcadeProfile=void 0,this.testData=void 0,this.suggestions=[],this.returnPredictOutputType=!0,this.arcadeTitle=void 0,this.arcadeTitleEditable=!1,this.arcadeTitleEditingEnabled=!1,this.addExistingExpressions=!1,this.layer=void 0,this.scriptInvalid=!0,this.hasChanges=!1}async componentWillLoad(){if(await this.loadAllModules(),this.addExistingExpressions&&this.layer){const t=this.getExistingExpressions();t&&(this.suggestions?.length?this.suggestions.push(t):this.suggestions=[t])}this.arcadeScript.length&&(this.scriptInvalid=!1)}async loadAllModules(){this.arcade=await(0,c.w)(),this.arcadeUtils=await(0,c.x)()}async getOutputType(){try{const t=await this.arcadeEditor.getTestResult();switch(t?.type){case"boolean":case"date":case"time":case"dateOnly":case"dictionary":case"number":return t.type;case"text":return"string";default:return null}}catch(t){return null}}getExistingExpressions(){if("subtype-sublayer"===this.layer.type)return{label:this.strings.existing,suggestions:[]};const t=this.arcadeUtils.getExpressionsFromLayer(this.layer).map((t=>({label:t?.title||t?.name||this.strings.newExpression,description:this.getStringFromProfileName(t.profileInfo?.name),code:t.expression})));return{label:this.strings.existing,suggestions:t?.length?t:[]}}getStringFromProfileName(t){switch(t){case"form-constraint":return this.strings.constraint;case"feature-z":return this.strings.featureZ;case"form-calculation":return this.strings.formCalculation;case"labeling":return this.strings.labeling;case"popup":return this.strings.popup;case"popup-element":return this.strings.popupElement;case"popup-feature-reduction":return this.strings.featureReductionPopup;case"popup-element-feature-reduction":return this.strings.featureReductionPopupElement;case"visualization":return this.strings.visualization;case"field-calculation":return this.strings.fieldCalculation;case"aggregate-field":return"Aggregate Field";default:return this.strings.unknown}}render(){return(0,s.h)(s.H,{key:"0b9accd83f20269c002c1892aa280cfd026ac8cf"},(0,s.h)("calcite-dialog",{key:"9f641b781e31a69002bb06abbbb2ab32bd8011a0",class:"arcade-dialog",open:!0,modal:!0,scale:"l",escapeDisabled:!0,outsideCloseDisabled:!0,onCalciteDialogClose:()=>{this.arcgisClose.emit(),this.arcgisModalArcadeClose.emit()}},(0,s.h)("div",{key:"4c543206cabc6c53207ca997ef704965d9b92b92",slot:"header-content",class:"header"},this.arcadeTitle&&this.arcadeTitleEditable?(0,s.h)("calcite-inline-editable",{scale:"l",editingEnabled:this.arcadeTitleEditingEnabled,messageOverrides:{cancelEditing:this.strings.cancel,enableEditing:this.strings.edit,confirmChanges:this.strings.done}},(0,s.h)("calcite-input",{ref:t=>this.arcadeTitleInput=t,alignment:"start",placeholder:this.strings.titlePlaceHolder,scale:"l",type:"text",value:this.arcadeTitle||this.strings.newExpression,onCalciteInputInput:()=>this.hasChanges=!0})):this.arcadeTitle||this.strings.newExpression),(0,s.h)("arcgis-arcade-editor",{key:"b2417594426c6e64f3799f1821586069669193ae",class:"arcade-editor",ref:t=>this.arcadeEditor=t,hideDocumentationActions:this.hideDocumentationActions,script:this.arcadeScript,profile:this.arcadeProfile,testData:this.testData,suggestions:this.suggestions,onArcgisDiagnosticsChange:t=>{const e=t.detail;if(e?.length){for(const t of e)if(1===t?.severity)return this.scriptInvalid=!0,void(this.hasChanges=!0);this.scriptInvalid=!1}else this.scriptInvalid=!1;if(!this.hasChanges){const t=this.arcadeEditor?.script;this.hasChanges=this.arcadeScript!==t}}}),(0,s.h)("calcite-button",{key:"e99671e5af1444d12a8d8c1afe68a25fcc5ed80b",slot:"footer-end",appearance:"outline-fill",alignment:"center",scale:"m",onClick:()=>{this.arcgisClose.emit(),this.arcgisModalArcadeClose.emit()}},this.strings.cancel),(0,s.h)("calcite-button",{key:"fee06e94a3b8b496c00a30caf1b0a9d733d3e1fa",slot:"footer-end",alignment:"center",appearance:"solid",scale:"m",disabled:this.scriptInvalid||!this.hasChanges,onClick:async()=>{this.arcgisClose.emit({script:this.arcadeEditor.script,...this.arcadeTitle&&{title:this.arcadeTitleInput?.value?.trim()||this.strings.newExpression},...this.returnPredictOutputType&&{predictOutputType:await this.getOutputType()}}),this.arcgisModalArcadeClose.emit({script:this.arcadeEditor.script,...this.arcadeTitle&&{title:this.arcadeTitleInput?.value?.trim()||this.strings.newExpression},...this.returnPredictOutputType&&{predictOutputType:await this.getOutputType()}})}},this.strings.done)))}static get assetsDirs(){return["assets"]}get el(){return(0,s.g)(this)}};n.style=".arcade-dialog.sc-arcgis-modal-arcade{top:7.5%;left:7.5%;right:7.5%;--calcite-dialog-size-x:85%;--calcite-dialog-size-y:85%}.header.sc-arcgis-modal-arcade{width:55%}.arcade-editor.sc-arcgis-modal-arcade{width:100%;height:100%}arcgis-arcade-editor.sc-arcgis-modal-arcade{z-index:var(--calcite-z-index-header);--calcite-panel-content-space:0}arcgis-arcade-editor.sc-arcgis-modal-arcade>calcite-tooltip.sc-arcgis-modal-arcade{z-index:var(--calcite-z-index-tooltip)}"},50063:(t,e,i)=>{i.d(e,{u:()=>r});var s=i(97127),a=i(28614);const r=(0,s.m)(a.a)}}]);