"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_arcgis-raster-function-editor_-911fb1"],{33968:(e,t,n)=>{n.d(t,{a:()=>y,c:()=>v,g:()=>h,l:()=>f});var r=n(588),a=n(71802),o=n(44345),l=n(32513),i=n(33752),s=n(36596),c=n(22493);const d="ConvertRasterFunctionTemplate",u="https://rasteranalysisdev.arcgis.com/arcgis/rest/services/Utilities/RasterUtilities/GPServer";async function p(e){try{return(await(0,o.default)(e,{query:{f:"json"}})).data}catch{Promise.reject("fetching rft data from url failed")}}async function m(e){let t={format:"json",inputRasterFunction:JSON.stringify({itemId:e.id})};const n=function(e){const t=e.helperServices,n=t&&t.rasterUtilities;return`${n?n.url:u}`}(e.portal);let o;(0,c.p)(n)&&Promise.reject("rasterUtilities server missing");try{const e=`${n}/${d}`,l=await r.default.getCredential(e);void 0!==l?.token&&(t={...t,token:l.token});const i=await a.submitJob(e,t),s={interval:1500,statusCallback:e=>{console.log("status: ",e.jobStatus)}};await i.waitForJobCompletion(s);const c=(await i.fetchResultData("outputRasterFunction")).value;({url:o}=c)}catch{Promise.reject("json conversion failed")}return p(o)}async function f(e,t){if((0,c.p)(e))throw new Error("Invalid Portal Item Id");(0,c.p)(t)&&!(0,c.p)(c.L?.portal)&&(t=c.L.portal);let n=new i.default({id:e,portal:t});try{await n.load()}catch(r){const a=c.L?.portal??t;if(!0===a?.isPortal)try{if(n=await async function(e){const t=new l.default({url:"https://www.arcgis.com"});if(t.authMode="immediate",await t.load(),!(0,c.p)(t.loadError))throw t.loadError;const n=new i.default({id:e,portal:t});try{await n.load()}catch(e){console.error(e)}return n}(e),!n?.loaded)throw new Error("Unable to load selected portal item "+e)}catch(e){console.error(e)}else console.error(r)}return n}async function h(e,t){let n;const r=await f(e,t),{title:a,snippet:o,id:l}=r,i=function(e){const t=e.name,n=t&&t.slice(-8);return n&&".rft.xml"===n.toLowerCase()}(r);if(i)n=await m(r);else{const e=`${r.itemUrl}/data`;n=await p(e)}return{...n,name:a,description:o??n.description,sourceItemId:l,type:n.type??c.R}}function v(e){return new s.default(e)}function y(e){if((0,c.p)(e))return;return`${e.portal.url.replace("/sharing/rest/","")}/home/item.html?id=${e.id}`}},42776:(e,t,n)=>{n.d(t,{C:()=>a,U:()=>r,a:()=>o,u:()=>l});const r={Scale:"s",PopoverTimer:60},a={s:"s",m:"m",l:"l"},o={absolute:"absolute",fixed:"fixed"},l=e=>e===a.s?a.m:a.l},40861:(e,t,n)=>{n.d(t,{D:()=>s,J:()=>u,a:()=>f,b:()=>A,c:()=>h,d:()=>v,e:()=>w,f:()=>g,g:()=>R,h:()=>y,i:()=>c,j:()=>d,k:()=>m,l:()=>i,m:()=>L,n:()=>I,o:()=>k,s:()=>T});var r=n(5294),a=(n(13661),n(18423),n(21255),n(35431),n(17078)),o=n(22493),l=(n(588),n(55448),n(2924),n(11840),n(52373),n(33752),n(440),n(66744),n(44345),n(91177));n(23795),n(17902),n(56451),n(71802),n(32513),n(36596);const i=[38,39,40,41,42,43,47,54,55,58,66,67,68,69,70,71,72,73,74,75,93,94],s="distanceLegacy",c=({category:e})=>!![s].includes(e),d={local:"LocalFunction",gpAdapter:"GPAdapterFunction",pythonAdapter:"PythonAdapterFunction"},u={RASTER_FUNCTION_TEMPLATE:"RasterFunctionTemplate",RASTER_FUNCTION_VARIABLE:"RasterFunctionVariable",ARGUMENT_ARRAY:"ArgumentArray",RECORD_SET:"RecordSet",ECD_FILE:"ECDFile"},p={MATCH_VARIABLE:"MatchVariable",UNION_DIMENSION:"UnionDimension"},m={name:"Raster",isDataset:!0,isPublic:!1,type:u.RASTER_FUNCTION_VARIABLE};function f(e){return null==e?"":e.name||e.datasetName&&e.datasetName.name}function h(e){return e.hasOwnProperty("EsriClassifierDefinitionFile")}function v(e){return e.type&&e.type.toLowerCase().indexOf(u.RECORD_SET.toLowerCase())>=0}function y(e,t){const n=t&&t.value;if(null==n)return;let r;return e.some((e=>{if(e.values&&e.values.indexOf(n)>-1)return r=e.inputArgs,!0})),r}function C(e,t){let n;if(!(0,o.p)(e)&&(n=e.rasterFunctionArguments,1===Object.keys(n).length&&!e.hasArgumentsObject))return!0;const r=t.arguments,a=r&&r.type;return!(!a||a!==u.RASTER_FUNCTION_TEMPLATE&&a!==u.RASTER_FUNCTION_VARIABLE)||void 0}function E(e,t,n){if((0,o.p)(t)||(0,o.p)(n))return;const r=e?.rasterFunctionArguments;return(0,o.p)(r)?void 0:(0,l.l)(t,r)}function g(e,t,n,r){if((0,o.p)(t)&&(0,o.p)(r))return!1;const l=E(e,r=r||t.key,n);if(!(0,o.p)(l)&&l.dataType===a.d.rasterArray)return!0;if(!t)return;const i=t.value;if(i&&i.elements){return i.elements.some((e=>e&&(e.isDataset||e.type===u.RASTER_FUNCTION_TEMPLATE||e.value&&e.value.type===u.RASTER_FUNCTION_TEMPLATE)))}i&&Array.isArray(i)&&i.some((e=>e&&e.name&&e.url))}function A(e,t,n){t.value||(t.value={elements:[],type:u.ARGUMENT_ARRAY});let r=t.value&&t.value.elements?t.value.elements:t.value;return r&&Array.isArray(r)?void 0!==n?r[n]=e:(r.push(e),n=r.length-1):(r=[e],n=0),t.value&&t.value.elements?t.value.elements=r:t.value=r,n}function R(e,t,n){let r,a;if("string"==typeof t?r=t:(r=t.key,a=t.index),(0,o.p)(r)||(0,o.p)(n))return;const l=n.arguments,i=l&&l.type,s=r&&r.toLowerCase();let c;if(C(e,n))return i!==u.RASTER_FUNCTION_TEMPLATE&&!l.isDataset||"raster"!==s?i===u.RASTER_FUNCTION_VARIABLE&&"rasters"===s&&(c=void 0!==a?function(e,t){if((0,o.p)(t)||void 0===e)return;const n=t.value&&t.value.elements?t.value.elements:t.value;return n&&n.length?n[e]:void 0}(a,l):l):c=l,c;if(c=l[r],void 0!==a&&g(e,c,n,r)){const e=c.value&&c.value.elements?c.value.elements:c.value;c=e&&e.length?e[a]:void 0}return c}function w(e,t){if((0,o.p)(t))return;const n=[],a=t.arguments,l=a&&a.type;if(C(e,t)){let e,t=r.clone(a);return e=l===u.RASTER_FUNCTION_TEMPLATE||t.isDataset?"Raster":"Rasters",(0,o.p)(t)?t={key:e}:t.key=e,n.push(t),n}return Object.keys(a).forEach((e=>{if(e===p.MATCH_VARIABLE||e===p.UNION_DIMENSION)return;let t=r.clone(a[e]);(0,o.g)(t)&&((0,o.p)(t)?t={key:e}:t.key=e,n.push(t))})),n}function T(e,t,n,r,a){if((0,o.p)(t)||(0,o.p)(n)||(0,o.p)(r))return;const l=t.arguments,i=g(e,l,t,r)&&void 0!==a;if(C(e,t))i?a=A(n,l,a):t.arguments=n;else{const e=l[r];i?a=A(n,e,a):l[r]=n}return n.value&&"Scalar"===n.value.type&&(0,o.p)(n.name)&&(n.name=i?t.function.type.toLowerCase()===d.local.toLowerCase()&&a>0?`InRaster${a+1}`:`Raster${a>0?a+1:""}`:E(e,r,t).displayName||r),{key:r,index:a}}function L(e){return e.dataType===a.d.raster||e.dataType===a.d.rfxtemplate}function k(e){return e.dataType===a.d.scalar}const I=(e,t,n)=>{let r=e;!function e(a){if(a>=t.length)return void n(r);const o=t[a];let l;if("shadowRoot"===o)l=r?.shadowRoot;else if(o.startsWith("children[")){const e=parseInt(o.match(/\d+/)[0],10);l=r.children[e]}l?(r=l,e(a+1)):requestAnimationFrame((()=>e(a)))}(0)}},61556:(e,t,n)=>{n.d(t,{a:()=>d,b:()=>h,c:()=>p,d:()=>f,e:()=>s,f:()=>u,g:()=>c,h:()=>y,i:()=>v,j:()=>C,k:()=>l,l:()=>o,m:()=>i});var r=n(22493),a=n(42776);const o=({label:e,open:t})=>{const n=document.createElement("rfx-section");return n.label=e,n.open=t,n},l=({content:e,unsupportedWarningComponent:t,title:n,isFunctionChain:a})=>{const o=document.createElement("calcite-block");return o.open=!0,!0===a&&(o.heading=n,o.collapsible=!0,o.headingLevel=3),(0,r.p)(t)||o.appendChild(t),o.appendChild(e),o},i=({label:e,hideHelp:t=!1,onHelpActionClick:n})=>{const r=document.createElement("rfx-label");return r.label=e,r.hideHelp=t,r.addEventListener("rfxLabelHelpActionClick",n),r},s=({portal:e,portalItem:t,itemProps:n,onCancel:r,onSave:a})=>{const o=document.createElement("rfx-save-modal");return o.portal=e,o.portalItem=t,o.itemProps=n,o.addEventListener("cancelClick",r),o.addEventListener("saveClick",a),o},c=({portal:e,portalItem:t})=>{const n=document.createElement("rfx-share-modal");return n.portal=e,n.portalItem=t,n},d=({modalStrings:{header:e},portal:t,user:n,filter:r,hideFilters:a,selectionMode:o,cardMessageOverrides:l,onClose:i,onSelection:s})=>{const c=document.createElement("rfx-item-browser");return c.portal=t,c.user=n,c.header=e,c.filter=r,c.hideFilters=a,c.cardMessageOverrides=l,c.selectionMode=o??"single",c.addEventListener("rfxItemBrowserClose",i),c.addEventListener("rfxItemBrowserSelection",s),c},u=({templateProperties:e,portalItem:t,modalStrings:n,showPrimaryButton:a,onCancel:o,onSave:l})=>{const i=document.createElement("rfx-modal"),{header:s,secondary:c}=n;(0,r.p)(c)||(i.labels={secondary:c}),i.showPrimaryButton=a;const d=document.createElement("div");d.innerHTML=s,d.slot="header",i.appendChild(d);const u=document.createElement("rfx-template-editor");u.value=e,u.portalItem=t;const p=document.createElement("div");return p.slot="content",p.style.height="50vh",p.appendChild(u),i.appendChild(p),i.addEventListener("rfxModalSecondaryClick",o),i.addEventListener("rfxModalPrimaryClick",(()=>{l(u.value)})),i.addEventListener("rfxModalClose",o),i},p=(e,t,n)=>{const r=document.createElement(e);var a,o;return a=r,o=n,Object.keys(o).forEach((e=>{a.setAttribute(e,o[e])})),r.innerHTML=t,r},m={modal:{kind:"warning"},header:{slot:"header",style:"\n      display: flex;\n      align-items: center;\n      justify-content: flex-start;\n    "},headerIcon:{icon:"exclamation-mark-triangle-f",style:"\n      margin: 0 1rem;\n      --calcite-ui-icon-color: var(--calcite-color-status-warning);\n    "},content:{slot:"content"}},f=({modalStrings:{header:e,content:t}})=>{const n=p("rfx-modal","",m.modal);n.showPrimaryButton=!1;const r=p("div","",m.header),a=p("div",e,{}),o=p("calcite-icon","",m.headerIcon);r.appendChild(o),r.appendChild(a);const l=p("div","",m.content);return l.appendChild(p("p",t,{})),n.appendChild(r),n.appendChild(l),n.addEventListener("rfxModalSecondaryClick",(()=>{n.remove(),n.open=!1})),n.addEventListener("rfxModalClose",(()=>{n.remove(),n.open=!1})),n},h=({modalStrings:{content:e,linkUrl:t,linkText:n},autoClose:o=!0,onLinkClicked:l})=>{const i=p("calcite-alert",e,{kind:"success",scale:a.C.l,open:!0,label:"save success"});i.autoClose=o;const s=p("div",e,{slot:"message"});if(i.appendChild(s),!1===(0,r.p)(t)&&!1===(0,r.p)(n)){const e=p("calcite-link",n,{slot:"link",href:t,target:"_blank"});"function"==typeof l&&(e.onclick=l),i.appendChild(e)}return i},v=({modalStrings:{content:e,header:t,functionNames:n}})=>{const r=p("calcite-alert",e,{kind:"warning",scale:a.C.m,open:!0,label:"deprecate function"});r.autoClose=!0;const o=p("div",t,{slot:"title"}),l=p("div",e,{slot:"message"}),i=p("p",n,{});return l.appendChild(i),r.appendChild(l),r.appendChild(o),r},y=({heading:e,labels:t,showPrimaryButton:n,handlePanelClose:r,handlePanelOk:a,inputLayers:o,layerValue:l,createLayerBrowse:i})=>{let s;const c=p("rfx-modal","",{open:!0});c.labels=t,c.showPrimaryButton=n,c.addEventListener("rfxModalClose",r),c.setAttribute("style","--calcite-dialog-size-y: 32rem"),c.addEventListener("rfxModalPrimaryClick",(async()=>{const e=await(s?.getRasterValue());a({rasterValue:e})})),c.addEventListener("rfxModalSecondaryClick",r);const d=p("div",e,{slot:"header"}),u=p("div","",{slot:"content"});return c.appendChild(d),s=document.createElement("rfx-select-layer-panel"),s.value=l?.value,s.inputLayers=o,c.addEventListener("rfxlayerSelectBrowseLayerClick",i),u.appendChild(s),c.appendChild(u),c},C=({modalStrings:{header:e,content:t}})=>{const n=p("calcite-alert",t,{kind:"info",scale:a.C.m,open:!0,label:"read only"});n.autoClose=!0;const r=p("div",e,{slot:"title"}),o=p("div",t,{slot:"message"});return n.appendChild(o),n.appendChild(r),n}}}]);