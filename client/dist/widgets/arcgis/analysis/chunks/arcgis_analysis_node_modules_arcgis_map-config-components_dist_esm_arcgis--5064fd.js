/*! For license information please see arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm_arcgis--5064fd.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_map-config-components_dist_esm_arcgis--5064fd"],{65863:(t,e,i)=>{i.r(e),i.d(e,{arcgis_layer_template:()=>r});var a=i(28614),s=i(97127),o=i(50063);const r=class{constructor(t){(0,a.r)(this,t),this.arcgisClose=(0,a.c)(this,"arcgisClose",7),this.manager=(0,s.u)(this),this.strings=(0,o.u)({blocking:!0}),this.layer=void 0,this.readOnly=!1,this.templateCoordinatorState={canUndo:!1,canRedo:!1,undoLabels:[],redoLabels:[],selectedTemplate:void 0,hasUnsavedChanges:!1}}componentWillLoad(){this.templateCoordinatorState.selectedTemplate="feature"===this.layer.type?this.layer.types?.[0]?.templates?.[0]??this.layer.templates?.[0]:this.layer.templates?.[0]}render(){return(0,a.h)("calcite-dialog",{key:"3e298ccecf0722908c706e4fac46459801266349",heading:this.strings.configureTemplates,modal:!0,placement:"cover",open:!0,onCalciteDialogClose:()=>this.arcgisClose.emit(),ref:t=>{t&&(this.dialogNode=t)}},(0,a.h)("tc-templates-coordinator",{key:"5acbe693945cdbd2bb771b1d9b9c3c0250823efc",layer:this.layer,initialTemplate:this.templateCoordinatorState.selectedTemplate,onTcTemplatesCoordinatorChange:t=>this.updateFromCoordinatorState(t.detail),ref:t=>{t&&(this.templatesCoordinator=t)}},(0,a.h)("div",{key:"ca52aa3dcff4ee5d7ebae1630ebb3160e7369bf5",class:"main-container"},this.renderTemplateListPanel(),this.renderEditorPanel())),this.renderFooterButtons())}renderTemplateListPanel(){return(0,a.h)("calcite-panel",{class:"template-list",heading:this.strings.templates},this.readOnly?this.renderReadOnlyMessgae():this.renderActionBar(),this.readOnly&&"subtype-sublayer"!==this.layer.type&&(0,a.h)("calcite-label",{layout:"inline",class:"read-only-permissions-message"},(0,a.h)("calcite-icon",{scale:"s",icon:"lock"})," ",this.strings.editingNotAllowed),(0,a.h)("tc-template-list",{readOnly:this.readOnly}))}renderReadOnlyMessgae(){return(0,a.h)("calcite-button",{class:"read-only-message",disabled:!0,slot:"header-actions-end",appearance:"solid",kind:"neutral"},this.strings.readOnly)}renderActionBar(){return(0,a.h)("calcite-action-bar",{slot:"header-actions-end",layout:"horizontal",expandDisabled:!0},(0,a.h)("calcite-action-group",null,(0,a.h)("calcite-action",{text:this.strings.undo,icon:"undo",disabled:!this.templateCoordinatorState.canUndo,onClick:()=>this.handleUndoClick()},(0,a.h)("calcite-tooltip",{slot:"tooltip"},this.strings.undo)),(0,a.h)("calcite-action",{text:this.strings.redo,icon:"redo",disabled:!this.templateCoordinatorState.canRedo,onClick:()=>this.handleRedoClick()},(0,a.h)("calcite-tooltip",{slot:"tooltip"},this.strings.redo))),(0,a.h)("calcite-dropdown",null,(0,a.h)("calcite-action",{id:"history-menu-trigger",text:this.strings.history,icon:"recent",slot:"trigger",disabled:!this.templateCoordinatorState.canRedo&&!this.templateCoordinatorState.canUndo},(0,a.h)("calcite-tooltip",{slot:"tooltip"},this.strings.history)),this.renderUndoHistoryGroup(),this.renderRedoHistoryGroup()))}renderEditorPanel(){return(0,a.h)("calcite-panel",{heading:this.strings.properties},this.templateCoordinatorState.selectedTemplate?this.renderEditors():this.renderEmptyState())}renderEditors(){return(0,a.h)(a.F,null,(0,a.h)("calcite-block",{heading:this.strings.formatting,open:!0,collapsible:!0},(0,a.h)("tc-formatting-editor",{readOnly:this.readOnly})),(0,a.h)("calcite-block",{heading:this.strings.defaultValues,open:!0,collapsible:!0},(0,a.h)("tc-default-values-editor",{readOnly:this.readOnly})))}renderEmptyState(){return(0,a.h)("div",{class:"empty-state"},(0,a.h)("div",{class:"empty-state-icon"},(0,a.h)("svg",{viewBox:"0 0 64 64",xmlns:"http://www.w3.org/2000/svg"},(0,a.h)("use",{href:`${(0,a.a)("./assets/icons/clipboard-64.svg")}#icon`}))),(0,a.h)("div",{class:"empty-state-title"},this.strings.emptyStateTitle),(0,a.h)("div",{class:"empty-state-description"},this.strings.emptyStateDescription))}renderUndoHistoryGroup(){return this.templateCoordinatorState.canUndo?(0,a.h)("calcite-dropdown-group",{selectionMode:"single",groupTitle:this.strings.undo},this.templateCoordinatorState.undoLabels.map(((t,e)=>(0,a.h)("calcite-dropdown-item",{iconStart:"undo",onCalciteDropdownItemSelect:()=>this.handleUndoClick(e+1)},t)))):(0,a.h)(a.F,null)}renderRedoHistoryGroup(){return this.templateCoordinatorState.canRedo?(0,a.h)("calcite-dropdown-group",{selectionMode:"single",groupTitle:this.strings.redo},this.templateCoordinatorState.redoLabels.map(((t,e)=>(0,a.h)("calcite-dropdown-item",{iconStart:"redo",onCalciteDropdownItemSelect:()=>this.handleRedoClick(e+1)},t)))):(0,a.h)(a.F,null)}renderFooterButtons(){return this.readOnly?(0,a.h)(a.F,null):(0,a.h)(a.F,null,(0,a.h)("calcite-button",{slot:"footer-end",appearance:"outline",disabled:!this.templateCoordinatorState.hasUnsavedChanges,onClick:()=>this.handleDiscardClick(),ref:t=>{t&&(this.discardNode=t)}},this.strings.cancel),(0,a.h)("calcite-button",{slot:"footer-end",disabled:!this.templateCoordinatorState.hasUnsavedChanges,onClick:()=>this.handleSaveClick(),ref:t=>{t&&(this.saveNode=t)}},this.strings.save))}async handleSaveClick(){try{this.saveNode.loading=!0;const t=await this.templatesCoordinator.save();this.showAlert("success",this.strings.saveSuccessful),this.updateFromCoordinatorState(t)}catch(t){console.error(t),t instanceof Error&&"ValidationError"===t.name?this.showAlert("error",this.strings.unableToSave,this.strings.saveErrorInvalidTemplate):this.showAlert("error",this.strings.unableToSaveTemplates,this.strings.checkPrivileges)}finally{this.saveNode.loading=!1}}async handleDiscardClick(){try{this.discardNode.loading=!0;const t=await this.templatesCoordinator.reset();this.updateFromCoordinatorState(t)}catch(t){console.error(t)}finally{this.discardNode.loading=!1}}async handleUndoClick(t=1){const e=await this.templatesCoordinator.undo(t);this.updateFromCoordinatorState(e)}async handleRedoClick(t=1){const e=await this.templatesCoordinator.redo(t);this.updateFromCoordinatorState(e)}showAlert(t,e,i){const a=document.createElement("calcite-alert");a.kind="error"===t?"danger":"success",a.label=e,a.autoClose=!0,a.slot="alerts";const s=document.createElement("div");if(s.innerHTML=e,s.slot="title",a.appendChild(s),i){const t=document.createElement("div");t.innerHTML=i,t.slot="message",a.appendChild(t)}a.open=!0,this.dialogNode.appendChild(a)}updateFromCoordinatorState(t){this.templateCoordinatorState=t}static get assetsDirs(){return["assets"]}get el(){return(0,a.g)(this)}};r.style=".empty-state{height:100%;align-content:center;text-align:center}.empty-state-description{color:#9f9f9f;font-size:var(--calcite-font-size-1)}.empty-state-icon{fill:#9f9f9f;display:inline-flex;height:80px;width:80px}.empty-state-title{color:#9f9f9f;font-weight:500;font-size:var(--calcite-font-size-3)}.main-container{display:flex;height:100%}.read-only-message{margin:auto 0.75rem auto auto}.read-only-permissions-message{margin:12px;align-self:center}.template-list{border-right:1px solid var(--calcite-color-border-3)}"},50063:(t,e,i)=>{i.d(e,{u:()=>o});var a=i(97127),s=i(28614);const o=(0,a.m)(s.a)}}]);