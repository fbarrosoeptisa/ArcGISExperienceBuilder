/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-1d38c3.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-new-ite-1d38c3"],{23325:(e,t,i)=>{i.d(t,{a:()=>s});var a=i(57159),n=i(8227),o=i(18409);async function s(e){var t,i,s;const l=(0,n.g)(e),r=`${null===(t=e.existingItem)||void 0===t?void 0:t.url}/${e.sourceDataLayer.id}/append`;try{const t=await(0,a.r)(r,l,{},"post"),{status:i,recordCount:n}=await(0,o.g)(e.id,{},null==t?void 0:t.statusUrl);return{result:{status:i,recordCount:n}}}catch(e){let t="unhandledError";const a={error:e},n=(null===(i=a.error.description)||void 0===i?void 0:i.toLowerCase())||(null===(s=a.error.message)||void 0===s?void 0:s.toLowerCase());switch(!0){case n.includes("the create unique index statement terminated because a duplicate key was found for the object name"):t="invalidUniqueIdentifier";break;case n.includes("does not allow nulls"):t="cannotAddNullData";break;case n.includes("the value violates the maxlength limit of this column"):t="exceededMaxFieldLength";break;case n.includes("input string was not in a correct format"):t="invalidFieldType"}return console.error(e),{error:{code:t,message:JSON.stringify(e)}}}}},45831:(e,t,i)=>{i.r(t),i.d(t,{arcgis_new_item_pages_append_select_update:()=>h});var a=i(19564),n=i(23325),o=i(68334),s=i(62913),l=i(61191),r=i(33861),d=i(22020),c=i(8227),p=i(17233),u=i(4948);i(57159),i(98034),i(99004),i(44508),i(65174),i(18409),i(86868),i(18991),i(32084),i(91102),i(73807),i(98821),i(90079),i(32198),i(82297),i(76246),i(748),i(87382),i(97018),i(56288),i(93863),i(80015),i(24211),i(67336),i(78537),i(11163),i(11560),i(63330),i(66484),i(44069);const h=class{constructor(e){(0,a.r)(this,e),this.workflowComplete=(0,a.c)(this,"workflowComplete",7),this.newItemToggleNavigationEnabled=(0,a.c)(this,"newItemToggleNavigationEnabled",7),this.newItemDisableCloseButtons=(0,a.c)(this,"newItemDisableCloseButtons",7),this.newItemUpdatePage=(0,a.c)(this,"newItemUpdatePage",7),this.newItemPrevPage=(0,a.c)(this,"newItemPrevPage",7),this.newItemSetButtonState=(0,a.c)(this,"newItemSetButtonState",7),this.appendOptions={attribute:{icon:"table",updateGeometry:!1},attributeAndGeometry:{icon:"multiple-variables",updateGeometry:!0}},this.updateOptions={uploaded:{icon:"upload-to",keepDescription:!1},existing:{icon:"feature-details",keepDescription:!0}},this.noticeMessage=null,this.selected=void 0,this.cannotUpdateGeometry=!1,this.loading=!1,this.loaderType="indeterminate",this.loaderMessage=void 0,this.error=void 0}async componentWillLoad(){var e;this.selected="append"===r.u.workflow?"attribute":"uploaded",this.i18n=r.u.i18n.appendSelectUpdateType,"append"===r.u.workflow&&(null!==(e=this.noticeMessage)&&void 0!==e||(this.noticeMessage=(0,d.v)({dataLayer:l.a.dataLayer,type:l.a.type,sourceDataLayer:l.a.sourceDataLayer})),this.cannotUpdateGeometry=!!this.noticeMessage),r.u.nextText="updateAppend",this.newItemSetButtonState.emit({targetButton:"primary",state:{loading:!1,disabled:!1}})}async handleNext(){const e=this.selected;if("update"===r.u.workflow){l.a.addUpdateItemPropertiesOption=e;const t="uploaded"!==e;l.a.keepDescription=t,this.handleUpdate()}else l.a.addAppendSelectUpdateTypeOption=e,this.handleAppend()}async handlePrev(e){e.preventDefault(),!this.loading&&this.newItemPrevPage.emit()}async handleUpdate(){this.loading=!0,this.loaderMessage=r.u.i18n.append.appendLoadingMessages.updating;const{file:e,overwrite:t,keepDescription:i,existingItem:a,fileName:n}=l.a,s=await(0,p.f)(a.owner,a.portal),d=(0,p.g)(s,a.portal),c=await(0,o.u)(a,d,{file:e,overwrite:t,keepDescription:i,fileName:n});c.success?this.workflowComplete.emit({success:c.success}):(this.loading=!1,this.error={title:r.u.i18n.error,description:r.u.i18n.appendOverwrite.errors.errorWhileUpdate})}disableModalButtons(e){this.newItemToggleNavigationEnabled.emit(!e),this.newItemDisableCloseButtons.emit(e)}async handleAppend(){var e,t;this.disableModalButtons(!0),this.loading=!0,this.loaderMessage=r.u.i18n.append.appendLoadingMessages.appendCloseNotice;const i=await(0,n.a)({portal:null===u.c||void 0===u.c?void 0:u.c.portal,sourceDataLayer:l.a.sourceDataLayer,existingItem:l.a.existingItem,timezone:l.a.timezone,analyzeResults:l.a.analyzeResults,type:l.a.type,fieldMappings:l.a.fieldMappings,dataLayer:l.a.dataLayer,id:l.a.id,uidPair:l.a.uidPair,addAppendSelectOption:l.a.addAppendSelectOption,attachmentsEnabled:l.a.attachmentsEnabled,insertAttachmentsEnabled:l.a.insertAttachmentsEnabled});if("completed"!==(null===(e=null==i?void 0:i.result)||void 0===e?void 0:e.status.toLowerCase()))this.disableModalButtons(!1),this.loading=!1,this.newItemToggleNavigationEnabled.emit(!0),this.error=(0,c.h)(null!==(t=null==i?void 0:i.error)&&void 0!==t?t:{code:"unhandledError"},{appendErrorMessages:r.u.i18n.append.appendErrorMessages});else{await(0,s.d)(l.a.id,{permanentDelete:!0});const e=Object.assign({appendType:l.a.addAppendSelectOption},i);this.workflowComplete.emit(e)}}render(){const{i18n:e,appendOptions:t,updateOptions:i,noticeMessage:n,error:o}=this;let s=t,d=e.header,c="appendOptions";return"update"===r.u.workflow&&(s=i,d=e.itemPropertiesHeader,c="updateOptions"),"Raster function template"===l.a.type&&(c="updateRFTOptions"),(0,a.h)(a.H,{key:"ff6f46972fb909face7273c6b261ab7225a56043",class:{"overflow-hidden":this.loading}},(0,a.h)("arcgis-new-item-description",{key:"b9efa126ba08130a6d5e4ac875eaa3eb2345e0df",header:d}),(0,a.h)("div",{key:"1a8e992c9fe95b1565fca4b0385eebe040b7a0ba",class:"w-full"},(0,a.h)("div",{key:"78a358659b32a42f793595d7e27a616d2cddf38f",class:"w-full"},(0,a.h)("calcite-tile-group",{key:"66620cde993e09d5cdd5ecea01fa892bde024a5e",layout:"vertical",class:"tile-select",label:d,selectionMode:"single-persist"},Object.keys(s).map((t=>{const{icon:i}=s[t];return(0,a.h)("calcite-tile",{key:t,selected:this.selected===t,heading:e[c][t].title,description:e[c][t].description,icon:i,"input-enabled":!0,"data-value":t,disabled:"attributeAndGeometry"===t&&this.cannotUpdateGeometry,onCalciteTileSelect:e=>this.selected=e.target.dataset.value})}))))),"append"===r.u.workflow&&this.cannotUpdateGeometry&&(0,a.h)("calcite-notice",{key:"5b9c922627be7b62a8374e30beaec264e1ec61de",class:"need-geometries-notice",open:!0,icon:"lightbulb"},(0,a.h)("div",{key:"0985423795ba1742e2292d849e124319eecc379e",slot:"title"},e[n.title]),(0,a.h)("div",{key:"dd495345865337abacb31236e031babd58a22c4e",slot:"message"},e[n.description])),(0,a.h)("arcgis-new-item-loader",{key:"f5a9f8796bd35b18f6cf2d3b8c6c758a183537a7",type:this.loaderType,active:this.loading,text:this.loaderMessage}),(0,a.h)("arcgis-new-item-alert",{key:"2d00813a45c3bd893734dba7f161edaaa10671ac",heading:null==o?void 0:o.title,description:null==o?void 0:o.description,link:{href:null==o?void 0:o.link,title:null==o?void 0:o.linkText},active:!!o,onAlertDismiss:()=>this.error=null}))}get el(){return(0,a.d)(this)}};h.style=".div-w-full{width:100%}.tile-select{margin-top:1.25rem}.need-geometries-notice{margin-top:1.5rem}calcite-tile-group{inline-size:100%}calcite-tile{max-inline-size:100%;min-inline-size:100%}"},91102:(e,t,i)=>{i.d(t,{a:()=>r,c:()=>n,d:()=>d,g:()=>o,i:()=>s,s:()=>l});var a=i(73807);function n(e,t){return function e(i){return i?i.closest(t)||e(function(e){return e.getRootNode()}(i).host||null):null}(e)}function o(e){const t=n(e,".calcite-mode-dark, .calcite-mode-light");return(null==t?void 0:t.classList.contains("calcite-mode-dark"))?"dark":"light"}function s(e){let t=e;for(;null==t?void 0:t.parentNode;){if(t.parentNode===document)return!0;t=t.parentNode instanceof ShadowRoot?t.parentNode.host:t.parentNode}return!1}function l(e){return(new a.S).sanitize(e)}function r(e){const t=l(e),i=document.createElement("div");return i.innerHTML=t,i.textContent||i.innerText||""}function d(e){const t=document.createElement("textarea");return t.innerHTML=e,t.value}},22020:(e,t,i)=>{function a(e){var t,i;const{dataLayer:a,type:n,sourceDataLayer:o}=e,s=null!==(t=null==a?void 0:a.geometryType)&&void 0!==t?t:null===(i=null==a?void 0:a.layerInfo)||void 0===i?void 0:i.geometryType;if("Microsoft Excel"===n||"CSV"===n){if(("address"===a.locationType&&a.addressFields||"coordinates"===a.locationType)&&"esriGeometryPoint"===(null==o?void 0:o.geometryType))return null;if(!s||"none"===a.locationType||"Table"===(null==o?void 0:o.type))return{title:"noGeometryMatchTitle",description:"noGeometryTableMessage"};if((null==o?void 0:o.geometryType)!==s)return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"}}else{if((null==o?void 0:o.geometryType)!==(null==a?void 0:a.geometryType))return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"};if("table"===(null==o?void 0:o.type.toLowerCase()))return{title:"noGeometryMatchTitle",description:"noGeometryMatchMessage"}}}function n(e,t,i){return"Microsoft Excel"===i||"CSV"===i?"Table"===(null==t?void 0:t.type)||("esriGeometryPoint"===(null==t?void 0:t.geometryType)&&"none"===(null==e?void 0:e.locationType)||"esriGeometryPoint"===(null==t?void 0:t.geometryType)&&(!!e.addressFields||"none"!==e.locationType)):"Table"===(null==t?void 0:t.type)||(null==e?void 0:e.geometryType)===(null==t?void 0:t.geometryType)}i.d(t,{c:()=>n,v:()=>a})}}]);