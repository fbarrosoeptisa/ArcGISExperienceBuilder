/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_servic-0ad95c.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_servic-0ad95c"],{76246:(e,r,t)=>{t.d(r,{a:()=>i,i:()=>n});const i={FeatureServer:"Feature Service",GeocodeServer:"Geocoding Service",GeoDataServer:"Geodata Service",GeometryServer:"Geometry Service",GeoenrichmentServer:"Geoenrichment Service",GPServer:"Geoprocessing Service",GlobeServer:"Globe Service",ImageServer:"Image Service",MapServer:"Map Service",NAServer:"Network Analysis Service",ElevationServer:"Image Service",VectorTileServer:"Vector Tile Service",SceneServer:"Scene Service",StreamServer:"Stream Service",WMServer:"Workflow Manager Service",TiledImageServer:"Image Service",VideoServer:"Video Service",KnowledgeGraphServer:"Knowledge Graph Layer"},n=e=>!!Object.values(i).includes(e)},24057:(e,r,t)=>{t.d(r,{a:()=>f,f:()=>y,s:()=>g});var i=t(44508),n=t(65174),o=t(4948),s=t(57159),l=t(748);function a(e,r,t){var i,n;return{description:e.description,fieldAliases:null===(i=e.fields)||void 0===i?void 0:i.map((e=>e.alias)),fields:e.fields,geometryType:t?"table":e.geometryType,id:e.id,title:e.name||e.title,type:e.type,matched:null===(n=null==r?void 0:r.find((r=>r.id===e.id)))||void 0===n?void 0:n.matched,sourceJSON:e}}function c(e,r,t){const{config:i}=o.c,n=(0,l.b)(e),a=Object.assign(Object.assign({useProxy:!1,timeout:!1===i.isMultiTenant?6e4:5e3,addSSL:n},r?{}:{addTokenManually:!1}),{usePost:!0,disableIdentityLookup:!t});return(0,s.r)(e,{},a,"post")}function d(e){var r,t;return(null==e?void 0:e.code)||(null===(t=null===(r=null==e?void 0:e.details)||void 0===r?void 0:r.raw)||void 0===t?void 0:t.code)}function u(e){const r=d(e);return[404,500].includes(r)||"Invalid URL"===(null==e?void 0:e.message)}function v(e,r){const t=d(r),i=498===t&&"Invalid Token"===(null==r?void 0:r.message),n=499===t&&("Token Required"===(null==r?void 0:r.message)||"Token required."===(null==r?void 0:r.message));return!e&&(n||403===t||i)&&!!o.c.user}async function f(e,r,t,i){const n={error:{code:"unhandledError"}};try{try{return{result:await c(`${t}/${r}`,i)}}catch(o){return v(i,o)?f(e,r,t,!0):(u(o)&&(n.error.code="serviceNotExist"),n)}}catch(e){return n}}function p(e,r,t,i){var n,o;const s=null==t?void 0:t.tables,l=(null===(n=null==t?void 0:t.layers)||void 0===n?void 0:n.length)>0||s,c=[...((null==t?void 0:t.layers)||[]).map((e=>e.id)),...null===(o=(null==t?void 0:t.tables)||[])||void 0===o?void 0:o.map((e=>e.id))];return(e||[]).filter((({id:e,type:r})=>!l||"Table"===r&&!s||c.includes(e))).map((e=>a(e,r,i)))}function g(e,r){return e.map((e=>{var t;return Object.assign(Object.assign({},e),{matched:null===(t=null==r?void 0:r.find((r=>r.id===e.id)))||void 0===t?void 0:t.matched})}))}async function y({item:e,portal:r,layers:t,isSecure:o,data:s,allowLoginWindow:l,retry:d}){var f,g,m;const S={error:{code:"unhandledError"}};try{if(!s&&!d)try{const t=(0,n.g)(r),o=t?`&token=${t}`:"",l=`${(0,i.g)(r)}content/items/${e.id}/data?f=json${o}`,a=await fetch(l),c=await a.text();if(c&&(s=JSON.parse(c)),(null==s?void 0:s.error)&&403===s.error.code&&"SB_0006"===(null===(f=s.error)||void 0===f?void 0:f.messageCode))return S.error.code="serviceNotExist",S}catch(e){s=null}if("Feature Collection"===e.type&&(null==s?void 0:s.layers))return{result:{sublayers:s.layers.map((({layerDefinition:e},r)=>{var t;return{description:"",fields:e.fields,fieldAliases:null===(t=e.fields)||void 0===t?void 0:t.map((e=>e.alias)),geometryType:e.geometryType,type:e.type,id:r,matched:!1,title:e.name}}))}};try{const{url:r}=e,i=await c(r,o,l),n=await async function({serviceInfo:e,item:r,layers:t,isSecure:i,allowLoginWindow:n,data:o}){var s,l;const{url:d}=r;if(!(null===(s=e.layers)||void 0===s?void 0:s.length)&&!(null===(l=e.tables)||void 0===l?void 0:l.length)&&(null==e?void 0:e.fields))return{result:{sublayers:[a(e,t)],serviceInfo:e}};try{const{layers:r,tables:s}=await c(`${d}/layers`,i,n);return{result:{sublayers:[...p(r,t,o),...p(s,t,o,!0)].sort(((e,r)=>e.id-r.id)),serviceInfo:e}}}catch(e){return{error:{code:"unhandledError"}}}}({serviceInfo:i,item:e,layers:t,isSecure:o,allowLoginWindow:l,data:s});return(null===(g=e.typeKeywords)||void 0===g?void 0:g.includes("SubtypeGroupLayer"))&&n.result.sublayers&&(null===(m=null==s?void 0:s.layers)||void 0===m?void 0:m.length)&&(n.result.sublayers=n.result.sublayers.reduce(((e,r)=>{var t;const i=s.layers.find((({id:e})=>e===r.id));return"SubtypeGroupLayer"===(null==i?void 0:i.layerType)&&(null===(t=i.layers)||void 0===t?void 0:t.length)?[...e,r,...i.layers.map((e=>Object.assign(Object.assign({},a(e)),{geometryType:r.geometryType})))]:[...e,r]}),[])),n}catch(i){return v(o,i)?y({item:e,portal:r,layers:t,data:s,isSecure:!0,allowLoginWindow:l}):(u(i)&&(S.error.code="serviceNotExist"),S)}}catch(e){return S}}},53076:(e,r,t)=>{t.d(r,{a:()=>d,b:()=>c,c:()=>u,d:()=>o,e:()=>n,g:()=>l,r:()=>a,s:()=>s,u:()=>v});var i=t(26408);function n(e,r,t,i){!function(e,r,t){t=t||{};let i=null==t?void 0:t.expires;if("number"==typeof i){const e=new Date,r=24*i*60*60*1e3;e.setTime(Date.now()+r),i=t.expires=e}"string"!=typeof i&&(null==i?void 0:i.toUTCString)&&(t.expires=i.toUTCString());let n,o=`${e}=${encodeURIComponent(r)}`;for(n in t){o+=`; ${n}`;const e=t[n];!0!==e&&(o+=`=${e}`)}document.cookie=o}(e,i?JSON.stringify(r):r,t)}function o(e,r){const t=function(e){const r=document.cookie,t=new RegExp(`(?:^|; )${(0,i.f)(e)}=([^;]*)`),n=r.match(t);return n?decodeURIComponent(n[1]):void 0}(e);return t&&r?JSON.parse(t):t}function s(e,r,t){window.localStorage.setItem(e,t?JSON.stringify(r):r)}function l(e,r){const t=window.localStorage.getItem(e);return t&&r?JSON.parse(t):t}function a(e){window.localStorage.removeItem(e)}function c(e,r,t){window.sessionStorage.setItem(e,t?JSON.stringify(r):r)}function d(e,r){const t=window.sessionStorage.getItem(e);return t&&r?JSON.parse(t):t}function u(e){window.sessionStorage.removeItem(e)}function v(e,r,t){const i=new Date(r);i.setFullYear(r.getFullYear()+1),n(e,t,{expires:i}),t?s(e,"true",!1):a(e)}},748:(e,r,t)=>{t.d(r,{a:()=>w,b:()=>y,c:()=>g,d:()=>u,e:()=>S,f:()=>h,g:()=>f,h:()=>m,i:()=>O,j:()=>d,r:()=>c,s:()=>p,u:()=>v});var i=t(44508),n=t(4948),o=t(98034),s=t(53076),l=t(76246),a=t(87382);function c(e){return"/"===(null==e?void 0:e.slice(-1))?e.slice(0,e.length-1):e}function d(e){return e.startsWith("/")||e.startsWith("\\")?e.slice(1):e}async function u(e){var r;const t=null!==(r=null===n.c||void 0===n.c?void 0:n.c.api)&&void 0!==r?r:4,[i]=await(0,o.l)([4===t?"esri/core/urlUtils":"esri/urlUtils"]);let s=i.urlToObject(e);s.query=s.query||{};for(let e in s.query||{})s.query.hasOwnProperty(e)&&(Array.isArray(s.query[e])||(s.query[e]=s.query[e].replace(/(&lt;|&gt;|<|>|%3C|%3E)/g,"")));return s}function v(e){return(null==e?void 0:e.replace(/^.*\//,"").replace(/.[^.]*$/,""))||""}function f(e){const r=(null==e?void 0:e.replace(/^.*\//,"").replace(/\?+.*/,""))||"",t=r.replace(/^.*\./,"").toLowerCase();return a.b.includes(t)?r:""}function p(e){return["WFS","GeoJson","CSV","GeoRSS","KML","OGCFeatureServer","WMS","WMTS","WCS"].includes(e)}function g(e){const{config:r,portal:t}=n.c;let i=!1;if(!e)return!1;if((r.httpsDomains||[]).forEach((r=>{(e.indexOf(`.${r}/`)>-1||e.indexOf(`/${r}/`)>-1)&&(i=!0)})),!i){let r=t.portalHostname;r.indexOf("/")>-1&&(r=r.substring(0,r.indexOf("/"))),e.indexOf(r)>-1&&(i=!0)}return i}function y(e){if(!e)return!1;const{config:r,portal:t}=n.c,o=(0,i.g)(t),s=new URL(o).hostname,l=!1===r.isMultiTenant,a=-1!==e.indexOf(".arcgis.com/"),c=-1!==e.indexOf("//services")||-1!==e.indexOf("//tiles")||-1!==e.indexOf("//features")||-1!==e.indexOf("//locationservices"),d=t.supportsHostedServices&&-1!==e.indexOf(s)&&!l;return a&&c||!a&&d}function m(){var e;if(-1===window.location.protocol.toLowerCase().indexOf("https")){const r=(0,s.d)("esri_auth",!0);return"web"!==(null===(e=null==r?void 0:r.auth_tier)||void 0===e?void 0:e.toLowerCase())}return!0}function S(e){let r=e.toLowerCase();-1==r.indexOf("http://")&&-1==r.indexOf("https://")&&(r=(e="https://"+e).toLowerCase());let t=r.indexOf("//");t=r.indexOf("/",t+2),-1==t?r=(e+="/arcgis/rest/services").toLowerCase():t==r.length-1&&(r=(e+="arcgis/rest/services").toLowerCase());let i=r.indexOf("/arcgis",t);i==r.length-7?r=(e+="/rest/services").toLowerCase():i==r.length-8&&(r=(e+="rest/services").toLowerCase()),i=r.indexOf("/server",t),r.endsWith("/server")?r=(e+="/rest/services").toLowerCase():r.endsWith("/server/")&&(r=(e+="rest/services").toLowerCase());const n=r.indexOf("/rest/services",t),o=r.indexOf("/services",t),s=r.indexOf("/rest",t);return-1==n&&o>-1?r=(e=`${e.substring(0,o)}/rest/services${e.substring(o+9)}`).toLowerCase():-1==n&&s>-1&&(r=(e=`${e.substring(0,s)}/rest/services${e.substring(s+5)}`).toLowerCase()),r.indexOf("/rest/services"),e}const h=(e,r=!1)=>(e=c(e=e.trim()),/(http|https|ftp):\/\/?/.exec(e)||(e=`https://${e}`),!r&&"https:"!==location.protocol||!y(e)&&!g(e)||(e=e.replace("http:/","https:/")),e=e.indexOf("/dynamicLayer?")>-1?e.substring(0,e.indexOf("/dynamicLayer?")):e),w=(e,r=!1)=>{var t,n,o;if(!e)return{error:{code:"invalidUrl"}};if(O(e,r))return{error:{code:"httpWarning"}};const s=decodeURIComponent(e),a=s.replace(i.v,"").match(/((\.|\/)*(kml|kmz))/gi),c=s.replace(i.v,"").match(/((\/|\=)(wmts|wms|wfs|wcs))/gi),d=s.replace(i.v,"").match(/((\/|\=)(OGC|OGCFeatureServer))/gi),u=s.replace(i.v,"").match(/((\.|\/)*(rss))/gi),v=null===(t=s.replace(i.v,"").match(i.r))||void 0===t?void 0:t[1],f=s.replace(i.v,"").match(i.h),p=s.replace(i.v,"").match(/((\.|\/)*(csv))/gi),g=s.replace(i.v,"").match(/(\.|\/)((\$?{(z|level)})\/*(\$?{(x|col)})\/*(\$?{(y|row)}))/gi);let y=null;if(s.match(i.f))y="GeoJson";else if(!d||c||v)if(v&&!c)y=l.a[v];else if(f)y="Map Service";else if(c){const e="/"===(null==c?void 0:c[0].charAt(0))?"/":"=";y=null===(o=null===(n=null==c?void 0:c[0])||void 0===n?void 0:n.split(e)[1])||void 0===o?void 0:o.toUpperCase()}else a?y="KML":u?y="GeoRSS":p?y="CSV":g?y="Tile Layer":s.endsWith("KnowledgeGraphServer")&&(y="Knowledge Graph");else y="OGCFeatureServer";return{result:y}},O=(e,r)=>!r&&e.includes("http://")}}]);