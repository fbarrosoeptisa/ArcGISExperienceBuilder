/*! For license information please see arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f8c6cb.js.LICENSE.txt */
"use strict";(self.webpackChunkexb_client=self.webpackChunkexb_client||[]).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-f8c6cb"],{99004:(e,t,a)=>{a.d(t,{c:()=>i,g:()=>s});var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==a.g?a.g:"undefined"!=typeof self?self:{};function s(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}},34815:(e,t,a)=>{a.r(t),a.d(t,{arcgis_new_item_pages_data_store_database_credentials:()=>u});var i=a(19564),s=a(4948),r=a(97018),n=a(5497),o=a(48218),c=a(61191),l=a(33861),d=a(78964);a(18991),a(87382),a(44508),a(5076),a(57159),a(98034),a(99004),a(65174),a(18409),a(86868),a(32084),a(91102),a(73807),a(98821),a(90079),a(32198),a(62913),a(17233),a(67336),a(82297),a(76246),a(748),a(56288),a(93863),a(80015),a(24211);const u=class{constructor(e){(0,i.r)(this,e),this.newItemUpdatePage=(0,i.c)(this,"newItemUpdatePage",7),this.handleFileInputChange=e=>{this.processFile(e.target.files[0])},this.authenticationType="serviceAuthentication",this.loading=!1,this.loaderType="indeterminate",this.loaderMessage=void 0,this.refreshToken=void 0,this.keyFileContents=void 0,this.projectId=void 0,this.defaultDataset=void 0,this.server=void 0,this.user=void 0,this.password=void 0,this.role=void 0,this.database=void 0,this.schema=void 0,this.warehouse=void 0,this.validJson=!0,this.invalidLogin=!1,this.emptyFieldsExist=!1,this.keyFileName=void 0,this.error=void 0}async handleNext(){c.a.authenticationType=this.authenticationType,c.a.refreshToken=this.refreshToken,c.a.projectID=this.projectId,c.a.defaultDataset=this.defaultDataset,c.a.snowflakeServer=this.server,c.a.snowflakeUsername=this.user,c.a.snowflakePassword=this.password,c.a.role=this.role,c.a.database=this.database,c.a.schema=this.schema,c.a.warehouse=this.warehouse,this.checkValidFields()?(c.a.databaseConnectionPath=this.createDatabaseConnectionPath(),await this.validateConnection()):this.handleError({code:"unhandledError"})}async componentWillLoad(){this.dataStoreConnectionType=c.a.databaseProvider,this.i18n=l.u.i18n.dataStoreDatabaseCredentials,this.populateFields()}checkValidFields(){const{projectId:e,keyFileName:t,server:a,database:i,schema:s,warehouse:r,role:n,user:o,password:c,dataStoreConnectionType:l}=this,d="snowflake"===l?[a,i,s,r,n,o,c]:[t,e];return this.emptyFieldsExist=d.some((e=>!e)),!this.emptyFieldsExist}populateFields(){var e;this.server=c.a.snowflakeServer,null!==(e=this.authenticationType)&&void 0!==e||(this.authenticationType=c.a.authenticationType),this.projectId=c.a.projectID,this.defaultDataset=c.a.defaultDataset,this.role=c.a.role,this.database=c.a.database,this.schema=c.a.schema,this.warehouse=c.a.warehouse}createDatabaseConnectionPath(){const{dataStoreConnectionType:e,authenticationType:t,projectId:a,defaultDataset:i,server:s,user:r,role:n,database:o,schema:l,warehouse:d}=this;let u;switch(e){case"bigQuery":u=`${this.i18n.bigQuery}/${"serviceAuthentication"===t?this.i18n.serviceAuthentication:this.i18n.userAuthentication}/${a}/${i}`;break;case"snowflake":u=`${s}/${r}/${n}/${o}/${l}/${d}`}return c.a.databaseConnectionPath=u,u}async validateConnection(){const{dataStoreConnectionType:e,projectId:t,defaultDataset:a,keyFileContents:i,refreshToken:r,user:l,password:u,database:h,role:f,server:p,warehouse:v,schema:b}=this;let m;const{orgId:y}=s.c.user;this.invalidLogin=!1,this.loading=!0,this.loaderMessage=this.i18n.validating;const k=i||"",g=r||"";if("bigQuery"===e){const e=await(0,d.f)(t,a,k,g);if(null==e?void 0:e.error)return"invalidJSON"===e.error.code&&(this.validJson=!1),void this.handleError({code:e.error.code});m=e.result,c.a.jdbcConnection=Object.assign({},m.info.JDBCConnection)}else m=(0,d.h)({user:l,password:u,database:h,role:f,server:p,warehouse:v,schema:b}),c.a.jdbcConnection=Object.assign({},m.info.JDBCConnection),c.a.typeKeywords=[...c.a.typeKeywords,"CDW","snowflake"];const w="bigQuery"===e?t:h;c.a.initialTitle=(0,o.f)(e,w);const{result:I,error:F}=await(0,n.v)(y,s.c.portal,m);"success"===(null==I?void 0:I.status)?this.newItemUpdatePage.emit("itemProperties"):this.handleError(F)}processFile(e){if(!e)return;const{extension:t,fileName:a}=(0,r.s)(e);if(this.keyFileName=a,"json"!==t)return void(this.validJson=!1);this.validJson=!0;const i=new FileReader;i.onload=e=>{this.keyFileContents=String(e.target.result)},i.readAsText(e)}trimInput(e){return e.trim()}handleError(e){this.loading=!1;let t=this.i18n.errors.validationFailedTitle,a=this.i18n.errors.invalidConnection;switch(e.code){case"invalidJSON":t=l.u.i18n.itemProperties.invalidJSON.title,a=l.u.i18n.itemProperties.invalidJSON.description;break;case"invalidUsernameOrPassword":this.invalidLogin=!0;break;case"invalidSnowflakeServer":case"invalidSnowflakeWarehouse":case"invalidSnowflakeDatabase":case"invalidSnowflakeSchema":case"invalidSnowflakeRole":case"invalidBigQueryProjectId":case"invalidCredentials":a=this.i18n.errors[e.code]}this.error={title:t,description:a,details:e.details}}render(){const{dataStoreConnectionType:e,i18n:t,server:a,authenticationType:s,projectId:r,defaultDataset:n,role:o,database:c,schema:l,warehouse:d,validJson:u,error:h,invalidLogin:f}=this;return(0,i.h)("div",{key:"642136ecccc5dc03a02af12373fe511e5ad0a0e2"},(0,i.h)("arcgis-new-item-loader",{key:"45d48baf619ea1291212143d9d5c8a2dc0e77347",type:this.loaderType,active:this.loading,text:this.loaderMessage}),(0,i.h)("arcgis-new-item-description",{key:"a7922ed68e799b136d8dfd4ec24c8b08670abacb",class:"header",header:t.dataStoreConnection,content:"bigQuery"===e?t.bigQuery:t.snowflake}),(0,i.h)("div",{key:"f055307eb51fa427be161282c2ff040ad1e038ae",class:"configure-form"},"snowflake"===e&&(0,i.h)("calcite-label",{key:"b6e70a484af4a926d9fe4121434c9c011b2527d5",class:"field"},t.server,(0,i.h)("calcite-input",{key:"88c162822964e2dac5345c99bd65414992a93a3b",placeholder:"server_name.com",value:a,onInput:e=>{this.server=this.trimInput(e.target.value)},required:!0}),!this.server&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"9c013d2c00db3edd02902447b667cddd346a0623",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noServer)),(0,i.h)("calcite-label",{key:"c88e10cf68ef05c03b4b477139b00033d8b49aea",class:"field"},t.authenticationType,(0,i.h)("calcite-select",{key:"02e83a820d437008a77f342580d33e114080d587",value:s,label:"authentication-type",disabled:!0,onCalciteSelectChange:e=>{this.authenticationType=e.target.selectedOption.value}},"bigQuery"===e?(0,i.h)("calcite-option",{value:"serviceAuthentication"},t.serviceAuthentication):(0,i.h)("calcite-option",{value:"userAuthentication"},t.userAuthentication))),"bigQuery"===e&&(0,i.h)("div",{key:"acecc7f709b503bd2e5af113ffa69fec6a4fa5e4",class:"configureBigQuery"},"serviceAuthentication"===s?(0,i.h)("calcite-label",{class:"field keyFileInput"},t.keyFile,(0,i.h)("calcite-input",{status:!u||!this.keyFileName&&this.emptyFieldsExist?"invalid":"valid","read-only":!0,value:this.keyFileName,required:!0},(0,i.h)("calcite-button",{"icon-start":"folder",slot:"action",kind:"neutral",appearance:"outline",onClick:()=>{var e;return null===(e=this.inputFileElement)||void 0===e?void 0:e.click()}},t.selectKeyFile)),(0,i.h)("input",{class:"hidden",type:"file",id:"snowflake-key-file",accept:".json",onChange:this.handleFileInputChange,ref:e=>this.inputFileElement=e}),(0,i.h)("calcite-input-message",{icon:!u||!this.keyFileName&&this.emptyFieldsExist?"exclamation-mark-triangle":"information",status:!u||!this.keyFileName&&this.emptyFieldsExist?"invalid":"idle"},!this.keyFileName&&this.emptyFieldsExist?t.errors.noKeyFile:u?t.jsonOnly:t.notJson)):(0,i.h)("calcite-label",{class:"field refreshTokenInput"},t.refreshToken,(0,i.h)("calcite-input",{type:"password",status:"valid",onInput:e=>{this.refreshToken=e.target.value}})),(0,i.h)("calcite-label",{key:"a795d562b25d461518526647bbfb50b987b51c87",class:"field"},t.projectId,(0,i.h)("calcite-input",{key:"0b7f91d8d5d2c119987c6b1b197f19d479e7f638",value:r,onInput:e=>{this.projectId=this.trimInput(e.target.value)},required:!0}),!this.projectId&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"8fec9f5286e5ab828a1a2e00486431f2c2b4d5a0",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noProjectId)),"userAuthentication"===s&&(0,i.h)("calcite-label",{key:"22edb068891d627ad740f9033dea937c334092ec",class:"field"},t.defaultDataset,(0,i.h)("calcite-input",{key:"07284f46577ab41e58ef2ccd29d94d1fa614fb86",value:n,onInput:e=>{this.defaultDataset=this.trimInput(e.target.value)}}))),"snowflake"===e&&(0,i.h)("div",{key:"c7165624969cc32775dfa99fd77e3ea51ce9026a",class:"configureSnowflake"},(0,i.h)("div",{key:"f8edb236d1b52e602057a6a2959ce63bd3949024",class:"field fill-credentials"},(0,i.h)("calcite-label",{key:"c8a62eee4558c6df09c9e323d8dfbd709c54f674",class:"credentials"},(0,i.h)("div",{key:"b88eb01dfc0a8fe7524ca53fefe8ead7f80e0bc3",class:"username"},t.username," ",(!this.user&&this.emptyFieldsExist||f)&&(0,i.h)("span",{key:"191925e28fab9a55c28b3916ebc1e43f7715a25e",class:"asterisk"},"*")),(0,i.h)("calcite-input",{key:"78c3e8bf8be6a48431ced6675b12ec998e928599",onInput:e=>{this.user=this.trimInput(e.target.value)},required:!0}),((!this.user||!this.password)&&this.emptyFieldsExist||f)&&(0,i.h)("calcite-input-message",{key:"78e22791e38b1bd29f92ae0b53c2d9b06f069f7b",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.incorrectLogin)),(0,i.h)("calcite-label",{key:"df10fffee5c14db6ae9bd1b06a390c97117cde88",class:"credentials"},(0,i.h)("div",{key:"0db26a26db30e59b3b1a535ce418c1b331a21138",class:"password"},t.password," ",(!this.password&&this.emptyFieldsExist||f)&&(0,i.h)("span",{key:"e9f06fc284a6b54cae1fcc9752701bb5d2709e13",class:"asterisk"},"*")),(0,i.h)("calcite-input",{key:"634a625d0558dc8136d8d8144204a277dc09c599",class:"credentials password",type:"password",onInput:e=>{this.password=this.trimInput(e.target.value)},required:!0}))),(0,i.h)("calcite-label",{key:"59755743a8b26d1a38a8b1bd47e55dd7929e9d0e",class:"field"},t.database,(0,i.h)("calcite-input",{key:"8fecc6bd15b278358063896fc0aca288ca8d2148",value:c,onInput:e=>{this.database=this.trimInput(e.target.value)},required:!0}),!this.database&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"b646ccd4d2ac5d5899f496b9fe6f88de1fc5e5f3",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noDatabase)),(0,i.h)("calcite-label",{key:"86f32de67bf6116f474815a925051ee24442d836",class:"field"},t.schema,(0,i.h)("calcite-input",{key:"53626e0f5c0f6d7e6318c41d951c76a28c9522ce",value:l,onInput:e=>{this.schema=this.trimInput(e.target.value)},required:!0}),!this.schema&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"0d6c8e1c4dd5b53165508c7edb22a74e3b87c971",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noSchema)),(0,i.h)("calcite-label",{key:"0d69c7422728a7bfe1f20912aa448dda0ec44e5f",class:"field"},t.warehouse,(0,i.h)("calcite-input",{key:"160b650658119273a725987a54f7b4fcddfd24bd",value:d,onInput:e=>{this.warehouse=this.trimInput(e.target.value)},required:!0}),!this.warehouse&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"620a2dc832a8ff7f54ea3eeab1f7330abc1792f3",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noWarehouse)),(0,i.h)("calcite-label",{key:"375ead24665a88ca5e6fe5efbdbb22144cf15bcf",class:"field"},t.role,(0,i.h)("calcite-input",{key:"06cd8aabf1fe49a24d6e8dce93b81ea53806061a",value:o,onInput:e=>{this.role=this.trimInput(e.target.value)},required:!0}),!this.role&&this.emptyFieldsExist&&(0,i.h)("calcite-input-message",{key:"b9588a089d6a7c04f76226d0f843966cb0389201",icon:"exclamation-mark-triangle",status:"invalid"},t.errors.noRole)))),(0,i.h)("arcgis-new-item-alert",{key:"a0bb5a221eb82adfda6ef5e519e6e768ba2ce61c",heading:null==h?void 0:h.title,description:null==h?void 0:h.description,details:null==h?void 0:h.details,detailsPopoverLabel:t.errorDetails,active:!!h,onAlertDismiss:()=>this.error=null}))}};u.style=".configure-form{margin-top:1.5rem}.fill-credentials{display:flex}.credentials{flex:1 1 0%}.password{margin-inline-start:3rem}.info-icon{color:var(--calcite-color-brand)}.hidden{display:none}calcite-label{--calcite-label-margin-bottom:1.25rem}.asterisk{color:var(--calcite-color-status-danger)}"},48218:(e,t,a)=>{a.d(t,{f:()=>i});const i=(e,t)=>{let a;const i=null!=t?t:"";switch(e){case"amazon":a=`AmazonS3_${i}`;break;case"azure":a=`Microsoft_Azure_Storage_${i}`;break;case"bigQuery":a=`BigQuery_${i}`;break;case"snowflake":a=`Snowflake_${i}`}return a.replace(/ /g,"_").replace(/-/g,"_")}},91102:(e,t,a)=>{a.d(t,{a:()=>c,c:()=>s,d:()=>l,g:()=>r,i:()=>n,s:()=>o});var i=a(73807);function s(e,t){return function e(a){return a?a.closest(t)||e(function(e){return e.getRootNode()}(a).host||null):null}(e)}function r(e){const t=s(e,".calcite-mode-dark, .calcite-mode-light");return(null==t?void 0:t.classList.contains("calcite-mode-dark"))?"dark":"light"}function n(e){let t=e;for(;null==t?void 0:t.parentNode;){if(t.parentNode===document)return!0;t=t.parentNode instanceof ShadowRoot?t.parentNode.host:t.parentNode}return!1}function o(e){return(new i.S).sanitize(e)}function c(e){const t=o(e),a=document.createElement("div");return a.innerHTML=t,a.textContent||a.innerText||""}function l(e){const t=document.createElement("textarea");return t.innerHTML=e,t.value}},98034:(e,t,a)=>{a.d(t,{e:()=>r,l:()=>n});var i,s=a(99004),r={exports:{}};i=r.exports,s.c,function(e){var t={Promise:"undefined"!=typeof window?window.Promise:void 0},a="4.24",i="next";function s(e){if(e.toLowerCase()===i)return i;var t=e&&e.match(/^(\d)\.(\d+)/);return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}function r(e){return void 0===e&&(e=a),"https://js.arcgis.com/".concat(e,"/")}function n(e){void 0===e&&(e=a);var t=r(e),n=s(e);if(n!==i&&3===n.major){var o=n.minor<=10?"js/":"";return"".concat(t).concat(o,"esri/css/esri.css")}return"".concat(t,"esri/themes/light/main.css")}function o(e){var t=document.createElement("link");return t.rel="stylesheet",t.href=e,t}function c(e,t){if(t){var a=document.querySelector(t);a.parentNode.insertBefore(e,a)}else document.head.appendChild(e)}function l(e){return document.querySelector('link[href*="'.concat(e,'"]'))}function d(e){return!e||s(e)?n(e):e}function u(e,t){var a=d(e),i=l(a);return i||c(i=o(a),t),i}var h={};function f(e){var t=document.createElement("script");return t.type="text/javascript",t.src=e,t.setAttribute("data-esri-loader","loading"),t}function p(e,t,a){var i;a&&(i=v(e,a));var s=function(){t(e),e.removeEventListener("load",s,!1),i&&e.removeEventListener("error",i,!1)};e.addEventListener("load",s,!1)}function v(e,t){var a=function(i){t(i.error||new Error("There was an error attempting to load ".concat(e.src))),e.removeEventListener("error",a,!1)};return e.addEventListener("error",a,!1),a}function b(e){void 0===e&&(e={}),h=e}function m(){return document.querySelector("script[data-esri-loader]")}function y(){var e=window.require;return e&&e.on}function k(e){void 0===e&&(e={});var a={};[h,e].forEach((function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(a[t]=e[t])}));var i=a.version,s=a.url||r(i);return new t.Promise((function(e,t){var r=m();if(r){var n=r.getAttribute("src");n!==s?t(new Error("The ArcGIS API for JavaScript is already loaded (".concat(n,")."))):y()?e(r):p(r,e,t)}else if(y())t(new Error("The ArcGIS API for JavaScript is already loaded."));else{var o=a.css;o&&u(!0===o?i:o,a.insertCssBefore),p(r=f(s),(function(){r.setAttribute("data-esri-loader","loaded"),e(r)}),t),document.body.appendChild(r)}}))}function g(e){return new t.Promise((function(t,a){var i=window.require.on("error",a);window.require(e,(function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];i.remove(),t(e)}))}))}function w(e,t){if(void 0===t&&(t={}),y())return g(e);var a=m(),i=a&&a.getAttribute("src");return!t.url&&i&&(t.url=i),k(t).then((function(){return g(e)}))}e.utils=t,e.loadModules=w,e.getScript=m,e.isLoaded=y,e.loadScript=k,e.setDefaultOptions=b,e.loadCss=u,Object.defineProperty(e,"__esModule",{value:!0})}(i);const n=async(e,t)=>(await r.exports.loadModules(e,t)).map((e=>e.__esModule&&e.default?e.default:e))}}]);